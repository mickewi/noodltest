!function(){function a(a,b,c){return a.call.apply(a.bind,arguments)}function b(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function c(d,e,f){return c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:b,c.apply(null,arguments)}function d(a,b){this.D=a,this.m=b||a,this.F=this.m.document}function e(a,b,c){a=a.F.getElementsByTagName(b)[0],a||(a=document.documentElement),a.insertBefore(c,a.lastChild)}function f(a,b,c){b=b||[],c=c||[];for(var d=a.className.split(/\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}for(b=[],e=0;e<d.length;e+=1){for(f=!1,g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function g(a,b){for(var c=a.className.split(/\s+/),d=0,e=c.length;e>d;d++)if(c[d]==b)return!0;return!1}function h(a){if("string"==typeof a.da)return a.da;var b=a.m.location.protocol;return"about:"==b&&(b=a.D.location.protocol),"https:"==b?"https:":"http:"}function i(a,b){var c=a.createElement("link",{rel:"stylesheet",href:b,media:"all"}),d=!1;c.onload=function(){d||(d=!0)},c.onerror=function(){d||(d=!0)},e(a,"head",c)}function j(a,b,c,d){var e=a.F.getElementsByTagName("head")[0];if(e){var f=a.createElement("script",{src:b}),g=!1;return f.onload=f.onreadystatechange=function(){g||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,"HEAD"==f.parentNode.tagName&&e.removeChild(f))},e.appendChild(f),setTimeout(function(){g||(g=!0,c&&c(Error("Script load timeout")))},d||5e3),f}return null}function k(a){this.ca=a||"-"}function l(a,b){this.V=a,this.N=4,this.H="n";var c=(b||"n4").match(/^([nio])([1-9])$/i);c&&(this.H=c[1],this.N=parseInt(c[2],10))}function m(a){return a.H+a.N}function n(a){var b=4,c="n",d=null;return a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10)))),c+b}function o(a,b){this.a=a,this.h=a.m.document.documentElement,this.J=b,this.f="wf",this.e=new k("-"),this.Z=!1!==b.events,this.u=!1!==b.classes}function p(a){a.u&&f(a.h,[a.e.d(a.f,"loading")]),r(a,"loading")}function q(a){if(a.u){var b=g(a.h,a.e.d(a.f,"active")),c=[],d=[a.e.d(a.f,"loading")];b||c.push(a.e.d(a.f,"inactive")),f(a.h,c,d)}r(a,"inactive")}function r(a,b,c){a.Z&&a.J[b]&&(c?a.J[b](c.getName(),m(c)):a.J[b]())}function s(){this.t={}}function t(a,b,c){var d,e=[];for(d in b)if(b.hasOwnProperty(d)){var f=a.t[d];f&&e.push(f(b[d],c))}return e}function u(a,b){this.a=a,this.q=b,this.j=this.a.createElement("span",{"aria-hidden":"true"},this.q)}function v(a,b){var c,d=a.j;c=[];for(var e=b.V.split(/,\s*/),f=0;f<e.length;f++){var g=e[f].replace(/['"]/g,"");-1==g.indexOf(" ")?c.push(g):c.push("'"+g+"'")}c=c.join(","),e="normal","o"===b.H?e="oblique":"i"===b.H&&(e="italic"),d.style.cssText="display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+c+";"+("font-style:"+e+";font-weight:"+(b.N+"00")+";")}function w(a){e(a.a,"body",a.j)}function x(a,b,c,d,e,f,g){this.O=a,this.ba=b,this.a=c,this.g=d,this.q=g||"BESbswy",this.s={},this.M=e||3e3,this.T=f||null,this.C=this.B=this.w=this.v=null,this.v=new u(this.a,this.q),this.w=new u(this.a,this.q),this.B=new u(this.a,this.q),this.C=new u(this.a,this.q),v(this.v,new l(this.g.getName()+",serif",m(this.g))),v(this.w,new l(this.g.getName()+",sans-serif",m(this.g))),v(this.B,new l("serif",m(this.g))),v(this.C,new l("sans-serif",m(this.g))),w(this.v),w(this.w),w(this.B),w(this.C)}function y(){if(null===R){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);R=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return R}function z(a,b,c){for(var d in Q)if(Q.hasOwnProperty(d)&&b===a.s[Q[d]]&&c===a.s[Q[d]])return!0;return!1}function A(a){var b,c=a.v.j.offsetWidth,d=a.w.j.offsetWidth;(b=c===a.s.serif&&d===a.s["sans-serif"])||(b=y()&&z(a,c,d)),b?P()-a.ea>=a.M?y()&&z(a,c,d)&&(null===a.T||a.T.hasOwnProperty(a.g.getName()))?C(a,a.O):C(a,a.ba):B(a):C(a,a.O)}function B(a){setTimeout(c(function(){A(this)},a),50)}function C(a,b){setTimeout(c(function(){this.v.remove(),this.w.remove(),this.B.remove(),this.C.remove(),b(this.g)},a),0)}function D(a,b,c){this.a=a,this.o=b,this.K=0,this.X=this.S=!1,this.M=c}function E(a){0==--a.K&&a.S&&(a.X?(a=a.o,a.u&&f(a.h,[a.e.d(a.f,"active")],[a.e.d(a.f,"loading"),a.e.d(a.f,"inactive")]),r(a,"active")):q(a.o))}function F(a){this.D=a,this.p=new s,this.U=0,this.P=this.Q=!0}function G(a,b,d,e,g){var h=0==--a.U;(a.P||a.Q)&&setTimeout(function(){var a=g||null,i=e||null||{};if(0===d.length&&h)q(b.o);else{b.K+=d.length,h&&(b.S=h);var j,k=[];for(j=0;j<d.length;j++){var l=d[j],n=i[l.getName()],o=b.o,p=l;o.u&&f(o.h,[o.e.d(o.f,p.getName(),m(p).toString(),"loading")]),r(o,"fontloading",p),o=null,o=new x(c(b.$,b),c(b.aa,b),b.a,l,b.M,a,n),k.push(o)}for(j=0;j<k.length;j++)k[j].start()}},0)}function H(a,b,c){var d=[],e=c.timeout;p(b);var d=t(a.p,c,a.a),f=new D(a.a,b,e);for(a.U=d.length,b=0,c=d.length;c>b;b++)d[b].load(function(b,c,d){G(a,f,b,c,d)})}function I(a,b,c){this.I=a?a:b+S,this.k=[],this.L=[],this.Y=c||""}function J(a){this.k=a,this.W=[],this.G={}}function K(a,b){this.a=a,this.c=b}function L(a,b){this.a=a,this.c=b,this.R=[]}function M(a,b){this.a=a,this.c=b}function N(a,b){this.a=a,this.c=b}function O(a,b){this.a=a,this.c=b}var P=Date.now||function(){return+new Date};d.prototype.createElement=function(a,b,c){if(a=this.F.createElement(a),b)for(var d in b)b.hasOwnProperty(d)&&("style"==d?a.style.cssText=b[d]:a.setAttribute(d,b[d]));return c&&a.appendChild(this.F.createTextNode(c)),a},k.prototype.d=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\W_]+/g,"").toLowerCase());return b.join(this.ca)},l.prototype.getName=function(){return this.V},u.prototype.remove=function(){var a=this.j;a.parentNode&&a.parentNode.removeChild(a)};var Q={ga:"serif",fa:"sans-serif"},R=null;x.prototype.start=function(){this.s.serif=this.B.j.offsetWidth,this.s["sans-serif"]=this.C.j.offsetWidth,this.ea=P(),A(this)},D.prototype.$=function(a){var b=this.o;b.u&&f(b.h,[b.e.d(b.f,a.getName(),m(a).toString(),"active")],[b.e.d(b.f,a.getName(),m(a).toString(),"loading"),b.e.d(b.f,a.getName(),m(a).toString(),"inactive")]),r(b,"fontactive",a),this.X=!0,E(this)},D.prototype.aa=function(a){var b=this.o;if(b.u){var c=g(b.h,b.e.d(b.f,a.getName(),m(a).toString(),"active")),d=[],e=[b.e.d(b.f,a.getName(),m(a).toString(),"loading")];c||d.push(b.e.d(b.f,a.getName(),m(a).toString(),"inactive")),f(b.h,d,e)}r(b,"fontinactive",a),E(this)},F.prototype.load=function(a){this.a=new d(this.D,a.context||this.D),this.Q=!1!==a.events,this.P=!1!==a.classes,H(this,new o(this.a,a),a)};var S="//fonts.googleapis.com/css";I.prototype.d=function(){if(0==this.k.length)throw Error("No fonts to load!");if(-1!=this.I.indexOf("kit="))return this.I;for(var a=this.k.length,b=[],c=0;a>c;c++)b.push(this.k[c].replace(/ /g,"+"));return a=this.I+"?family="+b.join("%7C"),0<this.L.length&&(a+="&subset="+this.L.join(",")),0<this.Y.length&&(a+="&text="+encodeURIComponent(this.Y)),a};var T={latin:"BESbswy",cyrillic:"&#1081;&#1103;&#1046;",greek:"&#945;&#946;&#931;",khmer:"&#x1780;&#x1781;&#x1782;",Hanuman:"&#x1780;&#x1781;&#x1782;"},U={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},V={i:"i",italic:"i",n:"n",normal:"n"},W=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;J.prototype.parse=function(){for(var a=this.k.length,b=0;a>b;b++){var c=this.k[b].split(":"),d=c[0].replace(/\+/g," "),e=["n4"];if(2<=c.length){var f,g=c[1];if(f=[],g)for(var g=g.split(","),h=g.length,i=0;h>i;i++){var j;if(j=g[i],j.match(/^[\w-]+$/))if(j=W.exec(j.toLowerCase()),null==j)j="";else{var k;if(k=j[1],null==k||""==k)k="4";else{var m=U[k];k=m?m:isNaN(k)?"4":k.substr(0,1)}j=j[2],j=[null==j||""==j?"n":V[j],k].join("")}else j="";j&&f.push(j)}0<f.length&&(e=f),3==c.length&&(c=c[2],f=[],c=c?c.split(","):f,0<c.length&&(c=T[c[0]])&&(this.G[d]=c))}for(this.G[d]||(c=T[d])&&(this.G[d]=c),c=0;c<e.length;c+=1)this.W.push(new l(d,e[c]))}};var X={Arimo:!0,Cousine:!0,Tinos:!0};K.prototype.load=function(a){for(var b=this.a,c=new I(this.c.api,h(b),this.c.text),d=this.c.families,e=d.length,f=0;e>f;f++){var g=d[f].split(":");3==g.length&&c.L.push(g.pop());var j="";2==g.length&&""!=g[1]&&(j=":"),c.k.push(g.join(j))}d=new J(d),d.parse(),i(b,c.d()),a(d.W,d.G,X)},L.prototype.A=function(a){var b=this.a;return h(this.a)+(this.c.api||"//f.fontdeck.com/s/css/js/")+(b.m.location.hostname||b.D.location.hostname)+"/"+a+".js"},L.prototype.load=function(a){var b=this.c.id,c=this.a.m,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var e=0,f=c.fonts.length;f>e;++e){var g=c.fonts[e];d.R.push(new l(g.name,n("font-weight:"+g.weight+";font-style:"+g.style)))}a(d.R)},j(this.a,this.A(b),function(b){b&&a([])})):a([])},M.prototype.A=function(a){return(this.c.api||"https://use.typekit.net")+"/"+a+".js"},M.prototype.load=function(a){var b=this.c.id,c=this.a.m;b?j(this.a,this.A(b),function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var d=[],e=0;e<b.length;e+=2)for(var f=b[e],g=b[e+1],h=0;h<g.length;h++)d.push(new l(f,g[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(i){}a(d)}},2e3):a([])},N.prototype.A=function(a,b){var c=h(this.a),d=(this.c.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"");return c+"//"+d+"/"+a+".js"+(b?"?v="+b:"")},N.prototype.load=function(a){var b=this.c.projectId,c=this.c.version;if(b){var d=this.a.m;j(this.a,this.A(b,c),function(c){if(c)a([]);else if(d["__mti_fntLst"+b]){c=d["__mti_fntLst"+b]();var e=[];if(c)for(var f=0;f<c.length;f++)e.push(new l(c[f].fontfamily));a(e)}else a([])}).id="__MonotypeAPIScript__"+b}else a([])},O.prototype.load=function(a){var b,c,d=this.c.urls||[],e=this.c.families||[],f=this.c.testStrings||{};for(b=0,c=d.length;c>b;b++)i(this.a,d[b]);for(d=[],b=0,c=e.length;c>b;b++){var g=e[b].split(":");if(g[1])for(var h=g[1].split(","),j=0;j<h.length;j+=1)d.push(new l(g[0],h[j]));else d.push(new l(g[0]))}a(d,f)};var Y=new F(window);Y.p.t.custom=function(a,b){return new O(b,a)},Y.p.t.fontdeck=function(a,b){return new L(b,a)},Y.p.t.monotype=function(a,b){return new N(b,a)},Y.p.t.typekit=function(a,b){return new M(b,a)},Y.p.t.google=function(a,b){return new K(b,a)};var Z={load:c(Y.load,Y)};"function"==typeof define&&define.amd?define(function(){return Z}):"undefined"!=typeof module&&module.exports?module.exports=Z:(window.WebFont=Z,window.WebFontConfig&&Y.load(window.WebFontConfig))}(),function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Application=a()}}(function(){var b;return function c(a,b,d){function e(g,h){if(!b[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=b[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,c,a,b,d)}return b[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g||b===l?62:b===h||b===m?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0),l="-".charCodeAt(0),m="_".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],2:[function(a,b,c){function d(a,b){return 1-3*b+3*a}function e(a,b){return 3*b-6*a}function f(a){return 3*a}function g(a,b,c){return((d(b,c)*a+e(b,c))*a+f(b))*a}function h(a,b,c){return 3*d(b,c)*a*a+2*e(b,c)*a+f(b)}function i(a,b,c,d,e){var f,h,i=0;do h=b+(c-b)/2,f=g(h,d,e)-a,f>0?c=h:b=h;while(Math.abs(f)>n&&++i<o);return h}function j(a,b,c,d){for(var e=0;l>e;++e){var f=h(b,c,d);if(0===f)return b;var i=g(b,c,d)-a;b-=i/f}return b}function k(a,b,c,d){if(4===arguments.length)return new k([a,b,c,d]);if(!(this instanceof k))return new k(a);if(!a||4!==a.length)throw new Error("BezierEasing: points must contains 4 values");for(var e=0;4>e;++e)if("number"!=typeof a[e]||isNaN(a[e])||!isFinite(a[e]))throw new Error("BezierEasing: points should be integers.");if(a[0]<0||a[0]>1||a[2]<0||a[2]>1)throw new Error("BezierEasing x values must be in [0, 1] range.");this._str="BezierEasing("+a+")",this._css="cubic-bezier("+a+")",this._p=a,this._mSampleValues=r?new Float32Array(p):new Array(p),this._precomputed=!1,this.get=this.get.bind(this)}var l=4,m=.001,n=1e-7,o=10,p=11,q=1/(p-1),r="function"==typeof Float32Array;k.prototype={get:function(a){var b=this._p[0],c=this._p[1],d=this._p[2],e=this._p[3];return this._precomputed||this._precompute(),b===c&&d===e?a:0===a?0:1===a?1:g(this._getTForX(a),c,e)},getPoints:function(){return this._p},toString:function(){return this._str},toCSS:function(){return this._css},_precompute:function(){var a=this._p[0],b=this._p[1],c=this._p[2],d=this._p[3];this._precomputed=!0,(a!==b||c!==d)&&this._calcSampleValues()},_calcSampleValues:function(){for(var a=this._p[0],b=this._p[2],c=0;p>c;++c)this._mSampleValues[c]=g(c*q,a,b)},_getTForX:function(a){for(var b=this._p[0],c=this._p[2],d=this._mSampleValues,e=0,f=1,g=p-1;f!==g&&d[f]<=a;++f)e+=q;--f;var k=(a-d[f])/(d[f+1]-d[f]),l=e+k*q,n=h(l,b,c);return n>=m?j(a,l,b,c):0===n?l:i(a,e,e+q,b,c)}},k.css={ease:k.ease=k(.25,.1,.25,1),linear:k.linear=k(0,0,1,1),"ease-in":k.easeIn=k(.42,0,1,1),"ease-out":k.easeOut=k(0,0,.58,1),"ease-in-out":k.easeInOut=k(.42,0,.58,1)},b.exports=k},{}],3:[function(a,b,c){(function(c){function d(a){if(!(this instanceof d))return new d(a);if(this._bufs=[],this.length=0,"function"==typeof a){this._callback=a;var b=function(a){this._callback&&(this._callback(a),this._callback=null)}.bind(this);this.on("pipe",function(a){a.on("error",b)}),this.on("unpipe",function(a){a.removeListener("error",b)})}else c.isBuffer(a)?this.append(a):Array.isArray(a)&&a.forEach(function(a){c.isBuffer(a)&&this.append(a)}.bind(this));e.call(this)}var e=a("readable-stream/duplex"),f=a("util");f.inherits(d,e),d.prototype._offset=function(a){for(var b,c=0,d=0;d<this._bufs.length;d++){if(b=c+this._bufs[d].length,b>a)return[d,a-c];c=b}},d.prototype.append=function(a){var b=c.isBuffer(a)||a instanceof d;return"number"==typeof a&&(a=a.toString()),this._bufs.push(b?a:new c(a)),this.length+=a.length,this},d.prototype._write=function(a,b,c){this.append(a),c&&c()},d.prototype._read=function(a){return this.length?(a=Math.min(a,this.length),this.push(this.slice(0,a)),void this.consume(a)):this.push(null)},d.prototype.end=function(a){e.prototype.end.call(this,a),this._callback&&(this._callback(null,this.slice()),this._callback=null)},d.prototype.get=function(a){return this.slice(a,a+1)[0]},d.prototype.slice=function(a,b){return this.copy(null,0,a,b)},d.prototype.copy=function(a,b,d,e){if(("number"!=typeof d||0>d)&&(d=0),("number"!=typeof e||e>this.length)&&(e=this.length),d>=this.length)return a||new c(0);if(0>=e)return a||new c(0);var f,g,h=!!a,i=this._offset(d),j=e-d,k=j,l=h&&b||0,m=i[1];if(0===d&&e==this.length){if(!h)return c.concat(this._bufs);for(g=0;g<this._bufs.length;g++)this._bufs[g].copy(a,l),l+=this._bufs[g].length;return a}if(k<=this._bufs[i[0]].length-m)return h?this._bufs[i[0]].copy(a,b,m,m+k):this._bufs[i[0]].slice(m,m+k);for(h||(a=new c(j)),g=i[0];g<this._bufs.length;g++){if(f=this._bufs[g].length-m,!(k>f)){this._bufs[g].copy(a,l,m,m+k);break}this._bufs[g].copy(a,l,m),l+=f,k-=f,m&&(m=0)}return a},d.prototype.toString=function(a,b,c){return this.slice(b,c).toString(a)},d.prototype.consume=function(a){for(;this._bufs.length;){if(!(a>this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(a),this.length-=a;break}a-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},d.prototype.duplicate=function(){for(var a=0,b=new d;a<this._bufs.length;a++)b.append(this._bufs[a]);return b},d.prototype.destroy=function(){this._bufs.length=0,this.length=0,this.push(null)},function(){var a={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1};for(var b in a)!function(b){d.prototype[b]=function(c){return this.slice(c,c+a[b])[b](0)}}(b)}(),b.exports=d}).call(this,a("buffer").Buffer)},{buffer:9,"readable-stream/duplex":4,util:185}],4:[function(a,b,c){b.exports=a("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":5}],5:[function(a,b,c){(function(c){function d(a){return this instanceof d?(i.call(this,a),j.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||c.nextTick(this.end.bind(this))}function f(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}b.exports=d;var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},h=a("core-util-is");h.inherits=a("inherits");var i=a("./_stream_readable"),j=a("./_stream_writable");h.inherits(d,i),f(g(j.prototype),function(a){d.prototype[a]||(d.prototype[a]=j.prototype[a])})}).call(this,a("_process"))},{"./_stream_readable":6,"./_stream_writable":7,_process:162,"core-util-is":10,inherits:19}],6:[function(a,b,c){(function(c){function d(b,c){b=b||{};var d=b.highWaterMark;this.highWaterMark=d||0===d?d:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!b.objectMode,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(C||(C=a("string_decoder/").StringDecoder),this.decoder=new C(b.encoding),this.encoding=b.encoding)}function e(a){return this instanceof e?(this._readableState=new d(a,this),this.readable=!0,void A.call(this)):new e(a)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(null===c||void 0===c)b.reading=!1,b.ended||k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else!b.decoder||e||d||(c=b.decoder.write(c)),b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):(b.reading=!1,b.buffer.push(c)),b.needReadable&&l(a),n(a,b);else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){if(a>=D)a=D;else{a--;for(var b=1;32>b;b<<=1)a|=a>>b;a++}return a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:null===a||isNaN(a)?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:0>=a?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return y.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(b.decoder&&!b.ended){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,b.length>0?l(a):u(a)}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(b.emittedReadable=!0,b.sync?c.nextTick(function(){m(a)}):m(a))}function m(a){a.emit("readable")}function n(a,b){b.readingMore||(b.readingMore=!0,c.nextTick(function(){o(a,b)}))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;b.awaitDrain--,0===b.awaitDrain&&q(a)}}function q(a){function b(a,b,e){var f=a.write(c);!1===f&&d.awaitDrain++}var c,d=a._readableState;for(d.awaitDrain=0;d.pipesCount&&null!==(c=a.read());)if(1===d.pipesCount?b(d.pipes,0,null):v(d.pipes,b),a.emit("data",c),d.awaitDrain>0)return;return 0===d.pipesCount?(d.flowing=!1,void(z.listenerCount(a,"data")>0&&s(a))):void(d.ranOut=!0)}function r(){this._readableState.ranOut&&(this._readableState.ranOut=!1,q(this))}function s(a,b){var d=a._readableState;if(d.flowing)throw new Error("Cannot switch to old mode now.");var e=b||!1,f=!1;a.readable=!0,a.pipe=A.prototype.pipe,a.on=a.addListener=A.prototype.on,a.on("readable",function(){f=!0;for(var b;!e&&null!==(b=a.read());)a.emit("data",b);null===b&&(f=!1,a._readableState.needReadable=!0)}),a.pause=function(){e=!0,this.emit("pause")},a.resume=function(){e=!1,f?c.nextTick(function(){a.emit("readable")}):this.read(0),this.emit("resume")},a.emit("readable")}function t(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):y.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new y(a);for(var i=0,j=0,k=d.length;k>j&&a>i;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function u(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");!b.endEmitted&&b.calledRead&&(b.ended=!0,c.nextTick(function(){b.endEmitted||0!==b.length||(b.endEmitted=!0,a.readable=!1,a.emit("end"))}))}function v(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}function w(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}b.exports=e;var x=a("isarray"),y=a("buffer").Buffer;e.ReadableState=d;var z=a("events").EventEmitter;z.listenerCount||(z.listenerCount=function(a,b){return a.listeners(b).length});var A=a("stream"),B=a("core-util-is");B.inherits=a("inherits");var C;B.inherits(e,A),e.prototype.push=function(a,b){var c=this._readableState;return"string"!=typeof a||c.objectMode||(b=b||c.defaultEncoding,b!==c.encoding&&(a=new y(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0)},e.prototype.setEncoding=function(b){C||(C=a("string_decoder/").StringDecoder),this._readableState.decoder=new C(b),this._readableState.encoding=b};var D=8388608;e.prototype.read=function(a){var b=this._readableState;b.calledRead=!0;var c,d=a;if(("number"!=typeof a||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return l(this),null;if(a=i(a,b),0===a&&b.ended)return c=null,b.length>0&&b.decoder&&(c=t(a,b),b.length-=c.length),0===b.length&&u(this),c;var e=b.needReadable;return b.length-a<=b.highWaterMark&&(e=!0),(b.ended||b.reading)&&(e=!1),e&&(b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),e&&!b.reading&&(a=i(d,b)),c=a>0?t(a,b):null,null===c&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),b.ended&&!b.endEmitted&&0===b.length&&u(this),c},e.prototype._read=function(a){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){a===k&&f()}function e(){a.end()}function f(){a.removeListener("close",h),a.removeListener("finish",i),a.removeListener("drain",o),a.removeListener("error",g),a.removeListener("unpipe",d),k.removeListener("end",e),k.removeListener("end",f),(!a._writableState||a._writableState.needDrain)&&o()}function g(b){j(),a.removeListener("error",g),0===z.listenerCount(a,"error")&&a.emit("error",b)}function h(){a.removeListener("finish",i),j()}function i(){a.removeListener("close",h),j()}function j(){k.unpipe(a)}var k=this,l=this._readableState;switch(l.pipesCount){case 0:l.pipes=a;break;case 1:l.pipes=[l.pipes,a];break;default:l.pipes.push(a)}l.pipesCount+=1;var m=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,n=m?e:f;l.endEmitted?c.nextTick(n):k.once("end",n),a.on("unpipe",d);var o=p(k);return a.on("drain",o),a._events&&a._events.error?x(a._events.error)?a._events.error.unshift(g):a._events.error=[g,a._events.error]:a.on("error",g),a.once("close",h),a.once("finish",i),a.emit("pipe",k),l.flowing||(this.on("readable",r),l.flowing=!0,c.nextTick(function(){q(k)})),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,this.removeListener("readable",r),b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,this.removeListener("readable",r),b.flowing=!1;for(var e=0;d>e;e++)c[e].emit("unpipe",this);return this}var e=w(b.pipes,a);return-1===e?this:(b.pipes.splice(e,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var c=A.prototype.on.call(this,a,b);if("data"!==a||this._readableState.flowing||s(this),"readable"===a&&this.readable){var d=this._readableState;d.readableListening||(d.readableListening=!0,d.emittedReadable=!1,d.needReadable=!0,d.reading?d.length&&l(this,d):this.read(0))}return c},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){s(this),this.read(0),this.emit("resume")},e.prototype.pause=function(){s(this,!0),this.emit("pause")},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(b.decoder&&(e=b.decoder.write(e)),(!b.objectMode||null!==e&&void 0!==e)&&(b.objectMode||e&&e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)"function"==typeof a[e]&&"undefined"==typeof this[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return v(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){c&&(c=!1,a.resume())},d},e._fromList=t}).call(this,a("_process"))},{_process:162,buffer:9,"core-util-is":10,events:17,inherits:19,isarray:22,stream:179,"string_decoder/":180}],7:[function(a,b,c){(function(c){function d(a,b,c){this.chunk=a,this.encoding=b,this.callback=c}function e(a,b){a=a||{};var c=a.highWaterMark;this.highWaterMark=c||0===c?c:16384,this.objectMode=!!a.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var d=a.decodeStrings===!1;this.decodeStrings=!d,this.defaultEncoding=a.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){n(b,a)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function f(b){var c=a("./_stream_duplex");return this instanceof f||this instanceof c?(this._writableState=new e(b,this),this.writable=!0,void w.call(this)):new f(b)}function g(a,b,d){var e=new Error("write after end");a.emit("error",e),c.nextTick(function(){d(e)})}function h(a,b,d,e){var f=!0;if(!u.isBuffer(d)&&"string"!=typeof d&&null!==d&&void 0!==d&&!b.objectMode){var g=new TypeError("Invalid non-string/buffer chunk");a.emit("error",g),c.nextTick(function(){e(g)}),f=!1}return f}function i(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=new u(b,c)),b}function j(a,b,c,e,f){c=i(b,c,e),u.isBuffer(c)&&(e="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;return h||(b.needDrain=!0),b.writing?b.buffer.push(new d(c,e,f)):k(a,b,g,c,e,f),h}function k(a,b,c,d,e,f){b.writelen=c,b.writecb=f,b.writing=!0,b.sync=!0,a._write(d,e,b.onwrite),b.sync=!1}function l(a,b,d,e,f){d?c.nextTick(function(){f(e)}):f(e),a._writableState.errorEmitted=!0,a.emit("error",e)}function m(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function n(a,b){var d=a._writableState,e=d.sync,f=d.writecb;if(m(d),b)l(a,d,e,b,f);else{var g=r(a,d);g||d.bufferProcessing||!d.buffer.length||q(a,d),e?c.nextTick(function(){o(a,d,g,f)}):o(a,d,g,f)}}function o(a,b,c,d){c||p(a,b),d(),c&&s(a,b)}function p(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function q(a,b){b.bufferProcessing=!0;for(var c=0;c<b.buffer.length;c++){var d=b.buffer[c],e=d.chunk,f=d.encoding,g=d.callback,h=b.objectMode?1:e.length;if(k(a,b,h,e,f,g),b.writing){c++;break}}b.bufferProcessing=!1,c<b.buffer.length?b.buffer=b.buffer.slice(c):b.buffer.length=0}function r(a,b){return b.ending&&0===b.length&&!b.finished&&!b.writing}function s(a,b){var c=r(a,b);return c&&(b.finished=!0,a.emit("finish")),c}function t(a,b,d){b.ending=!0,s(a,b),d&&(b.finished?c.nextTick(d):a.once("finish",d)),b.ended=!0}b.exports=f;var u=a("buffer").Buffer;f.WritableState=e;var v=a("core-util-is");v.inherits=a("inherits");var w=a("stream");v.inherits(f,w),f.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},f.prototype.write=function(a,b,c){var d=this._writableState,e=!1;return"function"==typeof b&&(c=b,b=null),u.isBuffer(a)?b="buffer":b||(b=d.defaultEncoding),"function"!=typeof c&&(c=function(){}),d.ended?g(this,d,c):h(this,d,a,c)&&(e=j(this,d,a,b,c)),e},f.prototype._write=function(a,b,c){c(new Error("not implemented"))},f.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),"undefined"!=typeof a&&null!==a&&this.write(a,b),d.ending||d.finished||t(this,d,c)}}).call(this,a("_process"))},{"./_stream_duplex":5,_process:162,buffer:9,"core-util-is":10,inherits:19,stream:179}],8:[function(a,b,c){},{}],9:[function(a,b,c){(function(b){function d(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function e(a){return this instanceof e?(this.length=0,this.parent=void 0,"number"==typeof a?f(this,a):"string"==typeof a?g(this,a,arguments.length>1?arguments[1]:"utf8"):h(this,a)):arguments.length>1?new e(a,arguments[1]):new e(a)}function f(a,b){if(a=o(a,0>b?0:0|p(b)),!e.TYPED_ARRAY_SUPPORT)for(var c=0;b>c;c++)a[c]=0;
return a}function g(a,b,c){("string"!=typeof c||""===c)&&(c="utf8");var d=0|r(b,c);return a=o(a,d),a.write(b,c),a}function h(a,b){if(e.isBuffer(b))return i(a,b);if(X(b))return j(a,b);if(null==b)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(b.buffer instanceof ArrayBuffer)return k(a,b);if(b instanceof ArrayBuffer)return l(a,b)}return b.length?m(a,b):n(a,b)}function i(a,b){var c=0|p(b.length);return a=o(a,c),b.copy(a,0,0,c),a}function j(a,b){var c=0|p(b.length);a=o(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function k(a,b){var c=0|p(b.length);a=o(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function l(a,b){return e.TYPED_ARRAY_SUPPORT?(b.byteLength,a=e._augment(new Uint8Array(b))):a=k(a,new Uint8Array(b)),a}function m(a,b){var c=0|p(b.length);a=o(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function n(a,b){var c,d=0;"Buffer"===b.type&&X(b.data)&&(c=b.data,d=0|p(c.length)),a=o(a,d);for(var e=0;d>e;e+=1)a[e]=255&c[e];return a}function o(a,b){e.TYPED_ARRAY_SUPPORT?(a=e._augment(new Uint8Array(b)),a.__proto__=e.prototype):(a.length=b,a._isBuffer=!0);var c=0!==b&&b<=e.poolSize>>>1;return c&&(a.parent=Y),a}function p(a){if(a>=d())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+d().toString(16)+" bytes");return 0|a}function q(a,b){if(!(this instanceof q))return new q(a,b);var c=new e(a,b);return delete c.parent,c}function r(a,b){"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"binary":case"raw":case"raws":return c;case"utf8":case"utf-8":return Q(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return T(a).length;default:if(d)return Q(a).length;b=(""+b).toLowerCase(),d=!0}}function s(a,b,c){var d=!1;if(b=0|b,c=void 0===c||c===1/0?this.length:0|c,a||(a="utf8"),0>b&&(b=0),c>this.length&&(c=this.length),b>=c)return"";for(;;)switch(a){case"hex":return E(this,b,c);case"utf8":case"utf-8":return A(this,b,c);case"ascii":return C(this,b,c);case"binary":return D(this,b,c);case"base64":return z(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function t(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;d>g;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function u(a,b,c,d){return U(Q(b,a.length-c),a,c,d)}function v(a,b,c,d){return U(R(b),a,c,d)}function w(a,b,c,d){return v(a,b,c,d)}function x(a,b,c,d){return U(T(b),a,c,d)}function y(a,b,c,d){return U(S(b,a.length-c),a,c,d)}function z(a,b,c){return 0===b&&c===a.length?V.fromByteArray(a):V.fromByteArray(a.slice(b,c))}function A(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;c>e;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(c>=e+h){var i,j,k,l;switch(h){case 1:128>f&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(55296>l||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&1114112>l&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return B(d)}function B(a){var b=a.length;if(Z>=b)return String.fromCharCode.apply(String,a);for(var c="",d=0;b>d;)c+=String.fromCharCode.apply(String,a.slice(d,d+=Z));return c}function C(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(127&a[e]);return d}function D(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function E(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=P(a[f]);return e}function F(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function G(a,b,c){if(a%1!==0||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function H(a,b,c,d,f,g){if(!e.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>f||g>b)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range")}function I(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);f>e;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function J(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);f>e;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function K(a,b,c,d,e,f){if(b>e||f>b)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(0>c)throw new RangeError("index out of range")}function L(a,b,c,d,e){return e||K(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),W.write(a,b,c,d,23,4),c+4}function M(a,b,c,d,e){return e||K(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),W.write(a,b,c,d,52,8),c+8}function N(a){if(a=O(a).replace(_,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function O(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function P(a){return 16>a?"0"+a.toString(16):a.toString(16)}function Q(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;d>g;g++){if(c=a.charCodeAt(g),c>55295&&57344>c){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(56320>c){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=e-55296<<10|c-56320|65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,128>c){if((b-=1)<0)break;f.push(c)}else if(2048>c){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(65536>c){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(1114112>c))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function R(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function S(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function T(a){return V.toByteArray(N(a))}function U(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}var V=a("base64-js"),W=a("ieee754"),X=a("is-array");c.Buffer=e,c.SlowBuffer=q,c.INSPECT_MAX_BYTES=50,e.poolSize=8192;var Y={};e.TYPED_ARRAY_SUPPORT=void 0!==b.TYPED_ARRAY_SUPPORT?b.TYPED_ARRAY_SUPPORT:function(){function a(){}try{var b=new Uint8Array(1);return b.foo=function(){return 42},b.constructor=a,42===b.foo()&&b.constructor===a&&"function"==typeof b.subarray&&0===b.subarray(1,1).byteLength}catch(c){return!1}}(),e.TYPED_ARRAY_SUPPORT&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array),e.isBuffer=function(a){return!(null==a||!a._isBuffer)},e.compare=function(a,b){if(!e.isBuffer(a)||!e.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,d=b.length,f=0,g=Math.min(c,d);g>f&&a[f]===b[f];)++f;return f!==g&&(c=a[f],d=b[f]),d>c?-1:c>d?1:0},e.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(a,b){if(!X(a))throw new TypeError("list argument must be an Array of Buffers.");if(0===a.length)return new e(0);var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var d=new e(b),f=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(d,f),f+=g.length}return d},e.byteLength=r,e.prototype.length=void 0,e.prototype.parent=void 0,e.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?A(this,0,a):s.apply(this,arguments)},e.prototype.equals=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===e.compare(this,a)},e.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},e.prototype.compare=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?0:e.compare(this,a)},e.prototype.indexOf=function(a,b){function c(a,b,c){for(var d=-1,e=0;c+e<a.length;e++)if(a[c+e]===b[-1===d?0:e-d]){if(-1===d&&(d=e),e-d+1===b.length)return c+d}else d=-1;return-1}if(b>2147483647?b=2147483647:-2147483648>b&&(b=-2147483648),b>>=0,0===this.length)return-1;if(b>=this.length)return-1;if(0>b&&(b=Math.max(this.length+b,0)),"string"==typeof a)return 0===a.length?-1:String.prototype.indexOf.call(this,a,b);if(e.isBuffer(a))return c(this,a,b);if("number"==typeof a)return e.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,b):c(this,[a],b);throw new TypeError("val must be string, number or Buffer")},e.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},e.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},e.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b=0|b,isFinite(c)?(c=0|c,void 0===d&&(d="utf8")):(d=c,c=void 0);else{var e=d;d=b,b=0|c,c=e}var f=this.length-b;if((void 0===c||c>f)&&(c=f),a.length>0&&(0>c||0>b)||b>this.length)throw new RangeError("attempt to write outside buffer bounds");d||(d="utf8");for(var g=!1;;)switch(d){case"hex":return t(this,a,b,c);case"utf8":case"utf-8":return u(this,a,b,c);case"ascii":return v(this,a,b,c);case"binary":return w(this,a,b,c);case"base64":return x(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,a,b,c);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),g=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;e.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,0>a?(a+=c,0>a&&(a=0)):a>c&&(a=c),0>b?(b+=c,0>b&&(b=0)):b>c&&(b=c),a>b&&(b=a);var d;if(e.TYPED_ARRAY_SUPPORT)d=e._augment(this.subarray(a,b));else{var f=b-a;d=new e(f,void 0);for(var g=0;f>g;g++)d[g]=this[g+a]}return d.length&&(d.parent=this.parent||this),d},e.prototype.readUIntLE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},e.prototype.readUIntBE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},e.prototype.readUInt8=function(a,b){return b||G(a,1,this.length),this[a]},e.prototype.readUInt16LE=function(a,b){return b||G(a,2,this.length),this[a]|this[a+1]<<8},e.prototype.readUInt16BE=function(a,b){return b||G(a,2,this.length),this[a]<<8|this[a+1]},e.prototype.readUInt32LE=function(a,b){return b||G(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},e.prototype.readUInt32BE=function(a,b){return b||G(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},e.prototype.readIntLE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},e.prototype.readIntBE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},e.prototype.readInt8=function(a,b){return b||G(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},e.prototype.readInt16LE=function(a,b){b||G(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},e.prototype.readInt16BE=function(a,b){b||G(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},e.prototype.readInt32LE=function(a,b){return b||G(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},e.prototype.readInt32BE=function(a,b){return b||G(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},e.prototype.readFloatLE=function(a,b){return b||G(a,4,this.length),W.read(this,a,!0,23,4)},e.prototype.readFloatBE=function(a,b){return b||G(a,4,this.length),W.read(this,a,!1,23,4)},e.prototype.readDoubleLE=function(a,b){return b||G(a,8,this.length),W.read(this,a,!0,52,8)},e.prototype.readDoubleBE=function(a,b){return b||G(a,8,this.length),W.read(this,a,!1,52,8)},e.prototype.writeUIntLE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||H(this,a,b,c,Math.pow(2,8*c),0);var e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},e.prototype.writeUIntBE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||H(this,a,b,c,Math.pow(2,8*c),0);var e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},e.prototype.writeUInt8=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,1,255,0),e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=a,b+1},e.prototype.writeUInt16LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):I(this,a,b,!0),b+2},e.prototype.writeUInt16BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):I(this,a,b,!1),b+2},e.prototype.writeUInt32LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=a):J(this,a,b,!0),b+4},e.prototype.writeUInt32BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):J(this,a,b,!1),b+4},e.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);H(this,a,b,c,e-1,-e)}var f=0,g=1,h=0>a?1:0;for(this[b]=255&a;++f<c&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},e.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);H(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0>a?1:0;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},e.prototype.writeInt8=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,1,127,-128),e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),0>a&&(a=255+a+1),this[b]=a,b+1},e.prototype.writeInt16LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):I(this,a,b,!0),b+2},e.prototype.writeInt16BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):I(this,a,b,!1),b+2},e.prototype.writeInt32LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):J(this,a,b,!0),b+4},e.prototype.writeInt32BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,2147483647,-2147483648),0>a&&(a=4294967295+a+1),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):J(this,a,b,!1),b+4},e.prototype.writeFloatLE=function(a,b,c){return L(this,a,b,!0,c)},e.prototype.writeFloatBE=function(a,b,c){return L(this,a,b,!1,c)},e.prototype.writeDoubleLE=function(a,b,c){return M(this,a,b,!0,c)},e.prototype.writeDoubleBE=function(a,b,c){return M(this,a,b,!1,c)},e.prototype.copy=function(a,b,c,d){if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&c>d&&(d=c),d===c)return 0;if(0===a.length||0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);var f,g=d-c;if(this===a&&b>c&&d>b)for(f=g-1;f>=0;f--)a[f+b]=this[f+c];else if(1e3>g||!e.TYPED_ARRAY_SUPPORT)for(f=0;g>f;f++)a[f+b]=this[f+c];else a._set(this.subarray(c,c+g),b);return g},e.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),b>c)throw new RangeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new RangeError("start out of bounds");if(0>c||c>this.length)throw new RangeError("end out of bounds");var d;if("number"==typeof a)for(d=b;c>d;d++)this[d]=a;else{var e=Q(a.toString()),f=e.length;for(d=b;c>d;d++)this[d]=e[d%f]}return this}},e.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(e.TYPED_ARRAY_SUPPORT)return new e(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;c>b;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var $=e.prototype;e._augment=function(a){return a.constructor=e,a._isBuffer=!0,a._set=a.set,a.get=$.get,a.set=$.set,a.write=$.write,a.toString=$.toString,a.toLocaleString=$.toString,a.toJSON=$.toJSON,a.equals=$.equals,a.compare=$.compare,a.indexOf=$.indexOf,a.copy=$.copy,a.slice=$.slice,a.readUIntLE=$.readUIntLE,a.readUIntBE=$.readUIntBE,a.readUInt8=$.readUInt8,a.readUInt16LE=$.readUInt16LE,a.readUInt16BE=$.readUInt16BE,a.readUInt32LE=$.readUInt32LE,a.readUInt32BE=$.readUInt32BE,a.readIntLE=$.readIntLE,a.readIntBE=$.readIntBE,a.readInt8=$.readInt8,a.readInt16LE=$.readInt16LE,a.readInt16BE=$.readInt16BE,a.readInt32LE=$.readInt32LE,a.readInt32BE=$.readInt32BE,a.readFloatLE=$.readFloatLE,a.readFloatBE=$.readFloatBE,a.readDoubleLE=$.readDoubleLE,a.readDoubleBE=$.readDoubleBE,a.writeUInt8=$.writeUInt8,a.writeUIntLE=$.writeUIntLE,a.writeUIntBE=$.writeUIntBE,a.writeUInt16LE=$.writeUInt16LE,a.writeUInt16BE=$.writeUInt16BE,a.writeUInt32LE=$.writeUInt32LE,a.writeUInt32BE=$.writeUInt32BE,a.writeIntLE=$.writeIntLE,a.writeIntBE=$.writeIntBE,a.writeInt8=$.writeInt8,a.writeInt16LE=$.writeInt16LE,a.writeInt16BE=$.writeInt16BE,a.writeInt32LE=$.writeInt32LE,a.writeInt32BE=$.writeInt32BE,a.writeFloatLE=$.writeFloatLE,a.writeFloatBE=$.writeFloatBE,a.writeDoubleLE=$.writeDoubleLE,a.writeDoubleBE=$.writeDoubleBE,a.fill=$.fill,a.inspect=$.inspect,a.toArrayBuffer=$.toArrayBuffer,a};var _=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:18,"is-array":20}],10:[function(a,b,c){(function(a){function b(a){return Array.isArray?Array.isArray(a):"[object Array]"===q(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return"[object RegExp]"===q(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return"[object Date]"===q(a)}function n(a){return"[object Error]"===q(a)||a instanceof Error}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=a.isBuffer}).call(this,{isBuffer:a("/Users/micke/development/noodl/noodl-viewer/node_modules/is-buffer/index.js")})},{"/Users/micke/development/noodl/noodl-viewer/node_modules/is-buffer/index.js":21}],11:[function(a,b,c){c.UINT32=a("./lib/uint32"),c.UINT64=a("./lib/uint64")},{"./lib/uint32":12,"./lib/uint64":13}],12:[function(a,c,d){!function(a){function d(a,b){return this instanceof d?(this._low=0,this._high=0,this.remainder=null,"undefined"==typeof b?f.call(this,a):"string"==typeof a?g.call(this,a,b):void e.call(this,a,b)):new d(a,b)}function e(a,b){return this._low=0|a,this._high=0|b,this}function f(a){return this._low=65535&a,this._high=a>>>16,this}function g(a,b){var c=parseInt(a,b||10);return this._low=65535&c,this._high=c>>>16,this}var h=({36:d(Math.pow(36,5)),16:d(Math.pow(16,7)),10:d(Math.pow(10,9)),2:d(Math.pow(2,30))},{36:d(36),16:d(16),10:d(10),2:d(2)});d.prototype.fromBits=e,d.prototype.fromNumber=f,d.prototype.fromString=g,d.prototype.toNumber=function(){return this._high<<16|this._low},d.prototype.toString=function(a){a=a||10;var b=h[a]||new d(a);if(!this.gt(b))return this.toNumber().toString(a);for(var c=this.clone(),e=new Array(32),f=31;f>=0&&(c.div(b),e[f]=c.remainder.toNumber().toString(a),c.gt(b));f--);return e[f-1]=c.toNumber().toString(a),e.join("")},d.prototype.add=function(a){var b=this._low+a._low,c=b>>>16;return c+=this._high+a._high,this._low=65535&b,this._high=65535&c,this},d.prototype.subtract=function(a){return this.add(a.clone().negate())},d.prototype.multiply=function(a){var b,c,d=this._high,e=this._low,f=a._high,g=a._low;return c=e*g,b=c>>>16,b+=d*g,b&=65535,b+=e*f,this._low=65535&c,this._high=65535&b,this},d.prototype.div=function(a){if(0==a._low&&0==a._high)throw Error("division by zero");if(0==a._high&&1==a._low)return this.remainder=new d(0),this;if(a.gt(this))return this.remainder=this.clone(),this._low=0,this._high=0,this;if(this.eq(a))return this.remainder=new d(0),this._low=1,this._high=0,this;for(var b=a.clone(),c=-1;!this.lt(b);)b.shiftLeft(1,!0),c++;for(this.remainder=this.clone(),this._low=0,this._high=0;c>=0;c--)b.shiftRight(1),this.remainder.lt(b)||(this.remainder.subtract(b),c>=16?this._high|=1<<c-16:this._low|=1<<c);return this},d.prototype.negate=function(){var a=(65535&~this._low)+1;return this._low=65535&a,this._high=~this._high+(a>>>16)&65535,this},d.prototype.equals=d.prototype.eq=function(a){return this._low==a._low&&this._high==a._high},d.prototype.greaterThan=d.prototype.gt=function(a){return this._high>a._high?!0:this._high<a._high?!1:this._low>a._low},d.prototype.lessThan=d.prototype.lt=function(a){return this._high<a._high?!0:this._high>a._high?!1:this._low<a._low},d.prototype.or=function(a){return this._low|=a._low,this._high|=a._high,this},d.prototype.and=function(a){return this._low&=a._low,this._high&=a._high,this},d.prototype.not=function(){return this._low=65535&~this._low,this._high=65535&~this._high,this},d.prototype.xor=function(a){return this._low^=a._low,this._high^=a._high,this},d.prototype.shiftRight=d.prototype.shiftr=function(a){return a>16?(this._low=this._high>>a-16,this._high=0):16==a?(this._low=this._high,this._high=0):(this._low=this._low>>a|this._high<<16-a&65535,this._high>>=a),this},d.prototype.shiftLeft=d.prototype.shiftl=function(a,b){return a>16?(this._high=this._low<<a-16,this._low=0,b||(this._high&=65535)):16==a?(this._high=this._low,this._low=0):(this._high=this._high<<a|this._low>>16-a,this._low=this._low<<a&65535,b||(this._high&=65535)),this},d.prototype.rotateLeft=d.prototype.rotl=function(a){var b=this._high<<16|this._low;return b=b<<a|b>>>32-a,this._low=65535&b,this._high=b>>>16,this},d.prototype.rotateRight=d.prototype.rotr=function(a){var b=this._high<<16|this._low;return b=b>>>a|b<<32-a,this._low=65535&b,this._high=b>>>16,this},d.prototype.clone=function(){return new d(this._low,this._high)},"undefined"!=typeof b&&b.amd?b([],function(){return d}):"undefined"!=typeof c&&c.exports?c.exports=d:a.UINT32=d}(this)},{}],13:[function(a,c,d){!function(a){function d(a,b,c,h){return this instanceof d?(this.remainder=null,"string"==typeof a?g.call(this,a,b):"undefined"==typeof b?f.call(this,a):void e.apply(this,arguments)):new d(a,b,c,h)}function e(a,b,c,d){return"undefined"==typeof c?(this._a00=65535&a,this._a16=a>>>16,this._a32=65535&b,this._a48=b>>>16,this):(this._a00=0|a,this._a16=0|b,this._a32=0|c,this._a48=0|d,this)}function f(a){return this._a00=65535&a,this._a16=a>>>16,this._a32=0,this._a48=0,this}function g(a,b){b=b||10,this._a00=0,this._a16=0,this._a32=0,this._a48=0;for(var c=h[b]||new d(Math.pow(b,5)),e=0,f=a.length;f>e;e+=5){var g=Math.min(5,f-e),i=parseInt(a.slice(e,e+g),b);this.multiply(5>g?new d(Math.pow(b,g)):c).add(new d(i))}return this}var h={16:d(Math.pow(16,5)),10:d(Math.pow(10,5)),2:d(Math.pow(2,5))},i={16:d(16),10:d(10),2:d(2)};d.prototype.fromBits=e,d.prototype.fromNumber=f,d.prototype.fromString=g,d.prototype.toNumber=function(){return this._a16<<16|this._a00},d.prototype.toString=function(a){a=a||10;var b=i[a]||new d(a);if(!this.gt(b))return this.toNumber().toString(a);for(var c=this.clone(),e=new Array(64),f=63;f>=0&&(c.div(b),e[f]=c.remainder.toNumber().toString(a),c.gt(b));f--);return e[f-1]=c.toNumber().toString(a),e.join("")},d.prototype.add=function(a){var b=this._a00+a._a00,c=b>>>16;c+=this._a16+a._a16;var d=c>>>16;d+=this._a32+a._a32;var e=d>>>16;return e+=this._a48+a._a48,this._a00=65535&b,this._a16=65535&c,this._a32=65535&d,this._a48=65535&e,this},d.prototype.subtract=function(a){return this.add(a.clone().negate())},d.prototype.multiply=function(a){var b=this._a00,c=this._a16,d=this._a32,e=this._a48,f=a._a00,g=a._a16,h=a._a32,i=a._a48,j=b*f,k=j>>>16;k+=b*g;var l=k>>>16;k&=65535,k+=c*f,l+=k>>>16,l+=b*h;var m=l>>>16;return l&=65535,l+=c*g,m+=l>>>16,l&=65535,l+=d*f,m+=l>>>16,m+=b*i,m&=65535,m+=c*h,m&=65535,m+=d*g,m&=65535,m+=e*f,this._a00=65535&j,this._a16=65535&k,this._a32=65535&l,this._a48=65535&m,this},d.prototype.div=function(a){if(0==a._a16&&0==a._a32&&0==a._a48){if(0==a._a00)throw Error("division by zero");if(1==a._a00)return this.remainder=new d(0),this}if(a.gt(this))return this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0,this;if(this.eq(a))return this.remainder=new d(0),this._a00=1,this._a16=0,this._a32=0,this._a48=0,this;for(var b=a.clone(),c=-1;!this.lt(b);)b.shiftLeft(1,!0),c++;for(this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0;c>=0;c--)b.shiftRight(1),this.remainder.lt(b)||(this.remainder.subtract(b),c>=48?this._a48|=1<<c-48:c>=32?this._a32|=1<<c-32:c>=16?this._a16|=1<<c-16:this._a00|=1<<c);return this},d.prototype.negate=function(){var a=(65535&~this._a00)+1;return this._a00=65535&a,a=(65535&~this._a16)+(a>>>16),this._a16=65535&a,a=(65535&~this._a32)+(a>>>16),this._a32=65535&a,this._a48=~this._a48+(a>>>16)&65535,this},d.prototype.equals=d.prototype.eq=function(a){return this._a48==a._a48&&this._a00==a._a00&&this._a32==a._a32&&this._a16==a._a16},d.prototype.greaterThan=d.prototype.gt=function(a){return this._a48>a._a48?!0:this._a48<a._a48?!1:this._a32>a._a32?!0:this._a32<a._a32?!1:this._a16>a._a16?!0:this._a16<a._a16?!1:this._a00>a._a00},d.prototype.lessThan=d.prototype.lt=function(a){return this._a48<a._a48?!0:this._a48>a._a48?!1:this._a32<a._a32?!0:this._a32>a._a32?!1:this._a16<a._a16?!0:this._a16>a._a16?!1:this._a00<a._a00},d.prototype.or=function(a){return this._a00|=a._a00,this._a16|=a._a16,this._a32|=a._a32,this._a48|=a._a48,this},d.prototype.and=function(a){return this._a00&=a._a00,this._a16&=a._a16,this._a32&=a._a32,this._a48&=a._a48,this},d.prototype.xor=function(a){return this._a00^=a._a00,this._a16^=a._a16,this._a32^=a._a32,this._a48^=a._a48,this},d.prototype.not=function(){return this._a00=65535&~this._a00,this._a16=65535&~this._a16,this._a32=65535&~this._a32,this._a48=65535&~this._a48,this},d.prototype.shiftRight=d.prototype.shiftr=function(a){return a%=64,a>=48?(this._a00=this._a48>>a-48,this._a16=0,this._a32=0,this._a48=0):a>=32?(a-=32,this._a00=65535&(this._a32>>a|this._a48<<16-a),this._a16=this._a48>>a&65535,this._a32=0,this._a48=0):a>=16?(a-=16,this._a00=65535&(this._a16>>a|this._a32<<16-a),this._a16=65535&(this._a32>>a|this._a48<<16-a),this._a32=this._a48>>a&65535,this._a48=0):(this._a00=65535&(this._a00>>a|this._a16<<16-a),this._a16=65535&(this._a16>>a|this._a32<<16-a),this._a32=65535&(this._a32>>a|this._a48<<16-a),this._a48=this._a48>>a&65535),this},d.prototype.shiftLeft=d.prototype.shiftl=function(a,b){return a%=64,a>=48?(this._a48=this._a00<<a-48,this._a32=0,this._a16=0,this._a00=0):a>=32?(a-=32,this._a48=this._a16<<a|this._a00>>16-a,this._a32=this._a00<<a&65535,this._a16=0,this._a00=0):a>=16?(a-=16,this._a48=this._a32<<a|this._a16>>16-a,this._a32=65535&(this._a16<<a|this._a00>>16-a),this._a16=this._a00<<a&65535,this._a00=0):(this._a48=this._a48<<a|this._a32>>16-a,this._a32=65535&(this._a32<<a|this._a16>>16-a),this._a16=65535&(this._a16<<a|this._a00>>16-a),this._a00=this._a00<<a&65535),b||(this._a48&=65535),this},d.prototype.rotateLeft=d.prototype.rotl=function(a){if(a%=64,0==a)return this;if(a>=32){var b=this._a00;if(this._a00=this._a32,this._a32=b,b=this._a48,this._a48=this._a16,this._a16=b,32==a)return this;a-=32}var c=this._a48<<16|this._a32,d=this._a16<<16|this._a00,e=c<<a|d>>>32-a,f=d<<a|c>>>32-a;return this._a00=65535&f,this._a16=f>>>16,this._a32=65535&e,this._a48=e>>>16,this},d.prototype.rotateRight=d.prototype.rotr=function(a){if(a%=64,0==a)return this;if(a>=32){var b=this._a00;if(this._a00=this._a32,this._a32=b,b=this._a48,this._a48=this._a16,this._a16=b,32==a)return this;a-=32}var c=this._a48<<16|this._a32,d=this._a16<<16|this._a00,e=c>>>a|d<<32-a,f=d>>>a|c<<32-a;return this._a00=65535&f,this._a16=f>>>16,this._a32=65535&e,this._a48=e>>>16,this},d.prototype.clone=function(){return new d(this._a00,this._a16,this._a32,this._a48)},"undefined"!=typeof b&&b.amd?b([],function(){return d}):"undefined"!=typeof c&&c.exports?c.exports=d:a.UINT64=d}(this)},{}],14:[function(a,b,c){(function(c,d){var e=a("readable-stream"),f=a("end-of-stream"),g=a("inherits"),h=new d([0]),i=function(a,b){a._corked?a.once("uncork",b):b()},j=function(a,b){return function(c){c?a.destroy("premature close"===c.message?null:c):b&&!a._ended&&a.end()}},k=function(a,b){return a?a._writableState&&a._writableState.finished?b():a._writableState?a.end(b):(a.end(),void b()):b()},l=function(a){return new e.Readable({objectMode:!0,highWaterMark:16}).wrap(a)},m=function(a,b,c){return this instanceof m?(e.Duplex.call(this,c),this._writable=null,this._readable=null,this._readable2=null,this._forwardDestroy=!c||c.destroy!==!1,this._forwardEnd=!c||c.end!==!1,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,a&&this.setWritable(a),void(b&&this.setReadable(b))):new m(a,b,c)};g(m,e.Duplex),m.obj=function(a,b,c){return c||(c={}),c.objectMode=!0,c.highWaterMark=16,new m(a,b,c)},m.prototype.cork=function(){1===++this._corked&&this.emit("cork")},m.prototype.uncork=function(){this._corked&&0===--this._corked&&this.emit("uncork")},m.prototype.setWritable=function(a){if(this._unwrite&&this._unwrite(),this.destroyed)return void(a&&a.destroy&&a.destroy());if(null===a||a===!1)return void this.end();var b=this,d=f(a,{writable:!0,readable:!1},j(this,this._forwardEnd)),e=function(){var a=b._ondrain;b._ondrain=null,a&&a()},g=function(){b._writable.removeListener("drain",e),d()};this._unwrite&&c.nextTick(e),this._writable=a,this._writable.on("drain",e),this._unwrite=g,this.uncork()},m.prototype.setReadable=function(a){if(this._unread&&this._unread(),this.destroyed)return void(a&&a.destroy&&a.destroy());if(null===a||a===!1)return this.push(null),void this.resume();var b=this,c=f(a,{writable:!1,readable:!0},j(this)),d=function(){b._forward()},e=function(){b.push(null)},g=function(){b._readable2.removeListener("readable",d),b._readable2.removeListener("end",e),c()};this._drained=!0,this._readable=a,this._readable2=a._readableState?a:l(a),this._readable2.on("readable",d),this._readable2.on("end",e),this._unread=g,this._forward()},m.prototype._read=function(){this._drained=!0,this._forward()},m.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){this._forwarding=!0;for(var a,b=this._readable2._readableState;null!==(a=this._readable2.read(b.buffer.length?b.buffer[0].length:b.length));)this._drained=this.push(a);this._forwarding=!1}},m.prototype.destroy=function(a){if(!this.destroyed){this.destroyed=!0;var b=this;c.nextTick(function(){b._destroy(a)})}},m.prototype._destroy=function(a){if(a){var b=this._ondrain;this._ondrain=null,b?b(a):this.emit("error",a)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),
this.emit("close")},m.prototype._write=function(a,b,c){return this.destroyed?c():this._corked?i(this,this._write.bind(this,a,b,c)):a===h?this._finish(c):this._writable?void(this._writable.write(a)===!1?this._ondrain=c:c()):c()},m.prototype._finish=function(a){var b=this;this.emit("preend"),i(this,function(){k(b._forwardEnd&&b._writable,function(){b._writableState.prefinished===!1&&(b._writableState.prefinished=!0),b.emit("prefinish"),i(b,a)})})},m.prototype.end=function(a,b,c){return"function"==typeof a?this.end(null,null,a):"function"==typeof b?this.end(a,null,b):(this._ended=!0,a&&this.write(a),this._writableState.ending||this.write(h),e.Writable.prototype.end.call(this,c))},b.exports=m}).call(this,a("_process"),a("buffer").Buffer)},{_process:162,buffer:9,"end-of-stream":15,inherits:19,"readable-stream":174}],15:[function(a,b,c){var d=a("once"),e=function(){},f=function(a){return a.setHeader&&"function"==typeof a.abort},g=function(a,b,c){if("function"==typeof b)return g(a,null,b);b||(b={}),c=d(c||e);var h=a._writableState,i=a._readableState,j=b.readable||b.readable!==!1&&a.readable,k=b.writable||b.writable!==!1&&a.writable,l=function(){a.writable||m()},m=function(){k=!1,j||c()},n=function(){j=!1,k||c()},o=function(){return(!j||i&&i.ended)&&(!k||h&&h.ended)?void 0:c(new Error("premature close"))},p=function(){a.req.on("finish",m)};return f(a)?(a.on("complete",m),a.on("abort",o),a.req?p():a.on("request",p)):k&&!h&&(a.on("end",l),a.on("close",l)),a.on("end",n),a.on("finish",m),b.error!==!1&&a.on("error",c),a.on("close",o),function(){a.removeListener("complete",m),a.removeListener("abort",o),a.removeListener("request",p),a.req&&a.req.removeListener("finish",m),a.removeListener("end",l),a.removeListener("close",l),a.removeListener("finish",m),a.removeListener("end",n),a.removeListener("error",c),a.removeListener("close",o)}};b.exports=g},{once:160}],16:[function(a,b,c){var d=a("once"),e=function(){},f=function(a){return a.setHeader&&"function"==typeof a.abort},g=function(a){return a.stdio&&Array.isArray(a.stdio)&&3===a.stdio.length},h=function(a,b,c){if("function"==typeof b)return h(a,null,b);b||(b={}),c=d(c||e);var i=a._writableState,j=a._readableState,k=b.readable||b.readable!==!1&&a.readable,l=b.writable||b.writable!==!1&&a.writable,m=function(){a.writable||n()},n=function(){l=!1,k||c()},o=function(){k=!1,l||c()},p=function(a){c(a?new Error("exited with error code: "+a):null)},q=function(){return(!k||j&&j.ended)&&(!l||i&&i.ended)?void 0:c(new Error("premature close"))},r=function(){a.req.on("finish",n)};return f(a)?(a.on("complete",n),a.on("abort",q),a.req?r():a.on("request",r)):l&&!i&&(a.on("end",m),a.on("close",m)),g(a)&&a.on("exit",p),a.on("end",o),a.on("finish",n),b.error!==!1&&a.on("error",c),a.on("close",q),function(){a.removeListener("complete",n),a.removeListener("abort",q),a.removeListener("request",r),a.req&&a.req.removeListener("finish",n),a.removeListener("end",m),a.removeListener("close",m),a.removeListener("finish",n),a.removeListener("exit",p),a.removeListener("end",o),a.removeListener("error",c),a.removeListener("close",q)}};b.exports=h},{once:160}],17:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;d>i;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(0>d)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],18:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],19:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],20:[function(a,b,c){var d=Array.isArray,e=Object.prototype.toString;b.exports=d||function(a){return!!a&&"[object Array]"==e.call(a)}},{}],21:[function(a,b,c){b.exports=function(a){return!(null==a||!(a._isBuffer||a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)))}},{}],22:[function(a,b,c){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],23:[function(a,b,c){!function(a){"use strict";var d="Compound",e="Identifier",f="MemberExpression",g="Literal",h="ThisExpression",i="CallExpression",j="UnaryExpression",k="BinaryExpression",l="LogicalExpression",m="ConditionalExpression",n="ArrayExpression",o=46,p=44,q=39,r=34,s=40,t=41,u=91,v=93,w=63,x=59,y=58,z=function(a,b){var c=new Error(a+" at character "+b);throw c.index=b,c.description=a,c},A=!0,B={"-":A,"!":A,"~":A,"+":A},C={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},D=function(a){var b,c=0;for(var d in a)(b=d.length)>c&&a.hasOwnProperty(d)&&(c=b);return c},E=D(B),F=D(C),G={"true":!0,"false":!1,"null":null},H="this",I=function(a){return C[a]||0},J=function(a,b,c){var d="||"===a||"&&"===a?l:k;return{type:d,operator:a,left:b,right:c}},K=function(a){return a>=48&&57>=a},L=function(a){return 36===a||95===a||a>=65&&90>=a||a>=97&&122>=a},M=function(a){return 36===a||95===a||a>=65&&90>=a||a>=97&&122>=a||a>=48&&57>=a},N=function(a){for(var b,c,k=0,l=a.charAt,A=a.charCodeAt,D=function(b){return l.call(a,b)},N=function(b){return A.call(a,b)},O=a.length,P=function(){for(var a=N(k);32===a||9===a;)a=N(++k)},Q=function(){var a,b,c=S();return P(),N(k)!==w?c:(k++,a=Q(),a||z("Expected expression",k),P(),N(k)===y?(k++,b=Q(),b||z("Expected expression",k),{type:m,test:c,consequent:a,alternate:b}):void z("Expected :",k))},R=function(){P();for(var b=a.substr(k,F),c=b.length;c>0;){if(C.hasOwnProperty(b))return k+=c,b;b=b.substr(0,--c)}return!1},S=function(){var a,b,c,d,e,f,g,h;if(f=T(),b=R(),!b)return f;for(e={value:b,prec:I(b)},g=T(),g||z("Expected expression after "+b,k),d=[f,e,g];(b=R())&&(c=I(b),0!==c);){for(e={value:b,prec:c};d.length>2&&c<=d[d.length-2].prec;)g=d.pop(),b=d.pop().value,f=d.pop(),a=J(b,f,g),d.push(a);a=T(),a||z("Expected expression after "+b,k),d.push(e,a)}for(h=d.length-1,a=d[h];h>1;)a=J(d[h-1].value,d[h-2],a),h-=2;return a},T=function(){var b,c,d;if(P(),b=N(k),K(b)||b===o)return U();if(b===q||b===r)return V();if(L(b)||b===s)return Y();if(b===u)return $();for(c=a.substr(k,E),d=c.length;d>0;){if(B.hasOwnProperty(c))return k+=d,{type:j,operator:c,argument:T(),prefix:!0};c=c.substr(0,--d)}return!1},U=function(){for(var a,b,c="";K(N(k));)c+=D(k++);if(N(k)===o)for(c+=D(k++);K(N(k));)c+=D(k++);if(a=D(k),"e"===a||"E"===a){for(c+=D(k++),a=D(k),("+"===a||"-"===a)&&(c+=D(k++));K(N(k));)c+=D(k++);K(N(k-1))||z("Expected exponent ("+c+D(k)+")",k)}return b=N(k),L(b)?z("Variable names cannot start with a number ("+c+D(k)+")",k):b===o&&z("Unexpected period",k),{type:g,value:parseFloat(c),raw:c}},V=function(){for(var a,b="",c=D(k++),d=!1;O>k;){if(a=D(k++),a===c){d=!0;break}if("\\"===a)switch(a=D(k++)){case"n":b+="\n";break;case"r":b+="\r";break;case"t":b+="	";break;case"b":b+="\b";break;case"f":b+="\f";break;case"v":b+="\x0B"}else b+=a}return d||z('Unclosed quote after "'+b+'"',k),{type:g,value:b,raw:c+b+c}},W=function(){var b,c=N(k),d=k;for(L(c)?k++:z("Unexpected "+D(k),k);O>k&&(c=N(k),M(c));)k++;return b=a.slice(d,k),G.hasOwnProperty(b)?{type:g,value:G[b],raw:b}:b===H?{type:h}:{type:e,name:b}},X=function(a){for(var b,c,e=[];O>k;){if(P(),b=N(k),b===a){k++;break}b===p?k++:(c=Q(),c&&c.type!==d||z("Expected comma",k),e.push(c))}return e},Y=function(){var a,b;for(a=N(k),b=a===s?Z():W(),P(),a=N(k);a===o||a===u||a===s;)k++,a===o?(P(),b={type:f,computed:!1,object:b,property:W()}):a===u?(b={type:f,computed:!0,object:b,property:Q()},P(),a=N(k),a!==v&&z("Unclosed [",k),k++):a===s&&(b={type:i,arguments:X(t),callee:b}),P(),a=N(k);return b},Z=function(){k++;var a=Q();return P(),N(k)===t?(k++,a):void z("Unclosed (",k)},$=function(){return k++,{type:n,elements:X(v)}},_=[];O>k;)b=N(k),b===x||b===p?k++:(c=Q())?_.push(c):O>k&&z('Unexpected "'+D(k)+'"',k);return 1===_.length?_[0]:{type:d,body:_}};if(N.version="0.3.0",N.toString=function(){return"JavaScript Expression Parser (JSEP) v"+N.version},N.addUnaryOp=function(a){return B[a]=A,this},N.addBinaryOp=function(a,b){return F=Math.max(a.length,F),C[a]=b,this},N.removeUnaryOp=function(a){return delete B[a],a.length===E&&(E=D(B)),this},N.removeBinaryOp=function(a){return delete C[a],a.length===F&&(F=D(C)),this},"undefined"==typeof c){var O=a.jsep;a.jsep=N,N.noConflict=function(){return a.jsep===N&&(a.jsep=O),N}}else"undefined"!=typeof b&&b.exports?c=b.exports=N:c.parse=N}(this)},{}],24:[function(a,b,c){function d(){}var e=a("./_nativeCreate"),f=Object.prototype;d.prototype=e?e(null):f,b.exports=d},{"./_nativeCreate":96}],25:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"Map");b.exports=f},{"./_getNative":75,"./_root":98}],26:[function(a,b,c){function d(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}var e=a("./_mapClear"),f=a("./_mapDelete"),g=a("./_mapGet"),h=a("./_mapHas"),i=a("./_mapSet");d.prototype.clear=e,d.prototype["delete"]=f,d.prototype.get=g,d.prototype.has=h,d.prototype.set=i,b.exports=d},{"./_mapClear":90,"./_mapDelete":91,"./_mapGet":92,"./_mapHas":93,"./_mapSet":94}],27:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"Set");b.exports=f},{"./_getNative":75,"./_root":98}],28:[function(a,b,c){function d(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}var e=a("./_stackClear"),f=a("./_stackDelete"),g=a("./_stackGet"),h=a("./_stackHas"),i=a("./_stackSet");d.prototype.clear=e,d.prototype["delete"]=f,d.prototype.get=g,d.prototype.has=h,d.prototype.set=i,b.exports=d},{"./_stackClear":100,"./_stackDelete":101,"./_stackGet":102,"./_stackHas":103,"./_stackSet":104}],29:[function(a,b,c){var d=a("./_root"),e=d.Symbol;b.exports=e},{"./_root":98}],30:[function(a,b,c){var d=a("./_root"),e=d.Uint8Array;b.exports=e},{"./_root":98}],31:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"WeakMap");b.exports=f},{"./_getNative":75,"./_root":98}],32:[function(a,b,c){function d(a,b,c){var d=c.length;switch(d){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}b.exports=d},{}],33:[function(a,b,c){function d(a,b){for(var c=-1,d=a.length;++c<d;)if(!b(a[c],c,a))return!1;return!0}b.exports=d},{}],34:[function(a,b,c){function d(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}b.exports=d},{}],35:[function(a,b,c){function d(a,b){for(var c=-1,d=a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}b.exports=d},{}],36:[function(a,b,c){function d(a,b,c){var d=a[b];g.call(a,b)&&e(d,c)&&(void 0!==c||b in a)||(a[b]=c)}var e=a("./eq"),f=Object.prototype,g=f.hasOwnProperty;b.exports=d},{"./eq":108}],37:[function(a,b,c){function d(a,b){var c=e(a,b);if(0>c)return!1;var d=a.length-1;return c==d?a.pop():g.call(a,c,1),!0}var e=a("./_assocIndexOf"),f=Array.prototype,g=f.splice;b.exports=d},{"./_assocIndexOf":40}],38:[function(a,b,c){function d(a,b){var c=e(a,b);return 0>c?void 0:a[c][1]}var e=a("./_assocIndexOf");b.exports=d},{"./_assocIndexOf":40}],39:[function(a,b,c){function d(a,b){return e(a,b)>-1}var e=a("./_assocIndexOf");b.exports=d},{"./_assocIndexOf":40}],40:[function(a,b,c){function d(a,b){for(var c=a.length;c--;)if(e(a[c][0],b))return c;return-1}var e=a("./eq");b.exports=d},{"./eq":108}],41:[function(a,b,c){function d(a,b,c){var d=e(a,b);0>d?a.push([b,c]):a[d][1]=c}var e=a("./_assocIndexOf");b.exports=d},{"./_assocIndexOf":40}],42:[function(a,b,c){function d(a,b){return a&&e(b,f(b),a)}var e=a("./_copyObject"),f=a("./keys");b.exports=d},{"./_copyObject":65,"./keys":126}],43:[function(a,b,c){function d(a){return e(a)?a:f(a)}var e=a("./isArray"),f=a("./_stringToPath");b.exports=d},{"./_stringToPath":105,"./isArray":114}],44:[function(a,b,c){function d(a){return e(a)?f(a):{}}var e=a("./isObject"),f=Object.create;b.exports=d},{"./isObject":121}],45:[function(a,b,c){var d=a("./_baseForOwn"),e=a("./_createBaseEach"),f=e(d);b.exports=f},{"./_baseForOwn":48,"./_createBaseEach":68}],46:[function(a,b,c){function d(a,b){var c=!0;return e(a,function(a,d,e){return c=!!b(a,d,e)}),c}var e=a("./_baseEach");b.exports=d},{"./_baseEach":45}],47:[function(a,b,c){var d=a("./_createBaseFor"),e=d();b.exports=e},{"./_createBaseFor":69}],48:[function(a,b,c){function d(a,b){return a&&e(a,b,f)}var e=a("./_baseFor"),f=a("./keys");b.exports=d},{"./_baseFor":47,"./keys":126}],49:[function(a,b,c){function d(a,b){b=f(b,a)?[b+""]:e(b);for(var c=0,d=b.length;null!=a&&d>c;)a=a[b[c++]];return c&&c==d?a:void 0}var e=a("./_baseCastPath"),f=a("./_isKey");b.exports=d},{"./_baseCastPath":43,"./_isKey":86}],50:[function(a,b,c){function d(a,b){return f.call(a,b)||"object"==typeof a&&b in a&&null===g(a)}var e=Object.prototype,f=e.hasOwnProperty,g=Object.getPrototypeOf;b.exports=d},{}],51:[function(a,b,c){function d(a,b){return b in Object(a)}b.exports=d},{}],52:[function(a,b,c){function d(a,b,c,h,i){return a===b?!0:null==a||null==b||!f(a)&&!g(b)?a!==a&&b!==b:e(a,b,d,c,h,i)}var e=a("./_baseIsEqualDeep"),f=a("./isObject"),g=a("./isObjectLike");b.exports=d},{"./_baseIsEqualDeep":53,"./isObject":121,"./isObjectLike":122}],53:[function(a,b,c){function d(a,b,c,d,q,s){var t=j(a),u=j(b),v=o,w=o;t||(v=i(a),v==n?v=p:v!=p&&(t=l(a))),u||(w=i(b),w==n?w=p:w!=p&&(u=l(b)));var x=v==p&&!k(a),y=w==p&&!k(b),z=v==w;if(z&&!t&&!x)return g(a,b,v,c,d,q);var A=q&m;if(!A){var B=x&&r.call(a,"__wrapped__"),C=y&&r.call(b,"__wrapped__");if(B||C)return c(B?a.value():a,C?b.value():b,d,q,s)}return z?(s||(s=new e),(t?f:h)(a,b,c,d,q,s)):!1}var e=a("./_Stack"),f=a("./_equalArrays"),g=a("./_equalByTag"),h=a("./_equalObjects"),i=a("./_getTag"),j=a("./isArray"),k=a("./_isHostObject"),l=a("./isTypedArray"),m=2,n="[object Arguments]",o="[object Array]",p="[object Object]",q=Object.prototype,r=q.hasOwnProperty;b.exports=d},{"./_Stack":28,"./_equalArrays":70,"./_equalByTag":71,"./_equalObjects":72,"./_getTag":76,"./_isHostObject":83,"./isArray":114,"./isTypedArray":125}],54:[function(a,b,c){function d(a,b,c,d){var i=c.length,j=i,k=!d;if(null==a)return!j;for(a=Object(a);i--;){var l=c[i];if(k&&l[2]?l[1]!==a[l[0]]:!(l[0]in a))return!1}for(;++i<j;){l=c[i];var m=l[0],n=a[m],o=l[1];if(k&&l[2]){if(void 0===n&&!(m in a))return!1}else{var p=new e,q=d?d(n,o,m,a,b,p):void 0;if(!(void 0===q?f(o,n,d,g|h,p):q))return!1}}return!0}var e=a("./_Stack"),f=a("./_baseIsEqual"),g=1,h=2;b.exports=d},{"./_Stack":28,"./_baseIsEqual":52}],55:[function(a,b,c){function d(a){var b=typeof a;return"function"==b?a:null==a?g:"object"==b?h(a)?f(a[0],a[1]):e(a):i(a)}var e=a("./_baseMatches"),f=a("./_baseMatchesProperty"),g=a("./identity"),h=a("./isArray"),i=a("./property");b.exports=d},{"./_baseMatches":57,"./_baseMatchesProperty":58,"./identity":112,"./isArray":114,"./property":129}],56:[function(a,b,c){function d(a){return e(Object(a))}var e=Object.keys;b.exports=d},{}],57:[function(a,b,c){function d(a){var b=f(a);if(1==b.length&&b[0][2]){var c=b[0][0],d=b[0][1];return function(a){return null==a?!1:a[c]===d&&(void 0!==d||c in Object(a))}}return function(c){return c===a||e(c,a,b)}}var e=a("./_baseIsMatch"),f=a("./_getMatchData");b.exports=d},{"./_baseIsMatch":54,"./_getMatchData":74}],58:[function(a,b,c){function d(a,b){return function(c){var d=f(c,a);return void 0===d&&d===b?g(c,a):e(b,d,void 0,h|i)}}var e=a("./_baseIsEqual"),f=a("./get"),g=a("./hasIn"),h=1,i=2;b.exports=d},{"./_baseIsEqual":52,"./get":110,"./hasIn":111}],59:[function(a,b,c){function d(a){return function(b){return null==b?void 0:b[a]}}b.exports=d},{}],60:[function(a,b,c){function d(a){return function(b){return e(b,a)}}var e=a("./_baseGet");b.exports=d},{"./_baseGet":49}],61:[function(a,b,c){function d(a,b,c){var d=-1,e=a.length;0>b&&(b=-b>e?0:e+b),c=c>e?e:c,0>c&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}b.exports=d},{}],62:[function(a,b,c){function d(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}b.exports=d},{}],63:[function(a,b,c){function d(a,b){return e(b,function(b){return[b,a[b]]})}var e=a("./_arrayMap");b.exports=d},{"./_arrayMap":34}],64:[function(a,b,c){function d(a){return a&&a.Object===Object?a:null}b.exports=d},{}],65:[function(a,b,c){function d(a,b,c){return e(a,b,c)}var e=a("./_copyObjectWith");b.exports=d},{"./_copyObjectWith":66}],66:[function(a,b,c){function d(a,b,c,d){c||(c={});for(var f=-1,g=b.length;++f<g;){var h=b[f],i=d?d(c[h],a[h],h,c,a):a[h];e(c,h,i)}return c}var e=a("./_assignValue");b.exports=d},{"./_assignValue":36}],67:[function(a,b,c){function d(a){return f(function(b,c){var d=-1,f=c.length,g=f>1?c[f-1]:void 0,h=f>2?c[2]:void 0;for(g="function"==typeof g?(f--,g):void 0,h&&e(c[0],c[1],h)&&(g=3>f?void 0:g,f=1),b=Object(b);++d<f;){var i=c[d];i&&a(b,i,d,g)}return b})}var e=a("./_isIterateeCall"),f=a("./rest");b.exports=d},{"./_isIterateeCall":85,"./rest":130}],68:[function(a,b,c){function d(a,b){return function(c,d){if(null==c)return c;if(!e(c))return a(c,d);for(var f=c.length,g=b?f:-1,h=Object(c);(b?g--:++g<f)&&d(h[g],g,h)!==!1;);return c}}var e=a("./isArrayLike");b.exports=d},{"./isArrayLike":115}],69:[function(a,b,c){function d(a){return function(b,c,d){for(var e=-1,f=Object(b),g=d(b),h=g.length;h--;){var i=g[a?h:++e];if(c(f[i],i,f)===!1)break}return b}}b.exports=d},{}],70:[function(a,b,c){function d(a,b,c,d,h,i){var j=-1,k=h&g,l=h&f,m=a.length,n=b.length;if(m!=n&&!(k&&n>m))return!1;var o=i.get(a);if(o)return o==b;var p=!0;for(i.set(a,b);++j<m;){var q=a[j],r=b[j];if(d)var s=k?d(r,q,j,b,a,i):d(q,r,j,a,b,i);if(void 0!==s){if(s)continue;p=!1;break}if(l){if(!e(b,function(a){return q===a||c(q,a,d,h,i)})){p=!1;break}}else if(q!==r&&!c(q,r,d,h,i)){p=!1;break}}return i["delete"](a),p}var e=a("./_arraySome"),f=1,g=2;b.exports=d},{"./_arraySome":35}],71:[function(a,b,c){function d(a,b,c,d,u,w){switch(c){case t:return a.byteLength==b.byteLength&&d(new f(a),new f(b))?!0:!1;case k:case l:return+a==+b;case m:return a.name==b.name&&a.message==b.message;case o:return a!=+a?b!=+b:a==+b;case p:case r:return a==b+"";case n:var x=g;case q:var y=w&j;return x||(x=h),(y||a.size==b.size)&&d(x(a),x(b),u,w|i);case s:return!!e&&v.call(a)==v.call(b)}return!1}var e=a("./_Symbol"),f=a("./_Uint8Array"),g=a("./_mapToArray"),h=a("./_setToArray"),i=1,j=2,k="[object Boolean]",l="[object Date]",m="[object Error]",n="[object Map]",o="[object Number]",p="[object RegExp]",q="[object Set]",r="[object String]",s="[object Symbol]",t="[object ArrayBuffer]",u=e?e.prototype:void 0,v=e?u.valueOf:void 0;b.exports=d},{"./_Symbol":29,"./_Uint8Array":30,"./_mapToArray":95,"./_setToArray":99}],72:[function(a,b,c){function d(a,b,c,d,h,i){var j=h&g,k=f(a),l=k.length,m=f(b),n=m.length;if(l!=n&&!j)return!1;for(var o=l;o--;){var p=k[o];if(!(j?p in b:e(b,p)))return!1}var q=i.get(a);if(q)return q==b;var r=!0;i.set(a,b);for(var s=j;++o<l;){p=k[o];var t=a[p],u=b[p];if(d)var v=j?d(u,t,p,b,a,i):d(t,u,p,a,b,i);if(!(void 0===v?t===u||c(t,u,d,h,i):v)){r=!1;break}s||(s="constructor"==p)}if(r&&!s){var w=a.constructor,x=b.constructor;w!=x&&"constructor"in a&&"constructor"in b&&!("function"==typeof w&&w instanceof w&&"function"==typeof x&&x instanceof x)&&(r=!1)}return i["delete"](a),r}var e=a("./_baseHas"),f=a("./keys"),g=2;b.exports=d},{"./_baseHas":50,"./keys":126}],73:[function(a,b,c){var d=a("./_baseProperty"),e=d("length");b.exports=e},{"./_baseProperty":59}],74:[function(a,b,c){function d(a){for(var b=f(a),c=b.length;c--;)b[c][2]=e(b[c][1]);return b}var e=a("./_isStrictComparable"),f=a("./toPairs");b.exports=d},{"./_isStrictComparable":89,"./toPairs":133}],75:[function(a,b,c){function d(a,b){var c=null==a?void 0:a[b];return e(c)?c:void 0}var e=a("./isNative");b.exports=d},{"./isNative":120}],76:[function(a,b,c){function d(a){return n.call(a)}var e=a("./_Map"),f=a("./_Set"),g=a("./_WeakMap"),h="[object Map]",i="[object Object]",j="[object Set]",k="[object WeakMap]",l=Object.prototype,m=Function.prototype.toString,n=l.toString,o=e?m.call(e):"",p=f?m.call(f):"",q=g?m.call(g):"";(e&&d(new e)!=h||f&&d(new f)!=j||g&&d(new g)!=k)&&(d=function(a){var b=n.call(a),c=b==i?a.constructor:null,d="function"==typeof c?m.call(c):"";if(d)switch(d){case o:return h;case p:return j;case q:return k}return b}),b.exports=d},{"./_Map":25,"./_Set":27,"./_WeakMap":31}],77:[function(a,b,c){function d(a,b,c){if(null==a)return!1;var d=c(a,b);d||i(b)||(b=e(b),a=m(a,b),null!=a&&(b=l(b),d=c(a,b)));var n=a?a.length:void 0;return d||!!n&&j(n)&&h(b,n)&&(g(a)||k(a)||f(a))}var e=a("./_baseCastPath"),f=a("./isArguments"),g=a("./isArray"),h=a("./_isIndex"),i=a("./_isKey"),j=a("./isLength"),k=a("./isString"),l=a("./last"),m=a("./_parent");b.exports=d},{"./_baseCastPath":43,"./_isIndex":84,"./_isKey":86,"./_parent":97,"./isArguments":113,"./isArray":114,"./isLength":119,"./isString":123,"./last":127}],78:[function(a,b,c){function d(a,b){return e(a,b)&&delete a[b]}var e=a("./_hashHas");b.exports=d},{"./_hashHas":80}],79:[function(a,b,c){function d(a,b){if(e){var c=a[b];return c===f?void 0:c}return h.call(a,b)?a[b]:void 0}var e=a("./_nativeCreate"),f="__lodash_hash_undefined__",g=Object.prototype,h=g.hasOwnProperty;b.exports=d},{"./_nativeCreate":96}],80:[function(a,b,c){function d(a,b){return e?void 0!==a[b]:g.call(a,b)}var e=a("./_nativeCreate"),f=Object.prototype,g=f.hasOwnProperty;b.exports=d},{"./_nativeCreate":96}],81:[function(a,b,c){function d(a,b,c){a[b]=e&&void 0===c?f:c}var e=a("./_nativeCreate"),f="__lodash_hash_undefined__";b.exports=d},{"./_nativeCreate":96}],82:[function(a,b,c){function d(a){var b=a?a.length:void 0;return h(b)&&(g(a)||i(a)||f(a))?e(b,String):null}var e=a("./_baseTimes"),f=a("./isArguments"),g=a("./isArray"),h=a("./isLength"),i=a("./isString");b.exports=d},{"./_baseTimes":62,"./isArguments":113,"./isArray":114,"./isLength":119,"./isString":123}],83:[function(a,b,c){function d(a){var b=!1;if(null!=a&&"function"!=typeof a.toString)try{b=!!(a+"")}catch(c){}return b}b.exports=d},{}],84:[function(a,b,c){function d(a,b){return a="number"==typeof a||f.test(a)?+a:-1,b=null==b?e:b,a>-1&&a%1==0&&b>a}var e=9007199254740991,f=/^(?:0|[1-9]\d*)$/;b.exports=d},{}],85:[function(a,b,c){function d(a,b,c){if(!h(c))return!1;var d=typeof b;return("number"==d?f(c)&&g(b,c.length):"string"==d&&b in c)?e(c[b],a):!1}var e=a("./eq"),f=a("./isArrayLike"),g=a("./_isIndex"),h=a("./isObject");b.exports=d},{"./_isIndex":84,"./eq":108,"./isArrayLike":115,"./isObject":121}],86:[function(a,b,c){function d(a,b){return"number"==typeof a?!0:!e(a)&&(g.test(a)||!f.test(a)||null!=b&&a in Object(b))}var e=a("./isArray"),f=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,g=/^\w*$/;b.exports=d},{"./isArray":114}],87:[function(a,b,c){function d(a){var b=typeof a;return"number"==b||"boolean"==b||"string"==b&&"__proto__"!=a||null==a}b.exports=d},{}],88:[function(a,b,c){function d(a){var b=a&&a.constructor,c=e(b)&&b.prototype||f;return a===c}var e=a("./isFunction"),f=Object.prototype;b.exports=d},{"./isFunction":118}],89:[function(a,b,c){function d(a){return a===a&&!e(a)}var e=a("./isObject");b.exports=d},{"./isObject":121}],90:[function(a,b,c){function d(){this.__data__={hash:new e,map:f?new f:[],string:new e}}var e=a("./_Hash"),f=a("./_Map");b.exports=d},{"./_Hash":24,"./_Map":25}],91:[function(a,b,c){function d(a){var b=this.__data__;return h(a)?g("string"==typeof a?b.string:b.hash,a):e?b.map["delete"](a):f(b.map,a)}var e=a("./_Map"),f=a("./_assocDelete"),g=a("./_hashDelete"),h=a("./_isKeyable");b.exports=d},{"./_Map":25,"./_assocDelete":37,"./_hashDelete":78,"./_isKeyable":87}],92:[function(a,b,c){function d(a){var b=this.__data__;return h(a)?g("string"==typeof a?b.string:b.hash,a):e?b.map.get(a):f(b.map,a)}var e=a("./_Map"),f=a("./_assocGet"),g=a("./_hashGet"),h=a("./_isKeyable");b.exports=d},{"./_Map":25,"./_assocGet":38,"./_hashGet":79,"./_isKeyable":87}],93:[function(a,b,c){function d(a){var b=this.__data__;return h(a)?g("string"==typeof a?b.string:b.hash,a):e?b.map.has(a):f(b.map,a)}var e=a("./_Map"),f=a("./_assocHas"),g=a("./_hashHas"),h=a("./_isKeyable");b.exports=d},{"./_Map":25,"./_assocHas":39,"./_hashHas":80,"./_isKeyable":87}],94:[function(a,b,c){function d(a,b){var c=this.__data__;return h(a)?g("string"==typeof a?c.string:c.hash,a,b):e?c.map.set(a,b):f(c.map,a,b),this}var e=a("./_Map"),f=a("./_assocSet"),g=a("./_hashSet"),h=a("./_isKeyable");b.exports=d},{"./_Map":25,"./_assocSet":41,"./_hashSet":81,"./_isKeyable":87}],95:[function(a,b,c){function d(a){var b=-1,c=Array(a.size);return a.forEach(function(a,d){c[++b]=[d,a]}),c}b.exports=d},{}],96:[function(a,b,c){var d=a("./_getNative"),e=d(Object,"create");b.exports=e},{"./_getNative":75}],97:[function(a,b,c){function d(a,b){return 1==b.length?a:f(a,e(b,0,-1))}var e=a("./_baseSlice"),f=a("./get");b.exports=d},{"./_baseSlice":61,"./get":110}],98:[function(a,b,c){(function(d){var e=a("./_checkGlobal"),f={"function":!0,object:!0},g=f[typeof c]&&c&&!c.nodeType?c:void 0,h=f[typeof b]&&b&&!b.nodeType?b:void 0,i=e(g&&h&&"object"==typeof d&&d),j=e(f[typeof self]&&self),k=e(f[typeof window]&&window),l=e(f[typeof this]&&this),m=i||k!==(l&&l.window)&&k||j||l||Function("return this")();b.exports=m}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_checkGlobal":64}],99:[function(a,b,c){function d(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=a}),c}b.exports=d},{}],100:[function(a,b,c){function d(){this.__data__={array:[],map:null}}b.exports=d},{}],101:[function(a,b,c){function d(a){var b=this.__data__,c=b.array;return c?e(c,a):b.map["delete"](a)}var e=a("./_assocDelete");b.exports=d},{"./_assocDelete":37}],102:[function(a,b,c){function d(a){var b=this.__data__,c=b.array;return c?e(c,a):b.map.get(a)}var e=a("./_assocGet");b.exports=d},{"./_assocGet":38}],103:[function(a,b,c){function d(a){var b=this.__data__,c=b.array;return c?e(c,a):b.map.has(a)}var e=a("./_assocHas");b.exports=d},{"./_assocHas":39}],104:[function(a,b,c){function d(a,b){var c=this.__data__,d=c.array;d&&(d.length<g-1?f(d,a,b):(c.array=null,c.map=new e(d)));var h=c.map;return h&&h.set(a,b),this}var e=a("./_MapCache"),f=a("./_assocSet"),g=200;b.exports=d},{"./_MapCache":26,"./_assocSet":41}],105:[function(a,b,c){function d(a){var b=[];return e(a).replace(f,function(a,c,d,e){b.push(d?e.replace(g,"$1"):c||a)}),b}var e=a("./toString"),f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,g=/\\(\\)?/g;b.exports=d},{"./toString":134}],106:[function(a,b,c){var d=a("./_copyObject"),e=a("./_createAssigner"),f=a("./keys"),g=e(function(a,b){d(b,f(b),a)});b.exports=g},{"./_copyObject":65,"./_createAssigner":67,"./keys":126}],107:[function(a,b,c){function d(a,b){var c=f(a);return b?e(c,b):c}var e=a("./_baseAssign"),f=a("./_baseCreate");b.exports=d},{"./_baseAssign":42,"./_baseCreate":44}],108:[function(a,b,c){function d(a,b){return a===b||a!==a&&b!==b}b.exports=d},{}],109:[function(a,b,c){function d(a,b,c){var d=h(a)?e:f;return c&&i(a,b,c)&&(b=void 0),d(a,g(b,3))}var e=a("./_arrayEvery"),f=a("./_baseEvery"),g=a("./_baseIteratee"),h=a("./isArray"),i=a("./_isIterateeCall");b.exports=d},{"./_arrayEvery":33,"./_baseEvery":46,"./_baseIteratee":55,"./_isIterateeCall":85,"./isArray":114}],110:[function(a,b,c){function d(a,b,c){var d=null==a?void 0:e(a,b);return void 0===d?c:d}var e=a("./_baseGet");b.exports=d},{"./_baseGet":49}],111:[function(a,b,c){function d(a,b){return f(a,b,e)}var e=a("./_baseHasIn"),f=a("./_hasPath");b.exports=d},{"./_baseHasIn":51,"./_hasPath":77}],112:[function(a,b,c){function d(a){return a}b.exports=d},{}],113:[function(a,b,c){function d(a){return e(a)&&h.call(a,"callee")&&(!j.call(a,"callee")||i.call(a)==f)}var e=a("./isArrayLikeObject"),f="[object Arguments]",g=Object.prototype,h=g.hasOwnProperty,i=g.toString,j=g.propertyIsEnumerable;b.exports=d},{"./isArrayLikeObject":116}],114:[function(a,b,c){
var d=Array.isArray;b.exports=d},{}],115:[function(a,b,c){function d(a){return null!=a&&!("function"==typeof a&&f(a))&&g(e(a))}var e=a("./_getLength"),f=a("./isFunction"),g=a("./isLength");b.exports=d},{"./_getLength":73,"./isFunction":118,"./isLength":119}],116:[function(a,b,c){function d(a){return f(a)&&e(a)}var e=a("./isArrayLike"),f=a("./isObjectLike");b.exports=d},{"./isArrayLike":115,"./isObjectLike":122}],117:[function(a,b,c){function d(a){if(g(a)&&(f(a)||i(a)||h(a.splice)||e(a)))return!a.length;for(var b in a)if(k.call(a,b))return!1;return!0}var e=a("./isArguments"),f=a("./isArray"),g=a("./isArrayLike"),h=a("./isFunction"),i=a("./isString"),j=Object.prototype,k=j.hasOwnProperty;b.exports=d},{"./isArguments":113,"./isArray":114,"./isArrayLike":115,"./isFunction":118,"./isString":123}],118:[function(a,b,c){function d(a){var b=e(a)?i.call(a):"";return b==f||b==g}var e=a("./isObject"),f="[object Function]",g="[object GeneratorFunction]",h=Object.prototype,i=h.toString;b.exports=d},{"./isObject":121}],119:[function(a,b,c){function d(a){return"number"==typeof a&&a>-1&&a%1==0&&e>=a}var e=9007199254740991;b.exports=d},{}],120:[function(a,b,c){function d(a){return null==a?!1:e(a)?m.test(k.call(a)):g(a)&&(f(a)?m:i).test(a)}var e=a("./isFunction"),f=a("./_isHostObject"),g=a("./isObjectLike"),h=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,j=Object.prototype,k=Function.prototype.toString,l=j.hasOwnProperty,m=RegExp("^"+k.call(l).replace(h,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");b.exports=d},{"./_isHostObject":83,"./isFunction":118,"./isObjectLike":122}],121:[function(a,b,c){function d(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}b.exports=d},{}],122:[function(a,b,c){function d(a){return!!a&&"object"==typeof a}b.exports=d},{}],123:[function(a,b,c){function d(a){return"string"==typeof a||!e(a)&&f(a)&&i.call(a)==g}var e=a("./isArray"),f=a("./isObjectLike"),g="[object String]",h=Object.prototype,i=h.toString;b.exports=d},{"./isArray":114,"./isObjectLike":122}],124:[function(a,b,c){function d(a){return"symbol"==typeof a||e(a)&&h.call(a)==f}var e=a("./isObjectLike"),f="[object Symbol]",g=Object.prototype,h=g.toString;b.exports=d},{"./isObjectLike":122}],125:[function(a,b,c){function d(a){return f(a)&&e(a.length)&&!!D[F.call(a)]}var e=a("./isLength"),f=a("./isObjectLike"),g="[object Arguments]",h="[object Array]",i="[object Boolean]",j="[object Date]",k="[object Error]",l="[object Function]",m="[object Map]",n="[object Number]",o="[object Object]",p="[object RegExp]",q="[object Set]",r="[object String]",s="[object WeakMap]",t="[object ArrayBuffer]",u="[object Float32Array]",v="[object Float64Array]",w="[object Int8Array]",x="[object Int16Array]",y="[object Int32Array]",z="[object Uint8Array]",A="[object Uint8ClampedArray]",B="[object Uint16Array]",C="[object Uint32Array]",D={};D[u]=D[v]=D[w]=D[x]=D[y]=D[z]=D[A]=D[B]=D[C]=!0,D[g]=D[h]=D[t]=D[i]=D[j]=D[k]=D[l]=D[m]=D[n]=D[o]=D[p]=D[q]=D[r]=D[s]=!1;var E=Object.prototype,F=E.toString;b.exports=d},{"./isLength":119,"./isObjectLike":122}],126:[function(a,b,c){function d(a){var b=j(a);if(!b&&!h(a))return f(a);var c=g(a),d=!!c,k=c||[],l=k.length;for(var m in a)!e(a,m)||d&&("length"==m||i(m,l))||b&&"constructor"==m||k.push(m);return k}var e=a("./_baseHas"),f=a("./_baseKeys"),g=a("./_indexKeys"),h=a("./isArrayLike"),i=a("./_isIndex"),j=a("./_isPrototype");b.exports=d},{"./_baseHas":50,"./_baseKeys":56,"./_indexKeys":82,"./_isIndex":84,"./_isPrototype":88,"./isArrayLike":115}],127:[function(a,b,c){function d(a){var b=a?a.length:0;return b?a[b-1]:void 0}b.exports=d},{}],128:[function(a,c,d){(function(a){(function(){function e(a,b){return a.set(b[0],b[1]),a}function f(a,b){return a.add(b),a}function g(a,b,c){var d=c.length;switch(d){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function h(a,b,c,d){for(var e=-1,f=a.length;++e<f;){var g=a[e];b(d,g,c(g),a)}return d}function i(a,b){for(var c=-1,d=a.length,e=-1,f=b.length,g=Array(d+f);++c<d;)g[c]=a[c];for(;++e<f;)g[c++]=b[e];return g}function j(a,b){for(var c=-1,d=a.length;++c<d&&b(a[c],c,a)!==!1;);return a}function k(a,b){for(var c=a.length;c--&&b(a[c],c,a)!==!1;);return a}function l(a,b){for(var c=-1,d=a.length;++c<d;)if(!b(a[c],c,a))return!1;return!0}function m(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;){var g=a[c];b(g,c,a)&&(f[++e]=g)}return f}function n(a,b){return!!a.length&&x(a,b,0)>-1}function o(a,b,c){for(var d=-1,e=a.length;++d<e;)if(c(b,a[d]))return!0;return!1}function p(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function q(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}function r(a,b,c,d){var e=-1,f=a.length;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function s(a,b,c,d){var e=a.length;for(d&&e&&(c=a[--e]);e--;)c=b(c,a[e],e,a);return c}function t(a,b){for(var c=-1,d=a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function u(a,b,c){for(var d=-1,e=a.length;++d<e;){var f=a[d],g=b(f);if(null!=g&&(h===Z?g===g:c(g,h)))var h=g,i=f}return i}function v(a,b,c,d){var e;return c(a,function(a,c,f){return b(a,c,f)?(e=d?c:a,!1):void 0}),e}function w(a,b,c){for(var d=a.length,e=c?d:-1;c?e--:++e<d;)if(b(a[e],e,a))return e;return-1}function x(a,b,c){if(b!==b)return O(a,c);for(var d=c-1,e=a.length;++d<e;)if(a[d]===b)return d;return-1}function y(a,b,c,d,e){return e(a,function(a,e,f){c=d?(d=!1,a):b(c,a,e,f)}),c}function z(a,b){var c=a.length;for(a.sort(b);c--;)a[c]=a[c].value;return a}function A(a,b){for(var c,d=-1,e=a.length;++d<e;){var f=b(a[d]);f!==Z&&(c=c===Z?f:c+f)}return c}function B(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}function C(a,b){return p(b,function(b){return[b,a[b]]})}function D(a){return function(b){return a(b)}}function E(a,b){return p(b,function(b){return a[b]})}function F(a,b){for(var c=-1,d=a.length;++c<d&&x(b,a[c],0)>-1;);return c}function G(a,b){for(var c=a.length;c--&&x(b,a[c],0)>-1;);return c}function H(a){return a&&a.Object===Object?a:null}function I(a,b){if(a!==b){var c=null===a,d=a===Z,e=a===a,f=null===b,g=b===Z,h=b===b;if(a>b&&!f||!e||c&&!g&&h||d&&h)return 1;if(b>a&&!c||!h||f&&!d&&e||g&&e)return-1}return 0}function J(a,b,c){for(var d=-1,e=a.criteria,f=b.criteria,g=e.length,h=c.length;++d<g;){var i=I(e[d],f[d]);if(i){if(d>=h)return i;var j=c[d];return i*("desc"==j?-1:1)}}return a.index-b.index}function K(a,b){for(var c=a.length,d=0;c--;)a[c]===b&&d++;return d}function L(a){return vc[a]}function M(a){return wc[a]}function N(a){return"\\"+zc[a]}function O(a,b,c){for(var d=a.length,e=b+(c?0:-1);c?e--:++e<d;){var f=a[e];if(f!==f)return e}return-1}function P(a){var b=!1;if(null!=a&&"function"!=typeof a.toString)try{b=!!(a+"")}catch(c){}return b}function Q(a,b){return a="number"==typeof a||Bb.test(a)?+a:-1,b=null==b?wa:b,a>-1&&a%1==0&&b>a}function R(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function S(a){var b=-1,c=Array(a.size);return a.forEach(function(a,d){c[++b]=[d,a]}),c}function T(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;){var g=a[c];(g===b||g===Ca)&&(a[c]=Ca,f[++e]=c)}return f}function U(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=a}),c}function V(a){if(!a||!nc.test(a))return a.length;for(var b=mc.lastIndex=0;mc.test(a);)b++;return b}function W(a){return a.match(mc)}function X(a){return xc[a]}function Y(a){function b(a){if(Mg(a)&&!uk(a)&&!(a instanceof H)){if(a instanceof d)return a;if(Ri.call(a,"__wrapped__"))return Ge(a)}return new d(a)}function c(){}function d(a,b){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!b,this.__index__=0,this.__values__=Z}function H(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=za,this.__views__=[]}function Bb(){var a=new H(this.__wrapped__);return a.__actions__=Ld(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=Ld(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=Ld(this.__views__),a}function Fb(){if(this.__filtered__){var a=new H(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function Gb(){var a=this.__wrapped__.value(),b=this.__dir__,c=uk(a),d=0>b,e=c?a.length:0,f=pe(0,e,this.__views__),g=f.start,h=f.end,i=h-g,j=d?h:g-1,k=this.__iteratees__,l=k.length,m=0,n=oj(i,this.__takeCount__);if(!c||pa>e||e==i&&n==i)return zd(a,this.__actions__);var o=[];a:for(;i--&&n>m;){j+=b;for(var p=-1,q=a[j];++p<l;){var r=k[p],s=r.iteratee,t=r.type,u=s(q);if(t==ra)q=u;else if(!u){if(t==qa)continue a;break a}}o[m++]=q}return o}function Hb(){}function Ib(a,b){return Kb(a,b)&&delete a[b]}function Jb(a,b){if(vj){var c=a[b];return c===ua?Z:c}return Ri.call(a,b)?a[b]:Z}function Kb(a,b){return vj?a[b]!==Z:Ri.call(a,b)}function Lb(a,b,c){a[b]=vj&&c===Z?ua:c}function Mb(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Nb(){this.__data__={hash:new Hb,map:sj?new sj:[],string:new Hb}}function Ob(a){var b=this.__data__;return xe(a)?Ib("string"==typeof a?b.string:b.hash,a):sj?b.map["delete"](a):_b(b.map,a)}function Pb(a){var b=this.__data__;return xe(a)?Jb("string"==typeof a?b.string:b.hash,a):sj?b.map.get(a):ac(b.map,a)}function Qb(a){var b=this.__data__;return xe(a)?Kb("string"==typeof a?b.string:b.hash,a):sj?b.map.has(a):bc(b.map,a)}function Rb(a,b){var c=this.__data__;return xe(a)?Lb("string"==typeof a?c.string:c.hash,a,b):sj?c.map.set(a,b):dc(c.map,a,b),this}function Sb(a){var b=-1,c=a?a.length:0;for(this.__data__=new Mb;++b<c;)this.push(a[b])}function Tb(a,b){var c=a.__data__;if(xe(b)){var d=c.__data__,e="string"==typeof b?d.string:d.hash;return e[b]===ua}return c.has(b)}function Ub(a){var b=this.__data__;if(xe(a)){var c=b.__data__,d="string"==typeof a?c.string:c.hash;d[a]=ua}else b.set(a,ua)}function Vb(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Wb(){this.__data__={array:[],map:null}}function Xb(a){var b=this.__data__,c=b.array;return c?_b(c,a):b.map["delete"](a)}function Yb(a){var b=this.__data__,c=b.array;return c?ac(c,a):b.map.get(a)}function Zb(a){var b=this.__data__,c=b.array;return c?bc(c,a):b.map.has(a)}function $b(a,b){var c=this.__data__,d=c.array;d&&(d.length<pa-1?dc(d,a,b):(c.array=null,c.map=new Mb(d)));var e=c.map;return e&&e.set(a,b),this}function _b(a,b){var c=cc(a,b);if(0>c)return!1;var d=a.length-1;return c==d?a.pop():hj.call(a,c,1),!0}function ac(a,b){var c=cc(a,b);return 0>c?Z:a[c][1]}function bc(a,b){return cc(a,b)>-1}function cc(a,b){for(var c=a.length;c--;)if(tg(a[c][0],b))return c;return-1}function dc(a,b,c){var d=cc(a,b);0>d?a.push([b,c]):a[d][1]=c}function ec(a,b,c,d){return a===Z||tg(a,Pi[c])&&!Ri.call(d,c)?b:a}function fc(a,b,c){(c!==Z&&!tg(a[b],c)||"number"==typeof b&&c===Z&&!(b in a))&&(a[b]=c)}function gc(a,b,c){var d=a[b];Ri.call(a,b)&&tg(d,c)&&(c!==Z||b in a)||(a[b]=c)}function hc(a,b,c,d){return Ej(a,function(a,e,f){b(d,a,c(a),f)}),d}function ic(a,b){return a&&Md(b,yh(b),a)}function jc(a,b){for(var c=-1,d=null==a,e=b.length,f=Array(e);++c<e;)f[c]=d?Z:vh(a,b[c]);return f}function kc(a){return zg(a)?a:[]}function mc(a){return"function"==typeof a?a:ni}function vc(a){return uk(a)?a:Fe(a)}function wc(a,b,c){return a===a&&(c!==Z&&(a=c>=a?a:c),b!==Z&&(a=a>=b?a:b)),a}function xc(a,b,c,d,e,f){var g;if(c&&(g=e?c(a,d,e,f):c(a)),g!==Z)return g;if(!Lg(a))return a;var h=uk(a);if(h){if(g=re(a),!b)return Ld(a,g)}else{var i=oe(a),k=i==Ia||i==Ja;if(vk(a))return Cd(a,b);if(i==Ma||i==Da||k&&!e){if(P(a))return e?a:{};if(g=se(k?{}:a),!b)return Od(a,ic(g,a))}else{if(!uc[i])return e?a:{};g=te(a,i,b)}}f||(f=new Vb);var l=f.get(a);return l?l:(f.set(a,g),(h?j:Mc)(a,function(d,e){gc(g,e,xc(d,b,c,e,a,f))}),h?g:Od(a,g))}function yc(a){var b=yh(a),c=b.length;return function(d){if(null==d)return!c;for(var e=c;e--;){var f=b[e],g=a[f],h=d[f];if(h===Z&&!(f in Object(d))||!g(h))return!1}return!0}}function zc(a){return Lg(a)?ej(a):{}}function Cc(a,b,c){if("function"!=typeof a)throw new Ni(ta);return gj(function(){a.apply(Z,c)},b)}function Dc(a,b,c,d){var e=-1,f=n,g=!0,h=a.length,i=[],j=b.length;if(!h)return i;c&&(b=p(b,D(c))),d?(f=o,g=!1):b.length>=pa&&(f=Tb,g=!1,b=new Sb(b));a:for(;++e<h;){var k=a[e],l=c?c(k):k;if(g&&l===l){for(var m=j;m--;)if(b[m]===l)continue a;i.push(k)}else f(b,l,d)||i.push(k)}return i}function Fc(a,b){var c=!0;return Ej(a,function(a,d,e){return c=!!b(a,d,e)}),c}function Gc(a,b,c,d){var e=a.length;for(c=gh(c),0>c&&(c=-c>e?0:e+c),d=d===Z||d>e?e:gh(d),0>d&&(d+=e),d=c>d?0:hh(d);d>c;)a[c++]=b;return a}function Hc(a,b){var c=[];return Ej(a,function(a,d,e){b(a,d,e)&&c.push(a)}),c}function Ic(a,b,c,d){d||(d=[]);for(var e=-1,f=a.length;++e<f;){var g=a[e];b>0&&zg(g)&&(c||uk(g)||wg(g))?b>1?Ic(g,b-1,c,d):q(d,g):c||(d[d.length]=g)}return d}function Lc(a,b){return null==a?a:Gj(a,b,zh)}function Mc(a,b){return a&&Gj(a,b,yh)}function Nc(a,b){return a&&Hj(a,b,yh)}function Oc(a,b){return m(b,function(b){return Ig(a[b])})}function Pc(a,b){b=we(b,a)?[b+""]:vc(b);for(var c=0,d=b.length;null!=a&&d>c;)a=a[b[c++]];return c&&c==d?a:Z}function Qc(a,b){return Ri.call(a,b)||"object"==typeof a&&b in a&&null===bj(a)}function Rc(a,b){return b in Object(a)}function Sc(a,b,c){return a>=oj(b,c)&&a<nj(b,c)}function Tc(a,b,c){for(var d=c?o:n,e=a.length,f=e,g=Array(e),h=[];f--;){var i=a[f];f&&b&&(i=p(i,D(b))),g[f]=!c&&(b||i.length>=120)?new Sb(f&&i):Z}i=a[0];var j=-1,k=i.length,l=g[0];a:for(;++j<k;){var m=i[j],q=b?b(m):m;if(!(l?Tb(l,q):d(h,q,c))){for(var f=e;--f;){var r=g[f];if(!(r?Tb(r,q):d(a[f],q,c)))continue a}l&&l.push(q),h.push(m)}}return h}function Uc(a,b,c,d){return Mc(a,function(a,e,f){b(d,c(a),e,f)}),d}function Vc(a,b,c){we(b,a)||(b=vc(b),a=De(a,b),b=Ye(b));var d=null==a?a:a[b];return null==d?Z:g(d,a,c)}function Wc(a,b,c,d,e){return a===b?!0:null==a||null==b||!Lg(a)&&!Mg(b)?a!==a&&b!==b:Xc(a,b,Wc,c,d,e)}function Xc(a,b,c,d,e,f){var g=uk(a),h=uk(b),i=Ea,j=Ea;g||(i=oe(a),i==Da?i=Ma:i!=Ma&&(g=_g(a))),h||(j=oe(b),j==Da?j=Ma:j!=Ma&&(h=_g(b)));var k=i==Ma&&!P(a),l=j==Ma&&!P(b),m=i==j;if(m&&!g&&!k)return he(a,b,i,c,d,e);var n=e&ka;if(!n){var o=k&&Ri.call(a,"__wrapped__"),p=l&&Ri.call(b,"__wrapped__");if(o||p)return c(o?a.value():a,p?b.value():b,d,e,f)}return m?(f||(f=new Vb),(g?ge:ie)(a,b,c,d,e,f)):!1}function Yc(a,b,c,d){var e=c.length,f=e,g=!d;if(null==a)return!f;for(a=Object(a);e--;){var h=c[e];if(g&&h[2]?h[1]!==a[h[0]]:!(h[0]in a))return!1}for(;++e<f;){h=c[e];var i=h[0],j=a[i],k=h[1];if(g&&h[2]){if(j===Z&&!(i in a))return!1}else{var l=new Vb,m=d?d(j,k,i,a,b,l):Z;if(!(m===Z?Wc(k,j,d,ja|ka,l):m))return!1}}return!0}function Zc(a){var b=typeof a;return"function"==b?a:null==a?ni:"object"==b?uk(a)?cd(a[0],a[1]):bd(a):vi(a)}function $c(a){return mj(Object(a))}function _c(a){a=null==a?a:Object(a);var b=[];for(var c in a)b.push(c);return b}function ad(a,b){var c=-1,d=yg(a)?Array(a.length):[];return Ej(a,function(a,e,f){d[++c]=b(a,e,f)}),d}function bd(a){var b=le(a);if(1==b.length&&b[0][2]){var c=b[0][0],d=b[0][1];return function(a){return null==a?!1:a[c]===d&&(d!==Z||c in Object(a))}}return function(c){return c===a||Yc(c,a,b)}}function cd(a,b){return function(c){var d=vh(c,a);return d===Z&&d===b?xh(c,a):Wc(b,d,Z,ja|ka)}}function dd(a,b,c,d,e){if(a!==b){var f=uk(b)||_g(b)?Z:zh(b);j(f||b,function(g,h){if(f&&(h=g,g=b[h]),Lg(g))e||(e=new Vb),ed(a,b,h,c,dd,d,e);else{var i=d?d(a[h],g,h+"",a,b,e):Z;i===Z&&(i=g),fc(a,h,i)}})}}function ed(a,b,c,d,e,f,g){var h=a[c],i=b[c],j=g.get(i);if(j)return void fc(a,c,j);var k=f?f(h,i,c+"",a,b,g):Z,l=k===Z;l&&(k=i,uk(i)||_g(i)?uk(h)?k=h:zg(h)?k=Ld(h):(l=!1,k=xc(i,!0)):Vg(i)||wg(i)?wg(h)?k=jh(h):!Lg(h)||d&&Ig(h)?(l=!1,k=xc(i,!0)):k=h:l=!1),g.set(i,k),l&&e(k,i,d,f,g),fc(a,c,k)}function fd(a,b,c){var d=-1,e=ke();b=p(b.length?b:Array(1),function(a){return e(a)});var f=ad(a,function(a,c,e){var f=p(b,function(b){return b(a)});return{criteria:f,index:++d,value:a}});return z(f,function(a,b){return J(a,b,c)})}function gd(a,b){return a=Object(a),r(b,function(b,c){return c in a&&(b[c]=a[c]),b},{})}function hd(a,b){var c={};return Lc(a,function(a,d){b(a,d)&&(c[d]=a)}),c}function id(a){return function(b){return null==b?Z:b[a]}}function jd(a){return function(b){return Pc(b,a)}}function kd(a,b){return ld(a,b)}function ld(a,b,c){var d=-1,e=b.length,f=a;for(c&&(f=p(a,function(a){return c(a)}));++d<e;)for(var g=0,h=b[d],i=c?c(h):h;(g=x(f,i,g))>-1;)f!==a&&hj.call(f,g,1),hj.call(a,g,1);return a}function md(a,b){for(var c=a?b.length:0,d=c-1;c--;){var e=b[c];if(d==c||e!=f){var f=e;if(Q(e))hj.call(a,e,1);else if(we(e,a))delete a[e];else{var g=vc(e),h=De(a,g);null!=h&&delete h[Ye(g)]}}}return a}function nd(a,b){return a+jj(qj()*(b-a+1))}function od(a,b,c,d){for(var e=-1,f=nj(ij((b-a)/(c||1)),0),g=Array(f);f--;)g[d?f:++e]=a,a+=c;return g}function pd(a,b,c,d){b=we(b,a)?[b+""]:vc(b);for(var e=-1,f=b.length,g=f-1,h=a;null!=h&&++e<f;){var i=b[e];if(Lg(h)){var j=c;if(e!=g){var k=h[i];j=d?d(k,i,h):Z,j===Z&&(j=null==k?Q(b[e+1])?[]:{}:k)}gc(h,i,j)}h=h[i]}return a}function qd(a,b,c){var d=-1,e=a.length;0>b&&(b=-b>e?0:e+b),c=c>e?e:c,0>c&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}function rd(a,b){var c;return Ej(a,function(a,d,e){return c=b(a,d,e),!c}),!!c}function sd(a,b,c){var d=0,e=a?a.length:d;if("number"==typeof b&&b===b&&Ba>=e){for(;e>d;){var f=d+e>>>1,g=a[f];(c?b>=g:b>g)&&null!==g?d=f+1:e=f}return e}return td(a,b,ni,c)}function td(a,b,c,d){b=c(b);for(var e=0,f=a?a.length:0,g=b!==b,h=null===b,i=b===Z;f>e;){var j=jj((e+f)/2),k=c(a[j]),l=k!==Z,m=k===k;if(g)var n=m||d;else n=h?m&&l&&(d||null!=k):i?m&&(d||l):null==k?!1:d?b>=k:b>k;n?e=j+1:f=j}return oj(f,Aa)}function ud(a){return vd(a)}function vd(a,b){for(var c=0,d=a.length,e=a[0],f=b?b(e):e,g=f,h=0,i=[e];++c<d;)e=a[c],f=b?b(e):e,tg(f,g)||(g=f,i[++h]=e);return i}function wd(a,b,c){var d=-1,e=n,f=a.length,g=!0,h=[],i=h;if(c)g=!1,e=o;else if(f>=pa){var j=b?null:Jj(a);if(j)return U(j);g=!1,e=Tb,i=new Sb}else i=b?[]:h;a:for(;++d<f;){var k=a[d],l=b?b(k):k;if(g&&l===l){for(var m=i.length;m--;)if(i[m]===l)continue a;b&&i.push(l),h.push(k)}else e(i,l,c)||(i!==h&&i.push(l),h.push(k))}return h}function xd(a,b){b=we(b,a)?[b+""]:vc(b),a=De(a,b);var c=Ye(b);return null!=a&&wh(a,c)?delete a[c]:!0}function yd(a,b,c,d){for(var e=a.length,f=d?e:-1;(d?f--:++f<e)&&b(a[f],f,a););return c?qd(a,d?0:f,d?f+1:e):qd(a,d?f+1:0,d?e:f)}function zd(a,b){var c=a;return c instanceof H&&(c=c.value()),r(b,function(a,b){return b.func.apply(b.thisArg,q([a],b.args))},c)}function Ad(a,b,c){for(var d=-1,e=a.length;++d<e;)var f=f?q(Dc(f,a[d],b,c),Dc(a[d],f,b,c)):a[d];return f&&f.length?wd(f,b,c):[]}function Bd(a,b,c){for(var d=-1,e=a.length,f=b.length,g={};++d<e;)c(g,a[d],f>d?b[d]:Z);return g}function Cd(a,b){if(b)return a.slice();var c=a.constructor,d=new c(a.length);return a.copy(d),d}function Dd(a){var b=a.constructor,c=new b(a.byteLength),d=new $i(c);return d.set(new $i(a)),c}function Ed(a){var b=a.constructor;return r(S(a),e,new b)}function Fd(a){var b=a.constructor,c=new b(a.source,vb.exec(a));return c.lastIndex=a.lastIndex,c}function Gd(a){var b=a.constructor;return r(U(a),f,new b)}function Hd(a){return Zi?Object(Bj.call(a)):{}}function Id(a,b){var c=a.buffer,d=b?Dd(c):c,e=a.constructor;return new e(d,a.byteOffset,a.length)}function Jd(a,b,c,d){for(var e=-1,f=a.length,g=c.length,h=-1,i=b.length,j=nj(f-g,0),k=Array(i+j),l=!d;++h<i;)k[h]=b[h];for(;++e<g;)(l||f>e)&&(k[c[e]]=a[e]);for(;j--;)k[h++]=a[e++];return k}function Kd(a,b,c,d){for(var e=-1,f=a.length,g=-1,h=c.length,i=-1,j=b.length,k=nj(f-h,0),l=Array(k+j),m=!d;++e<k;)l[e]=a[e];for(var n=e;++i<j;)l[n+i]=b[i];for(;++g<h;)(m||f>e)&&(l[n+c[g]]=a[e++]);return l}function Ld(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function Md(a,b,c){return Nd(a,b,c)}function Nd(a,b,c,d){c||(c={});for(var e=-1,f=b.length;++e<f;){var g=b[e],h=d?d(c[g],a[g],g,c,a):a[g];gc(c,g,h)}return c}function Od(a,b){return Md(a,Mj(a),b)}function Pd(a,b){return function(c,d){var e=uk(c)?h:hc,f=b?b():{};return e(c,a,ke(d),f)}}function Qd(a){return jg(function(b,c){var d=-1,e=c.length,f=e>1?c[e-1]:Z,g=e>2?c[2]:Z;for(f="function"==typeof f?(e--,f):Z,g&&ve(c[0],c[1],g)&&(f=3>e?Z:f,e=1),b=Object(b);++d<e;){var h=c[d];h&&a(b,h,d,f)}return b})}function Rd(a,b){return function(c,d){if(null==c)return c;if(!yg(c))return a(c,d);for(var e=c.length,f=b?e:-1,g=Object(c);(b?f--:++f<e)&&d(g[f],f,g)!==!1;);return c}}function Sd(a){return function(b,c,d){for(var e=-1,f=Object(b),g=d(b),h=g.length;h--;){var i=g[a?h:++e];if(c(f[i],i,f)===!1)break}return b}}function Td(a,b,c){function d(){var b=this&&this!==Jc&&this instanceof d?f:a;return b.apply(e?c:this,arguments)}var e=b&_,f=Wd(a);return d}function Ud(a){return function(b){b=lh(b);var c=nc.test(b)?W(b):Z,d=c?c[0]:b.charAt(0),e=c?c.slice(1).join(""):b.slice(1);return d[a]()+e}}function Vd(a){return function(b){return r(ji(Rh(b)),a,"")}}function Wd(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=zc(a.prototype),d=a.apply(c,b);return Lg(d)?d:c}}function Xd(a,b,c){function d(){for(var f=arguments.length,h=Array(f),i=f,j=ne(d);i--;)h[i]=arguments[i];var k=3>f&&h[0]!==j&&h[f-1]!==j?[]:T(h,j);if(f-=k.length,c>f)return de(a,b,Zd,d.placeholder,Z,h,k,Z,Z,c-f);var l=this&&this!==Jc&&this instanceof d?e:a;return g(l,this,h)}var e=Wd(a);return d}function Yd(a){return jg(function(b){b=Ic(b,1);var c=b.length,e=c,f=d.prototype.thru;for(a&&b.reverse();e--;){var g=b[e];if("function"!=typeof g)throw new Ni(ta);if(f&&!h&&"wrapper"==je(g))var h=new d([],!0)}for(e=h?e:c;++e<c;){g=b[e];var i=je(g),j="wrapper"==i?Kj(g):Z;h=j&&ye(j[0])&&j[1]==(ga|ca|ea|ha)&&!j[4].length&&1==j[9]?h[je(j[0])].apply(h,j[3]):1==g.length&&ye(g)?h[i]():h.thru(g)}return function(){var a=arguments,d=a[0];if(h&&1==a.length&&uk(d)&&d.length>=pa)return h.plant(d).value();for(var e=0,f=c?b[e].apply(this,a):d;++e<c;)f=b[e].call(this,f);return f}})}function Zd(a,b,c,d,e,f,g,h,i,j){function k(){for(var r=arguments.length,s=r,t=Array(r);s--;)t[s]=arguments[s];if(o)var u=ne(k),v=K(t,u);if(d&&(t=Jd(t,d,e,o)),f&&(t=Kd(t,f,g,o)),r-=v,o&&j>r){var w=T(t,u);return de(a,b,Zd,k.placeholder,c,t,w,h,i,j-r)}var x=m?c:this,y=n?x[a]:a;return r=t.length,h?t=Ee(t,h):p&&r>1&&t.reverse(),l&&r>i&&(t.length=i),this&&this!==Jc&&this instanceof k&&(y=q||Wd(y)),y.apply(x,t)}var l=b&ga,m=b&_,n=b&aa,o=b&(ca|da),p=b&ia,q=n?Z:Wd(a);return k}function $d(a,b){return function(c,d){return Uc(c,a,b(d),{})}}function _d(a){return jg(function(b){return b=p(Ic(b,1),ke()),jg(function(c){var d=this;return a(b,function(a){return g(a,d,c)})})})}function ae(a,b,c){b=gh(b);var d=V(a);if(!b||d>=b)return"";var e=b-d;c=c===Z?" ":c+"";var f=Zh(c,ij(e/V(c)));return nc.test(c)?W(f).slice(0,e).join(""):f.slice(0,e)}function be(a,b,c,d){function e(){for(var b=-1,i=arguments.length,j=-1,k=d.length,l=Array(k+i),m=this&&this!==Jc&&this instanceof e?h:a;++j<k;)l[j]=d[j];for(;i--;)l[j++]=arguments[++b];return g(m,f?c:this,l)}var f=b&_,h=Wd(a);return e}function ce(a){return function(b,c,d){return d&&"number"!=typeof d&&ve(b,c,d)&&(c=d=Z),b=ih(b),b=b===b?b:0,c===Z?(c=b,b=0):c=ih(c)||0,d=d===Z?c>b?1:-1:ih(d)||0,od(b,c,d,a)}}function de(a,b,c,d,e,f,g,h,i,j){var k=b&ca,l=h?Ld(h):Z,m=k?g:Z,n=k?Z:g,o=k?f:Z,p=k?Z:f;b|=k?ea:fa,b&=~(k?fa:ea),b&ba||(b&=~(_|aa));var q=[a,b,e,o,m,p,n,l,i,j],r=c.apply(Z,q);return ye(a)&&Nj(r,q),r.placeholder=d,r}function ee(a){var b=Li[a];return function(a,c){if(a=ih(a),c=gh(c)){var d=(lh(a)+"e").split("e"),e=b(d[0]+"e"+(+d[1]+c));return d=(lh(e)+"e").split("e"),+(d[0]+"e"+(+d[1]-c))}return b(a)}}function fe(a,b,c,d,e,f,g,h){var i=b&aa;if(!i&&"function"!=typeof a)throw new Ni(ta);var j=d?d.length:0;if(j||(b&=~(ea|fa),d=e=Z),g=g===Z?g:nj(gh(g),0),h=h===Z?h:gh(h),j-=e?e.length:0,b&fa){var k=d,l=e;d=e=Z}var m=i?Z:Kj(a),n=[a,b,c,d,e,k,l,f,g,h];if(m&&Be(n,m),a=n[0],b=n[1],c=n[2],d=n[3],e=n[4],h=n[9]=null==n[9]?i?0:a.length:nj(n[9]-j,0),!h&&b&(ca|da)&&(b&=~(ca|da)),b&&b!=_)o=b==ca||b==da?Xd(a,b,h):b!=ea&&b!=(_|ea)||e.length?Zd.apply(Z,n):be(a,b,c,d);else var o=Td(a,b,c);var p=m?Ij:Nj;return p(o,n)}function ge(a,b,c,d,e,f){var g=-1,h=e&ka,i=e&ja,j=a.length,k=b.length;if(j!=k&&!(h&&k>j))return!1;var l=f.get(a);if(l)return l==b;var m=!0;for(f.set(a,b);++g<j;){var n=a[g],o=b[g];if(d)var p=h?d(o,n,g,b,a,f):d(n,o,g,a,b,f);if(p!==Z){if(p)continue;m=!1;break}if(i){if(!t(b,function(a){return n===a||c(n,a,d,e,f)})){m=!1;break}}else if(n!==o&&!c(n,o,d,e,f)){m=!1;break}}return f["delete"](a),m}function he(a,b,c,d,e,f){switch(c){case Ta:return a.byteLength==b.byteLength&&d(new $i(a),new $i(b))?!0:!1;case Fa:case Ga:return+a==+b;case Ha:return a.name==b.name&&a.message==b.message;case La:return a!=+a?b!=+b:a==+b;case Na:case Pa:return a==b+"";case Ka:var g=S;case Oa:var h=f&ka;return g||(g=U),(h||a.size==b.size)&&d(g(a),g(b),e,f|ja);case Qa:return!!Zi&&Bj.call(a)==Bj.call(b)}return!1}function ie(a,b,c,d,e,f){var g=e&ka,h=yh(a),i=h.length,j=yh(b),k=j.length;if(i!=k&&!g)return!1;for(var l=i;l--;){var m=h[l];if(!(g?m in b:Qc(b,m)))return!1}var n=f.get(a);if(n)return n==b;var o=!0;f.set(a,b);for(var p=g;++l<i;){m=h[l];var q=a[m],r=b[m];if(d)var s=g?d(r,q,m,b,a,f):d(q,r,m,a,b,f);if(!(s===Z?q===r||c(q,r,d,e,f):s)){o=!1;break}p||(p="constructor"==m)}if(o&&!p){var t=a.constructor,u=b.constructor;t!=u&&"constructor"in a&&"constructor"in b&&!("function"==typeof t&&t instanceof t&&"function"==typeof u&&u instanceof u)&&(o=!1)}return f["delete"](a),o}function je(a){for(var b=a.name+"",c=Dj[b],d=Ri.call(Dj,b)?c.length:0;d--;){var e=c[d],f=e.func;if(null==f||f==a)return e.name}return b}function ke(){var a=b.iteratee||oi;return a=a===oi?Zc:a,arguments.length?a(arguments[0],arguments[1]):a}function le(a){for(var b=Hh(a),c=b.length;c--;)b[c][2]=Ae(b[c][1]);return b}function me(a,b){var c=null==a?Z:a[b];return Rg(c)?c:Z}function ne(a){var c=Ri.call(b,"placeholder")?b:a;return c.placeholder}function oe(a){return Ui.call(a)}function pe(a,b,c){for(var d=-1,e=c.length;++d<e;){var f=c[d],g=f.size;switch(f.type){case"drop":a+=g;break;case"dropRight":b-=g;break;case"take":b=oj(b,a+g);break;case"takeRight":a=nj(a,b-g)}}return{start:a,end:b}}function qe(a,b,c){if(null==a)return!1;var d=c(a,b);d||we(b)||(b=vc(b),a=De(a,b),null!=a&&(b=Ye(b),d=c(a,b)));var e=a?a.length:Z;return d||!!e&&Kg(e)&&Q(b,e)&&(uk(a)||Zg(a)||wg(a))}function re(a){var b=a.length,c=a.constructor(b);return b&&"string"==typeof a[0]&&Ri.call(a,"index")&&(c.index=a.index,c.input=a.input),c}function se(a){return Ig(a.constructor)&&!ze(a)?zc(bj(a)):{}}function te(a,b,c){var d=a.constructor;switch(b){case Ta:return Dd(a);case Fa:case Ga:return new d(+a);case Ua:case Va:case Wa:case Xa:case Ya:case Za:case $a:case _a:case ab:return Id(a,c);case Ka:return Ed(a);case La:case Pa:return new d(a);case Na:return Fd(a);case Oa:return Gd(a);case Qa:return Hd(a)}}function ue(a){var b=a?a.length:Z;return Kg(b)&&(uk(a)||Zg(a)||wg(a))?B(b,String):null}function ve(a,b,c){if(!Lg(c))return!1;var d=typeof b;return("number"==d?yg(c)&&Q(b,c.length):"string"==d&&b in c)?tg(c[b],a):!1}function we(a,b){return"number"==typeof a?!0:!uk(a)&&(mb.test(a)||!lb.test(a)||null!=b&&a in Object(b))}function xe(a){var b=typeof a;return"number"==b||"boolean"==b||"string"==b&&"__proto__"!=a||null==a}function ye(a){var c=je(a),d=b[c];if("function"!=typeof d||!(c in H.prototype))return!1;if(a===d)return!0;var e=Kj(d);return!!e&&a===e[0]}function ze(a){var b=a&&a.constructor,c=Ig(b)&&b.prototype||Pi;return a===c}function Ae(a){return a===a&&!Lg(a)}function Be(a,b){var c=a[1],d=b[1],e=c|d,f=(_|aa|ga)>e,g=d==ga&&c==ca||d==ga&&c==ha&&a[7].length<=b[8]||d==(ga|ha)&&b[7].length<=b[8]&&c==ca;if(!f&&!g)return a;d&_&&(a[2]=b[2],e|=c&_?0:ba);var h=b[3];if(h){var i=a[3];a[3]=i?Jd(i,h,b[4]):Ld(h),a[4]=i?T(a[3],Ca):Ld(b[4])}return h=b[5],h&&(i=a[5],a[5]=i?Kd(i,h,b[6]):Ld(h),a[6]=i?T(a[5],Ca):Ld(b[6])),h=b[7],h&&(a[7]=Ld(h)),d&ga&&(a[8]=null==a[8]?b[8]:oj(a[8],b[8])),null==a[9]&&(a[9]=b[9]),a[0]=b[0],a[1]=e,a}function Ce(a,b,c,d,e,f){return Lg(a)&&Lg(b)&&(f.set(b,a),dd(a,b,Z,Ce,f)),a}function De(a,b){return 1==b.length?a:vh(a,qd(b,0,-1))}function Ee(a,b){for(var c=a.length,d=oj(b.length,c),e=Ld(a);d--;){var f=b[d];a[d]=Q(f,c)?e[f]:Z}return a}function Fe(a){var b=[];return lh(a).replace(nb,function(a,c,d,e){b.push(d?e.replace(tb,"$1"):c||a)}),b}function Ge(a){if(a instanceof H)return a.clone();var b=new d(a.__wrapped__,a.__chain__);return b.__actions__=Ld(a.__actions__),b.__index__=a.__index__,b.__values__=a.__values__,b}function He(a,b){b=nj(gh(b),0);var c=a?a.length:0;if(!c||1>b)return[];for(var d=0,e=-1,f=Array(ij(c/b));c>d;)f[++e]=qd(a,d,d+=b);return f}function Ie(a){for(var b=-1,c=a?a.length:0,d=-1,e=[];++b<c;){var f=a[b];f&&(e[++d]=f)}return e}function Je(a,b,c){var d=a?a.length:0;return d?(b=c||b===Z?1:gh(b),qd(a,0>b?0:b,d)):[]}function Ke(a,b,c){var d=a?a.length:0;return d?(b=c||b===Z?1:gh(b),b=d-b,qd(a,0,0>b?0:b)):[]}function Le(a,b){return a&&a.length?yd(a,ke(b,3),!0,!0):[]}function Me(a,b){return a&&a.length?yd(a,ke(b,3),!0):[]}function Ne(a,b,c,d){var e=a?a.length:0;return e?(c&&"number"!=typeof c&&ve(a,b,c)&&(c=0,d=e),Gc(a,b,c,d)):[]}function Oe(a,b){return a&&a.length?w(a,ke(b,3)):-1}function Pe(a,b){return a&&a.length?w(a,ke(b,3),!0):-1}function Qe(a){var b=a?a.length:0;return b?Ic(a,1):[]}function Re(a){var b=a?a.length:0;return b?Ic(a,va):[]}function Se(a,b){var c=a?a.length:0;return c?(b=b===Z?1:gh(b),Ic(a,b)):[]}function Te(a){for(var b=-1,c=a?a.length:0,d={};++b<c;){var e=a[b];d[e[0]]=e[1]}return d}function Ue(a){return a?a[0]:Z}function Ve(a,b,c){var d=a?a.length:0;return d?(c=gh(c),0>c&&(c=nj(d+c,0)),x(a,b,c)):-1}function We(a){return Ke(a,1)}function Xe(a,b){return a?lj.call(a,b):""}function Ye(a){var b=a?a.length:0;return b?a[b-1]:Z}function Ze(a,b,c){var d=a?a.length:0;if(!d)return-1;var e=d;if(c!==Z&&(e=gh(c),e=(0>e?nj(d+e,0):oj(e,d-1))+1),b!==b)return O(a,e,!0);for(;e--;)if(a[e]===b)return e;return-1}function $e(a,b){return a&&a.length&&b&&b.length?kd(a,b):a}function _e(a,b,c){return a&&a.length&&b&&b.length?ld(a,b,ke(c)):a}function af(a,b){var c=[];if(!a||!a.length)return c;var d=-1,e=[],f=a.length;for(b=ke(b,3);++d<f;){var g=a[d];b(g,d,a)&&(c.push(g),e.push(d))}return md(a,e),c}function bf(a){return a?rj.call(a):a}function cf(a,b,c){var d=a?a.length:0;return d?(c&&"number"!=typeof c&&ve(a,b,c)?(b=0,c=d):(b=null==b?0:gh(b),c=c===Z?d:gh(c)),qd(a,b,c)):[]}function df(a,b){return sd(a,b)}function ef(a,b,c){return td(a,b,ke(c))}function ff(a,b){var c=a?a.length:0;if(c){var d=sd(a,b);if(c>d&&tg(a[d],b))return d}return-1}function gf(a,b){return sd(a,b,!0)}function hf(a,b,c){return td(a,b,ke(c),!0)}function jf(a,b){var c=a?a.length:0;if(c){var d=sd(a,b,!0)-1;if(tg(a[d],b))return d}return-1}function kf(a){return a&&a.length?ud(a):[]}function lf(a,b){return a&&a.length?vd(a,ke(b)):[]}function mf(a){return Je(a,1)}function nf(a,b,c){return a&&a.length?(b=c||b===Z?1:gh(b),qd(a,0,0>b?0:b)):[]}function of(a,b,c){var d=a?a.length:0;return d?(b=c||b===Z?1:gh(b),b=d-b,qd(a,0>b?0:b,d)):[]}function pf(a,b){return a&&a.length?yd(a,ke(b,3),!1,!0):[]}function qf(a,b){return a&&a.length?yd(a,ke(b,3)):[]}function rf(a){return a&&a.length?wd(a):[]}function sf(a,b){return a&&a.length?wd(a,ke(b)):[]}function tf(a,b){return a&&a.length?wd(a,Z,b):[]}function uf(a){if(!a||!a.length)return[];var b=0;return a=m(a,function(a){return zg(a)?(b=nj(a.length,b),!0):void 0}),B(b,function(b){return p(a,id(b))})}function vf(a,b){if(!a||!a.length)return[];var c=uf(a);return null==b?c:p(c,function(a){return g(b,Z,a)})}function wf(a,b){return Bd(a||[],b||[],gc)}function xf(a,b){return Bd(a||[],b||[],pd)}function yf(a){var c=b(a);return c.__chain__=!0,c}function zf(a,b){return b(a),a}function Af(a,b){return b(a)}function Bf(){return yf(this)}function Cf(){return new d(this.value(),this.__chain__);
}function Df(a){return this.map(a).flatten()}function Ef(){this.__values__===Z&&(this.__values__=fh(this.value()));var a=this.__index__>=this.__values__.length,b=a?Z:this.__values__[this.__index__++];return{done:a,value:b}}function Ff(){return this}function Gf(a){for(var b,d=this;d instanceof c;){var e=Ge(d);e.__index__=0,e.__values__=Z,b?f.__wrapped__=e:b=e;var f=e;d=d.__wrapped__}return f.__wrapped__=a,b}function Hf(){var a=this.__wrapped__;if(a instanceof H){var b=a;return this.__actions__.length&&(b=new H(this)),b=b.reverse(),b.__actions__.push({func:Af,args:[bf],thisArg:Z}),new d(b,this.__chain__)}return this.thru(bf)}function If(){return zd(this.__wrapped__,this.__actions__)}function Jf(a,b,c){var d=uk(a)?l:Fc;return c&&ve(a,b,c)&&(b=Z),d(a,ke(b,3))}function Kf(a,b){var c=uk(a)?m:Hc;return c(a,ke(b,3))}function Lf(a,b){if(b=ke(b,3),uk(a)){var c=w(a,b);return c>-1?a[c]:Z}return v(a,b,Ej)}function Mf(a,b){if(b=ke(b,3),uk(a)){var c=w(a,b,!0);return c>-1?a[c]:Z}return v(a,b,Fj)}function Nf(a,b){return Ic(Rf(a,b),1)}function Of(a,b){return"function"==typeof b&&uk(a)?j(a,b):Ej(a,mc(b))}function Pf(a,b){return"function"==typeof b&&uk(a)?k(a,b):Fj(a,mc(b))}function Qf(a,b,c,d){a=yg(a)?a:Lh(a),c=c&&!d?gh(c):0;var e=a.length;return 0>c&&(c=nj(e+c,0)),Zg(a)?e>=c&&a.indexOf(b,c)>-1:!!e&&x(a,b,c)>-1}function Rf(a,b){var c=uk(a)?p:ad;return c(a,ke(b,3))}function Sf(a,b,c,d){return null==a?[]:(uk(b)||(b=null==b?[]:[b]),c=d?Z:c,uk(c)||(c=null==c?[]:[c]),fd(a,b,c))}function Tf(a,b,c){var d=uk(a)?r:y,e=arguments.length<3;return d(a,ke(b,4),c,e,Ej)}function Uf(a,b,c){var d=uk(a)?s:y,e=arguments.length<3;return d(a,ke(b,4),c,e,Fj)}function Vf(a,b){var c=uk(a)?m:Hc;return b=ke(b,3),c(a,function(a,c,d){return!b(a,c,d)})}function Wf(a){var b=yg(a)?a:Lh(a),c=b.length;return c>0?b[nd(0,c-1)]:Z}function Xf(a,b){var c=-1,d=fh(a),e=d.length,f=e-1;for(b=wc(gh(b),0,e);++c<b;){var g=nd(c,f),h=d[g];d[g]=d[c],d[c]=h}return d.length=b,d}function Yf(a){return Xf(a,za)}function Zf(a){if(null==a)return 0;if(yg(a)){var b=a.length;return b&&Zg(a)?V(a):b}return yh(a).length}function $f(a,b,c){var d=uk(a)?t:rd;return c&&ve(a,b,c)&&(b=Z),d(a,ke(b,3))}function _f(a,b){if("function"!=typeof b)throw new Ni(ta);return a=gh(a),function(){return--a<1?b.apply(this,arguments):void 0}}function ag(a,b,c){return b=c?Z:b,b=a&&null==b?a.length:b,fe(a,ga,Z,Z,Z,Z,b)}function bg(a,b){var c;if("function"!=typeof b)throw new Ni(ta);return a=gh(a),function(){return--a>0&&(c=b.apply(this,arguments)),1>=a&&(b=Z),c}}function cg(a,b,c){b=c?Z:b;var d=fe(a,ca,Z,Z,Z,Z,Z,b);return d.placeholder=cg.placeholder,d}function dg(a,b,c){b=c?Z:b;var d=fe(a,da,Z,Z,Z,Z,Z,b);return d.placeholder=dg.placeholder,d}function eg(a,b,c){function d(){o&&_i(o),k&&_i(k),q=0,j=k=n=o=p=Z}function e(b,c){c&&_i(c),k=o=p=Z,b&&(q=lk(),l=a.apply(n,j),o||k||(j=n=Z))}function f(){var a=b-(lk()-m);0>=a||a>b?e(p,k):o=gj(f,a)}function g(){return(o&&p||k&&t)&&(l=a.apply(n,j)),d(),l}function h(){e(t,o)}function i(){if(j=arguments,m=lk(),n=this,p=t&&(o||!r),s===!1)var c=r&&!o;else{q||k||r||(q=m);var d=s-(m-q),e=(0>=d||d>s)&&(r||k);e?(k&&(k=_i(k)),q=m,l=a.apply(n,j)):k||(k=gj(h,d))}return e&&o?o=_i(o):o||b===s||(o=gj(f,b)),c&&(e=!0,l=a.apply(n,j)),!e||o||k||(j=n=Z),l}var j,k,l,m,n,o,p,q=0,r=!1,s=!1,t=!0;if("function"!=typeof a)throw new Ni(ta);return b=ih(b)||0,Lg(c)&&(r=!!c.leading,s="maxWait"in c&&nj(ih(c.maxWait)||0,b),t="trailing"in c?!!c.trailing:t),i.cancel=d,i.flush=g,i}function fg(a){return fe(a,ia)}function gg(a,b){if("function"!=typeof a||b&&"function"!=typeof b)throw new Ni(ta);var c=function(){var d=arguments,e=b?b.apply(this,d):d[0],f=c.cache;if(f.has(e))return f.get(e);var g=a.apply(this,d);return c.cache=f.set(e,g),g};return c.cache=new gg.Cache,c}function hg(a){if("function"!=typeof a)throw new Ni(ta);return function(){return!a.apply(this,arguments)}}function ig(a){return bg(2,a)}function jg(a,b){if("function"!=typeof a)throw new Ni(ta);return b=nj(b===Z?a.length-1:gh(b),0),function(){for(var c=arguments,d=-1,e=nj(c.length-b,0),f=Array(e);++d<e;)f[d]=c[b+d];switch(b){case 0:return a.call(this,f);case 1:return a.call(this,c[0],f);case 2:return a.call(this,c[0],c[1],f)}var h=Array(b+1);for(d=-1;++d<b;)h[d]=c[d];return h[b]=f,g(a,this,h)}}function kg(a,b){if("function"!=typeof a)throw new Ni(ta);return b=b===Z?0:nj(gh(b),0),jg(function(c){var d=c[b],e=c.slice(0,b);return d&&q(e,d),g(a,this,e)})}function lg(a,b,c){var d=!0,e=!0;if("function"!=typeof a)throw new Ni(ta);return Lg(c)&&(d="leading"in c?!!c.leading:d,e="trailing"in c?!!c.trailing:e),eg(a,b,{leading:d,maxWait:b,trailing:e})}function mg(a){return ag(a,1)}function ng(a,b){return b=null==b?ni:b,rk(b,a)}function og(){if(!arguments.length)return[];var a=arguments[0];return uk(a)?a:[a]}function pg(a){return xc(a)}function qg(a,b){return xc(a,!1,b)}function rg(a){return xc(a,!0)}function sg(a,b){return xc(a,!0,b)}function tg(a,b){return a===b||a!==a&&b!==b}function ug(a,b){return a>b}function vg(a,b){return a>=b}function wg(a){return zg(a)&&Ri.call(a,"callee")&&(!fj.call(a,"callee")||Ui.call(a)==Da)}function xg(a){return Mg(a)&&Ui.call(a)==Ta}function yg(a){return null!=a&&!("function"==typeof a&&Ig(a))&&Kg(Lj(a))}function zg(a){return Mg(a)&&yg(a)}function Ag(a){return a===!0||a===!1||Mg(a)&&Ui.call(a)==Fa}function Bg(a){return Mg(a)&&Ui.call(a)==Ga}function Cg(a){return!!a&&1===a.nodeType&&Mg(a)&&!Vg(a)}function Dg(a){if(yg(a)&&(uk(a)||Zg(a)||Ig(a.splice)||wg(a)))return!a.length;for(var b in a)if(Ri.call(a,b))return!1;return!0}function Eg(a,b){return Wc(a,b)}function Fg(a,b,c){c="function"==typeof c?c:Z;var d=c?c(a,b):Z;return d===Z?Wc(a,b,c):!!d}function Gg(a){return Mg(a)?Ui.call(a)==Ha||"string"==typeof a.message&&"string"==typeof a.name:!1}function Hg(a){return"number"==typeof a&&kj(a)}function Ig(a){var b=Lg(a)?Ui.call(a):"";return b==Ia||b==Ja}function Jg(a){return"number"==typeof a&&a==gh(a)}function Kg(a){return"number"==typeof a&&a>-1&&a%1==0&&wa>=a}function Lg(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function Mg(a){return!!a&&"object"==typeof a}function Ng(a){return Mg(a)&&oe(a)==Ka}function Og(a,b){return a===b||Yc(a,b,le(b))}function Pg(a,b,c){return c="function"==typeof c?c:Z,Yc(a,b,le(b),c)}function Qg(a){return Ug(a)&&a!=+a}function Rg(a){return null==a?!1:Ig(a)?Wi.test(Qi.call(a)):Mg(a)&&(P(a)?Wi:zb).test(a)}function Sg(a){return null===a}function Tg(a){return null==a}function Ug(a){return"number"==typeof a||Mg(a)&&Ui.call(a)==La}function Vg(a){if(!Mg(a)||Ui.call(a)!=Ma||P(a))return!1;var b=bj(a);if(null===b)return!0;var c=b.constructor;return"function"==typeof c&&c instanceof c&&Qi.call(c)==Ti}function Wg(a){return Lg(a)&&Ui.call(a)==Na}function Xg(a){return Jg(a)&&a>=-wa&&wa>=a}function Yg(a){return Mg(a)&&oe(a)==Oa}function Zg(a){return"string"==typeof a||!uk(a)&&Mg(a)&&Ui.call(a)==Pa}function $g(a){return"symbol"==typeof a||Mg(a)&&Ui.call(a)==Qa}function _g(a){return Mg(a)&&Kg(a.length)&&!!tc[Ui.call(a)]}function ah(a){return a===Z}function bh(a){return Mg(a)&&oe(a)==Ra}function ch(a){return Mg(a)&&Ui.call(a)==Sa}function dh(a,b){return b>a}function eh(a,b){return b>=a}function fh(a){if(!a)return[];if(yg(a))return Zg(a)?W(a):Ld(a);if(dj&&a[dj])return R(a[dj]());var b=oe(a),c=b==Ka?S:b==Oa?U:Lh;return c(a)}function gh(a){if(!a)return 0===a?a:0;if(a=ih(a),a===va||a===-va){var b=0>a?-1:1;return b*xa}var c=a%1;return a===a?c?a-c:a:0}function hh(a){return a?wc(gh(a),0,za):0}function ih(a){if(Lg(a)){var b=Ig(a.valueOf)?a.valueOf():a;a=Lg(b)?b+"":b}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(qb,"");var c=yb.test(a);return c||Ab.test(a)?Bc(a.slice(2),c?2:8):xb.test(a)?ya:+a}function jh(a){return Md(a,zh(a))}function kh(a){return wc(gh(a),-wa,wa)}function lh(a){if("string"==typeof a)return a;if(null==a)return"";if($g(a))return Zi?Cj.call(a):"";var b=a+"";return"0"==b&&1/a==-va?"-0":b}function mh(a,b){var c=zc(a);return b?ic(c,b):c}function nh(a,b){return v(a,ke(b,3),Mc,!0)}function oh(a,b){return v(a,ke(b,3),Nc,!0)}function ph(a,b){return null==a?a:Gj(a,mc(b),zh)}function qh(a,b){return null==a?a:Hj(a,mc(b),zh)}function rh(a,b){return a&&Mc(a,mc(b))}function sh(a,b){return a&&Nc(a,mc(b))}function th(a){return null==a?[]:Oc(a,yh(a))}function uh(a){return null==a?[]:Oc(a,zh(a))}function vh(a,b,c){var d=null==a?Z:Pc(a,b);return d===Z?c:d}function wh(a,b){return qe(a,b,Qc)}function xh(a,b){return qe(a,b,Rc)}function yh(a){var b=ze(a);if(!b&&!yg(a))return $c(a);var c=ue(a),d=!!c,e=c||[],f=e.length;for(var g in a)!Qc(a,g)||d&&("length"==g||Q(g,f))||b&&"constructor"==g||e.push(g);return e}function zh(a){for(var b=-1,c=ze(a),d=_c(a),e=d.length,f=ue(a),g=!!f,h=f||[],i=h.length;++b<e;){var j=d[b];g&&("length"==j||Q(j,i))||"constructor"==j&&(c||!Ri.call(a,j))||h.push(j)}return h}function Ah(a,b){var c={};return b=ke(b,3),Mc(a,function(a,d,e){c[b(a,d,e)]=a}),c}function Bh(a,b){var c={};return b=ke(b,3),Mc(a,function(a,d,e){c[d]=b(a,d,e)}),c}function Ch(a,b){return b=ke(b),hd(a,function(a,c){return!b(a,c)})}function Dh(a,b){return null==a?{}:hd(a,ke(b))}function Eh(a,b,c){if(we(b,a))d=null==a?Z:a[b];else{b=vc(b);var d=vh(a,b);a=De(a,b)}return d===Z&&(d=c),Ig(d)?d.call(a):d}function Fh(a,b,c){return null==a?a:pd(a,b,c)}function Gh(a,b,c,d){return d="function"==typeof d?d:Z,null==a?a:pd(a,b,c,d)}function Hh(a){return C(a,yh(a))}function Ih(a){return C(a,zh(a))}function Jh(a,b,c){var d=uk(a)||_g(a);if(b=ke(b,4),null==c)if(d||Lg(a)){var e=a.constructor;c=d?uk(a)?new e:[]:Ig(e)?zc(bj(a)):{}}else c={};return(d?j:Mc)(a,function(a,d,e){return b(c,a,d,e)}),c}function Kh(a,b){return null==a?!0:xd(a,b)}function Lh(a){return a?E(a,yh(a)):[]}function Mh(a){return null==a?[]:E(a,zh(a))}function Nh(a,b,c){return c===Z&&(c=b,b=Z),c!==Z&&(c=ih(c),c=c===c?c:0),b!==Z&&(b=ih(b),b=b===b?b:0),wc(ih(a),b,c)}function Oh(a,b,c){return b=ih(b)||0,c===Z?(c=b,b=0):c=ih(c)||0,a=ih(a),Sc(a,b,c)}function Ph(a,b,c){if(c&&"boolean"!=typeof c&&ve(a,b,c)&&(b=c=Z),c===Z&&("boolean"==typeof b?(c=b,b=Z):"boolean"==typeof a&&(c=a,a=Z)),a===Z&&b===Z?(a=0,b=1):(a=ih(a)||0,b===Z?(b=a,a=0):b=ih(b)||0),a>b){var d=a;a=b,b=d}if(c||a%1||b%1){var e=qj();return oj(a+e*(b-a+Ac("1e-"+((e+"").length-1))),b)}return nd(a,b)}function Qh(a){return Ok(lh(a).toLowerCase())}function Rh(a){return a=lh(a),a&&a.replace(Cb,L).replace(lc,"")}function Sh(a,b,c){a=lh(a),b="string"==typeof b?b:b+"";var d=a.length;return c=c===Z?d:wc(gh(c),0,d),c-=b.length,c>=0&&a.indexOf(b,c)==c}function Th(a){return a=lh(a),a&&hb.test(a)?a.replace(fb,M):a}function Uh(a){return a=lh(a),a&&pb.test(a)?a.replace(ob,"\\$&"):a}function Vh(a,b,c){a=lh(a),b=gh(b);var d=V(a);if(!b||d>=b)return a;var e=(b-d)/2,f=jj(e),g=ij(e);return ae("",f,c)+a+ae("",g,c)}function Wh(a,b,c){return a=lh(a),a+ae(a,b,c)}function Xh(a,b,c){return a=lh(a),ae(a,b,c)+a}function Yh(a,b,c){return c||null==b?b=0:b&&(b=+b),a=lh(a).replace(qb,""),pj(a,b||(wb.test(a)?16:10))}function Zh(a,b){a=lh(a),b=gh(b);var c="";if(!a||1>b||b>wa)return c;do b%2&&(c+=a),b=jj(b/2),a+=a;while(b);return c}function $h(){var a=arguments,b=lh(a[0]);return a.length<3?b:b.replace(a[1],a[2])}function _h(a,b,c){return lh(a).split(b,c)}function ai(a,b,c){return a=lh(a),c=wc(gh(c),0,a.length),a.lastIndexOf(b,c)==c}function bi(a,c,d){var e=b.templateSettings;d&&ve(a,c,d)&&(c=Z),a=lh(a),c=yk({},c,e,ec);var f,g,h=yk({},c.imports,e.imports,ec),i=yh(h),j=E(h,i),k=0,l=c.interpolate||Db,m="__p += '",n=Mi((c.escape||Db).source+"|"+l.source+"|"+(l===kb?ub:Db).source+"|"+(c.evaluate||Db).source+"|$","g"),o="//# sourceURL="+("sourceURL"in c?c.sourceURL:"lodash.templateSources["+ ++sc+"]")+"\n";a.replace(n,function(b,c,d,e,h,i){return d||(d=e),m+=a.slice(k,i).replace(Eb,N),c&&(f=!0,m+="' +\n__e("+c+") +\n'"),h&&(g=!0,m+="';\n"+h+";\n__p += '"),d&&(m+="' +\n((__t = ("+d+")) == null ? '' : __t) +\n'"),k=i+b.length,b}),m+="';\n";var p=c.variable;p||(m="with (obj) {\n"+m+"\n}\n"),m=(g?m.replace(bb,""):m).replace(cb,"$1").replace(db,"$1;"),m="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(f?", __e = _.escape":"")+(g?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var q=Sk(function(){return Function(i,o+"return "+m).apply(Z,j)});if(q.source=m,Gg(q))throw q;return q}function ci(a){return lh(a).toLowerCase()}function di(a){return lh(a).toUpperCase()}function ei(a,b,c){if(a=lh(a),!a)return a;if(c||b===Z)return a.replace(qb,"");if(b+="",!b)return a;var d=W(a),e=W(b);return d.slice(F(d,e),G(d,e)+1).join("")}function fi(a,b,c){if(a=lh(a),!a)return a;if(c||b===Z)return a.replace(sb,"");if(b+="",!b)return a;var d=W(a);return d.slice(0,G(d,W(b))+1).join("")}function gi(a,b,c){if(a=lh(a),!a)return a;if(c||b===Z)return a.replace(rb,"");if(b+="",!b)return a;var d=W(a);return d.slice(F(d,W(b))).join("")}function hi(a,b){var c=la,d=ma;if(Lg(b)){var e="separator"in b?b.separator:e;c="length"in b?gh(b.length):c,d="omission"in b?lh(b.omission):d}a=lh(a);var f=a.length;if(nc.test(a)){var g=W(a);f=g.length}if(c>=f)return a;var h=c-V(d);if(1>h)return d;var i=g?g.slice(0,h).join(""):a.slice(0,h);if(e===Z)return i+d;if(g&&(h+=i.length-h),Wg(e)){if(a.slice(h).search(e)){var j,k=i;for(e.global||(e=Mi(e.source,lh(vb.exec(e))+"g")),e.lastIndex=0;j=e.exec(k);)var l=j.index;i=i.slice(0,l===Z?h:l)}}else if(a.indexOf(e,h)!=h){var m=i.lastIndexOf(e);m>-1&&(i=i.slice(0,m))}return i+d}function ii(a){return a=lh(a),a&&gb.test(a)?a.replace(eb,X):a}function ji(a,b,c){return a=lh(a),b=c?Z:b,b===Z&&(b=qc.test(a)?pc:oc),a.match(b)||[]}function ki(a){var b=a?a.length:0,c=ke();return a=b?p(a,function(a){if("function"!=typeof a[1])throw new Ni(ta);return[c(a[0]),a[1]]}):[],jg(function(c){for(var d=-1;++d<b;){var e=a[d];if(g(e[0],this,c))return g(e[1],this,c)}})}function li(a){return yc(xc(a,!0))}function mi(a){return function(){return a}}function ni(a){return a}function oi(a){return Zc("function"==typeof a?a:xc(a,!0))}function pi(a){return bd(xc(a,!0))}function qi(a,b){return cd(a,xc(b,!0))}function ri(a,b,c){var d=yh(b),e=Oc(b,d);null!=c||Lg(b)&&(e.length||!d.length)||(c=b,b=a,a=this,e=Oc(b,yh(b)));var f=Lg(c)&&"chain"in c?c.chain:!0,g=Ig(a);return j(e,function(c){var d=b[c];a[c]=d,g&&(a.prototype[c]=function(){var b=this.__chain__;if(f||b){var c=a(this.__wrapped__),e=c.__actions__=Ld(this.__actions__);return e.push({func:d,args:arguments,thisArg:a}),c.__chain__=b,c}return d.apply(a,q([this.value()],arguments))})}),a}function si(){return Jc._===this&&(Jc._=Vi),this}function ti(){}function ui(a){return a=gh(a),function(){return arguments[a]}}function vi(a){return we(a)?id(a):jd(a)}function wi(a){return function(b){return null==a?Z:Pc(a,b)}}function xi(a,b){if(a=gh(a),1>a||a>wa)return[];var c=za,d=oj(a,za);b=mc(b),a-=za;for(var e=B(d,b);++c<a;)b(c);return e}function yi(a){return uk(a)?p(a,String):Fe(a)}function zi(a){var b=++Si;return lh(a)+b}function Ai(a,b){var c;return a===Z&&b===Z?0:(a!==Z&&(c=a),b!==Z&&(c=c===Z?b:c+b),c)}function Bi(a){return a&&a.length?u(a,ni,ug):Z}function Ci(a,b){return a&&a.length?u(a,ke(b),ug):Z}function Di(a){return Hi(a)/(a?a.length:0)}function Ei(a){return a&&a.length?u(a,ni,dh):Z}function Fi(a,b){return a&&a.length?u(a,ke(b),dh):Z}function Gi(a,b){var c;return a===Z&&b===Z?0:(a!==Z&&(c=a),b!==Z&&(c=c===Z?b:c-b),c)}function Hi(a){return a&&a.length?A(a,ni):0}function Ii(a,b){return a&&a.length?A(a,ke(b)):0}a=a?Kc.defaults({},a,Kc.pick(Jc,rc)):Jc;var Ji=a.Date,Ki=a.Error,Li=a.Math,Mi=a.RegExp,Ni=a.TypeError,Oi=a.Array.prototype,Pi=a.Object.prototype,Qi=a.Function.prototype.toString,Ri=Pi.hasOwnProperty,Si=0,Ti=Qi.call(Object),Ui=Pi.toString,Vi=Jc._,Wi=Mi("^"+Qi.call(Ri).replace(ob,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Xi=Ec?a.Buffer:Z,Yi=a.Reflect,Zi=a.Symbol,$i=a.Uint8Array,_i=a.clearTimeout,aj=Yi?Yi.enumerate:Z,bj=Object.getPrototypeOf,cj=Object.getOwnPropertySymbols,dj="symbol"==typeof(dj=Zi&&Zi.iterator)?dj:Z,ej=Object.create,fj=Pi.propertyIsEnumerable,gj=a.setTimeout,hj=Oi.splice,ij=Li.ceil,jj=Li.floor,kj=a.isFinite,lj=Oi.join,mj=Object.keys,nj=Li.max,oj=Li.min,pj=a.parseInt,qj=Li.random,rj=Oi.reverse,sj=me(a,"Map"),tj=me(a,"Set"),uj=me(a,"WeakMap"),vj=me(Object,"create"),wj=uj&&new uj,xj=sj?Qi.call(sj):"",yj=tj?Qi.call(tj):"",zj=uj?Qi.call(uj):"",Aj=Zi?Zi.prototype:Z,Bj=Zi?Aj.valueOf:Z,Cj=Zi?Aj.toString:Z,Dj={};b.templateSettings={escape:ib,evaluate:jb,interpolate:kb,variable:"",imports:{_:b}};var Ej=Rd(Mc),Fj=Rd(Nc,!0),Gj=Sd(),Hj=Sd(!0);aj&&!fj.call({valueOf:1},"valueOf")&&(_c=function(a){return R(aj(a))});var Ij=wj?function(a,b){return wj.set(a,b),a}:ni,Jj=tj&&2===new tj([1,2]).size?function(a){return new tj(a)}:ti,Kj=wj?function(a){return wj.get(a)}:ti,Lj=id("length"),Mj=cj||function(){return[]};(sj&&oe(new sj)!=Ka||tj&&oe(new tj)!=Oa||uj&&oe(new uj)!=Ra)&&(oe=function(a){var b=Ui.call(a),c=b==Ma?a.constructor:null,d="function"==typeof c?Qi.call(c):"";if(d)switch(d){case xj:return Ka;case yj:return Oa;case zj:return Ra}return b});var Nj=function(){var a=0,b=0;return function(c,d){var e=lk(),f=oa-(e-b);if(b=e,f>0){if(++a>=na)return c}else a=0;return Ij(c,d)}}(),Oj=jg(function(a,b){return uk(a)||(a=null==a?[]:[Object(a)]),b=Ic(b,1),i(a,b)}),Pj=jg(function(a,b){return zg(a)?Dc(a,Ic(b,1,!0)):[]}),Qj=jg(function(a,b){var c=Ye(b);return zg(c)&&(c=Z),zg(a)?Dc(a,Ic(b,1,!0),ke(c)):[]}),Rj=jg(function(a,b){var c=Ye(b);return zg(c)&&(c=Z),zg(a)?Dc(a,Ic(b,1,!0),Z,c):[]}),Sj=jg(function(a){var b=p(a,kc);return b.length&&b[0]===a[0]?Tc(b):[]}),Tj=jg(function(a){var b=Ye(a),c=p(a,kc);return b===Ye(c)?b=Z:c.pop(),c.length&&c[0]===a[0]?Tc(c,ke(b)):[]}),Uj=jg(function(a){var b=Ye(a),c=p(a,kc);return b===Ye(c)?b=Z:c.pop(),c.length&&c[0]===a[0]?Tc(c,Z,b):[]}),Vj=jg($e),Wj=jg(function(a,b){b=p(Ic(b,1),String);var c=jc(a,b);return md(a,b.sort(I)),c}),Xj=jg(function(a){return wd(Ic(a,1,!0))}),Yj=jg(function(a){var b=Ye(a);return zg(b)&&(b=Z),wd(Ic(a,1,!0),ke(b))}),Zj=jg(function(a){var b=Ye(a);return zg(b)&&(b=Z),wd(Ic(a,1,!0),Z,b)}),$j=jg(function(a,b){return zg(a)?Dc(a,b):[]}),_j=jg(function(a){return Ad(m(a,zg))}),ak=jg(function(a){var b=Ye(a);return zg(b)&&(b=Z),Ad(m(a,zg),ke(b))}),bk=jg(function(a){var b=Ye(a);return zg(b)&&(b=Z),Ad(m(a,zg),Z,b)}),ck=jg(uf),dk=jg(function(a){var b=a.length,c=b>1?a[b-1]:Z;return c="function"==typeof c?(a.pop(),c):Z,vf(a,c)}),ek=jg(function(a){a=Ic(a,1);var b=a.length,c=b?a[0]:0,e=this.__wrapped__,f=function(b){return jc(b,a)};return!(b>1||this.__actions__.length)&&e instanceof H&&Q(c)?(e=e.slice(c,+c+(b?1:0)),e.__actions__.push({func:Af,args:[f],thisArg:Z}),new d(e,this.__chain__).thru(function(a){return b&&!a.length&&a.push(Z),a})):this.thru(f)}),fk=Pd(function(a,b,c){Ri.call(a,c)?++a[c]:a[c]=1}),gk=Pd(function(a,b,c){Ri.call(a,c)?a[c].push(b):a[c]=[b]}),hk=jg(function(a,b,c){var d=-1,e="function"==typeof b,f=we(b),h=yg(a)?Array(a.length):[];return Ej(a,function(a){var i=e?b:f&&null!=a?a[b]:Z;h[++d]=i?g(i,a,c):Vc(a,b,c)}),h}),ik=Pd(function(a,b,c){a[c]=b}),jk=Pd(function(a,b,c){a[c?0:1].push(b)},function(){return[[],[]]}),kk=jg(function(a,b){if(null==a)return[];var c=b.length;return c>1&&ve(a,b[0],b[1])?b=[]:c>2&&ve(b[0],b[1],b[2])&&(b.length=1),fd(a,Ic(b,1),[])}),lk=Ji.now,mk=jg(function(a,b,c){var d=_;if(c.length){var e=T(c,ne(mk));d|=ea}return fe(a,d,b,c,e)}),nk=jg(function(a,b,c){var d=_|aa;if(c.length){var e=T(c,ne(nk));d|=ea}return fe(b,d,a,c,e)}),ok=jg(function(a,b){return Cc(a,1,b)}),pk=jg(function(a,b,c){return Cc(a,ih(b)||0,c)}),qk=jg(function(a,b){b=p(Ic(b,1),ke());var c=b.length;return jg(function(d){for(var e=-1,f=oj(d.length,c);++e<f;)d[e]=b[e].call(this,d[e]);return g(a,this,d)})}),rk=jg(function(a,b){var c=T(b,ne(rk));return fe(a,ea,Z,b,c)}),sk=jg(function(a,b){var c=T(b,ne(sk));return fe(a,fa,Z,b,c)}),tk=jg(function(a,b){return fe(a,ha,Z,Z,Z,Ic(b,1))}),uk=Array.isArray,vk=Xi?function(a){return a instanceof Xi}:mi(!1),wk=Qd(function(a,b){Md(b,yh(b),a)}),xk=Qd(function(a,b){Md(b,zh(b),a)}),yk=Qd(function(a,b,c,d){Nd(b,zh(b),a,d)}),zk=Qd(function(a,b,c,d){Nd(b,yh(b),a,d)}),Ak=jg(function(a,b){return jc(a,Ic(b,1))}),Bk=jg(function(a){return a.push(Z,ec),g(yk,Z,a)}),Ck=jg(function(a){return a.push(Z,Ce),g(Hk,Z,a)}),Dk=$d(function(a,b,c){a[b]=c},mi(ni)),Ek=$d(function(a,b,c){Ri.call(a,b)?a[b].push(c):a[b]=[c]},ke),Fk=jg(Vc),Gk=Qd(function(a,b,c){dd(a,b,c)}),Hk=Qd(function(a,b,c,d){dd(a,b,c,d)}),Ik=jg(function(a,b){return null==a?{}:(b=p(Ic(b,1),String),gd(a,Dc(zh(a),b)))}),Jk=jg(function(a,b){return null==a?{}:gd(a,Ic(b,1))}),Kk=Vd(function(a,b,c){return b=b.toLowerCase(),a+(c?Qh(b):b)}),Lk=Vd(function(a,b,c){return a+(c?"-":"")+b.toLowerCase()}),Mk=Vd(function(a,b,c){return a+(c?" ":"")+b.toLowerCase()}),Nk=Ud("toLowerCase"),Ok=Ud("toUpperCase"),Pk=Vd(function(a,b,c){return a+(c?"_":"")+b.toLowerCase()}),Qk=Vd(function(a,b,c){return a+(c?" ":"")+Qh(b)}),Rk=Vd(function(a,b,c){return a+(c?" ":"")+b.toUpperCase()}),Sk=jg(function(a,b){try{return g(a,Z,b)}catch(c){return Gg(c)?c:new Ki(c)}}),Tk=jg(function(a,b){return j(Ic(b,1),function(b){a[b]=mk(a[b],a)}),a}),Uk=Yd(),Vk=Yd(!0),Wk=jg(function(a,b){return function(c){return Vc(c,a,b)}}),Xk=jg(function(a,b){return function(c){return Vc(a,c,b)}}),Yk=_d(p),Zk=_d(l),$k=_d(t),_k=ce(),al=ce(!0),bl=ee("ceil"),cl=ee("floor"),dl=ee("round");return b.prototype=c.prototype,d.prototype=zc(c.prototype),d.prototype.constructor=d,H.prototype=zc(c.prototype),H.prototype.constructor=H,Hb.prototype=vj?vj(null):Pi,Mb.prototype.clear=Nb,Mb.prototype["delete"]=Ob,Mb.prototype.get=Pb,Mb.prototype.has=Qb,Mb.prototype.set=Rb,Sb.prototype.push=Ub,Vb.prototype.clear=Wb,Vb.prototype["delete"]=Xb,Vb.prototype.get=Yb,Vb.prototype.has=Zb,Vb.prototype.set=$b,gg.Cache=Mb,b.after=_f,b.ary=ag,b.assign=wk,b.assignIn=xk,b.assignInWith=yk,b.assignWith=zk,b.at=Ak,b.before=bg,b.bind=mk,b.bindAll=Tk,b.bindKey=nk,b.castArray=og,b.chain=yf,b.chunk=He,b.compact=Ie,b.concat=Oj,b.cond=ki,b.conforms=li,b.constant=mi,b.countBy=fk,b.create=mh,b.curry=cg,b.curryRight=dg,b.debounce=eg,b.defaults=Bk,b.defaultsDeep=Ck,b.defer=ok,b.delay=pk,b.difference=Pj,b.differenceBy=Qj,b.differenceWith=Rj,b.drop=Je,b.dropRight=Ke,b.dropRightWhile=Le,b.dropWhile=Me,b.fill=Ne,b.filter=Kf,b.flatMap=Nf,b.flatten=Qe,b.flattenDeep=Re,b.flattenDepth=Se,b.flip=fg,b.flow=Uk,b.flowRight=Vk,b.fromPairs=Te,b.functions=th,b.functionsIn=uh,b.groupBy=gk,b.initial=We,b.intersection=Sj,b.intersectionBy=Tj,b.intersectionWith=Uj,b.invert=Dk,b.invertBy=Ek,b.invokeMap=hk,b.iteratee=oi,b.keyBy=ik,b.keys=yh,b.keysIn=zh,b.map=Rf,b.mapKeys=Ah,b.mapValues=Bh,b.matches=pi,b.matchesProperty=qi,b.memoize=gg,b.merge=Gk,b.mergeWith=Hk,b.method=Wk,b.methodOf=Xk,b.mixin=ri,b.negate=hg,b.nthArg=ui,b.omit=Ik,b.omitBy=Ch,b.once=ig,b.orderBy=Sf,b.over=Yk,b.overArgs=qk,b.overEvery=Zk,b.overSome=$k,b.partial=rk,b.partialRight=sk,b.partition=jk,b.pick=Jk,b.pickBy=Dh,b.property=vi,b.propertyOf=wi,b.pull=Vj,b.pullAll=$e,b.pullAllBy=_e,b.pullAt=Wj,b.range=_k,b.rangeRight=al,b.rearg=tk,b.reject=Vf,b.remove=af,b.rest=jg,b.reverse=bf,b.sampleSize=Xf,b.set=Fh,b.setWith=Gh,b.shuffle=Yf,b.slice=cf,b.sortBy=kk,b.sortedUniq=kf,b.sortedUniqBy=lf,b.split=_h,b.spread=kg,b.tail=mf,b.take=nf,b.takeRight=of,b.takeRightWhile=pf,b.takeWhile=qf,b.tap=zf,b.throttle=lg,b.thru=Af,b.toArray=fh,b.toPairs=Hh,b.toPairsIn=Ih,b.toPath=yi,b.toPlainObject=jh,b.transform=Jh,b.unary=mg,b.union=Xj,b.unionBy=Yj,b.unionWith=Zj,b.uniq=rf,b.uniqBy=sf,b.uniqWith=tf,b.unset=Kh,b.unzip=uf,b.unzipWith=vf,b.values=Lh,b.valuesIn=Mh,b.without=$j,b.words=ji,b.wrap=ng,b.xor=_j,b.xorBy=ak,b.xorWith=bk,b.zip=ck,b.zipObject=wf,b.zipObjectDeep=xf,b.zipWith=dk,b.extend=xk,b.extendWith=yk,ri(b,b),b.add=Ai,b.attempt=Sk,b.camelCase=Kk,b.capitalize=Qh,b.ceil=bl,b.clamp=Nh,b.clone=pg,b.cloneDeep=rg,b.cloneDeepWith=sg,b.cloneWith=qg,b.deburr=Rh,b.endsWith=Sh,b.eq=tg,b.escape=Th,b.escapeRegExp=Uh,b.every=Jf,b.find=Lf,b.findIndex=Oe,b.findKey=nh,b.findLast=Mf,b.findLastIndex=Pe,b.findLastKey=oh,b.floor=cl,b.forEach=Of,b.forEachRight=Pf,b.forIn=ph,b.forInRight=qh,b.forOwn=rh,b.forOwnRight=sh,b.get=vh,b.gt=ug,b.gte=vg,b.has=wh,b.hasIn=xh,b.head=Ue,b.identity=ni,b.includes=Qf,b.indexOf=Ve,b.inRange=Oh,b.invoke=Fk,b.isArguments=wg,b.isArray=uk,b.isArrayBuffer=xg,b.isArrayLike=yg,b.isArrayLikeObject=zg,b.isBoolean=Ag,b.isBuffer=vk,b.isDate=Bg,b.isElement=Cg,b.isEmpty=Dg,b.isEqual=Eg,b.isEqualWith=Fg,b.isError=Gg,b.isFinite=Hg,b.isFunction=Ig,b.isInteger=Jg,b.isLength=Kg,b.isMap=Ng,b.isMatch=Og,b.isMatchWith=Pg,b.isNaN=Qg,b.isNative=Rg,b.isNil=Tg,b.isNull=Sg,b.isNumber=Ug,b.isObject=Lg,b.isObjectLike=Mg,b.isPlainObject=Vg,b.isRegExp=Wg,b.isSafeInteger=Xg,b.isSet=Yg,b.isString=Zg,b.isSymbol=$g,b.isTypedArray=_g,b.isUndefined=ah,b.isWeakMap=bh,b.isWeakSet=ch,b.join=Xe,b.kebabCase=Lk,b.last=Ye,b.lastIndexOf=Ze,b.lowerCase=Mk,b.lowerFirst=Nk,b.lt=dh,b.lte=eh,b.max=Bi,b.maxBy=Ci,b.mean=Di,b.min=Ei,b.minBy=Fi,b.noConflict=si,b.noop=ti,b.now=lk,b.pad=Vh,b.padEnd=Wh,b.padStart=Xh,b.parseInt=Yh,b.random=Ph,b.reduce=Tf,b.reduceRight=Uf,b.repeat=Zh,b.replace=$h,b.result=Eh,b.round=dl,b.runInContext=Y,b.sample=Wf,b.size=Zf,b.snakeCase=Pk,b.some=$f,b.sortedIndex=df,b.sortedIndexBy=ef,b.sortedIndexOf=ff,b.sortedLastIndex=gf,b.sortedLastIndexBy=hf,b.sortedLastIndexOf=jf,b.startCase=Qk,b.startsWith=ai,b.subtract=Gi,b.sum=Hi,b.sumBy=Ii,b.template=bi,b.times=xi,b.toInteger=gh,b.toLength=hh,b.toLower=ci,b.toNumber=ih,b.toSafeInteger=kh,b.toString=lh,b.toUpper=di,b.trim=ei,b.trimEnd=fi,b.trimStart=gi,b.truncate=hi,b.unescape=ii,b.uniqueId=zi,b.upperCase=Rk,b.upperFirst=Ok,b.each=Of,b.eachRight=Pf,b.first=Ue,ri(b,function(){var a={};return Mc(b,function(c,d){Ri.call(b.prototype,d)||(a[d]=c)}),a}(),{chain:!1}),b.VERSION=$,j(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){b[a].placeholder=b}),j(["drop","take"],function(a,b){H.prototype[a]=function(c){var d=this.__filtered__;if(d&&!b)return new H(this);c=c===Z?1:nj(gh(c),0);var e=this.clone();return d?e.__takeCount__=oj(c,e.__takeCount__):e.__views__.push({size:oj(c,za),type:a+(e.__dir__<0?"Right":"")}),e},H.prototype[a+"Right"]=function(b){return this.reverse()[a](b).reverse()}}),j(["filter","map","takeWhile"],function(a,b){var c=b+1,d=c==qa||c==sa;H.prototype[a]=function(a){var b=this.clone();return b.__iteratees__.push({iteratee:ke(a,3),type:c}),b.__filtered__=b.__filtered__||d,b}}),j(["head","last"],function(a,b){var c="take"+(b?"Right":"");H.prototype[a]=function(){return this[c](1).value()[0]}}),j(["initial","tail"],function(a,b){var c="drop"+(b?"":"Right");H.prototype[a]=function(){return this.__filtered__?new H(this):this[c](1)}}),H.prototype.compact=function(){return this.filter(ni)},H.prototype.find=function(a){return this.filter(a).head()},H.prototype.findLast=function(a){return this.reverse().find(a)},H.prototype.invokeMap=jg(function(a,b){return"function"==typeof a?new H(this):this.map(function(c){return Vc(c,a,b)})}),H.prototype.reject=function(a){return a=ke(a,3),this.filter(function(b){return!a(b)})},H.prototype.slice=function(a,b){a=gh(a);var c=this;return c.__filtered__&&(a>0||0>b)?new H(c):(0>a?c=c.takeRight(-a):a&&(c=c.drop(a)),b!==Z&&(b=gh(b),c=0>b?c.dropRight(-b):c.take(b-a)),c)},H.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},H.prototype.toArray=function(){return this.take(za)},Mc(H.prototype,function(a,c){var e=/^(?:filter|find|map|reject)|While$/.test(c),f=/^(?:head|last)$/.test(c),g=b[f?"take"+("last"==c?"Right":""):c],h=f||/^find/.test(c);g&&(b.prototype[c]=function(){var c=this.__wrapped__,i=f?[1]:arguments,j=c instanceof H,k=i[0],l=j||uk(c),m=function(a){var c=g.apply(b,q([a],i));return f&&n?c[0]:c};l&&e&&"function"==typeof k&&1!=k.length&&(j=l=!1);var n=this.__chain__,o=!!this.__actions__.length,p=h&&!n,r=j&&!o;if(!h&&l){c=r?c:new H(this);var s=a.apply(c,i);return s.__actions__.push({func:Af,args:[m],thisArg:Z}),new d(s,n)}return p&&r?a.apply(this,i):(s=this.thru(m),p?f?s.value()[0]:s.value():s)})}),j(["pop","push","shift","sort","splice","unshift"],function(a){var c=Oi[a],d=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",e=/^(?:pop|shift)$/.test(a);b.prototype[a]=function(){var a=arguments;return e&&!this.__chain__?c.apply(this.value(),a):this[d](function(b){return c.apply(b,a)})}}),Mc(H.prototype,function(a,c){var d=b[c];if(d){var e=d.name+"",f=Dj[e]||(Dj[e]=[]);f.push({name:c,func:d})}}),Dj[Zd(Z,aa).name]=[{name:"wrapper",func:Z}],H.prototype.clone=Bb,H.prototype.reverse=Fb,H.prototype.value=Gb,b.prototype.at=ek,b.prototype.chain=Bf,b.prototype.commit=Cf,b.prototype.flatMap=Df,b.prototype.next=Ef,b.prototype.plant=Gf,b.prototype.reverse=Hf,b.prototype.toJSON=b.prototype.valueOf=b.prototype.value=If,dj&&(b.prototype[dj]=Ff),b}var Z,$="4.5.1",_=1,aa=2,ba=4,ca=8,da=16,ea=32,fa=64,ga=128,ha=256,ia=512,ja=1,ka=2,la=30,ma="...",na=150,oa=16,pa=200,qa=1,ra=2,sa=3,ta="Expected a function",ua="__lodash_hash_undefined__",va=1/0,wa=9007199254740991,xa=1.7976931348623157e308,ya=NaN,za=4294967295,Aa=za-1,Ba=za>>>1,Ca="__lodash_placeholder__",Da="[object Arguments]",Ea="[object Array]",Fa="[object Boolean]",Ga="[object Date]",Ha="[object Error]",Ia="[object Function]",Ja="[object GeneratorFunction]",Ka="[object Map]",La="[object Number]",Ma="[object Object]",Na="[object RegExp]",Oa="[object Set]",Pa="[object String]",Qa="[object Symbol]",Ra="[object WeakMap]",Sa="[object WeakSet]",Ta="[object ArrayBuffer]",Ua="[object Float32Array]",Va="[object Float64Array]",Wa="[object Int8Array]",Xa="[object Int16Array]",Ya="[object Int32Array]",Za="[object Uint8Array]",$a="[object Uint8ClampedArray]",_a="[object Uint16Array]",ab="[object Uint32Array]",bb=/\b__p \+= '';/g,cb=/\b(__p \+=) '' \+/g,db=/(__e\(.*?\)|\b__t\)) \+\n'';/g,eb=/&(?:amp|lt|gt|quot|#39|#96);/g,fb=/[&<>"'`]/g,gb=RegExp(eb.source),hb=RegExp(fb.source),ib=/<%-([\s\S]+?)%>/g,jb=/<%([\s\S]+?)%>/g,kb=/<%=([\s\S]+?)%>/g,lb=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mb=/^\w*$/,nb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,ob=/[\\^$.*+?()[\]{}|]/g,pb=RegExp(ob.source),qb=/^\s+|\s+$/g,rb=/^\s+/,sb=/\s+$/,tb=/\\(\\)?/g,ub=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vb=/\w*$/,wb=/^0x/i,xb=/^[-+]0x[0-9a-f]+$/i,yb=/^0b[01]+$/i,zb=/^\[object .+?Constructor\]$/,Ab=/^0o[0-7]+$/i,Bb=/^(?:0|[1-9]\d*)$/,Cb=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Db=/($^)/,Eb=/['\n\r\u2028\u2029\\]/g,Fb="\\ud800-\\udfff",Gb="\\u0300-\\u036f\\ufe20-\\ufe23",Hb="\\u20d0-\\u20f0",Ib="\\u2700-\\u27bf",Jb="a-z\\xdf-\\xf6\\xf8-\\xff",Kb="\\xac\\xb1\\xd7\\xf7",Lb="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Mb="\\u2018\\u2019\\u201c\\u201d",Nb=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ob="A-Z\\xc0-\\xd6\\xd8-\\xde",Pb="\\ufe0e\\ufe0f",Qb=Kb+Lb+Mb+Nb,Rb="["+Fb+"]",Sb="["+Qb+"]",Tb="["+Gb+Hb+"]",Ub="\\d+",Vb="["+Ib+"]",Wb="["+Jb+"]",Xb="[^"+Fb+Qb+Ub+Ib+Jb+Ob+"]",Yb="\\ud83c[\\udffb-\\udfff]",Zb="(?:"+Tb+"|"+Yb+")",$b="[^"+Fb+"]",_b="(?:\\ud83c[\\udde6-\\uddff]){2}",ac="[\\ud800-\\udbff][\\udc00-\\udfff]",bc="["+Ob+"]",cc="\\u200d",dc="(?:"+Wb+"|"+Xb+")",ec="(?:"+bc+"|"+Xb+")",fc=Zb+"?",gc="["+Pb+"]?",hc="(?:"+cc+"(?:"+[$b,_b,ac].join("|")+")"+gc+fc+")*",ic=gc+fc+hc,jc="(?:"+[Vb,_b,ac].join("|")+")"+ic,kc="(?:"+[$b+Tb+"?",Tb,_b,ac,Rb].join("|")+")",lc=RegExp(Tb,"g"),mc=RegExp(Yb+"(?="+Yb+")|"+kc+ic,"g"),nc=RegExp("["+cc+Fb+Gb+Hb+Pb+"]"),oc=/[a-zA-Z0-9]+/g,pc=RegExp([bc+"?"+Wb+"+(?="+[Sb,bc,"$"].join("|")+")",ec+"+(?="+[Sb,bc+dc,"$"].join("|")+")",bc+"?"+dc+"+",bc+"+",Ub,jc].join("|"),"g"),qc=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,rc=["Array","Buffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Reflect","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],sc=-1,tc={};tc[Ua]=tc[Va]=tc[Wa]=tc[Xa]=tc[Ya]=tc[Za]=tc[$a]=tc[_a]=tc[ab]=!0,tc[Da]=tc[Ea]=tc[Ta]=tc[Fa]=tc[Ga]=tc[Ha]=tc[Ia]=tc[Ka]=tc[La]=tc[Ma]=tc[Na]=tc[Oa]=tc[Pa]=tc[Ra]=!1;var uc={};
uc[Da]=uc[Ea]=uc[Ta]=uc[Fa]=uc[Ga]=uc[Ua]=uc[Va]=uc[Wa]=uc[Xa]=uc[Ya]=uc[Ka]=uc[La]=uc[Ma]=uc[Na]=uc[Oa]=uc[Pa]=uc[Qa]=uc[Za]=uc[$a]=uc[_a]=uc[ab]=!0,uc[Ha]=uc[Ia]=uc[Ra]=!1;var vc={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},wc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},xc={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},yc={"function":!0,object:!0},zc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ac=parseFloat,Bc=parseInt,Cc=yc[typeof d]&&d&&!d.nodeType?d:Z,Dc=yc[typeof c]&&c&&!c.nodeType?c:Z,Ec=Dc&&Dc.exports===Cc?Cc:Z,Fc=H(Cc&&Dc&&"object"==typeof a&&a),Gc=H(yc[typeof self]&&self),Hc=H(yc[typeof window]&&window),Ic=H(yc[typeof this]&&this),Jc=Fc||Hc!==(Ic&&Ic.window)&&Hc||Gc||Ic||Function("return this")(),Kc=Y();(Hc||Gc||{})._=Kc,"function"==typeof b&&"object"==typeof b.amd&&b.amd?b(function(){return Kc}):Cc&&Dc?(Ec&&((Dc.exports=Kc)._=Kc),Cc._=Kc):Jc._=Kc}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],129:[function(a,b,c){function d(a){return g(a)?e(a):f(a)}var e=a("./_baseProperty"),f=a("./_basePropertyDeep"),g=a("./_isKey");b.exports=d},{"./_baseProperty":59,"./_basePropertyDeep":60,"./_isKey":86}],130:[function(a,b,c){function d(a,b){if("function"!=typeof a)throw new TypeError(g);return b=h(void 0===b?a.length-1:f(b),0),function(){for(var c=arguments,d=-1,f=h(c.length-b,0),g=Array(f);++d<f;)g[d]=c[b+d];switch(b){case 0:return a.call(this,g);case 1:return a.call(this,c[0],g);case 2:return a.call(this,c[0],c[1],g)}var i=Array(b+1);for(d=-1;++d<b;)i[d]=c[d];return i[b]=g,e(a,this,i)}}var e=a("./_apply"),f=a("./toInteger"),g="Expected a function",h=Math.max;b.exports=d},{"./_apply":32,"./toInteger":131}],131:[function(a,b,c){function d(a){if(!a)return 0===a?a:0;if(a=e(a),a===f||a===-f){var b=0>a?-1:1;return b*g}var c=a%1;return a===a?c?a-c:a:0}var e=a("./toNumber"),f=1/0,g=1.7976931348623157e308;b.exports=d},{"./toNumber":132}],132:[function(a,b,c){function d(a){if(f(a)){var b=e(a.valueOf)?a.valueOf():a;a=f(b)?b+"":b}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(h,"");var c=j.test(a);return c||k.test(a)?l(a.slice(2),c?2:8):i.test(a)?g:+a}var e=a("./isFunction"),f=a("./isObject"),g=NaN,h=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,j=/^0b[01]+$/i,k=/^0o[0-7]+$/i,l=parseInt;b.exports=d},{"./isFunction":118,"./isObject":121}],133:[function(a,b,c){function d(a){return e(a,f(a))}var e=a("./_baseToPairs"),f=a("./keys");b.exports=d},{"./_baseToPairs":63,"./keys":126}],134:[function(a,b,c){function d(a){if("string"==typeof a)return a;if(null==a)return"";if(f(a))return e?i.call(a):"";var b=a+"";return"0"==b&&1/a==-g?"-0":b}var e=a("./_Symbol"),f=a("./isSymbol"),g=1/0,h=e?e.prototype:void 0,i=e?h.toString:void 0;b.exports=d},{"./_Symbol":29,"./isSymbol":124}],135:[function(a,b,c){function d(a,b,d,g,i,j){var o=i,r=j-i,s=0;if(a.length>=e)throw new Error("input too large");if(a.length>k){var t=c.compressBound(a.length);if(t>r)throw Error("output too small: "+r+" < "+t);for(var u=1,v=(1<<l)+3,w=a.length-k;w>d+f;){var x=a[d+1]<<8|a[d],y=a[d+3]<<8|a[d+2],z=Math.imul(x|y<<16,q)>>>h,A=g[z]-1;if(g[z]=d+1,0>A||d-A>>>16>0||(a[A+3]<<8|a[A+2])!=y||(a[A+1]<<8|a[A])!=x)u=v++>>l,d+=u;else{v=(1<<l)+3;var B=d-s,C=d-A;d+=f,A+=f;for(var D=d;w>d&&a[d]==a[A];)d++,A++;D=d-D;var E=n>D?D:n;if(B>=p){b[o++]=(p<<m)+E;for(var F=B-p;F>254;F-=255)b[o++]=255;b[o++]=F}else b[o++]=(B<<m)+E;for(var G=0;B>G;G++)b[o++]=a[s+G];if(b[o++]=C,b[o++]=C>>8,D>=n){for(D-=n;D>=255;)D-=255,b[o++]=255;b[o++]=D}s=d}}}if(0==s)return 0;if(B=a.length-s,B>=p){b[o++]=p<<m;for(var H=B-p;H>254;H-=255)b[o++]=255;b[o++]=H}else b[o++]=B<<m;for(d=s;d<a.length;)b[o++]=a[d++];return o}a("cuint").UINT32;Math.imul||(Math.imul=function(a,b){var c=a>>>16,d=65535&a,e=b>>>16,f=65535&b;return d*f+(c*f+d*e<<16)|0}),c.uncompress=function(a,b,c,d){c=c||0,d=d||a.length-c;for(var e=c,f=d,g=0;f>e;){var h=a[e++],i=h>>4;if(i>0){for(var j=i+240;255===j;)j=a[e++],i+=j;for(var k=e+i;k>e;)b[g++]=a[e++];if(e===f)return g}var l=a[e++]|a[e++]<<8;if(0===l||l>g)return-(e-2);for(var m=15&h,j=m+240;255===j;)j=a[e++],m+=j;for(var n=g-l,k=g+m+4;k>g;)b[g++]=b[n++]}return g};var e=2113929216,f=4,g=16,h=8*f-g,i=1<<g,j=8,k=j+f,l=6,m=4,n=(1<<m)-1,o=8-m,p=(1<<o)-1,q=2654435761;c.compressBound=function(a){return a>e?0:a+a/255+16|0},c.compress=function(a,b,c,e){for(var f=new Array(i),g=0;i>g;g++)f[g]=0;return d(a,b,0,f,c||0,e||b.length)},c.compressHC=c.compress,c.compressDependent=d},{cuint:11}],136:[function(a,b,c){(function(b){function d(a,c){var d=[],f=new e(c);return f.on("data",function(a){d.push(a)}),f.end(a),b.concat(d)}var e=a("./decoder_stream");c.LZ4_uncompress=d}).call(this,a("buffer").Buffer)},{"./decoder_stream":137,buffer:9}],137:[function(a,b,c){(function(c){function d(a){return this instanceof d?(e.call(this,a),this.options=a||{},this.binding=this.options.useJS?j:i,this.buffer=null,this.pos=0,this.descriptor=null,this.state=k.MAGIC,this.notEnoughData=!1,this.descriptorStart=0,this.streamSize=null,this.dictId=null,this.currentStreamChecksum=null,this.dataBlockSize=0,void(this.skippableSize=0)):new d(a)}var e=a("stream").Transform,f=a("util").inherits,g=a("./static"),h=g.utils,i=h.bindings,j=a("./binding"),k=g.STATES,l=g.SIZES;f(d,e),d.prototype._transform=function(a,b,d){if(this.skippableSize>0){if(this.skippableSize-=a.length,this.skippableSize>0)return void d();a=a.slice(-this.skippableSize),this.skippableSize=0,this.state=k.MAGIC}this.buffer=this.buffer?c.concat([this.buffer,a],this.buffer.length+a.length):a,this._main(d)},d.prototype.emit_Error=function(a){this.emit("error",new Error(a+" @"+this.pos))},d.prototype.check_Size=function(a){var b=this.buffer.length-this.pos;return 0>=b||a>b?(this.notEnoughData&&this.emit_Error("Unexpected end of LZ4 stream"),!0):(this.pos+=a,!1)},d.prototype.read_MagicNumber=function(){var a=this.pos;if(this.check_Size(l.MAGIC))return!0;var b=h.readInt32LE(this.buffer,a);return(4294967280&b)===g.MAGICNUMBER_SKIPPABLE?void(this.state=k.SKIP_SIZE):b!==g.MAGICNUMBER?(this.pos=a,this.emit_Error("Invalid magic number: "+b.toString(16).toUpperCase()),!0):void(this.state=k.DESCRIPTOR)},d.prototype.read_SkippableSize=function(){var a=this.pos;return this.check_Size(l.SKIP_SIZE)?!0:(this.state=k.SKIP_DATA,void(this.skippableSize=h.readInt32LE(this.buffer,a)))},d.prototype.read_Descriptor=function(){var a=this.pos;if(this.check_Size(l.DESCRIPTOR))return!0;this.descriptorStart=a;var b=this.buffer[a],c=b>>6;if(c!==g.VERSION)return this.pos=a,this.emit_Error("Invalid version: "+c+" != "+g.VERSION),!0;if(b>>1&1)return this.pos=a,this.emit_Error("Reserved bit set"),!0;var d=this.buffer[a+1]>>4&7,e=g.blockMaxSizes[d];return null===e?(this.pos=a,this.emit_Error("Invalid block max size: "+d),!0):(this.descriptor={blockIndependence:Boolean(b>>5&1),blockChecksum:Boolean(b>>4&1),blockMaxSize:e,streamSize:Boolean(b>>3&1),streamChecksum:Boolean(b>>2&1),dict:Boolean(1&b),dictId:0},void(this.state=k.SIZE))},d.prototype.read_Size=function(){if(this.descriptor.streamSize){var a=this.pos;if(this.check_Size(l.SIZE))return!0;this.streamSize=this.buffer.slice(a,a+8)}this.state=k.DICTID},d.prototype.read_DictId=function(){if(this.descriptor.dictId){var a=this.pos;if(this.check_Size(l.DICTID))return!0;this.dictId=h.readInt32LE(this.buffer,a)}this.state=k.DESCRIPTOR_CHECKSUM},d.prototype.read_DescriptorChecksum=function(){var a=this.pos;if(this.check_Size(l.DESCRIPTOR_CHECKSUM))return!0;var b=this.buffer[a],c=h.descriptorChecksum(this.buffer.slice(this.descriptorStart,a));return c!==b?(this.pos=a,this.emit_Error("Invalid stream descriptor checksum"),!0):void(this.state=k.DATABLOCK_SIZE)},d.prototype.read_DataBlockSize=function(){var a=this.pos;if(this.check_Size(l.DATABLOCK_SIZE))return!0;var b=h.readInt32LE(this.buffer,a);return b===g.EOS?void(this.state=k.EOS):(this.dataBlockSize=b,void(this.state=k.DATABLOCK_DATA))},d.prototype.read_DataBlockData=function(){var a=this.pos,b=this.dataBlockSize;return 2147483648&b&&(b=2147483647&b),this.check_Size(b)?!0:(this.dataBlock=this.buffer.slice(a,a+b),void(this.state=k.DATABLOCK_CHECKSUM))},d.prototype.read_DataBlockChecksum=function(){var a=this.pos;if(this.descriptor.blockChecksum){if(this.check_Size(l.DATABLOCK_CHECKSUM))return!0;var b=h.readInt32LE(this.buffer,this.pos-4),c=h.blockChecksum(this.dataBlock);if(c!==b)return this.pos=a,this.emit_Error("Invalid block checksum"),!0}this.state=k.DATABLOCK_UNCOMPRESS},d.prototype.uncompress_DataBlock=function(){var a;if(2147483648&this.dataBlockSize)a=this.dataBlock;else{a=new c(this.descriptor.blockMaxSize);var b=this.binding.uncompress(this.dataBlock,a);if(0>b)return this.emit_Error("Invalid data block: "+-b),!0;b<this.descriptor.blockMaxSize&&(a=a.slice(0,b))}this.dataBlock=null,this.push(a),this.descriptor.streamChecksum&&(this.currentStreamChecksum=h.streamChecksum(a,this.currentStreamChecksum)),this.state=k.DATABLOCK_SIZE},d.prototype.read_EOS=function(){if(this.descriptor.streamChecksum){var a=this.pos;if(this.check_Size(l.EOS))return!0;var b=h.readInt32LE(this.buffer,a);if(b!==h.streamChecksum(null,this.currentStreamChecksum))return this.pos=a,this.emit_Error("Invalid stream checksum: "+b.toString(16).toUpperCase()),!0}this.state=k.MAGIC},d.prototype._flush=function(a){this.notEnoughData=!0,this._main(a)},d.prototype._main=function(a){for(var b,c=this.pos;!b&&this.pos<this.buffer.length;)this.state===k.MAGIC&&(b=this.read_MagicNumber()),this.state===k.SKIP_SIZE&&(b=this.read_SkippableSize()),this.state===k.DESCRIPTOR&&(b=this.read_Descriptor()),this.state===k.SIZE&&(b=this.read_Size()),this.state===k.DICTID&&(b=this.read_DictId()),this.state===k.DESCRIPTOR_CHECKSUM&&(b=this.read_DescriptorChecksum()),this.state===k.DATABLOCK_SIZE&&(b=this.read_DataBlockSize()),this.state===k.DATABLOCK_DATA&&(b=this.read_DataBlockData()),this.state===k.DATABLOCK_CHECKSUM&&(b=this.read_DataBlockChecksum()),this.state===k.DATABLOCK_UNCOMPRESS&&(b=this.uncompress_DataBlock()),this.state===k.EOS&&(b=this.read_EOS());this.pos>c&&(this.buffer=this.buffer.slice(this.pos),this.pos=0),a()},b.exports=d}).call(this,a("buffer").Buffer)},{"./binding":135,"./static":141,buffer:9,stream:179,util:185}],138:[function(a,b,c){(function(b){function d(a,c){var d=[],f=new e(c);return f.on("data",function(a){d.push(a)}),f.end(a),b.concat(d)}var e=a("./encoder_stream");c.LZ4_compress=d}).call(this,a("buffer").Buffer)},{"./encoder_stream":139,buffer:9}],139:[function(a,b,c){(function(c){function d(a){if(!(this instanceof d))return new d(a);e.call(this,a);var b=a||m;b!==m&&Object.keys(m).forEach(function(a){b.hasOwnProperty(a)||(b[a]=m[a])}),this.options=b,this.binding=this.options.useJS?j:i,this.compress=b.highCompression?this.binding.compressHC:this.binding.compress;var c=0;c|=g.VERSION<<6,c|=(1&b.blockIndependence)<<5,c|=(1&b.blockChecksum)<<4,c|=(1&b.streamSize)<<3,c|=(1&b.streamChecksum)<<2,c|=1&b.dict;var f=g.blockMaxSizes.indexOf(b.blockMaxSize);if(0>f)throw new Error("Invalid blockMaxSize: "+b.blockMaxSize);this.descriptor={flg:c,bd:(7&f)<<4},this.buffer=[],this.length=0,this.first=!0,this.checksum=null}var e=a("stream").Transform,f=a("util").inherits,g=a("./static"),h=g.utils,i=h.bindings,j=a("./binding"),k=g.STATES,l=g.SIZES,m={blockIndependence:!0,blockChecksum:!1,blockMaxSize:4<<20,streamSize:!1,streamChecksum:!0,dict:!1,dictId:0,highCompression:!1};f(d,e),d.prototype.headerSize=function(){var a=this.options.streamSize?l.DESCRIPTOR:0,b=this.options.dict?l.DICTID:0;return l.MAGIC+1+1+a+b+1},d.prototype.header=function(){var a=this.headerSize(),b=new c(a);this.state=k.MAGIC,b.writeInt32LE(g.MAGICNUMBER,0,!0),this.state=k.DESCRIPTOR;var d=b.slice(l.MAGIC,b.length-1);d.writeUInt8(this.descriptor.flg,0,!0),d.writeUInt8(this.descriptor.bd,1,!0);var e=2;return this.state=k.SIZE,this.options.streamSize&&(d.writeInt32LE(0,e,!0),d.writeInt32LE(this.size,e+4,!0),e+=l.SIZE),this.state=k.DICTID,this.options.dict&&(d.writeInt32LE(this.dictId,e,!0),e+=l.DICTID),this.state=k.DESCRIPTOR_CHECKSUM,b.writeUInt8(h.descriptorChecksum(d),l.MAGIC+e,!1),b},d.prototype.update_Checksum=function(a){this.state=k.CHECKSUM_UPDATE,this.options.streamChecksum&&(this.checksum=h.streamChecksum(a,this.checksum))},d.prototype.compress_DataBlock=function(a){this.state=k.DATABLOCK_COMPRESS;var b=this.options.blockChecksum?l.DATABLOCK_CHECKSUM:0,d=this.binding.compressBound(a.length),e=new c(l.DATABLOCK_SIZE+d+b),f=e.slice(l.DATABLOCK_SIZE,l.DATABLOCK_SIZE+d),g=this.compress(a,f);if(this.state=k.DATABLOCK_SIZE,g>0&&g<=this.options.blockMaxSize?(e.writeUInt32LE(g,0,!0),e=e.slice(0,l.DATABLOCK_SIZE+g+b)):(e.writeInt32LE(2147483648|a.length,0,!0),e=e.slice(0,l.DATABLOCK_SIZE+a.length+b),a.copy(e,l.DATABLOCK_SIZE)),this.state=k.DATABLOCK_CHECKSUM,this.options.blockChecksum){var i=e.slice(-b);i.writeInt32LE(h.blockChecksum(f),0,!0)}return this.update_Checksum(a),this.size+=a.length,e},d.prototype._transform=function(a,b,d){a&&(this.buffer.push(a),this.length+=a.length),this.first&&(this.push(this.header()),this.first=!1);var e=this.options.blockMaxSize;if(this.length<e)return d();for(var f=c.concat(this.buffer,this.length),g=0,h=f.length;h>=e;h-=e,g+=e)this.push(this.compress_DataBlock(f.slice(g,g+e)));h>0?(this.buffer=[f.slice(g)],this.length=this.buffer[0].length):(this.buffer=[],this.length=0),d()},d.prototype._flush=function(a){if(this.length>0){var b=c.concat(this.buffer,this.length);this.buffer=[],this.length=0;var d=this.compress_DataBlock(b);this.push(d)}if(this.options.streamChecksum){this.state=k.CHECKSUM;var e=new c(l.EOS+l.CHECKSUM);e.writeInt32LE(h.streamChecksum(null,this.checksum),l.EOS,!0)}else var e=new c(l.EOS);this.state=k.EOS,e.writeInt32LE(g.EOS,0,!0),this.push(e),a()},b.exports=d}).call(this,a("buffer").Buffer)},{"./binding":135,"./static":141,buffer:9,stream:179,util:185}],140:[function(a,b,c){b.exports=a("./static"),b.exports.version="0.5.1",b.exports.createDecoderStream=a("./decoder_stream"),b.exports.decode=a("./decoder").LZ4_uncompress,b.exports.createEncoderStream=a("./encoder_stream"),b.exports.encode=a("./encoder").LZ4_compress;var d=b.exports.utils.bindings;b.exports.decodeBlock=d.uncompress,b.exports.encodeBound=d.compressBound,b.exports.encodeBlock=d.compress,b.exports.encodeBlockHC=d.compressHC},{"./decoder":136,"./decoder_stream":137,"./encoder":138,"./encoder_stream":139,"./static":141}],141:[function(a,b,c){(function(b){c.MAGICNUMBER=407708164,c.MAGICNUMBER_BUFFER=new b(4),c.MAGICNUMBER_BUFFER.writeUInt32LE(c.MAGICNUMBER,0,!1),c.EOS=0,c.EOS_BUFFER=new b(4),c.EOS_BUFFER.writeUInt32LE(c.EOS,0,!1),c.VERSION=1,c.MAGICNUMBER_SKIPPABLE=407710288,c.blockMaxSizes=[null,null,null,null,65536,262144,1<<20,4<<20],c.extension=".lz4",c.STATES={MAGIC:0,DESCRIPTOR:1,SIZE:2,DICTID:3,DESCRIPTOR_CHECKSUM:4,DATABLOCK_SIZE:5,DATABLOCK_DATA:6,DATABLOCK_CHECKSUM:7,DATABLOCK_UNCOMPRESS:8,DATABLOCK_COMPRESS:9,CHECKSUM:10,CHECKSUM_UPDATE:11,EOS:90,SKIP_SIZE:101,SKIP_DATA:102},c.SIZES={MAGIC:4,DESCRIPTOR:2,SIZE:8,DICTID:4,DESCRIPTOR_CHECKSUM:1,DATABLOCK_SIZE:4,DATABLOCK_CHECKSUM:4,CHECKSUM:4,EOS:4,SKIP_SIZE:4},c.utils=a("./utils")}).call(this,a("buffer").Buffer)},{"./utils":142,buffer:9}],142:[function(a,b,c){var d=a("xxhashjs"),e=0;c.descriptorChecksum=function(a){return d(a,e).toNumber()>>8&255},c.blockChecksum=function(a){return d(a,e).toNumber()},c.streamChecksum=function(a,b){return null===a?b.digest().toNumber():(null===b&&(b=d(e)),b.update(a))},c.readInt32LE=function(a,b){return a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24},c.bindings=a("./binding")},{"./binding":135,xxhashjs:215}],143:[function(a,b,c){b.exports.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"reserved"},b.exports.codes={};for(var d in b.exports.types){var e=b.exports.types[d];b.exports.codes[e]=d}b.exports.CMD_SHIFT=4,b.exports.CMD_MASK=240,b.exports.DUP_MASK=8,b.exports.QOS_MASK=3,b.exports.QOS_SHIFT=1,b.exports.RETAIN_MASK=1,b.exports.LENGTH_MASK=127,b.exports.LENGTH_FIN_MASK=128,b.exports.SESSIONPRESENT_MASK=1,b.exports.USERNAME_MASK=128,b.exports.PASSWORD_MASK=64,b.exports.WILL_RETAIN_MASK=32,b.exports.WILL_QOS_MASK=24,b.exports.WILL_QOS_SHIFT=3,b.exports.WILL_FLAG_MASK=4,b.exports.CLEAN_SESSION_MASK=2},{}],144:[function(a,b,c){(function(c){"use strict";function d(a){switch(a.cmd){case"connect":return e(a);case"connack":return f(a);case"publish":return g(a);case"puback":case"pubrec":case"pubrel":case"pubcomp":case"unsuback":return h(a);case"subscribe":return i(a);case"suback":return j(a);case"unsubscribe":return k(a);case"pingreq":case"pingresp":case"disconnect":return l(a);default:throw new Error("unknown command")}}function e(a){var a=a||{},b=a.protocolId||"MQTT",d=a.protocolVersion||4,e=a.will,f=a.clean,g=a.keepalive||0,h=a.clientId||"",i=a.username,j=a.password;void 0===f&&(f=!0);var k=0;if(!b||"string"!=typeof b&&!c.isBuffer(b))throw new Error("Invalid protocol id");if(k+=b.length+2,!d||"number"!=typeof d||d>255||0>d)throw new Error("Invalid protocol version");if(k+=1,"string"!=typeof h&&!c.isBuffer(h)||!h&&4!=d||!h&&!f){if(4>d)throw new Error("clientId must be supplied before 3.1.1");if(0==f)throw new Error("clientId must be given if cleanSession set to 0")}else k+=h.length+2;if("number"!=typeof g||0>g||g>65535)throw new Error("Invalid keepalive");if(k+=2,k+=1,e){if("object"!=typeof e)throw new Error("Invalid will");if(!e.topic||"string"!=typeof e.topic)throw new Error("Invalid will topic");if(k+=c.byteLength(e.topic)+2,e.payload&&e.payload){if(!(e.payload.length>=0))throw new Error("Invalid will payload");k+="string"==typeof e.payload?c.byteLength(e.payload)+2:e.payload.length+2}else k+=2}if(i){if(!i.length)throw new Error("Invalid username");k+=c.byteLength(i)+2}if(j){if(!j.length)throw new Error("Invalid password");k+=t(j)+2}var l=new c(1+m(k)+k),p=0;l.writeUInt8(u.codes.connect<<u.CMD_SHIFT,p++,!0),p+=n(l,p,k),p+=s(l,p,b),l.writeUInt8(d,p++,!0);var q=0;return q|=i?u.USERNAME_MASK:0,q|=j?u.PASSWORD_MASK:0,q|=e&&e.retain?u.WILL_RETAIN_MASK:0,q|=e&&e.qos?e.qos<<u.WILL_QOS_SHIFT:0,q|=e?u.WILL_FLAG_MASK:0,q|=f?u.CLEAN_SESSION_MASK:0,l.writeUInt8(q,p++,!0),p+=r(l,p,g),p+=s(l,p,h),e&&(p+=o(l,p,e.topic),p+=s(l,p,e.payload)),i&&(p+=s(l,p,i)),j&&(p+=s(l,p,j)),l}function f(a){var a=a||{},b=a.returnCode;if("number"!=typeof b)throw new Error("Invalid return code");var d=new c(4),e=0;return d.writeUInt8(u.codes.connack<<u.CMD_SHIFT,e++,!0),e+=n(d,e,2),d.writeUInt8(a.sessionPresent&&u.SESSIONPRESENT_MASK||0,e++,!0),d.writeUInt8(b,e++,!0),d}function g(a){var a=a||{},b=a.dup?u.DUP_MASK:0,d=a.qos,e=a.retain?u.RETAIN_MASK:0,f=a.topic,g=a.payload||v,h=a.messageId,i=0;if("string"==typeof f)i+=c.byteLength(f)+2;else{if(!c.isBuffer(f))throw new Error("Invalid topic");i+=f.length+2}if(i+=c.isBuffer(g)?g.length:c.byteLength(g),d&&"number"!=typeof h)throw new Error("Invalid message id");d&&(i+=2);var j=new c(1+m(i)+i),k=0;return j.writeUInt8(u.codes.publish<<u.CMD_SHIFT|b|d<<u.QOS_SHIFT|e,k++,!0),k+=n(j,k,i),k+=s(j,k,f),d>0&&(k+=r(j,k,h)),c.isBuffer(g)?q(j,k,g):p(j,k,g),j}function h(a){var a=a||{},b=a.cmd||"puback",d=a.messageId,e=a.dup&&"pubrel"===b?u.DUP_MASK:0,f=0;if("pubrel"===b&&(f=1),"number"!=typeof d)throw new Error("Invalid message id");var g=new c(4),h=0;return g[h++]=u.codes[b]<<u.CMD_SHIFT|e|f<<u.QOS_SHIFT,h+=n(g,h,2),h+=r(g,h,d),g}function i(a){var a=a||{},b=a.dup?u.DUP_MASK:0,d=a.qos||0,e=a.messageId,f=a.subscriptions,g=0;if("number"!=typeof e)throw new Error("Invalid message id");if(g+=2,"object"!=typeof f||!f.length)throw new Error("Invalid subscriptions");for(var h=0;h<f.length;h+=1){var i=f[h].topic,d=f[h].qos;if("string"!=typeof i)throw new Error("Invalid subscriptions - invalid topic");if("number"!=typeof d)throw new Error("Invalid subscriptions - invalid qos");g+=c.byteLength(i)+2+1}var j=new c(1+m(g)+g),k=0;j.writeUInt8(u.codes.subscribe<<u.CMD_SHIFT|b|1<<u.QOS_SHIFT,k++,!0),k+=n(j,k,g),k+=r(j,k,e);for(var h=0;h<f.length;h++){var l=f[h],i=l.topic,d=l.qos;k+=o(j,k,i),j.writeUInt8(d,k++,!0)}return j}function j(a){var a=a||{},b=a.messageId,d=a.granted,e=0;if("number"!=typeof b)throw new Error("Invalid message id");if(e+=2,"object"!=typeof d||!d.length)throw new Error("Invalid qos vector");for(var f=0;f<d.length;f+=1){if("number"!=typeof d[f])throw new Error("Invalid qos vector");e+=1}var g=new c(1+m(e)+e),h=0;g.writeUInt8(u.codes.suback<<u.CMD_SHIFT,h++,!0),h+=n(g,h,e),h+=r(g,h,b);for(var f=0;f<d.length;f++)g.writeUInt8(d[f],h++,!0);return g}function k(a){var a=a||{},b=a.messageId,d=a.dup?u.DUP_MASK:0,e=a.unsubscriptions,f=0;if("number"!=typeof b)throw new Error("Invalid message id");if(f+=2,"object"!=typeof e||!e.length)throw new Error("Invalid unsubscriptions");for(var g=0;g<e.length;g+=1){if("string"!=typeof e[g])throw new Error("Invalid unsubscriptions");f+=c.byteLength(e[g])+2}var h=new c(1+m(f)+f),i=0;h[i++]=u.codes.unsubscribe<<u.CMD_SHIFT|d|1<<u.QOS_SHIFT,i+=n(h,i,f),i+=r(h,i,b);for(var g=0;g<e.length;g++)i+=o(h,i,e[g]);return h}function l(a){var b=new c(2);return b[0]=u.codes[a.cmd]<<4,b[1]=0,b}function m(a){return a>=0&&128>a?1:a>=128&&16384>a?2:a>=16384&&2097152>a?3:a>=2097152&&268435456>a?4:0}function n(a,b,c){var d=0,e=b;do d=c%128|0,c=c/128|0,c>0&&(d=128|d),a.writeUInt8(d,b++,!0);while(c>0);return b-e}function o(a,b,d){var e=c.byteLength(d);return r(a,b,e),p(a,b+2,d),e+2}function p(a,b,c){a.write(c,b)}function q(a,b,c){return c.copy(a,b),c.length}function r(a,b,c){return a.writeUInt8(c>>8,b,!0),a.writeUInt8(255&c,b+1,!0),2}function s(a,b,c){var d=0;return c&&"string"==typeof c?d+=o(a,b+d,c):c?(d+=r(a,b+d,c.length),d+=q(a,b+d,c)):d+=r(a,b+d,0),d}function t(a){return c.isBuffer(a)?a.length:c.byteLength(a)}var u=a("./constants"),v=new c(0);b.exports=d}).call(this,a("buffer").Buffer)},{"./constants":143,buffer:9}],145:[function(a,b,c){"use strict";c.parser=a("./parser"),c.generate=a("./generate")},{"./generate":144,"./parser":147}],146:[function(a,b,c){function d(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}b.exports=d},{}],147:[function(a,b,c){function d(){return this instanceof d?(this._list=e(),this._newPacket(),this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],void(this._stateCounter=0)):new d}var e=a("bl"),f=a("inherits"),g=a("events").EventEmitter,h=a("./packet"),i=a("./constants");f(d,g),d.prototype._newPacket=function(){return this.packet&&(this._list.consume(this.packet.length),this.emit("packet",this.packet)),this.packet=new h,!0},d.prototype.parse=function(a){for(this._list.append(a);(-1!=this.packet.length||this._list.length>0)&&this[this._states[this._stateCounter]]();)this._stateCounter++,this._stateCounter>=this._states.length&&(this._stateCounter=0);return this._list.length},d.prototype._parseHeader=function(){var a=this._list.readUInt8(0);return this.packet.cmd=i.types[a>>i.CMD_SHIFT],this.packet.retain=0!==(a&i.RETAIN_MASK),this.packet.qos=a>>i.QOS_SHIFT&i.QOS_MASK,this.packet.dup=0!==(a&i.DUP_MASK),this._list.consume(1),!0},d.prototype._parseLength=function(){for(var a,b=0,c=1,d=0,e=!0;5>b&&(a=this._list.readUInt8(b++),d+=c*(a&i.LENGTH_MASK),c*=128,0!==(a&i.LENGTH_FIN_MASK));)if(this._list.length<=b){e=!1;break}return e&&(this.packet.length=d,this._list.consume(b)),e},d.prototype._parsePayload=function(){var a=!1;if(0===this.packet.length||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseMessageId();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":case"disconnect":break;default:this.emit("error",new Error("not supported"))}a=!0}return a},d.prototype._parseConnect=function(){var a,b,c,d,e,f,g={},h=this.packet;if(a=this._parseString(),null===a)return this.emit("error",new Error("cannot parse protocol id"));if("MQTT"!=a&&"MQIsdp"!=a)return this.emit("error",new Error("invalid protocol id"));if(h.protocolId=a,this._pos>=this._list.length)return this.emit("error",new Error("packet too short"));if(h.protocolVersion=this._list.readUInt8(this._pos),3!=h.protocolVersion&&4!=h.protocolVersion)return this.emit("error",new Error("invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this.emit("error",new Error("packet too short"));if(g.username=this._list.readUInt8(this._pos)&i.USERNAME_MASK,g.password=this._list.readUInt8(this._pos)&i.PASSWORD_MASK,g.will=this._list.readUInt8(this._pos)&i.WILL_FLAG_MASK,g.will&&(h.will={},h.will.retain=0!==(this._list.readUInt8(this._pos)&i.WILL_RETAIN_MASK),h.will.qos=(this._list.readUInt8(this._pos)&i.WILL_QOS_MASK)>>i.WILL_QOS_SHIFT),h.clean=0!==(this._list.readUInt8(this._pos)&i.CLEAN_SESSION_MASK),this._pos++,h.keepalive=this._parseNum(),-1===h.keepalive)return this.emit("error",new Error("packet too short"));if(b=this._parseString(),null===b)return this.emit("error",new Error("packet too short"));if(h.clientId=b,g.will){if(c=this._parseString(),null===c)return this.emit("error",new Error("cannot parse will topic"));if(h.will.topic=c,d=this._parseBuffer(),null===d)return this.emit("error",new Error("cannot parse will payload"));h.will.payload=d}if(g.username){if(f=this._parseString(),null===f)return this.emit("error",new Error("cannot parse username"));h.username=f}if(g.password){if(e=this._parseBuffer(),null===e)return this.emit("error",new Error("cannot parse username"));h.password=e}return h},d.prototype._parseConnack=function(){var a=this.packet;return this._list.length<2?null:(a.sessionPresent=!!(this._list.readUInt8(this._pos++)&i.SESSIONPRESENT_MASK),a.returnCode=this._list.readUInt8(this._pos),-1===a.returnCode?this.emit("error",new Error("cannot parse return code")):void 0)},d.prototype._parsePublish=function(){var a=this.packet;return a.topic=this._parseString(),null===a.topic?this.emit("error",new Error("cannot parse topic")):void(a.qos>0&&!this._parseMessageId()||(a.payload=this._list.slice(this._pos,a.length)))},d.prototype._parseSubscribe=function(){var a,b,c=this.packet;if(1!=c.qos)return this.emit("error",new Error("wrong subscribe header"));if(c.subscriptions=[],this._parseMessageId())for(;this._pos<c.length;){if(a=this._parseString(),null===a)return this.emit("error",new Error("Parse error - cannot parse topic"));b=this._list.readUInt8(this._pos++),c.subscriptions.push({topic:a,qos:b})}},d.prototype._parseSuback=function(){if(this.packet.granted=[],this._parseMessageId())for(;this._pos<this.packet.length;)this.packet.granted.push(this._list.readUInt8(this._pos++))},d.prototype._parseUnsubscribe=function(){var a=this.packet;if(a.unsubscriptions=[],this._parseMessageId())for(;this._pos<a.length;){var b;if(b=this._parseString(),null===b)return this.emit("error",new Error("cannot parse topic"));a.unsubscriptions.push(b)}},d.prototype._parseUnsuback=function(){return this._parseMessageId()?void 0:this.emit("error",new Error("cannot parse message id"))},d.prototype._parseMessageId=function(){var a=this.packet;return a.messageId=this._parseNum(),null===a.messageId?(this.emit("error",new Error("cannot parse message id")),!1):!0},d.prototype._parseString=function(a){var b,c=this._parseNum(),d=c+this._pos;return-1===c||d>this._list.length||d>this.packet.length?null:(b=this._list.toString("utf8",this._pos,d),this._pos+=c,b)},d.prototype._parseBuffer=function(){var a,b=this._parseNum(),c=b+this._pos;return-1===b||c>this._list.length||c>this.packet.length?null:(a=this._list.slice(this._pos,c),this._pos+=b,a)},d.prototype._parseNum=function(){if(this._list.length-this._pos<2)return-1;var a=this._list.readUInt16BE(this._pos);return this._pos+=2,a},b.exports=d},{"./constants":143,"./packet":146,bl:3,events:17,inherits:19}],148:[function(a,b,c){(function(c,d){"use strict";function e(){return"mqttjs_"+Math.random().toString(16).substr(2,8)}function f(a,b,c){try{var d=m.generate(b);!a.stream.write(d)&&c?a.stream.once("drain",c):c&&c()}catch(e){c?c(e):a.emit("error",e)}}function g(a,b,c){a.outgoingStore.put(b,function(d){return d?c&&c(d):void f(a,b,c)})}function h(){}function i(a,b){var c,d=this;if(!(this instanceof i))return new i(a,b);this.options=b||{};for(c in r)"undefined"==typeof this.options[c]?this.options[c]=r[c]:this.options[c]=b[c];this.options.clientId=this.options.clientId||e(),this.streamBuilder=a,this.outgoingStore=this.options.outgoingStore||new k,this.incomingStore=this.options.incomingStore||new k,this.queueQoSZero=null==this.options.queueQoSZero?!0:this.options.queueQoSZero,this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this.nextId=Math.floor(65535*Math.random()),this.outgoing={},this.on("connect",function(){this.connected=!0;var a=null;a=this.outgoingStore.createStream(),a.once("readable",function(){function b(){var c,e=a.read(1);e&&(!d.disconnecting&&!d.reconnectTimer&&0<d.options.reconnectPeriod?(a.read(0),c=d.outgoing[e.messageId],d.outgoing[e.messageId]=function(){c&&c(),b()},d._sendPacket(e)):a.destroy&&a.destroy())}b()}).on("error",this.emit.bind(this,"error"))}),this.on("close",function(){this.connected=!1,clearTimeout(this.connackTimer)}),this.on("connect",this._setupPingTimer),this.on("connect",function(){function a(){var c=b.shift(),e=null;c&&(e=c.packet,d._sendPacket(e,function(b){c.cb&&c.cb(b),a()}))}var b=this.queue;a()}),this.on("close",function(){null!==d.pingTimer&&(d.pingTimer.clear(),d.pingTimer=null)}),this.on("close",this._setupReconnect),j.EventEmitter.call(this),this._setupStream()}var j=a("events"),k=a("./store"),l=a("end-of-stream"),m=a("mqtt-packet"),n=a("readable-stream").Writable,o=a("inherits"),p=a("reinterval"),q=d.setImmediate||function(a){c.nextTick(a)},r={keepalive:10,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0};o(i,j.EventEmitter),i.prototype._setupStream=function(){function a(){var b=i.shift(),d=g;b?c._handlePacket(b,a):(g=null,d())}var b,c=this,d=new n,e=m.parser(this.options),g=null,i=[];this._clearReconnect(),this.stream=this.streamBuilder(this),e.on("packet",function(a){i.push(a)}),d._write=function(b,c,d){g=d,e.parse(b),a()},this.stream.pipe(d),this.stream.on("error",h),l(this.stream,this.emit.bind(this,"close")),b=Object.create(this.options),b.cmd="connect",f(this,b),e.on("error",this.emit.bind(this,"error")),this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(function(){c._cleanUp(!0)},this.options.connectTimeout)},i.prototype._handlePacket=function(a,b){switch(a.cmd){case"publish":this._handlePublish(a,b);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":this._handleAck(a),b();break;case"pubrel":this._handlePubrel(a,b);break;case"connack":this._handleConnack(a),b();break;case"pingresp":this._handlePingresp(a),b()}},i.prototype._checkDisconnecting=function(a){return this.disconnecting&&(a?a(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting},i.prototype.publish=function(a,b,c,d){var e;if("function"==typeof c&&(d=c,c=null),c||(c={qos:0,retain:!1}),this._checkDisconnecting(d))return this;switch(e={cmd:"publish",topic:a,payload:b,qos:c.qos,retain:c.retain,messageId:this._nextId()
},c.qos){case 1:case 2:this.outgoing[e.messageId]=d||h,this._sendPacket(e);break;default:this._sendPacket(e,d)}return this},i.prototype.subscribe=function(){var a,b=Array.prototype.slice.call(arguments),c=[],d=b.shift(),e=b.pop()||h,f=b.pop();return"string"==typeof d&&(d=[d]),"function"!=typeof e&&(f=e,e=h),this._checkDisconnecting(e)?this:(f||(f={qos:0}),Array.isArray(d)?d.forEach(function(a){c.push({topic:a,qos:f.qos})}):Object.keys(d).forEach(function(a){c.push({topic:a,qos:d[a]})}),a={cmd:"subscribe",subscriptions:c,qos:1,retain:!1,dup:!1,messageId:this._nextId()},this.outgoing[a.messageId]=e,this._sendPacket(a),this)},i.prototype.unsubscribe=function(a,b){var c={cmd:"unsubscribe",qos:1,messageId:this._nextId()};return b=b||h,this._checkDisconnecting(b)?this:("string"==typeof a?c.unsubscriptions=[a]:"object"==typeof a&&a.length&&(c.unsubscriptions=a),this.outgoing[c.messageId]=b,this._sendPacket(c),this)},i.prototype.end=function(a,b){function c(){e.incomingStore.close(function(){e.outgoingStore.close(b)})}function d(){e._cleanUp(a,c)}var e=this;return"function"==typeof a&&(b=a,a=!1),this.disconnecting?!0:(this.disconnecting=!0,!a&&0<Object.keys(this.outgoing).length?this.once("outgoingEmpty",setTimeout.bind(null,d,10)):d(),this)},i.prototype._reconnect=function(){this.emit("reconnect"),this._setupStream()},i.prototype._setupReconnect=function(){var a=this;!a.disconnecting&&!a.reconnectTimer&&0<a.options.reconnectPeriod&&(this.emit("offline"),a.reconnectTimer=setInterval(function(){a._reconnect()},a.options.reconnectPeriod))},i.prototype._clearReconnect=function(){this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=!1)},i.prototype._cleanUp=function(a,b){b&&this.stream.on("close",b),a?this.stream.destroy():this._sendPacket({cmd:"disconnect"},q.bind(null,this.stream.end.bind(this.stream))),this.reconnectTimer&&(this._clearReconnect(),this._setupReconnect()),null!==this.pingTimer&&(this.pingTimer.clear(),this.pingTimer=null)},i.prototype._sendPacket=function(a,b){if(!this.connected)return void(0<a.qos||"publish"!==a.cmd||this.queueQoSZero?this.queue.push({packet:a,cb:b}):b&&b(new Error("No connection to broker")));switch(this._shiftPingInterval(),a.qos){case 2:case 1:g(this,a,b);break;case 0:default:f(this,a,b)}},i.prototype._setupPingTimer=function(){var a=this;!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=p(function(){a._checkPing()},1e3*this.options.keepalive))},i.prototype._shiftPingInterval=function(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule(1e3*this.options.keepalive)},i.prototype._checkPing=function(){this.pingResp?(this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):this._cleanUp(!0)},i.prototype._handlePingresp=function(){this.pingResp=!0},i.prototype._handleConnack=function(a){var b=a.returnCode,c=["","Unacceptable protocol version","Identifier rejected","Server unavailable","Bad username or password","Not authorized"];clearTimeout(this.connackTimer),0===b?this.emit("connect",a):b>0&&this.emit("error",new Error("Connection refused: "+c[b]))},i.prototype._handlePublish=function(a,b){var c=a.topic.toString(),d=a.payload,e=a.qos,f=a.messageId,g=this;switch(e){case 2:this.incomingStore.put(a,function(){g._sendPacket({cmd:"pubrec",messageId:f},b)});break;case 1:this._sendPacket({cmd:"puback",messageId:f});case 0:this.emit("message",c,d,a),this.handleMessage(a,b)}},i.prototype.handleMessage=function(a,b){b()},i.prototype._handleAck=function(a){var b=a.messageId,c=a.cmd,d=null,e=this.outgoing[b],f=this;if(e){switch(c){case"pubcomp":case"puback":delete this.outgoing[b],this.outgoingStore.del(a,e);break;case"pubrec":d={cmd:"pubrel",qos:2,messageId:b},this._sendPacket(d);break;case"suback":delete this.outgoing[b],this.outgoingStore.del(a,function(b,c){var d,g=c.subscriptions,h=a.granted;if(b)return f.emit("error",b);for(d=0;d<h.length;d+=1)g[d].qos=h[d];e(null,g)});break;case"unsuback":delete this.outgoing[b],this.outgoingStore.del(a,e);break;default:f.emit("error",new Error("unrecognized packet type"))}this.disconnecting&&0===Object.keys(this.outgoing).length&&this.emit("outgoingEmpty")}},i.prototype._handlePubrel=function(a,b){var c=a.messageId,d=this;d.incomingStore.get(a,function(e,f){return e?d.emit("error",e):("pubrel"!==f.cmd&&(d.emit("message",f.topic,f.payload,f),d.incomingStore.put(a)),void d._sendPacket({cmd:"pubcomp",messageId:c},b))})},i.prototype._nextId=function(){var a=this.nextId++;return 65535===a&&(this.nextId=1),a},b.exports=i}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./store":153,_process:162,"end-of-stream":16,events:17,inherits:19,"mqtt-packet":145,"readable-stream":159,reinterval:177}],149:[function(a,b,c){(function(c){"use strict";function d(a){var b;a.auth&&(b=a.auth.match(/^(.+):(.+)$/),b?(a.username=b[1],a.password=b[2]):a.username=a.auth)}function e(a,b){function c(a){return b.servers&&(a._reconnectCount&&a._reconnectCount!==b.servers.length||(a._reconnectCount=0),b.host=b.servers[a._reconnectCount].host,b.port=b.servers[a._reconnectCount].port,b.hostname=b.host,a._reconnectCount++),i[b.protocol](a,b)}if("object"!=typeof a||b||(b=a,a=null),b=b||{},a&&(b=h(g.parse(a,!0),b),b.protocol=b.protocol.replace(/\:$/,"")),d(b),b.query&&"string"==typeof b.query.clientId&&(b.clientId=b.query.clientId),b.cert&&b.key){if(!b.protocol)throw new Error("Missing secure protocol key");if(-1===["mqtts","wss"].indexOf(b.protocol))switch(b.protocol){case"mqtt":b.protocol="mqtts";break;case"ws":b.protocol="wss";break;default:throw new Error('Unknown protocol for secure conenction: "'+b.protocol+'"!')}}if(i[b.protocol]||(b.protocol=j.filter(function(a){return"function"==typeof i[a]})[0]),!1===b.clean&&!b.clientId)throw new Error("Missing clientId for unclean clients");return new f(c,b)}var f=a("../client"),g=a("url"),h=a("xtend"),i={},j=[];"browser"!==c.title&&(i.mqtt=a("./tcp"),i.tcp=a("./tcp"),i.ssl=a("./tls"),i.tls=a("./tls"),i.mqtts=a("./tls")),i.ws=a("./ws"),i.wss=a("./ws"),j=["mqtt","mqtts","ws","wss"],b.exports=e,b.exports.connect=e}).call(this,a("_process"))},{"../client":148,"./tcp":150,"./tls":151,"./ws":152,_process:162,url:182,xtend:211}],150:[function(a,b,c){"use strict";function d(a,b){var c,d;return b.port=b.port||1883,b.hostname=b.hostname||b.host||"localhost",c=b.port,d=b.hostname,e.createConnection(c,d)}var e=a("net");b.exports=d},{net:8}],151:[function(a,b,c){"use strict";function d(a,b){function c(c){b.rejectUnauthorized&&a.emit("error",c),d.end()}var d;return b.port=b.port||8883,b.host=b.hostname||b.host||"localhost",b.rejectUnauthorized=!1!==b.rejectUnauthorized,d=e.connect(b),d.on("secureConnect",function(){b.rejectUnauthorized&&!d.authorized?d.emit("error",new Error("TLS not authorized")):d.removeListener("error",c)}),d.on("error",c),d}var e=a("tls");b.exports=d},{tls:8}],152:[function(a,b,c){(function(c){"use strict";function d(a,b){var c={protocol:"mqttv3.1"},d=b.hostname||"localhost",e=String(b.port||80),g=b.path||"/",i=b.protocol+"://"+d+":"+e+g;return"wss"===b.protocol&&h.forEach(function(a){b.hasOwnProperty(a)&&(c[a]=b[a])}),f(i,c)}function e(a,b){var c,d;if("undefined"==typeof document)throw new Error("Could not determine host. Specify host manually.");return d=g.parse(document.URL),b.protocol||("https:"===d.protocol?b.protocol="wss":b.protocol="ws"),b.hostname||(b.hostname=b.host),b.hostname||(b.hostname=d.hostname,b.port||(b.port=d.port)),b.port||("wss"===b.protocol?b.port=443:b.port=80),b.path||(b.path="/"),c=b.protocol+"://"+b.hostname+":"+b.port+b.path,f(c,"mqttv3.1")}var f=a("websocket-stream"),g=a("url"),h=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];"browser"!==c.title?b.exports=d:b.exports=e}).call(this,a("_process"))},{_process:162,url:182,"websocket-stream":187}],153:[function(a,b,c){(function(c){"use strict";function d(){return this instanceof d?void(this._inflights={}):new d}var e=a("readable-stream").Readable,f={objectMode:!0};d.prototype.put=function(a,b){return this._inflights[a.messageId]=a,b&&b(),this},d.prototype.createStream=function(){var a=new e(f),b=this._inflights,d=Object.keys(this._inflights),g=!1,h=0;return a._read=function(){!g&&h<d.length?this.push(b[d[h++]]):this.push(null)},a.destroy=function(){if(!g){var a=this;g=!0,c.nextTick(function(){a.emit("close")})}},a},d.prototype.del=function(a,b){return a=this._inflights[a.messageId],a?(delete this._inflights[a.messageId],b(null,a)):b&&b(new Error("missing packet")),this},d.prototype.get=function(a,b){return a=this._inflights[a.messageId],a?b(null,a):b&&b(new Error("missing packet")),this},d.prototype.close=function(a){this._inflights=null,a&&a()},b.exports=d}).call(this,a("_process"))},{_process:162,"readable-stream":159}],154:[function(a,b,c){(function(c){function d(a){return this instanceof d?(i.call(this,a),j.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||c.nextTick(this.end.bind(this))}function f(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}b.exports=d;var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},h=a("core-util-is");h.inherits=a("inherits");var i=a("./_stream_readable"),j=a("./_stream_writable");h.inherits(d,i),f(g(j.prototype),function(a){d.prototype[a]||(d.prototype[a]=j.prototype[a])})}).call(this,a("_process"))},{"./_stream_readable":156,"./_stream_writable":158,_process:162,"core-util-is":10,inherits:19}],155:[function(a,b,c){function d(a){return this instanceof d?void e.call(this,a):new d(a)}b.exports=d;var e=a("./_stream_transform"),f=a("core-util-is");f.inherits=a("inherits"),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":157,"core-util-is":10,inherits:19}],156:[function(a,b,c){(function(c){function d(b,c){b=b||{};var d=b.highWaterMark;this.highWaterMark=d||0===d?d:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!b.objectMode,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(C||(C=a("string_decoder/").StringDecoder),this.decoder=new C(b.encoding),this.encoding=b.encoding)}function e(a){return this instanceof e?(this._readableState=new d(a,this),this.readable=!0,void A.call(this)):new e(a)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(null===c||void 0===c)b.reading=!1,b.ended||k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else!b.decoder||e||d||(c=b.decoder.write(c)),b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):(b.reading=!1,b.buffer.push(c)),b.needReadable&&l(a),n(a,b);else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){if(a>=D)a=D;else{a--;for(var b=1;32>b;b<<=1)a|=a>>b;a++}return a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:null===a||isNaN(a)?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:0>=a?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return y.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(b.decoder&&!b.ended){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,b.length>0?l(a):u(a)}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(b.emittedReadable=!0,b.sync?c.nextTick(function(){m(a)}):m(a))}function m(a){a.emit("readable")}function n(a,b){b.readingMore||(b.readingMore=!0,c.nextTick(function(){o(a,b)}))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;b.awaitDrain--,0===b.awaitDrain&&q(a)}}function q(a){function b(a,b,e){var f=a.write(c);!1===f&&d.awaitDrain++}var c,d=a._readableState;for(d.awaitDrain=0;d.pipesCount&&null!==(c=a.read());)if(1===d.pipesCount?b(d.pipes,0,null):v(d.pipes,b),a.emit("data",c),d.awaitDrain>0)return;return 0===d.pipesCount?(d.flowing=!1,void(z.listenerCount(a,"data")>0&&s(a))):void(d.ranOut=!0)}function r(){this._readableState.ranOut&&(this._readableState.ranOut=!1,q(this))}function s(a,b){var d=a._readableState;if(d.flowing)throw new Error("Cannot switch to old mode now.");var e=b||!1,f=!1;a.readable=!0,a.pipe=A.prototype.pipe,a.on=a.addListener=A.prototype.on,a.on("readable",function(){f=!0;for(var b;!e&&null!==(b=a.read());)a.emit("data",b);null===b&&(f=!1,a._readableState.needReadable=!0)}),a.pause=function(){e=!0,this.emit("pause")},a.resume=function(){e=!1,f?c.nextTick(function(){a.emit("readable")}):this.read(0),this.emit("resume")},a.emit("readable")}function t(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):y.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new y(a);for(var i=0,j=0,k=d.length;k>j&&a>i;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function u(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");!b.endEmitted&&b.calledRead&&(b.ended=!0,c.nextTick(function(){b.endEmitted||0!==b.length||(b.endEmitted=!0,a.readable=!1,a.emit("end"))}))}function v(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}function w(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}b.exports=e;var x=a("isarray"),y=a("buffer").Buffer;e.ReadableState=d;var z=a("events").EventEmitter;z.listenerCount||(z.listenerCount=function(a,b){return a.listeners(b).length});var A=a("stream"),B=a("core-util-is");B.inherits=a("inherits");var C;B.inherits(e,A),e.prototype.push=function(a,b){var c=this._readableState;return"string"!=typeof a||c.objectMode||(b=b||c.defaultEncoding,b!==c.encoding&&(a=new y(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0)},e.prototype.setEncoding=function(b){C||(C=a("string_decoder/").StringDecoder),this._readableState.decoder=new C(b),this._readableState.encoding=b};var D=8388608;e.prototype.read=function(a){var b=this._readableState;b.calledRead=!0;var c,d=a;if(("number"!=typeof a||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return l(this),null;if(a=i(a,b),0===a&&b.ended)return c=null,b.length>0&&b.decoder&&(c=t(a,b),b.length-=c.length),0===b.length&&u(this),c;var e=b.needReadable;return b.length-a<=b.highWaterMark&&(e=!0),(b.ended||b.reading)&&(e=!1),e&&(b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),e&&!b.reading&&(a=i(d,b)),c=a>0?t(a,b):null,null===c&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),b.ended&&!b.endEmitted&&0===b.length&&u(this),c},e.prototype._read=function(a){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){a===k&&f()}function e(){a.end()}function f(){a.removeListener("close",h),a.removeListener("finish",i),a.removeListener("drain",o),a.removeListener("error",g),a.removeListener("unpipe",d),k.removeListener("end",e),k.removeListener("end",f),(!a._writableState||a._writableState.needDrain)&&o()}function g(b){j(),a.removeListener("error",g),0===z.listenerCount(a,"error")&&a.emit("error",b)}function h(){a.removeListener("finish",i),j()}function i(){a.removeListener("close",h),j()}function j(){k.unpipe(a)}var k=this,l=this._readableState;switch(l.pipesCount){case 0:l.pipes=a;break;case 1:l.pipes=[l.pipes,a];break;default:l.pipes.push(a)}l.pipesCount+=1;var m=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,n=m?e:f;l.endEmitted?c.nextTick(n):k.once("end",n),a.on("unpipe",d);var o=p(k);return a.on("drain",o),a._events&&a._events.error?x(a._events.error)?a._events.error.unshift(g):a._events.error=[g,a._events.error]:a.on("error",g),a.once("close",h),a.once("finish",i),a.emit("pipe",k),l.flowing||(this.on("readable",r),l.flowing=!0,c.nextTick(function(){q(k)})),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,this.removeListener("readable",r),b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,this.removeListener("readable",r),b.flowing=!1;for(var e=0;d>e;e++)c[e].emit("unpipe",this);return this}var e=w(b.pipes,a);return-1===e?this:(b.pipes.splice(e,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var c=A.prototype.on.call(this,a,b);if("data"!==a||this._readableState.flowing||s(this),"readable"===a&&this.readable){var d=this._readableState;d.readableListening||(d.readableListening=!0,d.emittedReadable=!1,d.needReadable=!0,d.reading?d.length&&l(this,d):this.read(0))}return c},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){s(this),this.read(0),this.emit("resume")},e.prototype.pause=function(){s(this,!0),this.emit("pause")},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(b.decoder&&(e=b.decoder.write(e)),(!b.objectMode||null!==e&&void 0!==e)&&(b.objectMode||e&&e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)"function"==typeof a[e]&&"undefined"==typeof this[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return v(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){c&&(c=!1,a.resume())},d},e._fromList=t}).call(this,a("_process"))},{_process:162,buffer:9,"core-util-is":10,events:17,inherits:19,isarray:22,stream:179,"string_decoder/":180}],157:[function(a,b,c){function d(a,b){this.afterTransform=function(a,c){return e(b,a,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e&&e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a);var b=(this._transformState=new d(a,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(a){g(b,a)}):g(b)})}function g(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=(a._readableState,a._transformState);if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./_stream_duplex"),i=a("core-util-is");i.inherits=a("inherits"),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;null!==b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0}},{"./_stream_duplex":154,"core-util-is":10,inherits:19}],158:[function(a,b,c){(function(c){function d(a,b,c){this.chunk=a,this.encoding=b,this.callback=c}function e(a,b){a=a||{};var c=a.highWaterMark;this.highWaterMark=c||0===c?c:16384,this.objectMode=!!a.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var d=a.decodeStrings===!1;this.decodeStrings=!d,this.defaultEncoding=a.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){n(b,a)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function f(b){var c=a("./_stream_duplex");return this instanceof f||this instanceof c?(this._writableState=new e(b,this),this.writable=!0,void w.call(this)):new f(b)}function g(a,b,d){var e=new Error("write after end");a.emit("error",e),c.nextTick(function(){d(e)})}function h(a,b,d,e){var f=!0;if(!u.isBuffer(d)&&"string"!=typeof d&&null!==d&&void 0!==d&&!b.objectMode){var g=new TypeError("Invalid non-string/buffer chunk");a.emit("error",g),c.nextTick(function(){e(g)}),f=!1}return f}function i(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=new u(b,c)),b}function j(a,b,c,e,f){c=i(b,c,e),u.isBuffer(c)&&(e="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;return h||(b.needDrain=!0),b.writing?b.buffer.push(new d(c,e,f)):k(a,b,g,c,e,f),h}function k(a,b,c,d,e,f){b.writelen=c,b.writecb=f,b.writing=!0,b.sync=!0,a._write(d,e,b.onwrite),b.sync=!1}function l(a,b,d,e,f){d?c.nextTick(function(){f(e)}):f(e),a._writableState.errorEmitted=!0,a.emit("error",e)}function m(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function n(a,b){var d=a._writableState,e=d.sync,f=d.writecb;if(m(d),b)l(a,d,e,b,f);else{var g=r(a,d);g||d.bufferProcessing||!d.buffer.length||q(a,d),e?c.nextTick(function(){o(a,d,g,f)}):o(a,d,g,f)}}function o(a,b,c,d){c||p(a,b),d(),c&&s(a,b)}function p(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function q(a,b){b.bufferProcessing=!0;for(var c=0;c<b.buffer.length;c++){var d=b.buffer[c],e=d.chunk,f=d.encoding,g=d.callback,h=b.objectMode?1:e.length;if(k(a,b,h,e,f,g),b.writing){c++;break}}b.bufferProcessing=!1,c<b.buffer.length?b.buffer=b.buffer.slice(c):b.buffer.length=0}function r(a,b){return b.ending&&0===b.length&&!b.finished&&!b.writing}function s(a,b){var c=r(a,b);return c&&(b.finished=!0,a.emit("finish")),c}function t(a,b,d){b.ending=!0,s(a,b),d&&(b.finished?c.nextTick(d):a.once("finish",d)),b.ended=!0}b.exports=f;var u=a("buffer").Buffer;f.WritableState=e;var v=a("core-util-is");v.inherits=a("inherits");var w=a("stream");v.inherits(f,w),f.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},f.prototype.write=function(a,b,c){var d=this._writableState,e=!1;return"function"==typeof b&&(c=b,b=null),u.isBuffer(a)?b="buffer":b||(b=d.defaultEncoding),"function"!=typeof c&&(c=function(){}),d.ended?g(this,d,c):h(this,d,a,c)&&(e=j(this,d,a,b,c)),e},f.prototype._write=function(a,b,c){c(new Error("not implemented"))},f.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),"undefined"!=typeof a&&null!==a&&this.write(a,b),d.ending||d.finished||t(this,d,c)}}).call(this,a("_process"))},{"./_stream_duplex":154,_process:162,buffer:9,"core-util-is":10,inherits:19,stream:179}],159:[function(a,b,c){(function(d){var e=a("stream");c=b.exports=a("./lib/_stream_readable.js"),c.Stream=e,c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js"),d.browser||"disable"!==d.env.READABLE_STREAM||(b.exports=a("stream"))}).call(this,a("_process"))},{"./lib/_stream_duplex.js":154,"./lib/_stream_passthrough.js":155,"./lib/_stream_readable.js":156,"./lib/_stream_transform.js":157,"./lib/_stream_writable.js":158,_process:162,stream:179}],160:[function(a,b,c){function d(a){var b=function(){return b.called?b.value:(b.called=!0,b.value=a.apply(this,arguments))};return b.called=!1,b}var e=a("wrappy");b.exports=e(d),d.proto=d(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return d(this)},configurable:!0})})},{wrappy:190}],161:[function(a,b,c){(function(a){"use strict";function c(b){for(var c=new Array(arguments.length-1),d=0;d<c.length;)c[d++]=arguments[d];a.nextTick(function(){b.apply(null,c)})}b.exports=c}).call(this,a("_process"))},{_process:162}],162:[function(a,b,c){function d(){k=!1,h.length?j=h.concat(j):l=-1,j.length&&e()}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h&&h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],163:[function(a,c,d){(function(a){!function(e){function f(a){throw RangeError(I[a])}function g(a,b){for(var c=a.length,d=[];c--;)d[c]=b(a[c]);return d}function h(a,b){var c=a.split("@"),d="";c.length>1&&(d=c[0]+"@",a=c[1]),a=a.replace(H,".");var e=a.split("."),f=g(e,b).join(".");return d+f}function i(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function j(a){return g(a,function(a){var b="";return a>65535&&(a-=65536,b+=L(a>>>10&1023|55296),a=56320|1023&a),b+=L(a)}).join("")}function k(a){return 10>a-48?a-22:26>a-65?a-65:26>a-97?a-97:x}function l(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function m(a,b,c){var d=0;for(a=c?K(a/B):a>>1,a+=K(a/b);a>J*z>>1;d+=x)a=K(a/J);return K(d+(J+1)*a/(a+A))}function n(a){var b,c,d,e,g,h,i,l,n,o,p=[],q=a.length,r=0,s=D,t=C;for(c=a.lastIndexOf(E),0>c&&(c=0),d=0;c>d;++d)a.charCodeAt(d)>=128&&f("not-basic"),p.push(a.charCodeAt(d));for(e=c>0?c+1:0;q>e;){for(g=r,h=1,i=x;e>=q&&f("invalid-input"),l=k(a.charCodeAt(e++)),(l>=x||l>K((w-r)/h))&&f("overflow"),r+=l*h,n=t>=i?y:i>=t+z?z:i-t,!(n>l);i+=x)o=x-n,h>K(w/o)&&f("overflow"),h*=o;b=p.length+1,t=m(r-g,b,0==g),K(r/b)>w-s&&f("overflow"),s+=K(r/b),r%=b,p.splice(r++,0,s)}return j(p)}function o(a){var b,c,d,e,g,h,j,k,n,o,p,q,r,s,t,u=[];for(a=i(a),q=a.length,b=D,c=0,g=C,h=0;q>h;++h)p=a[h],128>p&&u.push(L(p));for(d=e=u.length,e&&u.push(E);q>d;){for(j=w,h=0;q>h;++h)p=a[h],p>=b&&j>p&&(j=p);for(r=d+1,j-b>K((w-c)/r)&&f("overflow"),c+=(j-b)*r,b=j,h=0;q>h;++h)if(p=a[h],b>p&&++c>w&&f("overflow"),p==b){for(k=c,n=x;o=g>=n?y:n>=g+z?z:n-g,!(o>k);n+=x)t=k-o,s=x-o,u.push(L(l(o+t%s,0))),k=K(t/s);u.push(L(l(k,0))),g=m(c,r,d==e),c=0,++d}++c,++b}return u.join("")}function p(a){return h(a,function(a){return F.test(a)?n(a.slice(4).toLowerCase()):a})}function q(a){return h(a,function(a){return G.test(a)?"xn--"+o(a):a})}var r="object"==typeof d&&d&&!d.nodeType&&d,s="object"==typeof c&&c&&!c.nodeType&&c,t="object"==typeof a&&a;(t.global===t||t.window===t||t.self===t)&&(e=t);var u,v,w=2147483647,x=36,y=1,z=26,A=38,B=700,C=72,D=128,E="-",F=/^xn--/,G=/[^\x20-\x7E]/,H=/[\x2E\u3002\uFF0E\uFF61]/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},J=x-y,K=Math.floor,L=String.fromCharCode;if(u={version:"1.3.2",ucs2:{decode:i,encode:j},decode:n,encode:o,toASCII:q,toUnicode:p},"function"==typeof b&&"object"==typeof b.amd&&b.amd)b("punycode",function(){return u});else if(r&&s)if(c.exports==r)s.exports=u;else for(v in u)u.hasOwnProperty(v)&&(r[v]=u[v]);else e.punycode=u}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],164:[function(a,b,c){"use strict";function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,c,f){b=b||"&",c=c||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;j>k;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(c);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),d(g,n)?e(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],165:[function(a,b,c){"use strict";function d(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var e=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,c,h){return b=b||"&",c=c||"=",null===a&&(a=void 0),"object"==typeof a?d(g(a),function(g){var h=encodeURIComponent(e(g))+c;return f(a[g])?d(a[g],function(a){return h+encodeURIComponent(e(a))}).join(b):h+encodeURIComponent(e(a[g]))}).join(b):h?encodeURIComponent(e(h))+c+encodeURIComponent(e(a)):""};var f=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],166:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":164,"./encode":165}],167:[function(a,b,c){arguments[4][4][0].apply(c,arguments)},{"./lib/_stream_duplex.js":168,dup:4}],168:[function(a,b,c){"use strict";function d(a){return this instanceof d?(j.call(this,a),k.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||h(f,this)}function f(a){a.end()}var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b};b.exports=d;var h=a("process-nextick-args"),i=a("core-util-is");i.inherits=a("inherits");var j=a("./_stream_readable"),k=a("./_stream_writable");i.inherits(d,j);for(var l=g(k.prototype),m=0;m<l.length;m++){var n=l[m];d.prototype[n]||(d.prototype[n]=k.prototype[n])}},{"./_stream_readable":170,"./_stream_writable":172,"core-util-is":10,inherits:19,"process-nextick-args":161}],169:[function(a,b,c){"use strict";function d(a){return this instanceof d?void e.call(this,a):new d(a)}b.exports=d;var e=a("./_stream_transform"),f=a("core-util-is");f.inherits=a("inherits"),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":171,"core-util-is":10,inherits:19}],170:[function(a,b,c){(function(c){"use strict";function d(b,c){var d=a("./_stream_duplex");b=b||{},this.objectMode=!!b.objectMode,c instanceof d&&(this.objectMode=this.objectMode||!!b.readableObjectMode);var e=b.highWaterMark,f=this.objectMode?16:16384;this.highWaterMark=e||0===e?e:f,this.highWaterMark=~~this.highWaterMark,this.buffer=[],
this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(G||(G=a("string_decoder/").StringDecoder),this.decoder=new G(b.encoding),this.encoding=b.encoding)}function e(b){a("./_stream_duplex");return this instanceof e?(this._readableState=new d(b,this),this.readable=!0,b&&"function"==typeof b.read&&(this._read=b.read),void D.call(this)):new e(b)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(null===c)b.reading=!1,k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else!b.decoder||e||d||(c=b.decoder.write(c)),e||(b.reading=!1),b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&l(a)),n(a,b);else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){if(a>=H)a=H;else{a--;for(var b=1;32>b;b<<=1)a|=a>>b;a++}return a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:null===a||isNaN(a)?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:0>=a?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return B.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(!b.ended){if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,l(a)}}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(F("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?z(m,a):m(a))}function m(a){F("emit readable"),a.emit("readable"),t(a)}function n(a,b){b.readingMore||(b.readingMore=!0,z(o,a,b))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(F("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;F("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&C.listenerCount(a,"data")&&(b.flowing=!0,t(a))}}function q(a){F("readable nexttick read 0"),a.read(0)}function r(a,b){b.resumeScheduled||(b.resumeScheduled=!0,z(s,a,b))}function s(a,b){b.reading||(F("resume read 0"),a.read(0)),b.resumeScheduled=!1,a.emit("resume"),t(a),b.flowing&&!b.reading&&a.read(0)}function t(a){var b=a._readableState;if(F("flow",b.flowing),b.flowing)do var c=a.read();while(null!==c&&b.flowing)}function u(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):B.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new B(a);for(var i=0,j=0,k=d.length;k>j&&a>i;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function v(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");b.endEmitted||(b.ended=!0,z(w,b,a))}function w(a,b){a.endEmitted||0!==a.length||(a.endEmitted=!0,b.readable=!1,b.emit("end"))}function x(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}function y(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}b.exports=e;var z=a("process-nextick-args"),A=a("isarray"),B=a("buffer").Buffer;e.ReadableState=d;var C=a("events").EventEmitter;C.listenerCount||(C.listenerCount=function(a,b){return a.listeners(b).length});var D;!function(){try{D=a("stream")}catch(b){}finally{D||(D=a("events").EventEmitter)}}();var B=a("buffer").Buffer,E=a("core-util-is");E.inherits=a("inherits");var F=a("util");F=F&&F.debuglog?F.debuglog("stream"):function(){};var G;E.inherits(e,D),e.prototype.push=function(a,b){var c=this._readableState;return c.objectMode||"string"!=typeof a||(b=b||c.defaultEncoding,b!==c.encoding&&(a=new B(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0)},e.prototype.isPaused=function(){return this._readableState.flowing===!1},e.prototype.setEncoding=function(b){return G||(G=a("string_decoder/").StringDecoder),this._readableState.decoder=new G(b),this._readableState.encoding=b,this};var H=8388608;e.prototype.read=function(a){F("read",a);var b=this._readableState,c=a;if(("number"!=typeof a||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return F("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?v(this):l(this),null;if(a=i(a,b),0===a&&b.ended)return 0===b.length&&v(this),null;var d=b.needReadable;F("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,F("length less than watermark",d)),(b.ended||b.reading)&&(d=!1,F("reading or ended",d)),d&&(F("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),d&&!b.reading&&(a=i(c,b));var e;return e=a>0?u(a,b):null,null===e&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),c!==a&&b.ended&&0===b.length&&v(this),null!==e&&this.emit("data",e),e},e.prototype._read=function(a){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){F("onunpipe"),a===l&&f()}function e(){F("onend"),a.end()}function f(){F("cleanup"),a.removeListener("close",i),a.removeListener("finish",j),a.removeListener("drain",q),a.removeListener("error",h),a.removeListener("unpipe",d),l.removeListener("end",e),l.removeListener("end",f),l.removeListener("data",g),!m.awaitDrain||a._writableState&&!a._writableState.needDrain||q()}function g(b){F("ondata");var c=a.write(b);!1===c&&(F("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,l.pause())}function h(b){F("onerror",b),k(),a.removeListener("error",h),0===C.listenerCount(a,"error")&&a.emit("error",b)}function i(){a.removeListener("finish",j),k()}function j(){F("onfinish"),a.removeListener("close",i),k()}function k(){F("unpipe"),l.unpipe(a)}var l=this,m=this._readableState;switch(m.pipesCount){case 0:m.pipes=a;break;case 1:m.pipes=[m.pipes,a];break;default:m.pipes.push(a)}m.pipesCount+=1,F("pipe count=%d opts=%j",m.pipesCount,b);var n=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,o=n?e:f;m.endEmitted?z(o):l.once("end",o),a.on("unpipe",d);var q=p(l);return a.on("drain",q),l.on("data",g),a._events&&a._events.error?A(a._events.error)?a._events.error.unshift(h):a._events.error=[h,a._events.error]:a.on("error",h),a.once("close",i),a.once("finish",j),a.emit("pipe",l),m.flowing||(F("pipe resume"),l.resume()),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var e=0;d>e;e++)c[e].emit("unpipe",this);return this}var e=y(b.pipes,a);return-1===e?this:(b.pipes.splice(e,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var c=D.prototype.on.call(this,a,b);if("data"===a&&!1!==this._readableState.flowing&&this.resume(),"readable"===a&&this.readable){var d=this._readableState;d.readableListening||(d.readableListening=!0,d.emittedReadable=!1,d.needReadable=!0,d.reading?d.length&&l(this,d):z(q,this))}return c},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){var a=this._readableState;return a.flowing||(F("resume"),a.flowing=!0,r(this,a)),this},e.prototype.pause=function(){return F("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(F("pause"),this._readableState.flowing=!1,this.emit("pause")),this},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(F("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(F("wrapped data"),b.decoder&&(e=b.decoder.write(e)),(!b.objectMode||null!==e&&void 0!==e)&&(b.objectMode||e&&e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)void 0===this[e]&&"function"==typeof a[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return x(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){F("wrapped _read",b),c&&(c=!1,a.resume())},d},e._fromList=u}).call(this,a("_process"))},{"./_stream_duplex":168,_process:162,buffer:9,"core-util-is":10,events:17,inherits:19,isarray:22,"process-nextick-args":161,"string_decoder/":180,util:8}],171:[function(a,b,c){"use strict";function d(a){this.afterTransform=function(b,c){return e(a,b,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e&&e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a),this._transformState=new d(this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,a&&("function"==typeof a.transform&&(this._transform=a.transform),"function"==typeof a.flush&&(this._flush=a.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(a){g(b,a)}):g(b)})}function g(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=a._transformState;if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./_stream_duplex"),i=a("core-util-is");i.inherits=a("inherits"),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;null!==b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0}},{"./_stream_duplex":168,"core-util-is":10,inherits:19}],172:[function(a,b,c){"use strict";function d(){}function e(a,b,c){this.chunk=a,this.encoding=b,this.callback=c,this.next=null}function f(b,c){var d=a("./_stream_duplex");b=b||{},this.objectMode=!!b.objectMode,c instanceof d&&(this.objectMode=this.objectMode||!!b.writableObjectMode);var e=b.highWaterMark,f=this.objectMode?16:16384;this.highWaterMark=e||0===e?e:f,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var g=b.decodeStrings===!1;this.decodeStrings=!g,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){o(c,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function g(b){var c=a("./_stream_duplex");return this instanceof g||this instanceof c?(this._writableState=new f(b,this),this.writable=!0,b&&("function"==typeof b.write&&(this._write=b.write),"function"==typeof b.writev&&(this._writev=b.writev)),void z.call(this)):new g(b)}function h(a,b){var c=new Error("write after end");a.emit("error",c),w(b,c)}function i(a,b,c,d){var e=!0;if(!x.isBuffer(c)&&"string"!=typeof c&&null!==c&&void 0!==c&&!b.objectMode){var f=new TypeError("Invalid non-string/buffer chunk");a.emit("error",f),w(d,f),e=!1}return e}function j(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=new x(b,c)),b}function k(a,b,c,d,f){c=j(b,c,d),x.isBuffer(c)&&(d="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;if(h||(b.needDrain=!0),b.writing||b.corked){var i=b.lastBufferedRequest;b.lastBufferedRequest=new e(c,d,f),i?i.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest}else l(a,b,!1,g,c,d,f);return h}function l(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function m(a,b,c,d,e){--b.pendingcb,c?w(e,d):e(d),a._writableState.errorEmitted=!0,a.emit("error",d)}function n(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function o(a,b){var c=a._writableState,d=c.sync,e=c.writecb;if(n(c),b)m(a,c,d,b,e);else{var f=s(c);f||c.corked||c.bufferProcessing||!c.bufferedRequest||r(a,c),d?w(p,a,c,f,e):p(a,c,f,e)}}function p(a,b,c,d){c||q(a,b),b.pendingcb--,d(),u(a,b)}function q(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function r(a,b){b.bufferProcessing=!0;var c=b.bufferedRequest;if(a._writev&&c&&c.next){for(var d=[],e=[];c;)e.push(c.callback),d.push(c),c=c.next;b.pendingcb++,b.lastBufferedRequest=null,l(a,b,!0,b.length,d,"",function(a){for(var c=0;c<e.length;c++)b.pendingcb--,e[c](a)})}else{for(;c;){var f=c.chunk,g=c.encoding,h=c.callback,i=b.objectMode?1:f.length;if(l(a,b,!1,i,f,g,h),c=c.next,b.writing)break}null===c&&(b.lastBufferedRequest=null)}b.bufferedRequest=c,b.bufferProcessing=!1}function s(a){return a.ending&&0===a.length&&null===a.bufferedRequest&&!a.finished&&!a.writing}function t(a,b){b.prefinished||(b.prefinished=!0,a.emit("prefinish"))}function u(a,b){var c=s(b);return c&&(0===b.pendingcb?(t(a,b),b.finished=!0,a.emit("finish")):t(a,b)),c}function v(a,b,c){b.ending=!0,u(a,b),c&&(b.finished?w(c):a.once("finish",c)),b.ended=!0}b.exports=g;var w=a("process-nextick-args"),x=a("buffer").Buffer;g.WritableState=f;var y=a("core-util-is");y.inherits=a("inherits");var z;!function(){try{z=a("stream")}catch(b){}finally{z||(z=a("events").EventEmitter)}}();var x=a("buffer").Buffer;y.inherits(g,z),f.prototype.getBuffer=function(){for(var a=this.bufferedRequest,b=[];a;)b.push(a),a=a.next;return b},function(){try{Object.defineProperty(f.prototype,"buffer",{get:a("util-deprecate")(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer() instead.")})}catch(b){}}(),g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},g.prototype.write=function(a,b,c){var e=this._writableState,f=!1;return"function"==typeof b&&(c=b,b=null),x.isBuffer(a)?b="buffer":b||(b=e.defaultEncoding),"function"!=typeof c&&(c=d),e.ended?h(this,c):i(this,e,a,c)&&(e.pendingcb++,f=k(this,e,a,b,c)),f},g.prototype.cork=function(){var a=this._writableState;a.corked++},g.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.bufferedRequest||r(this,a))},g.prototype.setDefaultEncoding=function(a){if("string"==typeof a&&(a=a.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+a);this._writableState.defaultEncoding=a},g.prototype._write=function(a,b,c){c(new Error("not implemented"))},g.prototype._writev=null,g.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),null!==a&&void 0!==a&&this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||v(this,d,c)}},{"./_stream_duplex":168,buffer:9,"core-util-is":10,events:17,inherits:19,"process-nextick-args":161,"util-deprecate":183}],173:[function(a,b,c){b.exports=a("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":169}],174:[function(a,b,c){var d=function(){try{return a("stream")}catch(b){}}();c=b.exports=a("./lib/_stream_readable.js"),c.Stream=d||c,c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":168,"./lib/_stream_passthrough.js":169,"./lib/_stream_readable.js":170,"./lib/_stream_transform.js":171,"./lib/_stream_writable.js":172}],175:[function(a,b,c){b.exports=a("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":171}],176:[function(a,b,c){b.exports=a("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":172}],177:[function(a,b,c){"use strict";function d(a,b,c){var d=this;this._callback=a,this._args=c,this._interval=setInterval(a,b,this._args),this.reschedule=function(a){Date.now();d._interval&&clearInterval(d._interval),d._interval=setInterval(d._callback,a,d._args)},this.clear=function(){d._interval&&(clearInterval(d._interval),d._interval=void 0,d._callback=void 0,d._args=void 0)}}function e(){if("function"!=typeof arguments[0])throw new Error("callback needed");if("number"!=typeof arguments[1])throw new Error("interval needed");var a;if(arguments.length>0){a=new Array(arguments.length-2);for(var b=0;b<a.length;b++)a[b]=arguments[b+2]}return new d(arguments[0],arguments[1],a)}b.exports=e},{}],178:[function(a,b,c){(function(b){!function(c){function d(a,b){if(!(this instanceof d))return new d(a,b);var e=this;f(e),e.q=e.c="",e.bufferCheckPosition=c.MAX_BUFFER_LENGTH,e.opt=b||{},e.opt.lowercase=e.opt.lowercase||e.opt.lowercasetags,e.looseCase=e.opt.lowercase?"toLowerCase":"toUpperCase",e.tags=[],e.closed=e.closedRoot=e.sawRoot=!1,e.tag=e.error=null,e.strict=!!a,e.noscript=!(!a&&!e.opt.noscript),e.state=V.BEGIN,e.strictEntities=e.opt.strictEntities,e.ENTITIES=e.strictEntities?Object.create(c.XML_ENTITIES):Object.create(c.ENTITIES),e.attribList=[],e.opt.xmlns&&(e.ns=Object.create(Q)),e.trackPosition=e.opt.position!==!1,e.trackPosition&&(e.position=e.line=e.column=0),n(e,"onready")}function e(a){for(var b=Math.max(c.MAX_BUFFER_LENGTH,10),d=0,e=0,f=D.length;f>e;e++){var g=a[D[e]].length;if(g>b)switch(D[e]){case"textNode":p(a);break;case"cdata":o(a,"oncdata",a.cdata),a.cdata="";break;case"script":o(a,"onscript",a.script),a.script="";break;default:r(a,"Max buffer length exceeded: "+D[e])}d=Math.max(d,g)}var h=c.MAX_BUFFER_LENGTH-d;a.bufferCheckPosition=h+a.position}function f(a){for(var b=0,c=D.length;c>b;b++)a[D[b]]=""}function g(a){p(a),""!==a.cdata&&(o(a,"oncdata",a.cdata),a.cdata=""),""!==a.script&&(o(a,"onscript",a.script),a.script="")}function h(a,b){return new i(a,b)}function i(a,b){if(!(this instanceof i))return new i(a,b);E.apply(this),this._parser=new d(a,b),this.writable=!0,this.readable=!0;var c=this;this._parser.onend=function(){c.emit("end")},this._parser.onerror=function(a){c.emit("error",a),c._parser.error=null},this._decoder=null,G.forEach(function(a){Object.defineProperty(c,"on"+a,{get:function(){return c._parser["on"+a]},set:function(b){return b?void c.on(a,b):(c.removeAllListeners(a),c._parser["on"+a]=b,b)},enumerable:!0,configurable:!1})})}function j(a){return a.split("").reduce(function(a,b){return a[b]=!0,a},{})}function k(a){return"[object RegExp]"===Object.prototype.toString.call(a)}function l(a,b){return k(a)?!!b.match(a):a[b]}function m(a,b){return!l(a,b)}function n(a,b,c){a[b]&&a[b](c)}function o(a,b,c){a.textNode&&p(a),n(a,b,c)}function p(a){a.textNode=q(a.opt,a.textNode),a.textNode&&n(a,"ontext",a.textNode),a.textNode=""}function q(a,b){return a.trim&&(b=b.trim()),a.normalize&&(b=b.replace(/\s+/g," ")),b}function r(a,b){return p(a),a.trackPosition&&(b+="\nLine: "+a.line+"\nColumn: "+a.column+"\nChar: "+a.c),b=new Error(b),a.error=b,n(a,"onerror",b),a}function s(a){return a.sawRoot&&!a.closedRoot&&t(a,"Unclosed root tag"),a.state!==V.BEGIN&&a.state!==V.BEGIN_WHITESPACE&&a.state!==V.TEXT&&r(a,"Unexpected end"),p(a),a.c="",a.closed=!0,n(a,"onend"),d.call(a,a.strict,a.opt),a}function t(a,b){if("object"!=typeof a||!(a instanceof d))throw new Error("bad call to strictFail");a.strict&&r(a,b)}function u(a){a.strict||(a.tagName=a.tagName[a.looseCase]());var b=a.tags[a.tags.length-1]||a,c=a.tag={name:a.tagName,attributes:{}};a.opt.xmlns&&(c.ns=b.ns),a.attribList.length=0,o(a,"onopentagstart",c)}function v(a,b){var c=a.indexOf(":"),d=0>c?["",a]:a.split(":"),e=d[0],f=d[1];return b&&"xmlns"===a&&(e="xmlns",f=""),{prefix:e,local:f}}function w(a){if(a.strict||(a.attribName=a.attribName[a.looseCase]()),-1!==a.attribList.indexOf(a.attribName)||a.tag.attributes.hasOwnProperty(a.attribName))return void(a.attribName=a.attribValue="");if(a.opt.xmlns){var b=v(a.attribName,!0),c=b.prefix,d=b.local;if("xmlns"===c)if("xml"===d&&a.attribValue!==O)t(a,"xml: prefix must be bound to "+O+"\nActual: "+a.attribValue);else if("xmlns"===d&&a.attribValue!==P)t(a,"xmlns: prefix must be bound to "+P+"\nActual: "+a.attribValue);else{var e=a.tag,f=a.tags[a.tags.length-1]||a;e.ns===f.ns&&(e.ns=Object.create(f.ns)),e.ns[d]=a.attribValue}a.attribList.push([a.attribName,a.attribValue])}else a.tag.attributes[a.attribName]=a.attribValue,o(a,"onattribute",{name:a.attribName,value:a.attribValue});a.attribName=a.attribValue=""}function x(a,b){if(a.opt.xmlns){var c=a.tag,d=v(a.tagName);c.prefix=d.prefix,c.local=d.local,c.uri=c.ns[d.prefix]||"",c.prefix&&!c.uri&&(t(a,"Unbound namespace prefix: "+JSON.stringify(a.tagName)),c.uri=d.prefix);var e=a.tags[a.tags.length-1]||a;c.ns&&e.ns!==c.ns&&Object.keys(c.ns).forEach(function(b){o(a,"onopennamespace",{prefix:b,uri:c.ns[b]})});for(var f=0,g=a.attribList.length;g>f;f++){var h=a.attribList[f],i=h[0],j=h[1],k=v(i,!0),l=k.prefix,m=k.local,n=""===l?"":c.ns[l]||"",p={name:i,value:j,prefix:l,local:m,uri:n};l&&"xmlns"!==l&&!n&&(t(a,"Unbound namespace prefix: "+JSON.stringify(l)),p.uri=l),a.tag.attributes[i]=p,o(a,"onattribute",p)}a.attribList.length=0}a.tag.isSelfClosing=!!b,a.sawRoot=!0,a.tags.push(a.tag),o(a,"onopentag",a.tag),b||(a.noscript||"script"!==a.tagName.toLowerCase()?a.state=V.TEXT:a.state=V.SCRIPT,a.tag=null,a.tagName=""),a.attribName=a.attribValue="",a.attribList.length=0}function y(a){if(!a.tagName)return t(a,"Weird empty close tag."),a.textNode+="</>",void(a.state=V.TEXT);if(a.script){if("script"!==a.tagName)return a.script+="</"+a.tagName+">",a.tagName="",void(a.state=V.SCRIPT);o(a,"onscript",a.script),a.script=""}var b=a.tags.length,c=a.tagName;a.strict||(c=c[a.looseCase]());for(var d=c;b--;){var e=a.tags[b];if(e.name===d)break;t(a,"Unexpected close tag")}if(0>b)return t(a,"Unmatched closing tag: "+a.tagName),a.textNode+="</"+a.tagName+">",void(a.state=V.TEXT);a.tagName=c;for(var f=a.tags.length;f-- >b;){var g=a.tag=a.tags.pop();a.tagName=a.tag.name,o(a,"onclosetag",a.tagName);var h={};for(var i in g.ns)h[i]=g.ns[i];var j=a.tags[a.tags.length-1]||a;a.opt.xmlns&&g.ns!==j.ns&&Object.keys(g.ns).forEach(function(b){var c=g.ns[b];o(a,"onclosenamespace",{prefix:b,uri:c})})}0===b&&(a.closedRoot=!0),a.tagName=a.attribValue=a.attribName="",a.attribList.length=0,a.state=V.TEXT}function z(a){var b,c=a.entity,d=c.toLowerCase(),e="";return a.ENTITIES[c]?a.ENTITIES[c]:a.ENTITIES[d]?a.ENTITIES[d]:(c=d,"#"===c.charAt(0)&&("x"===c.charAt(1)?(c=c.slice(2),b=parseInt(c,16),e=b.toString(16)):(c=c.slice(1),b=parseInt(c,10),e=b.toString(10))),c=c.replace(/^0+/,""),e.toLowerCase()!==c?(t(a,"Invalid character entity"),"&"+a.entity+";"):String.fromCodePoint(b))}function A(a,b){"<"===b?(a.state=V.OPEN_WAKA,a.startTagPosition=a.position):m(H,b)&&(t(a,"Non-whitespace before first tag."),a.textNode=b,a.state=V.TEXT)}function B(a,b){var c="";return b<a.length&&(c=a.charAt(b)),c}function C(a){var b=this;if(this.error)throw this.error;if(b.closed)return r(b,"Cannot write after close. Assign an onready handler.");if(null===a)return s(b);"object"==typeof a&&(a=a.toString());for(var c=0,d="";;){if(d=B(a,c++),b.c=d,!d)break;switch(b.trackPosition&&(b.position++,"\n"===d?(b.line++,b.column=0):b.column++),b.state){case V.BEGIN:if(b.state=V.BEGIN_WHITESPACE,"\ufeff"===d)continue;A(b,d);continue;case V.BEGIN_WHITESPACE:A(b,d);continue;case V.TEXT:if(b.sawRoot&&!b.closedRoot){for(var f=c-1;d&&"<"!==d&&"&"!==d;)d=B(a,c++),d&&b.trackPosition&&(b.position++,"\n"===d?(b.line++,b.column=0):b.column++);b.textNode+=a.substring(f,c-1)}"<"!==d||b.sawRoot&&b.closedRoot&&!b.strict?(!m(H,d)||b.sawRoot&&!b.closedRoot||t(b,"Text data outside of root node."),"&"===d?b.state=V.TEXT_ENTITY:b.textNode+=d):(b.state=V.OPEN_WAKA,b.startTagPosition=b.position);continue;case V.SCRIPT:"<"===d?b.state=V.SCRIPT_ENDING:b.script+=d;continue;case V.SCRIPT_ENDING:"/"===d?b.state=V.CLOSE_TAG:(b.script+="<"+d,b.state=V.SCRIPT);continue;case V.OPEN_WAKA:if("!"===d)b.state=V.SGML_DECL,b.sgmlDecl="";else if(l(H,d));else if(l(R,d))b.state=V.OPEN_TAG,b.tagName=d;else if("/"===d)b.state=V.CLOSE_TAG,b.tagName="";else if("?"===d)b.state=V.PROC_INST,b.procInstName=b.procInstBody="";else{if(t(b,"Unencoded <"),b.startTagPosition+1<b.position){var g=b.position-b.startTagPosition;d=new Array(g).join(" ")+d}b.textNode+="<"+d,b.state=V.TEXT}continue;case V.SGML_DECL:(b.sgmlDecl+d).toUpperCase()===M?(o(b,"onopencdata"),b.state=V.CDATA,b.sgmlDecl="",b.cdata=""):b.sgmlDecl+d==="--"?(b.state=V.COMMENT,b.comment="",b.sgmlDecl=""):(b.sgmlDecl+d).toUpperCase()===N?(b.state=V.DOCTYPE,(b.doctype||b.sawRoot)&&t(b,"Inappropriately located doctype declaration"),b.doctype="",b.sgmlDecl=""):">"===d?(o(b,"onsgmldeclaration",b.sgmlDecl),b.sgmlDecl="",b.state=V.TEXT):l(K,d)?(b.state=V.SGML_DECL_QUOTED,b.sgmlDecl+=d):b.sgmlDecl+=d;continue;case V.SGML_DECL_QUOTED:d===b.q&&(b.state=V.SGML_DECL,b.q=""),b.sgmlDecl+=d;continue;case V.DOCTYPE:">"===d?(b.state=V.TEXT,o(b,"ondoctype",b.doctype),b.doctype=!0):(b.doctype+=d,"["===d?b.state=V.DOCTYPE_DTD:l(K,d)&&(b.state=V.DOCTYPE_QUOTED,b.q=d));continue;case V.DOCTYPE_QUOTED:b.doctype+=d,d===b.q&&(b.q="",b.state=V.DOCTYPE);continue;case V.DOCTYPE_DTD:b.doctype+=d,"]"===d?b.state=V.DOCTYPE:l(K,d)&&(b.state=V.DOCTYPE_DTD_QUOTED,b.q=d);continue;case V.DOCTYPE_DTD_QUOTED:b.doctype+=d,d===b.q&&(b.state=V.DOCTYPE_DTD,b.q="");continue;case V.COMMENT:"-"===d?b.state=V.COMMENT_ENDING:b.comment+=d;continue;case V.COMMENT_ENDING:"-"===d?(b.state=V.COMMENT_ENDED,b.comment=q(b.opt,b.comment),b.comment&&o(b,"oncomment",b.comment),b.comment=""):(b.comment+="-"+d,b.state=V.COMMENT);continue;case V.COMMENT_ENDED:">"!==d?(t(b,"Malformed comment"),b.comment+="--"+d,b.state=V.COMMENT):b.state=V.TEXT;continue;case V.CDATA:"]"===d?b.state=V.CDATA_ENDING:b.cdata+=d;continue;case V.CDATA_ENDING:"]"===d?b.state=V.CDATA_ENDING_2:(b.cdata+="]"+d,b.state=V.CDATA);continue;case V.CDATA_ENDING_2:">"===d?(b.cdata&&o(b,"oncdata",b.cdata),o(b,"onclosecdata"),b.cdata="",b.state=V.TEXT):"]"===d?b.cdata+="]":(b.cdata+="]]"+d,b.state=V.CDATA);continue;case V.PROC_INST:"?"===d?b.state=V.PROC_INST_ENDING:l(H,d)?b.state=V.PROC_INST_BODY:b.procInstName+=d;continue;case V.PROC_INST_BODY:if(!b.procInstBody&&l(H,d))continue;"?"===d?b.state=V.PROC_INST_ENDING:b.procInstBody+=d;continue;case V.PROC_INST_ENDING:">"===d?(o(b,"onprocessinginstruction",{name:b.procInstName,body:b.procInstBody}),b.procInstName=b.procInstBody="",b.state=V.TEXT):(b.procInstBody+="?"+d,b.state=V.PROC_INST_BODY);continue;case V.OPEN_TAG:l(S,d)?b.tagName+=d:(u(b),">"===d?x(b):"/"===d?b.state=V.OPEN_TAG_SLASH:(m(H,d)&&t(b,"Invalid character in tag name"),b.state=V.ATTRIB));continue;case V.OPEN_TAG_SLASH:">"===d?(x(b,!0),y(b)):(t(b,"Forward-slash in opening tag not followed by >"),b.state=V.ATTRIB);continue;case V.ATTRIB:if(l(H,d))continue;">"===d?x(b):"/"===d?b.state=V.OPEN_TAG_SLASH:l(R,d)?(b.attribName=d,b.attribValue="",b.state=V.ATTRIB_NAME):t(b,"Invalid attribute name");continue;case V.ATTRIB_NAME:"="===d?b.state=V.ATTRIB_VALUE:">"===d?(t(b,"Attribute without value"),b.attribValue=b.attribName,w(b),x(b)):l(H,d)?b.state=V.ATTRIB_NAME_SAW_WHITE:l(S,d)?b.attribName+=d:t(b,"Invalid attribute name");continue;case V.ATTRIB_NAME_SAW_WHITE:if("="===d)b.state=V.ATTRIB_VALUE;else{if(l(H,d))continue;t(b,"Attribute without value"),b.tag.attributes[b.attribName]="",b.attribValue="",o(b,"onattribute",{name:b.attribName,value:""}),b.attribName="",">"===d?x(b):l(R,d)?(b.attribName=d,b.state=V.ATTRIB_NAME):(t(b,"Invalid attribute name"),b.state=V.ATTRIB)}continue;case V.ATTRIB_VALUE:if(l(H,d))continue;l(K,d)?(b.q=d,b.state=V.ATTRIB_VALUE_QUOTED):(t(b,"Unquoted attribute value"),b.state=V.ATTRIB_VALUE_UNQUOTED,b.attribValue=d);continue;case V.ATTRIB_VALUE_QUOTED:if(d!==b.q){"&"===d?b.state=V.ATTRIB_VALUE_ENTITY_Q:b.attribValue+=d;continue}w(b),b.q="",b.state=V.ATTRIB_VALUE_CLOSED;continue;case V.ATTRIB_VALUE_CLOSED:l(H,d)?b.state=V.ATTRIB:">"===d?x(b):"/"===d?b.state=V.OPEN_TAG_SLASH:l(R,d)?(t(b,"No whitespace between attributes"),b.attribName=d,b.attribValue="",b.state=V.ATTRIB_NAME):t(b,"Invalid attribute name");continue;case V.ATTRIB_VALUE_UNQUOTED:if(m(L,d)){"&"===d?b.state=V.ATTRIB_VALUE_ENTITY_U:b.attribValue+=d;continue}w(b),">"===d?x(b):b.state=V.ATTRIB;continue;case V.CLOSE_TAG:if(b.tagName)">"===d?y(b):l(S,d)?b.tagName+=d:b.script?(b.script+="</"+b.tagName,b.tagName="",b.state=V.SCRIPT):(m(H,d)&&t(b,"Invalid tagname in closing tag"),b.state=V.CLOSE_TAG_SAW_WHITE);else{if(l(H,d))continue;m(R,d)?b.script?(b.script+="</"+d,b.state=V.SCRIPT):t(b,"Invalid tagname in closing tag."):b.tagName=d}continue;case V.CLOSE_TAG_SAW_WHITE:if(l(H,d))continue;">"===d?y(b):t(b,"Invalid characters in closing tag");continue;case V.TEXT_ENTITY:case V.ATTRIB_VALUE_ENTITY_Q:case V.ATTRIB_VALUE_ENTITY_U:var h,i;switch(b.state){case V.TEXT_ENTITY:h=V.TEXT,i="textNode";break;case V.ATTRIB_VALUE_ENTITY_Q:h=V.ATTRIB_VALUE_QUOTED,i="attribValue";break;case V.ATTRIB_VALUE_ENTITY_U:h=V.ATTRIB_VALUE_UNQUOTED,i="attribValue"}";"===d?(b[i]+=z(b),b.entity="",b.state=h):l(b.entity.length?U:T,d)?b.entity+=d:(t(b,"Invalid character in entity name"),b[i]+="&"+b.entity+d,b.entity="",b.state=h);continue;default:throw new Error(b,"Unknown state: "+b.state)}}return b.position>=b.bufferCheckPosition&&e(b),b}c.parser=function(a,b){return new d(a,b)},c.SAXParser=d,c.SAXStream=i,c.createStream=h,c.MAX_BUFFER_LENGTH=65536;var D=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];c.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(a){function b(){}b.prototype=a;var c=new b;return c}),Object.keys||(Object.keys=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}),d.prototype={end:function(){s(this)},write:C,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){g(this)}};var E;try{E=a("stream").Stream}catch(F){E=function(){}}var G=c.EVENTS.filter(function(a){return"error"!==a&&"end"!==a});i.prototype=Object.create(E.prototype,{constructor:{value:i}}),i.prototype.write=function(c){if("function"==typeof b&&"function"==typeof b.isBuffer&&b.isBuffer(c)){if(!this._decoder){var d=a("string_decoder").StringDecoder;this._decoder=new d("utf8")}c=this._decoder.write(c)}return this._parser.write(c.toString()),this.emit("data",c),!0},i.prototype.end=function(a){return a&&a.length&&this.write(a),this._parser.end(),!0},i.prototype.on=function(a,b){var c=this;return c._parser["on"+a]||-1===G.indexOf(a)||(c._parser["on"+a]=function(){var b=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);
b.splice(0,0,a),c.emit.apply(c,b)}),E.prototype.on.call(c,a,b)};var H="\r\n	 ",I="0124356789",J="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",K="'\"",L=H+">",M="[CDATA[",N="DOCTYPE",O="http://www.w3.org/XML/1998/namespace",P="http://www.w3.org/2000/xmlns/",Q={xml:O,xmlns:P};H=j(H),I=j(I),J=j(J);var R=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,S=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,T=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,U=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;K=j(K),L=j(L);var V=0;c.STATE={BEGIN:V++,BEGIN_WHITESPACE:V++,TEXT:V++,TEXT_ENTITY:V++,OPEN_WAKA:V++,SGML_DECL:V++,SGML_DECL_QUOTED:V++,DOCTYPE:V++,DOCTYPE_QUOTED:V++,DOCTYPE_DTD:V++,DOCTYPE_DTD_QUOTED:V++,COMMENT_STARTING:V++,COMMENT:V++,COMMENT_ENDING:V++,COMMENT_ENDED:V++,CDATA:V++,CDATA_ENDING:V++,CDATA_ENDING_2:V++,PROC_INST:V++,PROC_INST_BODY:V++,PROC_INST_ENDING:V++,OPEN_TAG:V++,OPEN_TAG_SLASH:V++,ATTRIB:V++,ATTRIB_NAME:V++,ATTRIB_NAME_SAW_WHITE:V++,ATTRIB_VALUE:V++,ATTRIB_VALUE_QUOTED:V++,ATTRIB_VALUE_CLOSED:V++,ATTRIB_VALUE_UNQUOTED:V++,ATTRIB_VALUE_ENTITY_Q:V++,ATTRIB_VALUE_ENTITY_U:V++,CLOSE_TAG:V++,CLOSE_TAG_SAW_WHITE:V++,SCRIPT:V++,SCRIPT_ENDING:V++},c.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},c.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,"int":8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(c.ENTITIES).forEach(function(a){var b=c.ENTITIES[a],d="number"==typeof b?String.fromCharCode(b):b;c.ENTITIES[a]=d});for(var W in c.STATE)c.STATE[c.STATE[W]]=W;V=c.STATE,String.fromCodePoint||!function(){var a=String.fromCharCode,b=Math.floor,c=function(){var c,d,e=16384,f=[],g=-1,h=arguments.length;if(!h)return"";for(var i="";++g<h;){var j=Number(arguments[g]);if(!isFinite(j)||0>j||j>1114111||b(j)!==j)throw RangeError("Invalid code point: "+j);65535>=j?f.push(j):(j-=65536,c=(j>>10)+55296,d=j%1024+56320,f.push(c,d)),(g+1===h||f.length>e)&&(i+=a.apply(null,f),f.length=0)}return i};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:c,configurable:!0,writable:!0}):String.fromCodePoint=c}()}("undefined"==typeof c?this.sax={}:c)}).call(this,a("buffer").Buffer)},{buffer:9,stream:179,string_decoder:180}],179:[function(a,b,c){function d(){e.call(this)}b.exports=d;var e=a("events").EventEmitter,f=a("inherits");f(d,e),d.Readable=a("readable-stream/readable.js"),d.Writable=a("readable-stream/writable.js"),d.Duplex=a("readable-stream/duplex.js"),d.Transform=a("readable-stream/transform.js"),d.PassThrough=a("readable-stream/passthrough.js"),d.Stream=d,d.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function d(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===e.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",d),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",d),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},{events:17,inherits:19,"readable-stream/duplex.js":167,"readable-stream/passthrough.js":173,"readable-stream/readable.js":174,"readable-stream/transform.js":175,"readable-stream/writable.js":176}],180:[function(a,b,c){function d(a){if(a&&!i(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){this.charReceived=a.length%2,this.charLength=this.charReceived?2:0}function g(a){this.charReceived=a.length%3,this.charLength=this.charReceived?3:0}var h=a("buffer").Buffer,i=h.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},j=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};j.prototype.write=function(a){for(var b="";this.charLength;){var c=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,0,c),this.charReceived+=c,this.charReceived<this.charLength)return"";a=a.slice(c,a.length),b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var d=b.charCodeAt(b.length-1);if(!(d>=55296&&56319>=d)){if(this.charReceived=this.charLength=0,0===a.length)return b;break}this.charLength+=this.surrogateSize,b=""}this.detectIncompleteChar(a);var e=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-this.charReceived,e),e-=this.charReceived),b+=a.toString(this.encoding,0,e);var e=b.length-1,d=b.charCodeAt(e);if(d>=55296&&56319>=d){var f=this.surrogateSize;return this.charLength+=f,this.charReceived+=f,this.charBuffer.copy(this.charBuffer,f,0,f),a.copy(this.charBuffer,0,0,f),b.substring(0,e)}return b},j.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(2>=b&&c>>4==14){this.charLength=3;break}if(3>=b&&c>>3==30){this.charLength=4;break}}this.charReceived=b},j.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:9}],181:[function(a,b,c){function d(a,b){this._id=a,this._clearFn=b}var e=a("process/browser.js").nextTick,f=Function.prototype.apply,g=Array.prototype.slice,h={},i=0;c.setTimeout=function(){return new d(f.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new d(f.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(a){a.close()},d.prototype.unref=d.prototype.ref=function(){},d.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(a,b){clearTimeout(a._idleTimeoutId),a._idleTimeout=b},c.unenroll=function(a){clearTimeout(a._idleTimeoutId),a._idleTimeout=-1},c._unrefActive=c.active=function(a){clearTimeout(a._idleTimeoutId);var b=a._idleTimeout;b>=0&&(a._idleTimeoutId=setTimeout(function(){a._onTimeout&&a._onTimeout()},b))},c.setImmediate="function"==typeof setImmediate?setImmediate:function(a){var b=i++,d=arguments.length<2?!1:g.call(arguments,1);return h[b]=!0,e(function(){h[b]&&(d?a.apply(null,d):a.call(null),c.clearImmediate(b))}),b},c.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(a){delete h[a]}},{"process/browser.js":162}],182:[function(a,b,c){function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return i(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}function i(a){return"string"==typeof a}function j(a){return"object"==typeof a&&null!==a}function k(a){return null===a}function l(a){return null==a}var m=a("punycode");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,p=["<",">",'"',"`"," ","\r","\n","	"],q=["{","}","|","\\","^","`"].concat(p),r=["'"].concat(q),s=["%","/","?",";","#"].concat(r),t=["/","?","#"],u=255,v=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=a("querystring");d.prototype.parse=function(a,b,c){if(!i(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a;d=d.trim();var e=n.exec(d);if(e){e=e[0];var f=e.toLowerCase();this.protocol=f,d=d.substr(e.length)}if(c||e||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===d.substr(0,2);!g||e&&y[e]||(d=d.substr(2),this.slashes=!0)}if(!y[e]&&(g||e&&!z[e])){for(var h=-1,j=0;j<t.length;j++){var k=d.indexOf(t[j]);-1!==k&&(-1===h||h>k)&&(h=k)}var l,o;o=-1===h?d.lastIndexOf("@"):d.lastIndexOf("@",h),-1!==o&&(l=d.slice(0,o),d=d.slice(o+1),this.auth=decodeURIComponent(l)),h=-1;for(var j=0;j<s.length;j++){var k=d.indexOf(s[j]);-1!==k&&(-1===h||h>k)&&(h=k)}-1===h&&(h=d.length),this.host=d.slice(0,h),d=d.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var q=this.hostname.split(/\./),j=0,B=q.length;B>j;j++){var C=q[j];if(C&&!C.match(v)){for(var D="",E=0,F=C.length;F>E;E++)D+=C.charCodeAt(E)>127?"x":C[E];if(!D.match(v)){var G=q.slice(0,j),H=q.slice(j+1),I=C.match(w);I&&(G.push(I[1]),H.unshift(I[2])),H.length&&(d="/"+H.join(".")+d),this.hostname=G.join(".");break}}}if(this.hostname.length>u?this.hostname="":this.hostname=this.hostname.toLowerCase(),!p){for(var J=this.hostname.split("."),K=[],j=0;j<J.length;++j){var L=J[j];K.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+m.encode(L):L)}this.hostname=K.join(".")}var M=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+M,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!x[f])for(var j=0,B=r.length;B>j;j++){var O=r[j],P=encodeURIComponent(O);P===O&&(P=escape(O)),d=d.split(O).join(P)}var Q=d.indexOf("#");-1!==Q&&(this.hash=d.substr(Q),d=d.slice(0,Q));var R=d.indexOf("?");if(-1!==R?(this.search=d.substr(R),this.query=d.substr(R+1),b&&(this.query=A.parse(this.query)),d=d.slice(0,R)):b&&(this.search="",this.query={}),d&&(this.pathname=d),z[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",L=this.search||"";this.path=M+L}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j(this.query)&&Object.keys(this.query).length&&(f=A.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||z[b])&&e!==!1?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(i(a)){var b=new d;b.parse(a,!1,!0),a=b}var c=new d;if(Object.keys(this).forEach(function(a){c[a]=this[a]},this),c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol)return Object.keys(a).forEach(function(b){"protocol"!==b&&(c[b]=a[b])}),z[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c;if(a.protocol&&a.protocol!==c.protocol){if(!z[a.protocol])return Object.keys(a).forEach(function(b){c[b]=a[b]}),c.href=c.format(),c;if(c.protocol=a.protocol,a.host||y[a.protocol])c.pathname=a.pathname;else{for(var e=(a.pathname||"").split("/");e.length&&!(a.host=e.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var f=c.pathname||"",g=c.search||"";c.path=f+g}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var h=c.pathname&&"/"===c.pathname.charAt(0),j=a.host||a.pathname&&"/"===a.pathname.charAt(0),m=j||h||c.host&&a.pathname,n=m,o=c.pathname&&c.pathname.split("/")||[],e=a.pathname&&a.pathname.split("/")||[],p=c.protocol&&!z[c.protocol];if(p&&(c.hostname="",c.port=null,c.host&&(""===o[0]?o[0]=c.host:o.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===e[0]?e[0]=a.host:e.unshift(a.host)),a.host=null),m=m&&(""===e[0]||""===o[0])),j)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,o=e;else if(e.length)o||(o=[]),o.pop(),o=o.concat(e),c.search=a.search,c.query=a.query;else if(!l(a.search)){if(p){c.hostname=c.host=o.shift();var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return c.search=a.search,c.query=a.query,k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!o.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var r=o.slice(-1)[0],s=(c.host||a.host)&&("."===r||".."===r)||""===r,t=0,u=o.length;u>=0;u--)r=o[u],"."==r?o.splice(u,1):".."===r?(o.splice(u,1),t++):t&&(o.splice(u,1),t--);if(!m&&!n)for(;t--;t)o.unshift("..");!m||""===o[0]||o[0]&&"/"===o[0].charAt(0)||o.unshift(""),s&&"/"!==o.join("/").substr(-1)&&o.push("");var v=""===o[0]||o[0]&&"/"===o[0].charAt(0);if(p){c.hostname=c.host=v?"":o.length?o.shift():"";var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return m=m||c.host&&o.length,m&&!v&&o.unshift(""),o.length?c.pathname=o.join("/"):(c.pathname=null,c.path=null),k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=o.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{punycode:163,querystring:166}],183:[function(a,b,c){(function(a){function c(a,b){function c(){if(!e){if(d("throwDeprecation"))throw new Error(b);d("traceDeprecation")?console.trace(b):console.warn(b),e=!0}return a.apply(this,arguments)}if(d("noDeprecation"))return a;var e=!1;return c}function d(b){if(!a.localStorage)return!1;var c=a.localStorage[b];return null==c?!1:"true"===String(c).toLowerCase()}b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],184:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],185:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":184,_process:162,inherits:19}],186:[function(a,b,c){(function(c){function d(a){g.call(this,a),this._destroyed=!1}function e(a,b,c){c(null,a)}function f(a){return function(b,c,d){return"function"==typeof b&&(d=c,c=b,b={}),"function"!=typeof c&&(c=e),"function"!=typeof d&&(d=null),a(b,c,d)}}var g=a("readable-stream/transform"),h=a("util").inherits,i=a("xtend");h(d,g),d.prototype.destroy=function(a){if(!this._destroyed){this._destroyed=!0;var b=this;c.nextTick(function(){a&&b.emit("error",a),b.emit("close")})}},b.exports=f(function(a,b,c){var e=new d(a);return e._transform=b,c&&(e._flush=c),e}),b.exports.ctor=f(function(a,b,c){function e(b){return this instanceof e?(this.options=i(a,b),void d.call(this,this.options)):new e(b)}return h(e,d),e.prototype._transform=b,c&&(e.prototype._flush=c),e}),b.exports.obj=f(function(a,b,c){var e=new d(i({objectMode:!0,highWaterMark:16},a));return e._transform=b,c&&(e._flush=c),e})}).call(this,a("_process"))},{_process:162,"readable-stream/transform":175,util:185,xtend:211}],187:[function(a,b,c){(function(c,d,e){function f(a,b,f){function j(a,b,c){s.send(a,c)}function k(a,b,c){if(s.bufferedAmount>x)return void setTimeout(k,y,a,b,c);try{s.send(a)}catch(d){return c(d)}c()}function l(a){s.close(),a()}function m(){r.setReadable(w),r.setWritable(w),r.emit("connect")}function n(){r.end(),r.destroy()}function o(a){r.destroy(a)}function p(a){var b=a.data;b=new e(b instanceof ArrayBuffer?new Uint8Array(b):b),w.push(b)}function q(){s.close()}var r,s,t="browser"===c.title,u=!!d.WebSocket,v=t?k:j,w=g.obj(v,l);b&&!Array.isArray(b)&&"object"==typeof b&&(f=b,b=null),f||(f={});var x=f.browserBufferSize||524288,y=f.browserBufferTimeout||1e3;return"object"==typeof a?s=a:(s=u&&t?new i(a,b):new i(a,b,f),s.binaryType="arraybuffer"),1===s.readyState?r=w:(r=h.obj(),s.addEventListener("open",m)),r.socket=s,s.addEventListener("close",n),s.addEventListener("error",o),s.addEventListener("message",p),w.on("close",q),r}var g=a("through2"),h=a("duplexify"),i=a("ws");b.exports=f}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a("buffer").Buffer)},{_process:162,buffer:9,duplexify:14,through2:186,ws:188}],188:[function(a,b,c){b.exports=window.WebSocket||window.MozWebSocket},{}],189:[function(a,b,c){var d=arguments[3],e=arguments[4],f=arguments[5],g=JSON.stringify;b.exports=function(a){for(var b,c=Object.keys(f),h=0,i=c.length;i>h;h++){var j=c[h],k=f[j].exports;if(k===a||k["default"]===a){b=j;break}}if(!b){b=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var l={},h=0,i=c.length;i>h;h++){var j=c[h];l[j]=j}e[b]=[Function(["require","module","exports"],"("+a+")(self)"),l]}var m=Math.floor(Math.pow(16,8)*Math.random()).toString(16),n={};n[b]=b,e[m]=[Function(["require"],"var f = require("+g(b)+");(f.default ? f.default : f)(self);"),n];var o="("+d+")({"+Object.keys(e).map(function(a){return g(a)+":["+e[a][0]+","+g(e[a][1])+"]"}).join(",")+"},{},["+g(m)+"])",p=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(p.createObjectURL(new Blob([o],{type:"text/javascript"})))}},{}],190:[function(a,b,c){function d(a,b){function c(){for(var b=new Array(arguments.length),c=0;c<b.length;c++)b[c]=arguments[c];var d=a.apply(this,b),e=b[b.length-1];return"function"==typeof d&&d!==e&&Object.keys(e).forEach(function(a){d[a]=e[a]}),d}if(a&&b)return d(a)(b);if("function"!=typeof a)throw new TypeError("need wrapper function");return Object.keys(a).forEach(function(b){c[b]=a[b]}),c}b.exports=d},{}],191:[function(a,b,c){(function(){"use strict";var b;b=a("../lib/xml2js"),c.stripBOM=function(a){return"\ufeff"===a[0]?a.substring(1):a}}).call(this)},{"../lib/xml2js":193}],192:[function(a,b,c){(function(){"use strict";var a;a=new RegExp(/(?!xmlns)^.*:/),c.normalize=function(a){return a.toLowerCase()},c.firstCharLowerCase=function(a){return a.charAt(0).toLowerCase()+a.slice(1)},c.stripPrefix=function(b){return b.replace(a,"")},c.parseNumbers=function(a){return isNaN(a)||(a=a%1===0?parseInt(a,10):parseFloat(a)),a},c.parseBooleans=function(a){return/^(?:true|false)$/i.test(a)&&(a="true"===a.toLowerCase()),a}}).call(this)},{}],193:[function(a,b,c){(function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},o={}.hasOwnProperty,p=function(a,b){return function(){return a.apply(b,arguments)}};k=a("sax"),f=a("events"),d=a("xmlbuilder"),b=a("./bom"),i=a("./processors"),l=a("timers").setImmediate,g=function(a){return"object"==typeof a&&null!=a&&0===Object.keys(a).length},h=function(a,b){var c,d,e;for(c=0,d=a.length;d>c;c++)e=a[c],b=e(b);return b},j=function(a){return a.indexOf("&")>=0||a.indexOf(">")>=0||a.indexOf("<")>=0},m=function(a){return"<![CDATA["+e(a)+"]]>"},e=function(a){return a.replace("]]>","]]]]><![CDATA[>")},c.processors=i,c.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}},c.ValidationError=function(a){function b(a){this.message=a}return n(b,a),b}(Error),c.Builder=function(){function a(a){var b,d,e;this.options={},d=c.defaults[.2];for(b in d)o.call(d,b)&&(e=d[b],this.options[b]=e);for(b in a)o.call(a,b)&&(e=a[b],this.options[b]=e)}return a.prototype.buildObject=function(a){var b,e,f,g,h;return b=this.options.attrkey,e=this.options.charkey,1===Object.keys(a).length&&this.options.rootName===c.defaults[.2].rootName?(h=Object.keys(a)[0],a=a[h]):h=this.options.rootName,f=function(a){return function(c,d){var g,h,i,k,l,n;if("object"!=typeof d)a.options.cdata&&j(d)?c.raw(m(d)):c.txt(d);else for(l in d)if(o.call(d,l))if(h=d[l],l===b){if("object"==typeof h)for(g in h)n=h[g],c=c.att(g,n)}else if(l===e)c=a.options.cdata&&j(h)?c.raw(m(h)):c.txt(h);else if(Array.isArray(h))for(k in h)o.call(h,k)&&(i=h[k],c="string"==typeof i?a.options.cdata&&j(i)?c.ele(l).raw(m(i)).up():c.ele(l,i).up():f(c.ele(l),i).up());else"object"==typeof h?c=f(c.ele(l),h).up():"string"==typeof h&&a.options.cdata&&j(h)?c=c.ele(l).raw(m(h)).up():(null==h&&(h=""),c=c.ele(l,h.toString()).up());return c}}(this),g=d.create(h,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),f(g,a).end(this.options.renderOpts)},a}(),c.Parser=function(a){function d(a){this.parseString=p(this.parseString,this),this.reset=p(this.reset,this),this.assignOrPush=p(this.assignOrPush,this),this.processAsync=p(this.processAsync,this);var b,d,e;if(!(this instanceof c.Parser))return new c.Parser(a);this.options={},d=c.defaults[.2];for(b in d)o.call(d,b)&&(e=d[b],this.options[b]=e);for(b in a)o.call(a,b)&&(e=a[b],this.options[b]=e);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(i.normalize)),this.reset()}return n(d,a),d.prototype.processAsync=function(){var a,b,c;try{return this.remaining.length<=this.options.chunkSize?(a=this.remaining,
this.remaining="",this.saxParser=this.saxParser.write(a),this.saxParser.close()):(a=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(a),l(this.processAsync))}catch(c){if(b=c,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(b)}},d.prototype.assignOrPush=function(a,b,c){return b in a?(a[b]instanceof Array||(a[b]=[a[b]]),a[b].push(c)):this.options.explicitArray?a[b]=[c]:a[b]=c},d.prototype.reset=function(){var a,b,c,d;return this.removeAllListeners(),this.saxParser=k.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(a){return function(b){return a.saxParser.resume(),a.saxParser.errThrown?void 0:(a.saxParser.errThrown=!0,a.emit("error",b))}}(this),this.saxParser.onend=function(a){return function(){return a.saxParser.ended?void 0:(a.saxParser.ended=!0,a.emit("end",a.resultObject))}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,d=[],a=this.options.attrkey,b=this.options.charkey,this.saxParser.onopentag=function(c){return function(e){var f,g,i,j,k;if(i={},i[b]="",!c.options.ignoreAttrs){k=e.attributes;for(f in k)o.call(k,f)&&(a in i||c.options.mergeAttrs||(i[a]={}),g=c.options.attrValueProcessors?h(c.options.attrValueProcessors,e.attributes[f]):e.attributes[f],j=c.options.attrNameProcessors?h(c.options.attrNameProcessors,f):f,c.options.mergeAttrs?c.assignOrPush(i,j,g):i[a][j]=g)}return i["#name"]=c.options.tagNameProcessors?h(c.options.tagNameProcessors,e.name):e.name,c.options.xmlns&&(i[c.options.xmlnskey]={uri:e.uri,local:e.local}),d.push(i)}}(this),this.saxParser.onclosetag=function(a){return function(){var c,e,f,i,j,k,l,m,n,p,q,r;if(m=d.pop(),l=m["#name"],a.options.explicitChildren&&a.options.preserveChildrenOrder||delete m["#name"],m.cdata===!0&&(c=m.cdata,delete m.cdata),q=d[d.length-1],m[b].match(/^\s*$/)&&!c?(e=m[b],delete m[b]):(a.options.trim&&(m[b]=m[b].trim()),a.options.normalize&&(m[b]=m[b].replace(/\s{2,}/g," ").trim()),m[b]=a.options.valueProcessors?h(a.options.valueProcessors,m[b]):m[b],1===Object.keys(m).length&&b in m&&!a.EXPLICIT_CHARKEY&&(m=m[b])),g(m)&&(m=""!==a.options.emptyTag?a.options.emptyTag:e),null!=a.options.validator){r="/"+function(){var a,b,c;for(c=[],a=0,b=d.length;b>a;a++)k=d[a],c.push(k["#name"]);return c}().concat(l).join("/");try{m=a.options.validator(r,q&&q[l],m)}catch(i){f=i,a.emit("error",f)}}if(a.options.explicitChildren&&!a.options.mergeAttrs&&"object"==typeof m)if(a.options.preserveChildrenOrder){if(q){q[a.options.childkey]=q[a.options.childkey]||[],n={};for(j in m)o.call(m,j)&&(n[j]=m[j]);q[a.options.childkey].push(n),delete m["#name"],1===Object.keys(m).length&&b in m&&!a.EXPLICIT_CHARKEY&&(m=m[b])}}else k={},a.options.attrkey in m&&(k[a.options.attrkey]=m[a.options.attrkey],delete m[a.options.attrkey]),!a.options.charsAsChildren&&a.options.charkey in m&&(k[a.options.charkey]=m[a.options.charkey],delete m[a.options.charkey]),Object.getOwnPropertyNames(m).length>0&&(k[a.options.childkey]=m),m=k;return d.length>0?a.assignOrPush(q,l,m):(a.options.explicitRoot&&(p=m,m={},m[l]=p),a.resultObject=m,a.saxParser.ended=!0,a.emit("end",a.resultObject))}}(this),c=function(a){return function(c){var e,f;return f=d[d.length-1],f?(f[b]+=c,a.options.explicitChildren&&a.options.preserveChildrenOrder&&a.options.charsAsChildren&&""!==c.replace(/\\n/g,"").trim()&&(f[a.options.childkey]=f[a.options.childkey]||[],e={"#name":"__text__"},e[b]=c,f[a.options.childkey].push(e)),f):void 0}}(this),this.saxParser.ontext=c,this.saxParser.oncdata=function(a){return function(a){var b;return b=c(a),b?b.cdata=!0:void 0}}(this)},d.prototype.parseString=function(a,c){var d,e;null!=c&&"function"==typeof c&&(this.on("end",function(a){return this.reset(),c(null,a)}),this.on("error",function(a){return this.reset(),c(a)}));try{return a=a.toString(),""===a.trim()?(this.emit("end",null),!0):(a=b.stripBOM(a),this.options.async?(this.remaining=a,l(this.processAsync),this.saxParser):this.saxParser.write(a).close())}catch(e){if(d=e,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",d),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw d}},d}(f.EventEmitter),c.parseString=function(a,b,d){var e,f,g;return null!=d?("function"==typeof d&&(e=d),"object"==typeof b&&(f=b)):("function"==typeof b&&(e=b),f={}),g=new c.Parser(f),g.parseString(a,e)}}).call(this)},{"./bom":191,"./processors":192,events:17,sax:178,timers:181,xmlbuilder:210}],194:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing attribute name of element "+a.name);if(null==c)throw new Error("Missing attribute value for attribute "+b+" of element "+a.name);this.name=this.stringify.attName(b),this.value=this.stringify.attValue(c)}return a.prototype.clone=function(){return d(a.prototype,this)},a.prototype.toString=function(a,b){return" "+this.name+'="'+this.value+'"'},a}()}).call(this)},{"lodash/create":107}],195:[function(a,b,c){(function(){var c,d,e,f,g;g=a("./XMLStringifier"),d=a("./XMLDeclaration"),e=a("./XMLDocType"),f=a("./XMLElement"),b.exports=c=function(){function a(a,b){var c,d;if(null==a)throw new Error("Root element needs a name");null==b&&(b={}),this.options=b,this.stringify=new g(b),d=new f(this,"doc"),c=d.element(a),c.isRoot=!0,c.documentObject=this,this.rootObject=c,b.headless||(c.declaration(b),(null!=b.pubID||null!=b.sysID)&&c.doctype(b))}return a.prototype.root=function(){return this.rootObject},a.prototype.end=function(a){return this.toString(a)},a.prototype.toString=function(a){var b,c,d,e,f,g,h,i;return e=(null!=a?a.pretty:void 0)||!1,b=null!=(g=null!=a?a.indent:void 0)?g:"  ",d=null!=(h=null!=a?a.offset:void 0)?h:0,c=null!=(i=null!=a?a.newline:void 0)?i:"\n",f="",null!=this.xmldec&&(f+=this.xmldec.toString(a)),null!=this.doctype&&(f+=this.doctype.toString(a)),f+=this.rootObject.toString(a),e&&f.slice(-c.length)===c&&(f=f.slice(0,-c.length)),f},a}()}).call(this)},{"./XMLDeclaration":202,"./XMLDocType":203,"./XMLElement":204,"./XMLStringifier":208}],196:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),d=a("./XMLNode"),b.exports=c=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing CDATA text");this.text=this.stringify.cdata(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<![CDATA["+this.text+"]]>",f&&(g+=d),g},b}(d)}).call(this)},{"./XMLNode":205,"lodash/create":107}],197:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),d=a("./XMLNode"),b.exports=c=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing comment text");this.text=this.stringify.comment(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!-- "+this.text+" -->",f&&(g+=d),g},b}(d)}).call(this)},{"./XMLNode":205,"lodash/create":107}],198:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c,d,e,f){if(this.stringify=a.stringify,null==b)throw new Error("Missing DTD element name");if(null==c)throw new Error("Missing DTD attribute name");if(!d)throw new Error("Missing DTD attribute type");if(!e)throw new Error("Missing DTD attribute default");if(0!==e.indexOf("#")&&(e="#"+e),!e.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT");if(f&&!e.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT");this.elementName=this.stringify.eleName(b),this.attributeName=this.stringify.attName(c),this.attributeType=this.stringify.dtdAttType(d),this.defaultValue=this.stringify.dtdAttDefault(f),this.defaultValueType=e}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!ATTLIST "+this.elementName+" "+this.attributeName+" "+this.attributeType,"#DEFAULT"!==this.defaultValueType&&(g+=" "+this.defaultValueType),this.defaultValue&&(g+=' "'+this.defaultValue+'"'),g+=">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":107}],199:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing DTD element name");c||(c="(#PCDATA)"),Array.isArray(c)&&(c="("+c.join(",")+")"),this.name=this.stringify.eleName(b),this.value=this.stringify.dtdElementValue(c)}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!ELEMENT "+this.name+" "+this.value+">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":107}],200:[function(a,b,c){(function(){var c,d,e;d=a("lodash/create"),e=a("lodash/isObject"),b.exports=c=function(){function a(a,b,c,d){if(this.stringify=a.stringify,null==c)throw new Error("Missing entity name");if(null==d)throw new Error("Missing entity value");if(this.pe=!!b,this.name=this.stringify.eleName(c),e(d)){if(!d.pubID&&!d.sysID)throw new Error("Public and/or system identifiers are required for an external entity");if(d.pubID&&!d.sysID)throw new Error("System identifier is required for a public external entity");if(null!=d.pubID&&(this.pubID=this.stringify.dtdPubID(d.pubID)),null!=d.sysID&&(this.sysID=this.stringify.dtdSysID(d.sysID)),null!=d.nData&&(this.nData=this.stringify.dtdNData(d.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity")}else this.value=this.stringify.dtdEntityValue(d)}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!ENTITY",this.pe&&(g+=" %"),g+=" "+this.name,this.value?g+=' "'+this.value+'"':(this.pubID&&this.sysID?g+=' PUBLIC "'+this.pubID+'" "'+this.sysID+'"':this.sysID&&(g+=' SYSTEM "'+this.sysID+'"'),this.nData&&(g+=" NDATA "+this.nData)),g+=">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":107,"lodash/isObject":121}],201:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing notation name");if(!c.pubID&&!c.sysID)throw new Error("Public or system identifiers are required for an external entity");this.name=this.stringify.eleName(b),null!=c.pubID&&(this.pubID=this.stringify.dtdPubID(c.pubID)),null!=c.sysID&&(this.sysID=this.stringify.dtdSysID(c.sysID))}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!NOTATION "+this.name,this.pubID&&this.sysID?g+=' PUBLIC "'+this.pubID+'" "'+this.sysID+'"':this.pubID?g+=' PUBLIC "'+this.pubID+'"':this.sysID&&(g+=' SYSTEM "'+this.sysID+'"'),g+=">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":107}],202:[function(a,b,c){(function(){var c,d,e,f,g=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h={}.hasOwnProperty;e=a("lodash/create"),f=a("lodash/isObject"),d=a("./XMLNode"),b.exports=c=function(a){function b(a,c,d,e){var g;b.__super__.constructor.call(this,a),f(c)&&(g=c,c=g.version,d=g.encoding,e=g.standalone),c||(c="1.0"),this.version=this.stringify.xmlVersion(c),null!=d&&(this.encoding=this.stringify.xmlEncoding(d)),null!=e&&(this.standalone=this.stringify.xmlStandalone(e))}return g(b,a),b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<?xml",g+=' version="'+this.version+'"',null!=this.encoding&&(g+=' encoding="'+this.encoding+'"'),null!=this.standalone&&(g+=' standalone="'+this.standalone+'"'),g+="?>",f&&(g+=d),g},b}(d)}).call(this)},{"./XMLNode":205,"lodash/create":107,"lodash/isObject":121}],203:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l;k=a("lodash/create"),l=a("lodash/isObject"),c=a("./XMLCData"),d=a("./XMLComment"),e=a("./XMLDTDAttList"),g=a("./XMLDTDEntity"),f=a("./XMLDTDElement"),h=a("./XMLDTDNotation"),j=a("./XMLProcessingInstruction"),b.exports=i=function(){function a(a,b,c){var d,e;this.documentObject=a,this.stringify=this.documentObject.stringify,this.children=[],l(b)&&(d=b,b=d.pubID,c=d.sysID),null==c&&(e=[b,c],c=e[0],b=e[1]),null!=b&&(this.pubID=this.stringify.dtdPubID(b)),null!=c&&(this.sysID=this.stringify.dtdSysID(c))}return a.prototype.element=function(a,b){var c;return c=new f(this,a,b),this.children.push(c),this},a.prototype.attList=function(a,b,c,d,f){var g;return g=new e(this,a,b,c,d,f),this.children.push(g),this},a.prototype.entity=function(a,b){var c;return c=new g(this,!1,a,b),this.children.push(c),this},a.prototype.pEntity=function(a,b){var c;return c=new g(this,!0,a,b),this.children.push(c),this},a.prototype.notation=function(a,b){var c;return c=new h(this,a,b),this.children.push(c),this},a.prototype.cdata=function(a){var b;return b=new c(this,a),this.children.push(b),this},a.prototype.comment=function(a){var b;return b=new d(this,a),this.children.push(b),this},a.prototype.instruction=function(a,b){var c;return c=new j(this,a,b),this.children.push(c),this},a.prototype.root=function(){return this.documentObject.root()},a.prototype.document=function(){return this.documentObject},a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;if(i=(null!=a?a.pretty:void 0)||!1,e=null!=(k=null!=a?a.indent:void 0)?k:"  ",h=null!=(l=null!=a?a.offset:void 0)?l:0,g=null!=(m=null!=a?a.newline:void 0)?m:"\n",b||(b=0),o=new Array(b+h+1).join(e),j="",i&&(j+=o),j+="<!DOCTYPE "+this.root().name,this.pubID&&this.sysID?j+=' PUBLIC "'+this.pubID+'" "'+this.sysID+'"':this.sysID&&(j+=' SYSTEM "'+this.sysID+'"'),this.children.length>0){for(j+=" [",i&&(j+=g),n=this.children,d=0,f=n.length;f>d;d++)c=n[d],j+=c.toString(a,b+1);j+="]"}return j+=">",i&&(j+=g),j},a.prototype.ele=function(a,b){return this.element(a,b)},a.prototype.att=function(a,b,c,d,e){return this.attList(a,b,c,d,e)},a.prototype.ent=function(a,b){return this.entity(a,b)},a.prototype.pent=function(a,b){return this.pEntity(a,b)},a.prototype.not=function(a,b){return this.notation(a,b)},a.prototype.dat=function(a){return this.cdata(a)},a.prototype.com=function(a){return this.comment(a)},a.prototype.ins=function(a,b){return this.instruction(a,b)},a.prototype.up=function(){return this.root()},a.prototype.doc=function(){return this.document()},a}()}).call(this)},{"./XMLCData":196,"./XMLComment":197,"./XMLDTDAttList":198,"./XMLDTDElement":199,"./XMLDTDEntity":200,"./XMLDTDNotation":201,"./XMLProcessingInstruction":206,"lodash/create":107,"lodash/isObject":121}],204:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l={}.hasOwnProperty;g=a("lodash/create"),j=a("lodash/isObject"),i=a("lodash/isFunction"),h=a("lodash/every"),e=a("./XMLNode"),c=a("./XMLAttribute"),f=a("./XMLProcessingInstruction"),b.exports=d=function(a){function b(a,c,d){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing element name");this.name=this.stringify.eleName(c),this.children=[],this.instructions=[],this.attributes={},null!=d&&this.attribute(d)}return k(b,a),b.prototype.clone=function(){var a,c,d,e,f,h,i,j;d=g(b.prototype,this),d.isRoot&&(d.documentObject=null),d.attributes={},i=this.attributes;for(c in i)l.call(i,c)&&(a=i[c],d.attributes[c]=a.clone());for(d.instructions=[],j=this.instructions,e=0,f=j.length;f>e;e++)h=j[e],d.instructions.push(h.clone());return d.children=[],this.children.forEach(function(a){var b;return b=a.clone(),b.parent=d,d.children.push(b)}),d},b.prototype.attribute=function(a,b){var d,e;if(null!=a&&(a=a.valueOf()),j(a))for(d in a)l.call(a,d)&&(e=a[d],this.attribute(d,e));else i(b)&&(b=b.apply()),this.options.skipNullAttributes&&null==b||(this.attributes[a]=new c(this,a,b));return this},b.prototype.removeAttribute=function(a){var b,c,d;if(null==a)throw new Error("Missing attribute name");if(a=a.valueOf(),Array.isArray(a))for(c=0,d=a.length;d>c;c++)b=a[c],delete this.attributes[b];else delete this.attributes[a];return this},b.prototype.instruction=function(a,b){var c,d,e,g,h;if(null!=a&&(a=a.valueOf()),null!=b&&(b=b.valueOf()),Array.isArray(a))for(c=0,h=a.length;h>c;c++)d=a[c],this.instruction(d);else if(j(a))for(d in a)l.call(a,d)&&(e=a[d],this.instruction(d,e));else i(b)&&(b=b.apply()),g=new f(this,a,b),this.instructions.push(g);return this},b.prototype.toString=function(a,b){var c,d,e,f,g,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x;for(p=(null!=a?a.pretty:void 0)||!1,f=null!=(r=null!=a?a.indent:void 0)?r:"  ",o=null!=(s=null!=a?a.offset:void 0)?s:0,n=null!=(t=null!=a?a.newline:void 0)?t:"\n",b||(b=0),x=new Array(b+o+1).join(f),q="",u=this.instructions,e=0,j=u.length;j>e;e++)g=u[e],q+=g.toString(a,b);p&&(q+=x),q+="<"+this.name,v=this.attributes;for(m in v)l.call(v,m)&&(c=v[m],q+=c.toString(a));if(0===this.children.length||h(this.children,function(a){return""===a.value}))q+="/>",p&&(q+=n);else if(p&&1===this.children.length&&null!=this.children[0].value)q+=">",q+=this.children[0].value,q+="</"+this.name+">",q+=n;else{for(q+=">",p&&(q+=n),w=this.children,i=0,k=w.length;k>i;i++)d=w[i],q+=d.toString(a,b+1);p&&(q+=x),q+="</"+this.name+">",p&&(q+=n)}return q},b.prototype.att=function(a,b){return this.attribute(a,b)},b.prototype.ins=function(a,b){return this.instruction(a,b)},b.prototype.a=function(a,b){return this.attribute(a,b)},b.prototype.i=function(a,b){return this.instruction(a,b)},b}(e)}).call(this)},{"./XMLAttribute":194,"./XMLNode":205,"./XMLProcessingInstruction":206,"lodash/create":107,"lodash/every":109,"lodash/isFunction":118,"lodash/isObject":121}],205:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty;m=a("lodash/isObject"),l=a("lodash/isFunction"),k=a("lodash/isEmpty"),g=null,c=null,d=null,e=null,f=null,i=null,j=null,b.exports=h=function(){function b(b){this.parent=b,this.options=this.parent.options,this.stringify=this.parent.stringify,null===g&&(g=a("./XMLElement"),c=a("./XMLCData"),d=a("./XMLComment"),e=a("./XMLDeclaration"),f=a("./XMLDocType"),i=a("./XMLRaw"),j=a("./XMLText"))}return b.prototype.element=function(a,b,c){var d,e,f,g,h,i,j,o,p,q;if(i=null,null==b&&(b={}),b=b.valueOf(),m(b)||(p=[b,c],c=p[0],b=p[1]),null!=a&&(a=a.valueOf()),Array.isArray(a))for(f=0,j=a.length;j>f;f++)e=a[f],i=this.element(e);else if(l(a))i=this.element(a.apply());else if(m(a)){for(h in a)if(n.call(a,h))if(q=a[h],l(q)&&(q=q.apply()),m(q)&&k(q)&&(q=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===h.indexOf(this.stringify.convertAttKey))i=this.attribute(h.substr(this.stringify.convertAttKey.length),q);else if(!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===h.indexOf(this.stringify.convertPIKey))i=this.instruction(h.substr(this.stringify.convertPIKey.length),q);else if(!this.options.separateArrayItems&&Array.isArray(q))for(g=0,o=q.length;o>g;g++)e=q[g],d={},d[h]=e,i=this.element(d);else m(q)?(i=this.element(h),i.element(q)):i=this.element(h,q)}else i=!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?this.text(c):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===a.indexOf(this.stringify.convertCDataKey)?this.cdata(c):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===a.indexOf(this.stringify.convertCommentKey)?this.comment(c):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===a.indexOf(this.stringify.convertRawKey)?this.raw(c):this.node(a,b,c);if(null==i)throw new Error("Could not create any elements with: "+a);return i},b.prototype.insertBefore=function(a,b,c){var d,e,f;if(this.isRoot)throw new Error("Cannot insert elements at root level");return e=this.parent.children.indexOf(this),f=this.parent.children.splice(e),d=this.parent.element(a,b,c),Array.prototype.push.apply(this.parent.children,f),d},b.prototype.insertAfter=function(a,b,c){var d,e,f;if(this.isRoot)throw new Error("Cannot insert elements at root level");return e=this.parent.children.indexOf(this),f=this.parent.children.splice(e+1),d=this.parent.element(a,b,c),Array.prototype.push.apply(this.parent.children,f),d},b.prototype.remove=function(){var a,b;if(this.isRoot)throw new Error("Cannot remove the root element");return a=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[a,a-a+1].concat(b=[])),b,this.parent},b.prototype.node=function(a,b,c){var d,e;return null!=a&&(a=a.valueOf()),null==b&&(b={}),b=b.valueOf(),m(b)||(e=[b,c],c=e[0],b=e[1]),d=new g(this,a,b),null!=c&&d.text(c),this.children.push(d),d},b.prototype.text=function(a){var b;return b=new j(this,a),this.children.push(b),this},b.prototype.cdata=function(a){var b;return b=new c(this,a),this.children.push(b),this},b.prototype.comment=function(a){var b;return b=new d(this,a),this.children.push(b),this},b.prototype.raw=function(a){var b;return b=new i(this,a),this.children.push(b),this},b.prototype.declaration=function(a,b,c){var d,f;return d=this.document(),f=new e(d,a,b,c),d.xmldec=f,d.root()},b.prototype.doctype=function(a,b){var c,d;return c=this.document(),d=new f(c,a,b),c.doctype=d,d},b.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},b.prototype.root=function(){var a;if(this.isRoot)return this;for(a=this.parent;!a.isRoot;)a=a.parent;return a},b.prototype.document=function(){return this.root().documentObject},b.prototype.end=function(a){return this.document().toString(a)},b.prototype.prev=function(){var a;if(this.isRoot)throw new Error("Root node has no siblings");if(a=this.parent.children.indexOf(this),1>a)throw new Error("Already at the first node");return this.parent.children[a-1]},b.prototype.next=function(){var a;if(this.isRoot)throw new Error("Root node has no siblings");if(a=this.parent.children.indexOf(this),-1===a||a===this.parent.children.length-1)throw new Error("Already at the last node");return this.parent.children[a+1]},b.prototype.importXMLBuilder=function(a){var b;return b=a.root().clone(),b.parent=this,b.isRoot=!1,this.children.push(b),this},b.prototype.ele=function(a,b,c){return this.element(a,b,c)},b.prototype.nod=function(a,b,c){return this.node(a,b,c)},b.prototype.txt=function(a){return this.text(a)},b.prototype.dat=function(a){return this.cdata(a)},b.prototype.com=function(a){return this.comment(a)},b.prototype.doc=function(){return this.document()},b.prototype.dec=function(a,b,c){return this.declaration(a,b,c)},b.prototype.dtd=function(a,b){return this.doctype(a,b)},b.prototype.e=function(a,b,c){return this.element(a,b,c)},b.prototype.n=function(a,b,c){return this.node(a,b,c)},b.prototype.t=function(a){return this.text(a)},b.prototype.d=function(a){return this.cdata(a)},b.prototype.c=function(a){return this.comment(a)},b.prototype.r=function(a){return this.raw(a)},b.prototype.u=function(){return this.up()},b}()}).call(this)},{"./XMLCData":196,"./XMLComment":197,"./XMLDeclaration":202,"./XMLDocType":203,"./XMLElement":204,"./XMLRaw":207,"./XMLText":209,"lodash/isEmpty":117,"lodash/isFunction":118,"lodash/isObject":121}],206:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing instruction target");this.target=this.stringify.insTarget(b),c&&(this.value=this.stringify.insValue(c))}return a.prototype.clone=function(){return d(a.prototype,this)},a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<?",g+=this.target,this.value&&(g+=" "+this.value),g+="?>",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":107}],207:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),c=a("./XMLNode"),b.exports=d=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing raw text");this.value=this.stringify.raw(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+=this.value,f&&(g+=d),g},b}(c)}).call(this)},{"./XMLNode":205,"lodash/create":107}],208:[function(a,b,c){(function(){var a,c=function(a,b){return function(){return a.apply(b,arguments)}},d={}.hasOwnProperty;b.exports=a=function(){function a(a){this.assertLegalChar=c(this.assertLegalChar,this);var b,e,f;this.allowSurrogateChars=null!=a?a.allowSurrogateChars:void 0,this.noDoubleEncoding=null!=a?a.noDoubleEncoding:void 0,e=(null!=a?a.stringify:void 0)||{};for(b in e)d.call(e,b)&&(f=e[b],this[b]=f)}return a.prototype.eleName=function(a){return a=""+a||"",this.assertLegalChar(a)},a.prototype.eleText=function(a){return a=""+a||"",this.assertLegalChar(this.elEscape(a))},a.prototype.cdata=function(a){if(a=""+a||"",a.match(/]]>/))throw new Error("Invalid CDATA text: "+a);return this.assertLegalChar(a)},a.prototype.comment=function(a){if(a=""+a||"",a.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+a);return this.assertLegalChar(a)},a.prototype.raw=function(a){return""+a||""},a.prototype.attName=function(a){return""+a||""},a.prototype.attValue=function(a){return a=""+a||"",this.attEscape(a)},a.prototype.insTarget=function(a){return""+a||""},a.prototype.insValue=function(a){if(a=""+a||"",a.match(/\?>/))throw new Error("Invalid processing instruction value: "+a);return a},a.prototype.xmlVersion=function(a){if(a=""+a||"",!a.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+a);return a},a.prototype.xmlEncoding=function(a){if(a=""+a||"",!a.match(/^[A-Za-z](?:[A-Za-z0-9._-]|-)*$/))throw new Error("Invalid encoding: "+a);return a},a.prototype.xmlStandalone=function(a){return a?"yes":"no"},a.prototype.dtdPubID=function(a){return""+a||""},a.prototype.dtdSysID=function(a){return""+a||""},a.prototype.dtdElementValue=function(a){return""+a||""},a.prototype.dtdAttType=function(a){return""+a||""},a.prototype.dtdAttDefault=function(a){return null!=a?""+a||"":a},a.prototype.dtdEntityValue=function(a){return""+a||""},a.prototype.dtdNData=function(a){return""+a||""},a.prototype.convertAttKey="@",a.prototype.convertPIKey="?",a.prototype.convertTextKey="#text",a.prototype.convertCDataKey="#cdata",a.prototype.convertCommentKey="#comment",a.prototype.convertRawKey="#raw",a.prototype.assertLegalChar=function(a){var b,c;if(b=this.allowSurrogateChars?/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uFFFE-\uFFFF]/:/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE-\uFFFF]/,c=a.match(b))throw new Error("Invalid character ("+c+") in string: "+a+" at index "+c.index);return a},a.prototype.elEscape=function(a){var b;return b=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,a.replace(b,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},a.prototype.attEscape=function(a){var b;return b=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,a.replace(b,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},a}()}).call(this)},{}],209:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),c=a("./XMLNode"),b.exports=d=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing element text");this.value=this.stringify.eleText(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+=this.value,f&&(g+=d),g},b}(c)}).call(this)},{"./XMLNode":205,"lodash/create":107}],210:[function(a,b,c){(function(){var c,d;d=a("lodash/assign"),c=a("./XMLBuilder"),b.exports.create=function(a,b,e,f){return f=d({},b,e,f),new c(a,f).root()}}).call(this)},{"./XMLBuilder":195,"lodash/assign":106}],211:[function(a,b,c){function d(){for(var a={},b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)e.call(c,d)&&(a[d]=c[d])}return a}b.exports=d;var e=Object.prototype.hasOwnProperty},{}],212:[function(a,b,c){arguments[4][11][0].apply(c,arguments)},{"./lib/uint32":213,"./lib/uint64":214,dup:11}],213:[function(a,b,c){arguments[4][12][0].apply(c,arguments)},{dup:12}],214:[function(a,b,c){arguments[4][13][0].apply(c,arguments)},{dup:13}],215:[function(a,c,d){(function(d){!function(e){function f(a){for(var b=[],c=0,d=a.length;d>c;c++){var e=a.charCodeAt(c);128>e?b.push(e):2048>e?b.push(192|e>>6,128|63&e):55296>e||e>=57344?b.push(224|e>>12,128|e>>6&63,128|63&e):(c++,e=65536+((1023&e)<<10|1023&a.charCodeAt(c)),b.push(240|e>>18,128|e>>12&63,128|e>>6&63,128|63&e))}return new Uint8Array(b)}function g(){return 2==arguments.length?new g(arguments[1]).update(arguments[0]).digest():this instanceof g?void h.call(this,arguments[0]):new g(arguments[0])}function h(a){return this.seed=a instanceof i?a.clone():i(a),this.v1=this.seed.clone().add(o),this.v2=this.seed.clone().add(k),this.v3=this.seed.clone(),this.v4=this.seed.clone().subtract(j),this.total_len=0,this.memsize=0,this.memory=null,this}var i=a("cuint").UINT32;i.prototype.xxh_update=function(a,b){var c,d,e=k._low,f=k._high;d=a*e,c=d>>>16,c+=b*e,c&=65535,c+=a*f;var g=this._low+(65535&d),h=g>>>16;h+=this._high+(65535&c);var i=h<<16|65535&g;i=i<<13|i>>>19,g=65535&i,h=i>>>16,e=j._low,f=j._high,d=g*e,c=d>>>16,
c+=h*e,c&=65535,c+=g*f,this._low=65535&d,this._high=65535&c};var j=i("2654435761"),k=i("2246822519"),l=i("3266489917"),m=i("668265263"),n=i("374761393"),o=j.clone().add(k);g.prototype.init=h,g.prototype.update=function(a){var b,c="string"==typeof a;c&&(a=f(a),c=!1,b=!0),"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer&&(b=!0,a=new Uint8Array(a));var e=0,g=a.length,h=e+g;if(0==g)return this;if(this.total_len+=g,0==this.memsize&&(c?this.memory="":b?this.memory=new Uint8Array(16):this.memory=new d(16)),this.memsize+g<16)return c?this.memory+=a:b?this.memory.set(a.subarray(0,g),this.memsize):a.copy(this.memory,this.memsize,0,g),this.memsize+=g,this;if(this.memsize>0){c?this.memory+=a.slice(0,16-this.memsize):b?this.memory.set(a.subarray(0,16-this.memsize),this.memsize):a.copy(this.memory,this.memsize,0,16-this.memsize);var i=0;c?(this.v1.xxh_update(this.memory.charCodeAt(i+1)<<8|this.memory.charCodeAt(i),this.memory.charCodeAt(i+3)<<8|this.memory.charCodeAt(i+2)),i+=4,this.v2.xxh_update(this.memory.charCodeAt(i+1)<<8|this.memory.charCodeAt(i),this.memory.charCodeAt(i+3)<<8|this.memory.charCodeAt(i+2)),i+=4,this.v3.xxh_update(this.memory.charCodeAt(i+1)<<8|this.memory.charCodeAt(i),this.memory.charCodeAt(i+3)<<8|this.memory.charCodeAt(i+2)),i+=4,this.v4.xxh_update(this.memory.charCodeAt(i+1)<<8|this.memory.charCodeAt(i),this.memory.charCodeAt(i+3)<<8|this.memory.charCodeAt(i+2))):(this.v1.xxh_update(this.memory[i+1]<<8|this.memory[i],this.memory[i+3]<<8|this.memory[i+2]),i+=4,this.v2.xxh_update(this.memory[i+1]<<8|this.memory[i],this.memory[i+3]<<8|this.memory[i+2]),i+=4,this.v3.xxh_update(this.memory[i+1]<<8|this.memory[i],this.memory[i+3]<<8|this.memory[i+2]),i+=4,this.v4.xxh_update(this.memory[i+1]<<8|this.memory[i],this.memory[i+3]<<8|this.memory[i+2])),e+=16-this.memsize,this.memsize=0,c&&(this.memory="")}if(h-16>=e){var j=h-16;do c?(this.v1.xxh_update(a.charCodeAt(e+1)<<8|a.charCodeAt(e),a.charCodeAt(e+3)<<8|a.charCodeAt(e+2)),e+=4,this.v2.xxh_update(a.charCodeAt(e+1)<<8|a.charCodeAt(e),a.charCodeAt(e+3)<<8|a.charCodeAt(e+2)),e+=4,this.v3.xxh_update(a.charCodeAt(e+1)<<8|a.charCodeAt(e),a.charCodeAt(e+3)<<8|a.charCodeAt(e+2)),e+=4,this.v4.xxh_update(a.charCodeAt(e+1)<<8|a.charCodeAt(e),a.charCodeAt(e+3)<<8|a.charCodeAt(e+2))):(this.v1.xxh_update(a[e+1]<<8|a[e],a[e+3]<<8|a[e+2]),e+=4,this.v2.xxh_update(a[e+1]<<8|a[e],a[e+3]<<8|a[e+2]),e+=4,this.v3.xxh_update(a[e+1]<<8|a[e],a[e+3]<<8|a[e+2]),e+=4,this.v4.xxh_update(a[e+1]<<8|a[e],a[e+3]<<8|a[e+2])),e+=4;while(j>=e)}return h>e&&(c?this.memory+=a.slice(e):b?this.memory.set(a.subarray(e,h),this.memsize):a.copy(this.memory,this.memsize,e,h),this.memsize=h-e),this},g.prototype.digest=function(){var a,b,c=this.memory,d="string"==typeof c,e=0,f=this.memsize,g=new i;for(a=this.total_len>=16?this.v1.rotl(1).add(this.v2.rotl(7).add(this.v3.rotl(12).add(this.v4.rotl(18)))):this.seed.add(n),a.add(g.fromNumber(this.total_len));f-4>=e;)d?g.fromBits(c.charCodeAt(e+1)<<8|c.charCodeAt(e),c.charCodeAt(e+3)<<8|c.charCodeAt(e+2)):g.fromBits(c[e+1]<<8|c[e],c[e+3]<<8|c[e+2]),a.add(g.multiply(l)).rotl(17).multiply(m),e+=4;for(;f>e;)g.fromBits(d?c.charCodeAt(e++):c[e++],0),a.add(g.multiply(n)).rotl(11).multiply(j);return b=a.clone().shiftRight(15),a.xor(b).multiply(k),b=a.clone().shiftRight(13),a.xor(b).multiply(l),b=a.clone().shiftRight(16),a.xor(b),this.init(this.seed),a},"undefined"!=typeof b&&b.amd?b([],function(){return g}):"undefined"!=typeof c&&c.exports?c.exports=g:e.XXH=g}(this)}).call(this,a("buffer").Buffer)},{buffer:9,cuint:212}],216:[function(a,b,c){"use strict";function d(b){[a("./nodes/visual/group"),a("./nodes/visual/image"),a("./nodes/visual/rectangle"),a("./nodes/visual/circle"),a("./nodes/visual/text"),a("./nodes/visual/stacklayout"),a("./nodes/visual/flowlayout"),a("./nodes/visual/scrollview"),a("./nodes/counter"),a("./nodes/expression"),a("./nodes/and"),a("./nodes/or"),a("./nodes/switch"),a("./nodes/numberblend"),a("./nodes/stringselector"),a("./nodes/stringmapper"),a("./nodes/drag"),a("./nodes/inverter"),a("./nodes/timer"),a("./nodes/velocity"),a("./nodes/variables/number"),a("./nodes/variables/string"),a("./nodes/variables/boolean"),a("./nodes/variables/color"),a("./nodes/touchposition"),a("./nodes/signaltoindex"),a("./nodes/substring"),a("./nodes/gyroscope"),a("./nodes/reload"),a("./nodes/colorblend"),a("./nodes/globals"),a("./nodes/eventsender"),a("./nodes/eventreceiver"),a("./nodes/screenresolution"),a("./nodes/javascript"),a("./nodes/javascript2"),a("./nodes/animation"),a("./nodes/transition"),a("./nodes/numberremapper"),a("./nodes/websocket"),a("./nodes/componentinputs"),a("./nodes/componentoutputs"),a("./nodes/valuechanged"),a("./nodes/visual/textinput"),a("./nodes/visual/page"),a("./nodes/visual/pages"),a("./nodes/pagenavigation"),a("./nodes/pagenavigationback"),a("./nodes/states"),a("./nodes/stringformat"),a("./nodes/data/foreach"),a("./nodes/data/foreachactions"),a("./nodes/data/modelnode"),a("./nodes/data/collectionnode"),a("./nodes/data/staticdata"),a("./nodes/data/restnode"),a("./nodes/sendmessage"),a("./nodes/receivemessage")].forEach(function(a){b.registerNode(a)})}function e(a){if(!a)return{};for(var b={},c=a.substr(1).split("&"),d=0;d<c.length;d++){var e=c[d].split("=");b[decodeURIComponent(e[0])]=decodeURIComponent(e[1]||"")}return b}function f(a){function b(a,b){if(c.rootComponent){var d=c.rootComponent.nodeScope.getNodesWithIdRecursive(a);d.forEach(function(a){a.setHighlightEnabled&&a.setHighlightEnabled(b)})}}var c=this;a=a||{},f.instance=this,this.frameScheduled=!1,this.rootComponent=null,this._currentLoadedData=null,this.isWaitingForExport=!0,this.graphModel=new l,this.transparentBackground=!1,this.runningInEditor=a.runStandalone?!1:!0,n.instance.setIsRunningInEditor(this.runningInEditor),this.editorConnection=new h,this.editorConnection.on("exportDataFull",function(a){c.patchExportData(a)===!1?(c.isWaitingForExport=!1,A.isEqual(c._currentLoadedData,a)===!1&&c.setData(a)):c.editorConnection.requestFullExport()}),this.editorConnection.on("hoverStart",function(a){b(a,!0)}),this.editorConnection.on("hoverEnd",function(a){b(a,!1)}),this.editorConnection.on("reload",this.reload.bind(this)),this.editorConnection.on("inspectStart",function(){c.enableInspector(function(a){c.editorConnection.sendInspectId(a)})}),this.editorConnection.on("inspectEnd",this.disableInspector.bind(this)),this.editorConnection.on("modelUpdate",this.onModelUpdateReceived.bind(this)),this.context=new g({uiEngineClass:s,runningInEditor:this.runningInEditor,editorConnection:this.editorConnection}),this.editorConnection.isRunningLocally()&&(this.context.setOutputCollectionEnabled(!0),this.editorConnection.on("connected",function(){c.sendNodeLibrary()})),this.editorConnection.on("debuggingEnabledChanged",this.context.setOutputCollectionEnabled.bind(this.context)),this.editorConnection.on("captureScreenShot",function(a){a.callback(c.context.uiEngine.captureScreenShot(a.width,a.height))}),this.context.eventEmitter.on("scheduleFrame",this.scheduleFrame.bind(this)),this.context.eventEmitter.on("reloadApplication",this.reload.bind(this)),this.registerGraphModelListeners(),this._resetData(),d(this),this.inspector=new w,this.textInputRenderer=new u,this.textInputRenderer.setRenderInputFieldsOnly(!0),p.pubsub=new q,p.pubsub.setConnection(this.editorConnection)}var g=a("./nodecontext"),h=a("./editorconnection"),i=a("./nodelibraryexport"),j=a("./projectsettings"),k=a("./projectpatchers"),l=a("./models/graphmodel"),m=a("./nodedefinition"),n=a("./fontloader"),o=a("./editormodeleventshandler"),p=a("./services/services"),q=a("./services/pubsub"),r=a("./services/mqtt-connection"),s=a("./uiengine/uiengine"),t=a("./uiengine/renderers/renderer-canvas2d"),u=a("./uiengine/renderers/renderer-dom"),v=a("./uiengine/renderers/renderer-webgl"),w=a("./inspector"),x=a("./useragent-utils"),y=a("./session-recorder"),z=a("./guid"),A=a("lodash");f.prototype.registerGraphModelListeners=function(){var a=this;this.graphModel.on("componentAdded",function(b){a.context.registerComponentModel(b)},this),this.graphModel.on("componentRemoved",function(b){a.context.deregisterComponentModel(b)},this),this.graphModel.on("settingsUpdated",function(){a.setViewportSettings(a.graphModel.getDeviceSettings(a.deviceName)),a.sendNodeLibrary()})},f.prototype.reload=function(){this._currentLoadedData&&this.setData(this._currentLoadedData)},f.prototype._resetData=function(){this.frameNumber=0,this.rootComponent=null,this._currentLoadedData=null,this.graphModel.reset(),this.context.reset()},f.prototype.registerNode=function(a){a.node?(this.context.nodeRegister.register(m.defineNode(a.node)),a.setup&&a.setup(this.context,this.graphModel)):this.context.nodeRegister.register(a)},f.prototype.patchExportData=function(a){var b=k.collectPatches(a),c=Object.keys(b),d=j.collectPatch(a.settings),e=this;return c.length>0||d?(this.editorConnection.isRunningLocally()&&(c.forEach(function(a){e.editorConnection.sendPatches(b[a])}),d&&e.editorConnection.sendPatches(d)),!0):!1},f.prototype.setRenderer=function(a){var b=this.context.uiEngine;b.removeAllRenderers();var c=x.isMobile.any();"canvas2d"===a?(b.addRenderer(new t({alpha:this.transparentBackground,useScreenResolution:c})),b.addRenderer(this.textInputRenderer)):"webgl"===a?(b.addRenderer(new v({alpha:this.transparentBackground})),b.addRenderer(this.textInputRenderer)):b.addRenderer(new u),this.sessionRecorder&&b.addRenderer(this.sessionRecorder.getRenderer())},f.prototype.setViewportSettings=function(a){this.currentRenderer!==a.renderer&&(this.setRenderer(a.renderer),this.currentRenderer=a.renderer),this.context.uiEngine.setFillMode(a.fillMode),"aspectFit"===a.fillMode&&this.context.uiEngine.setAspectFitViewport(a.canvasWidth,a.canvasHeight)},f.prototype.setData=function(a){this.graphModel.isEmpty()===!1&&this._resetData();var b=a.settings.devices&&a.settings.devices.split(",").length>1,c=e(window.location.search),d=this.editorConnection.isRunningLocally()===!1&&b>0&&!c.device;if(d){var f=JSON.stringify({settings:{devices:"Default Device","Default Device.fillMode":"fill","Default Device.renderer":"canvas2d","Default Device.rootComponent":"/Main"},components:[{name:"/Main",nodes:[{id:"2d3ccd33-f1ef-2dc5-3e1a-ca9d61cd222b",type:"Group",parameters:{fill:"parent"},ports:[],children:[{id:"fa90ea16-1232-0437-deea-5dd6263d8247",type:"Rectangle",parameters:{color:"#ebebf2"},ports:[],children:[]},{id:"84ce46fb-1240-c8b1-6cf8-d49b466af961",type:"Scroll View",parameters:{sizeMode:"explicit",alignX:"left",alignY:"top",clip:!0,paddingTop:50,paddingBottom:50,itemSpacing:20},ports:[],children:[{id:"919460fe-c10e-9656-1924-3b39afe0a908",type:"Text",version:2,parameters:{text:"NOODL DEVICE LIST",color:"#666666",fontSize:26,x:30,fontFamily:"fonts/Roboto-Regular.ttf"},ports:[],children:[]},{id:"88e5bc50-f85b-7cfc-61a9-8a8e947a91e0",type:"Stack Layout",parameters:{sizeMode:"childHeight"},ports:[],children:[{id:"6fff1cb1-b58c-aafd-8790-951dd51e2230",type:"For Each",parameters:{template:"/Device Item"},ports:[{name:"template",plug:"input",type:"component",displayName:"Component",group:"Appearance",index:3}],children:[]}]},{id:"01d3bb07-74e9-f7c5-442b-dda6601882b7",type:"Text",version:2,parameters:{text:"Choose a device from the list",color:"#666666",fontSize:16,x:30,fontFamily:"fonts/Roboto-Light.ttf"},ports:[],children:[]}]}]},{id:"23a6c0c0-859b-cf8d-af06-95dba0c57d78",type:"Collection",parameters:{collectionId:"Devices"},ports:[{name:"collectionId",plug:"input",type:"string",displayName:"Id",group:"General",index:9}],children:[]},{id:"55b1046f-9c39-c183-7a7e-f7d0a0afd7a3",type:"Static Data",parameters:{csv:"DeviceName\nDevice 1\nMy Other Device\nSome third device"},ports:[{name:"csv",plug:"input",type:{name:"string",codeeditor:"text"},displayName:"CSV",group:"General",index:2}],children:[]}],connections:[{sourceId:"55b1046f-9c39-c183-7a7e-f7d0a0afd7a3",sourcePort:"items",targetId:"23a6c0c0-859b-cf8d-af06-95dba0c57d78",targetPort:"items"},{sourceId:"23a6c0c0-859b-cf8d-af06-95dba0c57d78",sourcePort:"items",targetId:"6fff1cb1-b58c-aafd-8790-951dd51e2230",targetPort:"items"}],ports:[],roots:["2d3ccd33-f1ef-2dc5-3e1a-ca9d61cd222b"]},{name:"/Device Item",nodes:[{id:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",type:"Group",version:2,parameters:{sizeMode:"explicit",height:{value:55,unit:"px"}},ports:[],children:[{id:"73bb365b-38c7-efde-1516-d06c61315551",type:"Rectangle",parameters:{color:"#ffffff"},ports:[],children:[]},{id:"1e991ed3-43de-e5ac-f939-1162d2bb010f",type:"Rectangle",parameters:{alignY:"top",color:"#c8c7cc",height:{value:1,unit:"px"}},ports:[],children:[]},{id:"a857ab77-b302-ec9d-b820-52be3faf623d",type:"Rectangle",parameters:{alignY:"bottom",color:"#c8c7cc",height:{value:1,unit:"px"}},ports:[],children:[]},{id:"0e012b10-9938-cedd-cb1d-8f643353367d",type:"Group",version:2,parameters:{sizeMode:"explicit",paddingLeft:30,paddingRight:30},ports:[],children:[{id:"8ecd1a84-167a-67c3-ea68-eca597baf606",type:"Rectangle",parameters:{alignY:"bottom",color:"#c8c7cc",height:{value:1,unit:"px"}},ports:[],children:[]},{id:"84669e81-f629-9b95-e309-a409ef64ff2e",type:"Text",version:2,parameters:{color:"#000000",fontFamily:"fonts/Roboto-Light.ttf",alignX:"left",alignY:"center",sizeMode:"childHeight",fontSize:20},ports:[],children:[]},{id:"7e35cfcb-81a5-14d4-6e30-cf04ff69ec6f",type:"Group",version:2,parameters:{alignY:"center",sizeMode:"childSize",alignX:"right"},ports:[],children:[{id:"7210c16d-d9cf-604f-cd4e-c3014d6487ee",type:"Rectangle",parameters:{height:{value:2,unit:"px"},width:{value:10,unit:"px"},color:"#666666",rotationZ:45,y:-3},ports:[],children:[]},{id:"5faf645f-3c87-219c-3371-3eeda03986bc",type:"Rectangle",parameters:{height:{value:2,unit:"px"},width:{value:10,unit:"px"},color:"#666666",rotationZ:-45,y:4},ports:[],children:[]}]}]}]},{id:"26f178df-a067-6a5f-1d93-d146462b9c0b",type:"Model",parameters:{idType:"instance",properties:"DeviceName"},ports:[{type:{name:"*",allowConnectionsOnly:!0},plug:"input/output",group:"Properties",name:"DeviceName",index:6}],children:[]},{id:"ce5249b7-7681-8532-080b-47206583620c",type:"Collection",parameters:{collectionId:"Devices"},ports:[{name:"collectionId",plug:"input",type:"string",displayName:"Id",group:"General",index:9}],children:[]},{id:"90b0f462-064f-4a96-98f5-e0b99d2c2f42",type:"Expression",parameters:{expression:"childIndex < count - 1"},ports:[{name:"childIndex",type:{name:"number"},plug:"input",index:2},{name:"count",type:{name:"number"},plug:"input",index:3}],children:[]},{id:"28d2af23-0c6e-db12-ad4f-8b5e1099e083",type:"Event Sender",parameters:{channelName:"Device Chosen"},ports:[{name:"DeviceName",plug:"input",type:{name:"*",allowConnectionOnly:!0},index:1}],children:[]},{id:"bf2def97-8cbf-a904-91ea-42f4fb14ccf8",type:"Expression",parameters:{expression:"childIndex === 0"},ports:[{name:"childIndex",type:{name:"number"},plug:"input",index:2}],children:[]},{id:"55ae463a-5ceb-2a1b-827f-19a30dc7895e",type:"Expression",parameters:{expression:"childIndex === count - 1"},ports:[{name:"childIndex",type:{name:"number"},plug:"input",index:2},{name:"count",type:{name:"number"},plug:"input",index:3}],children:[]}],connections:[{sourceId:"26f178df-a067-6a5f-1d93-d146462b9c0b",sourcePort:"DeviceName",targetId:"84669e81-f629-9b95-e309-a409ef64ff2e",targetPort:"text"},{sourceId:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",sourcePort:"childIndex",targetId:"90b0f462-064f-4a96-98f5-e0b99d2c2f42",targetPort:"childIndex"},{sourceId:"ce5249b7-7681-8532-080b-47206583620c",sourcePort:"count",targetId:"90b0f462-064f-4a96-98f5-e0b99d2c2f42",targetPort:"count"},{sourceId:"90b0f462-064f-4a96-98f5-e0b99d2c2f42",sourcePort:"result",targetId:"8ecd1a84-167a-67c3-ea68-eca597baf606",targetPort:"visible"},{sourceId:"26f178df-a067-6a5f-1d93-d146462b9c0b",sourcePort:"DeviceName",targetId:"28d2af23-0c6e-db12-ad4f-8b5e1099e083",targetPort:"DeviceName"},{sourceId:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",sourcePort:"touch.tap",targetId:"28d2af23-0c6e-db12-ad4f-8b5e1099e083",targetPort:"sendEvent"},{sourceId:"bf2def97-8cbf-a904-91ea-42f4fb14ccf8",sourcePort:"result",targetId:"1e991ed3-43de-e5ac-f939-1162d2bb010f",targetPort:"visible"},{sourceId:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",sourcePort:"childIndex",targetId:"bf2def97-8cbf-a904-91ea-42f4fb14ccf8",targetPort:"childIndex"},{sourceId:"ce5249b7-7681-8532-080b-47206583620c",sourcePort:"count",targetId:"55ae463a-5ceb-2a1b-827f-19a30dc7895e",targetPort:"count"},{sourceId:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",sourcePort:"childIndex",targetId:"55ae463a-5ceb-2a1b-827f-19a30dc7895e",targetPort:"childIndex"},{sourceId:"55ae463a-5ceb-2a1b-827f-19a30dc7895e",sourcePort:"result",targetId:"a857ab77-b302-ec9d-b820-52be3faf623d",targetPort:"visible"}],ports:[],roots:["ccd8d324-7db3-d669-1099-dd84a0da6cf1"]}],rootComponent:"/Main",rootNode:"2d3ccd33-f1ef-2dc5-3e1a-ca9d61cd222b"});f=f.replace(/fonts\//g,"external/viewer/fonts/"),f=JSON.parse(f),this._currentLoadedData=f,this.graphModel.importEditorData(f),this.graphModel.getComponentWithName("/Main").removeNodeWithId(this.graphModel.getNodesWithType("Static Data")[0].id),this.deviceName="Default Device",this.context.eventSenderEmitter.once("Device Chosen",function(a){window.location=window.location.href+(window.location.search?"&":"?")+"device="+a.DeviceName}),this.editorConnection.close()}else{this._currentLoadedData=a,this.graphModel.importEditorData(a);var g=this.graphModel.getSettings();this.runningInEditor===!1&&g.analyticsEnabled&&this.recordSession(this.graphModel.getSettings().analyticsServerUrl),g.mqttUseExternalBroker?(this.mqttConnection||(this.mqttConnection=new r),this.mqttConnection.connect({url:g.mqttBrokerUrl,clientId:(this.deviceName||"Noodl Editor")+"-"+z()}),p.pubsub.setConnection(this.mqttConnection)):p.pubsub.setConnection(this.editorConnection)}var h=this.graphModel.getDeviceSettings(c.device);this.deviceName=h.name;var i,j;if(this.editorConnection.isRunningLocally()&&!c.device?(i=this.graphModel.rootComponent,j=this.graphModel.rootNode):(i=h.rootComponent||this.graphModel.rootComponent,j=h.rootId),j||(j=this.graphModel.getComponentWithName(i).getFirstRootId()),this.rootComponent=this.context.createComponentInstanceNode(i),this.rootComponent.setRoot(j),this.context.setRootComponent(this.rootComponent),this.setViewportSettings(h),window.Noodl=this.rootComponent.nodeScope.noodlJavascriptAPI,d){var k=a.settings.devices.split(",").map(function(a){return{DeviceName:a}});this.rootComponent.nodeScope.noodlJavascriptAPI.Collection.get("Devices").set(k)}this.scheduleFrame()},f.prototype.scheduleFrame=function(){this.frameScheduled||(window.requestAnimationFrame(f.prototype._doFrame.bind(this)),this.frameScheduled=!0)},f.prototype._doFrame=function(){this.frameScheduled=!1,this.context.currentFrameTime=window.performance.now(),this.context.eventEmitter.emit("frameStart"),this.context.update(),this.context.layout(),this.context.update(),this.context.uiEngine.renderFrame(),this.context.eventEmitter.emit("frameEnd"),this.frameNumber++},f.prototype.getNodeLibrary=function(){var a=j.generateProjectSettings(this.graphModel.getRawProjectSettings()),b=i(this.context.nodeRegister);return b.projectsettings=a,JSON.stringify(b,null,3)},f.prototype.sendNodeLibrary=function(){var a=this.getNodeLibrary();this.lastSentNodeLibrary!==a&&(this.lastSentNodeLibrary=a,this.editorConnection.send({cmd:"nodelibrary",type:"viewer",content:this.getNodeLibrary()}))},f.prototype.enableInspector=function(a){this.inspector.enable(this.context.uiEngine,a)},f.prototype.disableInspector=function(){this.inspector.disable()},f.prototype.connectToEditor=function(a){this.editorConnection.connect(a)},f.prototype.onModelUpdateReceived=function(a){this.isWaitingForExport||("projectInstanceChanged"===a.type?(this.context.uiEngine.clearImageCache(),this._resetData(),this.scheduleFrame(),this.isWaitingForExport=!0):o.handleEvent(this.context,this.graphModel,a))},f.prototype.recordSession=function(a){this.sessionRecorder=new y(z(),a),this.context.setSessionRecorder(this.sessionRecorder),this.context.uiEngine.on("touchEvent",this.sessionRecorder.appendTouchEvent.bind(this.sessionRecorder)),this.context.uiEngine.addRenderer(this.sessionRecorder.getRenderer())},b.exports=f},{"./editorconnection":219,"./editormodeleventshandler":220,"./fontloader":222,"./guid":223,"./inspector":224,"./models/graphmodel":227,"./nodecontext":230,"./nodedefinition":231,"./nodelibraryexport":232,"./nodes/and":234,"./nodes/animation":235,"./nodes/colorblend":236,"./nodes/componentinputs":237,"./nodes/componentoutputs":239,"./nodes/counter":240,"./nodes/data/collectionnode":242,"./nodes/data/foreach":243,"./nodes/data/foreachactions":244,"./nodes/data/modelnode":246,"./nodes/data/restnode":247,"./nodes/data/staticdata":248,"./nodes/drag":249,"./nodes/eventreceiver":250,"./nodes/eventsender":251,"./nodes/expression":252,"./nodes/globals":253,"./nodes/gyroscope":254,"./nodes/inverter":255,"./nodes/javascript":256,"./nodes/javascript2":257,"./nodes/numberblend":258,"./nodes/numberremapper":259,"./nodes/or":260,"./nodes/pagenavigation":261,"./nodes/pagenavigationback":262,"./nodes/receivemessage":263,"./nodes/reload":264,"./nodes/screenresolution":265,"./nodes/sendmessage":266,"./nodes/signaltoindex":267,"./nodes/states":268,"./nodes/stringformat":269,"./nodes/stringmapper":270,"./nodes/stringselector":271,"./nodes/substring":272,"./nodes/switch":273,"./nodes/timer":274,"./nodes/touchposition":275,"./nodes/transition":276,"./nodes/valuechanged":277,"./nodes/variables/boolean":278,"./nodes/variables/color":279,"./nodes/variables/number":280,"./nodes/variables/string":281,"./nodes/velocity":283,"./nodes/visual/circle":284,"./nodes/visual/flowlayout":285,"./nodes/visual/group":286,"./nodes/visual/image":287,"./nodes/visual/page":289,"./nodes/visual/pages":290,"./nodes/visual/rectangle":291,"./nodes/visual/scrollview":293,"./nodes/visual/stacklayout":294,"./nodes/visual/text":295,"./nodes/visual/textinput":296,"./nodes/websocket":298,"./projectpatchers":302,"./projectsettings":303,"./services/mqtt-connection":304,"./services/pubsub":305,"./services/services":306,"./session-recorder":308,"./uiengine/renderers/renderer-canvas2d":339,"./uiengine/renderers/renderer-dom":340,"./uiengine/renderers/renderer-webgl":341,"./uiengine/uiengine":357,"./useragent-utils":358,lodash:128}],217:[function(a,b,c){"use strict";var d={easeOutQuartic:function(a,b,c){return c--,-(b-a)*(c*c*c*c-1)+a},easeInQuartic:function(a,b,c){return(b-a)*(c*c*c*c)+a},easeInOutQuartic:function(a,b,c){return c*=2,1>c?(b-a)/2*c*c*c*c+a:(c-=2,-(b-a)/2*(c*c*c*c-2)+a)},easeOutCubic:function(a,b,c){return c--,(b-a)*(c*c*c+1)+a},easeInCubic:function(a,b,c){return(b-a)*(c*c*c)+a},easeInOutCubic:function(a,b,c){return c*=2,1>c?(b-a)/2*c*c*c+a:(c-=2,(b-a)/2*(c*c*c+2)+a)},easeOutQuadratic:function(a,b,c){return-(b-a)*c*(c-2)+a},easeInQuadratic:function(a,b,c){return(b-a)*(c*c)+a},easeInOutQuadratic:function(a,b,c){return c*=2,1>c?(b-a)/2*c*c+a:(c-=1,-(b-a)/2*(c*(c-2)-1)+a)},linear:function(a,b,c){return a+(b-a)*c}};d.easeIn=d.easeInCubic,d.easeOut=d.easeOutCubic,d.easeInOut=d.easeInOutCubic,b.exports=d},{}],218:[function(a,b,c){"use strict";function d(a){var b=!1;return function(c){c=c?!0:!1,c&&b===!1&&a.valueChangedToTrue.call(this),b=c}}b.exports={createSetter:d}},{}],219:[function(a,b,c){"use strict";function d(a){var b=a||{};e.call(this),this.ws=a&&a.webSocketClass||WebSocket,this.reconnectOnClose=!0,this.forceDebugger=b.forceDebugger||"undefined"!=typeof document&&-1!==document.location.href.indexOf("forceDebugger=true")}var e=a("./eventsender"),f=a("./services/services"),g=a("./guid");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.isRunningLocally=function(){var a="undefined"!=typeof document&&("localhost"===document.location.hostname||"127.0.0.1"===document.location.hostname);return a},d.prototype.connect=function(a){this.socket=new this.ws(a);var b=this;this.socket.addEventListener("open",function(){b.clientId=g(),b.socket.send(JSON.stringify({cmd:"register",type:"viewer",clientId:b.clientId})),b.emit("connected")}),this.socket.addEventListener("close",function(){b.reconnectOnClose&&b.reconnect(a),b.emit("connectionClosed")}),this.socket.addEventListener("error",function(c){console.log("Editor connection error, trying to reconnect"),b.reconnect(a)}),this.socket.addEventListener("message",function(a){var c,d=JSON.parse(a.data);"registered"===d.cmd||("export"===d.cmd?(c=JSON.parse(d.content),"full"===d.type&&b.emit("exportDataFull",c)):"hoverStart"===d.cmd?b.emit("hoverStart",d.content.id):"hoverEnd"===d.cmd?b.emit("hoverEnd",d.content.id):"refresh"===d.cmd?b.emit("reload"):"inspectStart"===d.cmd?b.emit("inspectStart"):"inspectEnd"===d.cmd?b.emit("inspectEnd"):"capture"===d.cmd?b.isRunningLocally()&&(c=JSON.parse(d.content),b.sendThumbnailCapture(c.width,c.height)):"connectionInspectors"===d.cmd?(b.isRunningLocally()||b.forceDebugger)&&(c=JSON.parse(d.content),b.emit("connectionInspectorsUpdated",c.connectionsToInspect)):"debuggingEnabled"===d.cmd?(b.isRunningLocally()||b.forceDebugger)&&(c=JSON.parse(d.content),b.emit("debuggingEnabledChanged",c.enabled)):"modelUpdate"===d.cmd?b.emit("modelUpdate",d.content):"publish"===d.cmd?f.pubsub.routeMessage(d):console.log("Command not implemented",d))})},d.prototype.reconnect=function(a){var b=this;setTimeout(function(){b.connect(a)},2e3)},d.prototype.isConnected=function(){return void 0!==this.socket&&this.socket.readyState===this.ws.OPEN},d.prototype.send=function(a){this.isConnected()!==!1&&this.socket.send(JSON.stringify(a))},d.prototype.sendInspectId=function(a){this.send({cmd:"select",type:"viewer",content:JSON.stringify({id:a})})},d.prototype.sendPulsingConnections=function(a){var b=[];Object.keys(a).forEach(function(c){var d=a[c];b=b.concat(d.connections)}),this.send({cmd:"connectiondebugpulse",type:"viewer",content:JSON.stringify({connectionsToPulse:b})})},d.prototype.sendConnectionValues=function(a){this.send({cmd:"connectionvalue",type:"viewer",content:JSON.stringify({connections:a})})},d.prototype.sendDynamicPorts=function(a,b){this.send({cmd:"instanceports",type:"viewer",content:JSON.stringify({nodeid:a,ports:b})})},d.prototype.sendThumbnailCapture=function(a,b){var c=this;this.emit("captureScreenShot",{width:a,height:b,callback:function(a){c.send({cmd:"captured",type:"viewer",content:JSON.stringify({data:a})})}})},d.prototype.sendWarning=function(a,b,c,d){this.send({cmd:"showwarning",type:"viewer",content:JSON.stringify({componentName:a,nodeId:b,key:c,warning:d})})},d.prototype.clearWarnings=function(a,b){this.send({cmd:"clearwarnings",type:"viewer",content:JSON.stringify({componentName:a,nodeId:b})})},d.prototype.sendPatches=function(a){this.send({cmd:"patchproject",type:"viewer",content:JSON.stringify(a)})},d.prototype.requestFullExport=function(){this.send({cmd:"register",type:"viewer"})};var h={};d.prototype.sendServiceRequest=function(a,b){a.token=g(),a.clientId=this.clientId,h[a.token]=b,this.send(a)},d.prototype.close=function(){this.reconnectOnClose=!1,this.isConnected()!==!1&&this.socket.close()},b.exports=d},{"./eventsender":221,"./guid":223,"./services/services":306}],220:[function(a,b,c){"use strict";function d(a,b,c){function d(b,c){var d={},f={};c.forEach(function(a){("input"===a.plug||"input/output"===a.plug)&&(d[a.name]=a),("output"===a.plug||"input/output"===a.plug)&&(f[a.name]=a)});var h=Object.keys(b.getInputPorts()),i=e.difference(h,Object.keys(d)),j=e.difference(Object.keys(d),h);i.forEach(b.removeInputPortWithName.bind(b)),j.forEach(function(c){b.addInputPort(d[c]),b.parameters&&b.parameters.hasOwnProperty(c)&&g(a.rootComponent.nodeScope,b,c,b.parameters[c])});var k=Object.keys(b.getOutputPorts()),l=e.difference(k,Object.keys(f)),m=e.difference(Object.keys(f),k);l.forEach(b.removeOutputPortWithName.bind(b)),m.forEach(function(a){b.addOutputPort(f[a])})}function f(a,b,c){if(a.hasNode(b)!==!1){var d=a.getNodeMetadata(b),e=d.inputs[c];if(e)return e.type.defaultUnit?{value:e["default"],unit:e.type.defaultUnit}:e["default"]}}function g(a,b,c,d){var e=a.getNodesWithIdRecursive(b.id);e.forEach(function(a){a.queueInput(c,d)})}var h;c.componentName&&(h=b.getComponentWithName(c.componentName));var i={nodeAdded:function(a){h.importEditorNodeData(a.model,a.parentId,a.childIndex)},nodeRemoved:function(a){h.removeNodeWithId(a.model.id)},connectionAdded:function(a){h.addConnection(a.model)},connectionRemoved:function(b){h.removeConnection(b.model);var c=h.getNodeWithId(b.model.targetId);if(0===h.getConnectionsToPort(c.id,b.model.targetId).length){var d=c.parameters[b.model.targetPort];void 0===d&&(d=f(a.nodeRegister,c.type,b.model.targetPort)),g(a.rootComponent.nodeScope,c,b.model.targetPort,d)}},parameterChanged:function(b){var c=h.getNodeWithId(b.nodeId);if(void 0===c)return void console.log("parameterChanged: Unkown node id",b);var d=b.parameterValue;void 0===d&&(d=f(a.nodeRegister,c.type,b.parameterName)),c.setParameter(b.parameterName,d)},nodeAttached:function(a){h.setNodeParent(h.getNodeWithId(a.nodeId),h.getNodeWithId(a.parentId),a.childIndex)},nodeDetached:function(a){h.setNodeParent(h.getNodeWithId(a.nodeId),null)},componentAdded:function(a){b.importComponentFromEditorData(a.model)},componentRemoved:function(a){b.removeComponentWithName(a.componentName)},rootAdded:function(a){h.addRootId(a.nodeId)},projectRootNodeChanged:function(b){a.editorConnection.requestFullExport()},portAdded:function(b){var c=h.getNodeWithId(b.nodeId);("input"===b.port.plug||"input/output"===b.port.plug)&&(c.addInputPort(b.port),c.parameters.hasOwnProperty(b.port)&&g(a.rootComponent.nodeScope,c,b.port,c.parameters[b.port])),("output"===b.port.plug||"input/output"===b.port.plug)&&c.addOutputPort(b.port)},portRemoved:function(a){var b=h.getNodeWithId(a.nodeId);("input"===a.port.plug||"input/output"===a.port.plug)&&b.removeInputPortWithName(a.port.name),("output"===a.port.plug||"input/output"===a.port.plug)&&b.removeOutputPortWithName(a.port.name)},nodePortRenamed:function(a){("input"===a.port.plug||"input/output"===a.port.plug)&&h.renameInputPortOnNodeWithId(a.nodeId,a.oldName,a.port.name),("output"===a.port.plug||"input/output"===a.port.plug)&&h.renameOutputPortOnNodeWithId(a.nodeId,a.oldName,a.port.name);var c=h.getNodeWithId(a.nodeId);"Component Inputs"===c.type?(h.addInputPort(a.port),b.getNodesWithType(h.name).forEach(function(b){b.component.renameInputPortOnNodeWithId(b.id,a.oldName,a.port.name)}),h.removeInputPortWithName(a.oldName)):"Component Outputs"===c.type&&(h.addOutputPort(a.port),b.getNodesWithType(h.name).forEach(function(b){b.component.renameOutputPortOnNodeWithId(b.id,a.oldName,a.port.name)}),h.removeOutputPortWithName(a.oldName))},componentPortsUpdated:function(a){d(h,a.ports)},instancePortsChanged:function(a){var b=h.getNodeWithId(a.nodeId);d(b,a.ports)},componentRenamed:function(a){b.renameComponent(a.oldName,a.newName)},settingsChanged:function(a){b.setSettings(a.settings)}};i.hasOwnProperty(c.type)?(i[c.type](c),a.scheduleFrame()):console.log("Unknown event",c)}var e=a("lodash");b.exports={handleEvent:d}},{lodash:128}],221:[function(a,b,c){"use strict";function d(){this.listeners={},this.numListeners={}}var e=a("lodash");d.prototype.on=function(a,b,c){this.listeners.hasOwnProperty(a)||(this.listeners[a]=[],this.numListeners[a]=0),this.listeners[a].push({callback:b,ref:c}),this.numListeners[a]++,this.numListeners[a]>1e3&&console.trace("too many events",a,this.numListeners[a])},d.prototype.removeListenersWithRef=function(a){var b=this.numListeners;e.forIn(this.listeners,function(c,d){var f=e.remove(c,function(b){return b.ref===a});b[d]-=f.length})},d.prototype.removeAllListeners=function(a){a?(delete this.listeners[a],delete this.numListeners[a]):(this.listeners={},this.numListeners={})},d.prototype.emit=function(a,b){var c=this.listeners[a];c&&c.forEach(function(a){a.callback.call(a.ref,b)})},b.exports=d},{lodash:128}],222:[function(a,b,c){"use strict";function d(){this.loadedFontFamilies={},this.fontCssFamiliesAdded={},
this.fontCallbacks={};var a=this;["Arial","Arial Black","Courier New","Helvetica","Impact","Lucida Console","Tahoma","Times New Roman"].forEach(function(b){a.loadedFontFamilies[b]=!0})}function e(a){return a.replace(/\.[^\/.]+$/,"")}d.prototype.setIsRunningInEditor=function(a){this.isRunningInEditor=a},d.prototype.loadFont=function(a){var b=e(a).split("/").pop();if(this.loadedFontFamilies[b])return void(this.fontCallbacks[b]&&this.fontCallbacks[b].forEach(function(a){a()}));if(!this.fontCssFamiliesAdded[b]){this.fontCssFamiliesAdded[b]=!0;var c=document.createElement("style");c.type="text/css",this.isRunningInEditor&&"/"!==a[0]&&(a="/"+a),c.appendChild(document.createTextNode("                    @font-face {                        font-family: '"+b+"';                        src: url('"+a+"');                    }                ")),document.head.appendChild(c);var d=this;WebFont.load({timeout:6e5,custom:{families:[b]},fontactive:function(a){d.loadedFontFamilies[a]=!0,d.fontCallbacks[a]&&d.fontCallbacks[a].forEach(function(a){a()})}})}},d.prototype.callWhenFontIsActive=function(a,b){return this.loadedFontFamilies[a]?void b():(this.fontCallbacks[a]||(this.fontCallbacks[a]=[]),void this.fontCallbacks[a].push(b))},d.instance=new d,b.exports=d},{}],223:[function(a,b,c){function d(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}b.exports=d},{}],224:[function(a,b,c){"use strict";function d(){this.mouseMoveListener=this._onMouseMove.bind(this),this.mouseDownListener=this._onMouseDown.bind(this),this.highlightedControl=void 0}function e(a,b){return a-b}function f(a){return g.some(function(b){return a instanceof b})}var g=[a("./uiengine/controls/circlecontrol"),a("./uiengine/controls/imagecontrol"),a("./uiengine/controls/rectanglecontrol"),a("./uiengine/controls/textcontrol"),a("./uiengine/controls/textinputcontrol")];d.prototype._onMouseMove=function(a){var b=this.uiEngine.hitTest(this._getTouchX(a)*this.uiEngine.renderer.viewportWidth,this._getTouchY(a)*this.uiEngine.renderer.viewportHeight);this.highlightedControl&&(this.highlightedControl.setHighlightEnabled(!1),this.highlightedControl=void 0);var c=Object.keys(b);c.sort(e);for(var d=!1,g=c.length-1;g>=0&&d===!1;g--)for(var h=b[c[g]],i=h.length-1;i>=0;i--)if(f(h[i])){this.highlightedControl=h[i],this.highlightedControl.setHighlightEnabled(!0),d=!0;break}},d.prototype._onMouseDown=function(a){0===a.button&&this.highlightedControl&&this.callback(this.highlightedControl.noodlNode.id)},d.prototype._getTouchX=function(a){var b=this.domElement.getBoundingClientRect(),c=b.right-b.left,d=a.pageX-b.left;return d/c},d.prototype._getTouchY=function(a){var b=this.domElement.getBoundingClientRect(),c=b.bottom-b.top,d=a.pageY-b.top;return d/c},d.prototype.enable=function(a,b){this.uiEngine=a,this.uiEngine.touchListener.setTouchEnabled(!1),this.domElement=a.renderer.renderers[0].rootElement,this.callback=b,this.domElement.addEventListener("mousemove",this.mouseMoveListener),this.domElement.addEventListener("mousedown",this.mouseDownListener)},d.prototype.disable=function(){this.domElement&&(this.uiEngine.touchListener.setTouchEnabled(!0),this.domElement.removeEventListener("mousemove",this.mouseMoveListener),this.domElement.removeEventListener("mousedown",this.mouseDownListener),this.domElement=void 0,this.callback=void 0,this.highlightedControl&&(this.highlightedControl.setHighlightEnabled(!1),this.highlightedControl=void 0))},b.exports=d},{"./uiengine/controls/circlecontrol":310,"./uiengine/controls/imagecontrol":314,"./uiengine/controls/rectanglecontrol":317,"./uiengine/controls/textcontrol":322,"./uiengine/controls/textinputcontrol":323}],225:[function(a,b,c){"use strict";function d(a,b){this.inputs={},this.outputs={},this.error=void 0;var c=e[a];if(!c)try{c=new Function("define","Noodl",a),e[a]=c}catch(d){this.error=d.message}c&&c(this.define.bind(this),b)}var e={};d.prototype.define=function(a){this.inputs=a.inputs||{},this.outputs=a.outputs||{},this.setup=a.setup,this.run=a.run,this.definedObject=a},d.createFromCode=function(a,b){return new d(a,b)},d.createFromURL=function(a,b,c){var e=new window.XMLHttpRequest;e.open("GET",a,!0),e.onreadystatechange=function(){(4===this.readyState||this.readyState===XMLHttpRequest.DONE)&&c(new d(this.response,b))},e.onerror=function(){console.log("Failed to request",a)},e.send()},d.prototype.getPorts=function(){var a=[],b=this;return Object.keys(this.inputs).forEach(function(c){var d=b.inputs[c],e={name:c,plug:"input"};if("string"==typeof d)e.type={name:d},e.group="Inputs";else for(var f in d)e[f]=d[f];a.push(e)}),Object.keys(this.outputs).forEach(function(c){a.push({name:c,type:{name:b.outputs[c]},plug:"output",group:"Outputs"})}),a},b.exports=d},{}],226:[function(a,b,c){"use strict";function d(a){f.call(this),this.name=a,this.nodes={},this.connections=[],this.roots=[],this.inputPorts={},this.outputPorts={}}var e=a("./nodemodel"),f=a("./../eventsender"),g=a("lodash");d.prototype=Object.create(f.prototype),d.prototype.addNode=function(a){a.component=this,this.nodes[a.id]=a,this.emit("nodeAdded",a)},d.prototype.getNodeWithId=function(a){return this.nodes[a]},d.prototype.getAllNodes=function(){return g.values(this.nodes)},d.prototype.getNodesWithType=function(a){var b=[],c=this;return Object.keys(this.nodes).forEach(function(d){var e=c.nodes[d];e.type===a&&b.push(e)}),b},d.prototype.addConnection=function(a){this.connections.push(a),this.emit("connectionAdded",a)},d.prototype.removeConnection=function(a){var b=g.findIndex(this.connections,function(b){return g.isEqual(b,a)});this.connections.splice(b,1),this.emit("connectionRemoved",a)},d.prototype.getConnectionsFromPort=function(a,b){return this.connections.filter(function(c){return c.sourceId===a&&c.sourcePort===b})},d.prototype.getConnectionsToPort=function(a,b){return this.connections.filter(function(c){return c.targetId===a&&c.targetPort===b})},d.prototype.getConnectionsFrom=function(a){return this.connections.filter(function(b){return b.sourceId===a})},d.prototype.getConnectionsTo=function(a){return this.connections.filter(function(b){return b.targetId===a})},d.prototype.addRootId=function(a){-1===this.roots.indexOf(a)&&(this.roots.push(a),this.emit("rootAdded",a))},d.prototype.getFirstRootId=function(){return this.roots[0]},d.prototype.removeNodeWithId=function(a){for(var b=this.getNodeWithId(a);b.children.length>0;){var c=b.children[0];this.removeNodeWithId(c.id)}for(var d=this.getConnectionsTo(a).concat(this.getConnectionsFrom(a)),e=0;e<d.length;e++)this.removeConnection(d[e]);this.setNodeParent(b,null);var f=this.roots.indexOf(b.id);-1!==f&&(this.roots.splice(f,1),this.emit("rootRemoved",b.id)),this.emit("nodeRemoved",b),b.removeAllListeners(),delete this.nodes[a]},d.prototype.getAllConnections=function(){return this.connections},d.prototype.getInputPorts=function(){return this.inputPorts},d.prototype.getOutputPorts=function(){return this.outputPorts},d.prototype.addInputPort=function(a){this.inputPorts[a.name]=a,this.emit("inputPortAdded",a)},d.prototype.addOutputPort=function(a){this.outputPorts[a.name]=a,this.emit("outputPortAdded",a)},d.prototype.removeOutputPortWithName=function(a){if(this.outputPorts.hasOwnProperty(a)){var b=this.outputPorts[a];delete this.outputPorts[a],this.emit("outputPortRemoved",b)}},d.prototype.removeInputPortWithName=function(a){if(this.inputPorts.hasOwnProperty(a)){var b=this.inputPorts[a];delete this.inputPorts[a],this.emit("inputPortRemoved",b)}},d.prototype.renameInputPortOnNodeWithId=function(a,b,c){var d=this.getConnectionsToPort(a,b);d.forEach(this.removeConnection.bind(this));var e=this.getNodeWithId(a),f=g.clone(e.getInputPort(b));f&&(e.removeInputPortWithName(b),f.name=c,e.addInputPort(f)),d.forEach(function(a){a.targetPort=c}),d.forEach(this.addConnection.bind(this))},d.prototype.renameOutputPortOnNodeWithId=function(a,b,c){var d=this.getConnectionsFromPort(a,b);d.forEach(this.removeConnection.bind(this));var e=this.getNodeWithId(a),f=g.clone(e.getOutputPort(b));e.removeOutputPortWithName(b),f.name=c,e.addOutputPort(f),d.forEach(function(a){a.sourcePort=c}),d.forEach(this.addConnection.bind(this))},d.prototype.setNodeParent=function(a,b,c){a.parent&&(this.emit("nodeParentWillBeRemoved",a),a.parent.removeChild(a)),a.emit("parentUpdated",b),b&&(b.addChild(a,c),this.emit("nodeParentUpdated",a))},d.prototype.importEditorNodeData=function(a,b,c){var d=e.createFromExportData(a);this.addNode(d),b&&this.setNodeParent(d,this.getNodeWithId(b),c);var f=this;a.children&&a.children.forEach(function(a,b){f.importEditorNodeData(a,d.id,b)})},d.prototype.reset=function(){for(;this.roots.length;)this.removeNodeWithId(this.roots[0]);if(Object.keys(this.nodes).forEach(this.removeNodeWithId.bind(this)),this.nodes.length>0)throw new Error("Not all nodes were removed during a reset");if(this.connections.length>0)throw new Error("Not all connections were removed during a reset")},d.prototype.rename=function(a){var b=this.name;this.name=a,this.emit("renamed",{oldName:b,newName:a})},d.createFromExportData=function(a){var b=new d(a.name);return a.ports&&a.ports.forEach(function(a){("input"===a.plug||"input/output"===a.plug)&&b.addInputPort(a),("output"===a.plug||"input/output"===a.plug)&&b.addOutputPort(a)}),a.nodes&&a.nodes.forEach(b.importEditorNodeData.bind(b)),a.connections&&a.connections.forEach(b.addConnection.bind(b)),a.roots&&a.roots.forEach(b.addRootId.bind(b)),b},b.exports=d},{"./../eventsender":221,"./nodemodel":228,lodash:128}],227:[function(a,b,c){"use strict";function d(){f.call(this),this.components={},this.defaultDevice={canvasWidth:1080,canvasHeight:1920,fillMode:"aspectFit",renderer:"webgl",name:"Default Device"},this.settings=g.clone(h)}var e=a("./componentmodel"),f=a("./../eventsender"),g=a("lodash"),h={analyticsEnabled:!1,analyticsServerUrl:"http://localhost:8080"};d.prototype=Object.create(f.prototype),d.prototype.importComponentFromEditorData=function(a){var b=e.createFromExportData(a);this.addComponent(b)},d.prototype.importEditorData=function(a){a.settings&&this.setSettings(a.settings),a.components.forEach(this.importComponentFromEditorData.bind(this)),this.setRootComponentName(a.rootComponent),this.setRootNodeId(a.rootNode)},d.prototype.setRootComponentName=function(a){this.rootComponent=a,this.emit("rootComponentNameUpdated",a)},d.prototype.setRootNodeId=function(a){this.rootNode=a,this.emit("rootNodeIdChanged",a)},d.prototype.getNodesWithType=function(a){for(var b=[],c=Object.keys(this.components),d=0;d<c.length;d++){var e=this.components[c[d]];b=b.concat(e.getNodesWithType(a))}return b},d.prototype.getComponentWithName=function(a){return this.components[a]},d.prototype.getAllNodes=function(){for(var a=[],b=Object.keys(this.components),c=0;c<b.length;c++){var d=this.components[b[c]];a=a.concat(d.getAllNodes())}return a},d.prototype.addComponent=function(a){this.components[a.name]=a,this.getNodesWithType(a.name).forEach(this._addComponentPorts.bind(this)),a.getAllNodes().forEach(this._onNodeAdded.bind(this)),a.on("nodeAdded",this._onNodeAdded.bind(this),this),this.emit("componentAdded",a)},d.prototype.removeComponentWithName=function(a){if(this.components.hasOwnProperty(a)===!1)return void console.error("GraphModel: Component with name "+componentNamee+" not in graph");var b=this.components[a];b.reset(),b.removeAllListeners(),delete this.components[b.name],this.emit("componentRemoved",b)},d.prototype.renameComponent=function(a,b){if(this.components.hasOwnProperty(a)===!1)return void console.error("GraphModel: Component with name "+componentNamee+" not in graph");this.getNodesWithType(a).forEach(function(a){a.type=b});var c=this.components[a];c.rename(b),delete this.components[a],this.components[b]=c},d.prototype._addComponentPorts=function(a){if(this.components.hasOwnProperty(a.type)){var b=this.components[a.type];g.forIn(b.getInputPorts(),a.addInputPort.bind(a)),g.forIn(b.getOutputPorts(),a.addOutputPort.bind(a))}},d.prototype._onNodeAdded=function(a){this._addComponentPorts(a),this.emit("nodeAdded",a),this.emit("nodeAdded."+a.type,a)},d.prototype.reset=function(){var a=this;Object.keys(this.components).forEach(function(b){a.removeComponentWithName(b)}),this.settings=g.clone(h),this.devices={}},d.prototype.isEmpty=function(){return 0===Object.keys(this.components).length},d.prototype.setSettings=function(a){if(a.hasOwnProperty("analyticsEnabed")&&(this.settings.analyticsEnabled=a.analyticsEnabled),a.hasOwnProperty("analyticsServerUrl")&&(this.settings.analyticsServerUrl=a.analyticsServerUrl),this.settings.mqttUseExternalBroker=a.mqttUseExternalBroker,this.settings.mqttBrokerUrl=a.mqttBrokerUrl,a.devices){this.devices={};var b=this,c=a.devices.split(",");c.forEach(function(c){b.devices[c]={fillMode:a[c+".fillMode"]||b.defaultDevice.fillMode,canvasWidth:a[c+".canvasWidth"]||b.defaultDevice.canvasWidth,canvasHeight:a[c+".canvasHeight"]||b.defaultDevice.canvasHeight,renderer:a[c+".renderer"]||b.defaultDevice.renderer,rootComponent:a[c+".rootComponent"],name:c}}),this.defaultDeviceName=c[0]}this.projectSettings=a,this.emit("settingsUpdated")},d.prototype.getSettings=function(){return this.settings},d.prototype.getDeviceSettings=function(a){return a&&this.devices.hasOwnProperty(a)!==!1||(a=this.defaultDeviceName),a?this.devices[a]:this.defaultDevice},d.prototype.getRawProjectSettings=function(){return this.projectSettings||{}},b.exports=d},{"./../eventsender":221,"./componentmodel":226,lodash:128}],228:[function(a,b,c){"use strict";function d(a,b){e.call(this),this.id=a,this.type=b,this.inputs=[],this.outputs=[],this.children=[],this.parameters={},this.inputPorts={},this.outputPorts={}}var e=a("./../eventsender");d.prototype=Object.create(e.prototype),d.prototype.setParameter=function(a,b){this.parameters[a]=b,this.emit("parameterUpdated",{name:a,value:b})},d.prototype.setParameters=function(a){var b=this;Object.keys(a).forEach(function(c){b.setParameter(c,a[c])})},d.prototype.addInputPort=function(a){this.inputPorts[a.name]=a,this.emit("inputPortAdded",a)},d.prototype.getInputPort=function(a){return this.inputPorts[a]},d.prototype.getInputPorts=function(){return this.inputPorts},d.prototype.removeInputPortWithName=function(a){if(this.inputPorts.hasOwnProperty(a)){var b=this.inputPorts[a];delete this.inputPorts[a],this.emit("inputPortRemoved",b)}},d.prototype.addOutputPort=function(a){this.outputPorts[a.name]=a,this.emit("outputPortAdded",a)},d.prototype.getOutputPort=function(a){return this.outputPorts[a]},d.prototype.getOutputPorts=function(){return this.outputPorts},d.prototype.removeOutputPortWithName=function(a){if(this.outputPorts.hasOwnProperty(a)){var b=this.outputPorts[a];delete this.outputPorts[a],this.emit("outputPortRemoved",b)}},d.prototype.addChild=function(a,b){a.parent=this,void 0===b?this.children.push(a):this.children.splice(b,0,a)},d.prototype.removeChild=function(a){a.parent=void 0;var b=this.children.indexOf(a);this.children.splice(b,1)},d.prototype.reset=function(){this.removeAllListeners()},d.createFromExportData=function(a){var b=new d(a.id,a.type);return a.parameters&&b.setParameters(a.parameters),a.ports&&a.ports.forEach(function(a){("input"===a.plug||"input/output"===a.plug)&&b.addInputPort(a),("output"===a.plug||"input/output"===a.plug)&&b.addOutputPort(a)}),b},b.exports=d},{"./../eventsender":221}],229:[function(a,b,c){"use strict";function d(a){this.context=a,this._dirty=!1,this._cachedInputValues={},this._inputs={},this.numberedInputs={},this._outputs={},this._inputConnections={},this._outputList=[],this._isUpdating=!1,this._inputValuesQueue={},this._afterInputsHaveUpdatedCallbacks=[],this._internal={},this._signalsSentThisUpdate={}}function e(a){var b=a.split(" ");return b.splice(-1,1),b.join(" ")}var f=a("./outputproperty");Object.defineProperties(d.prototype,{registerInput:{value:function(a,b){if(this.hasInput(a))throw new Error("Input property "+a+" already registered");this._inputs[a]=b,b.hasOwnProperty("default")&&(this._cachedInputValues[a]=b["default"])}},deregisterInput:{value:function(a){if(this.hasInput(a)===!1)throw new Error("Input property "+a+" doesn't exist");delete this._inputs[a],delete this._cachedInputValues[a]}},registerInputs:{value:function(a){for(var b in a)this.registerInput(b,a[b])}},_registerSelectors:{value:function(a){var b=this;Object.keys(a).forEach(function(c){var d=a[c],e={set:function(a){var c=a.split(" "),e=Number(c[c.length-1]);d.set.call(b,e)}};b.registerInput(c,e)})}},registerNumberedInput:{value:function(a,b){if(this.hasNumberedInput(a))throw new Error("Numbered input property "+a+" already registered");this.numberedInputs[a]=b,b.selectors&&this._registerSelectors(b.selectors)}},getInput:{value:function(a){if(this.hasInput(a)===!1)throw new Error("Node "+this.name+": Invalid input property "+a);return this._inputs[a]}},hasInput:{value:function(a){return a in this._inputs}},hasNumberedInput:{value:function(a){return this.numberedInputs.hasOwnProperty(a)}},registerInputIfNeeded:{value:function(a){this.hasInput(a)===!1&&this._isUnregisteredNumberedInput(a)&&this._registerNumberedInputInstance(a)}},_isUnregisteredNumberedInput:{value:function(a){var b=e(a);return this.numberedInputs.hasOwnProperty(b)}},_registerNumberedInputInstance:{value:function(a){var b=a.split(" "),c=b[b.length-1];if(isNaN(c))throw new Error("Numbered input with name "+a+" doesn't end with a number");c=Number(c);var d=this.numberedInputs[e(a)],f={name:d.name,set:d.createSetter.call(this,c)};this.registerInput(a,f)}},setInputValue:{value:function(a,b,c){this._cachedInputValues[a]=b;var d=this.getInput(a);c?d.set.call(this,b,c):d.set.call(this,b)}},hasOutput:{value:function(a){return a in this._outputs}},registerOutput:{value:function(a,b){if(this.hasOutput(a))throw new Error("Output property "+a+" already registered");var c=new f({owner:this,getter:b.getter,name:a});this._outputs[a]=c,this._outputList.push(c)}},deregisterOutput:{value:function(a){if(this.hasOutput(a)===!1)throw new Error("Output property "+a+" isn't registered");var b=this._outputs[a];if(b.hasConnections())throw new Error("Output property "+a+" has connections and can't be removed");delete this._outputs[a];var c=this._outputList.indexOf(b);this._outputList.splice(c,1)}},registerOutputs:{value:function(a){for(var b in a)this.registerOutput(b,a[b])}},registerOutputIfNeeded:{value:function(){}},getOutput:{value:function(a){if(this.hasOutput(a)===!1)throw new Error("Node "+this.name+" doesn't have a port named "+a);return this._outputs[a]}},connectInput:{value:function(a,b,c){if(this.hasInput(a)===!1)throw new Error("Invalid connection, input doesn't exist. Trying to connect from "+b.name+" output "+c+" to "+this.name+" input "+a);var d=b.getOutput(c);if(d.registerConnection(this,a),this._inputConnections[a]||(this._inputConnections[a]=[],this._inputValuesQueue[a]=[]),this._inputConnections[a].push(d),b._signalsSentThisUpdate[c])this.queueInput(a,!0),this.queueInput(a,!1);else{var e=d.value;void 0!==e&&this.queueInput(a,e)}this.flagDirty()}},removeInputConnection:{value:function(a,b,c){if(!this._inputConnections[a])throw new Error("Node removeInputConnection: Input doesn't exist");for(var d=this._inputConnections[a],e=0;e<d.length;e++){var f=d[e];if(f.owner.id===b&&f.name===c){d.splice(e,1);var g=f.owner.getOutput(c);g.deregisterConnection(this,a);break}}}},isInputConnected:{value:function(a){return this._inputConnections.hasOwnProperty(a)}},update:{value:function(){if(!this._isUpdating&&this._dirty!==!1){this._isUpdating=!0;for(var a,b=0;this._dirty&&100>b;){this._updateDependencies(),this._dirty=!1;for(var c=!0,d=Object.keys(this._inputValuesQueue);c;){for(c=!1,a=0;a<d.length;a++){var e=d[a],f=this._inputValuesQueue[e];if(f.length>0){var g=f.shift();null!==g&&"object"==typeof g&&g.hasOwnProperty("value")&&g.hasOwnProperty("unit")?this.setInputValue(e,g.value,g.unit):this.setInputValue(e,g),f.length>0&&(c=!0)}}var h=this._afterInputsHaveUpdatedCallbacks;for(this._afterInputsHaveUpdatedCallbacks=[],a=0;a<h.length;a++)h[a].call(this)}b++}this._isUpdating=!1}}},_updateDependencies:{value:function(){for(var a in this._inputConnections)for(var b=this._inputConnections[a],c=0;c<b.length;++c)"reference"!==b[c].type&&b[c].owner.update()}},flagDirty:{value:function(){if(!this._dirty){this._dirty=!0,this.context&&this.context.nodeIsDirty(this);for(var a=0;a<this._outputList.length;++a)this._outputList[a].flagDependeesDirty()}}},sendValue:{value:function(a,b){if(this.hasOutput(a)===!1)return void console.log("Error: Node",this.name,"doesn't have a output named",a);var c=this.getOutput(a);c.hasConnections()!==!1&&void 0!==b&&(c.sendValue(b),this.context&&this.context.connectionSentValue(c,b))}},flagOutputDirty:{value:function(a){var b=this.getOutput(a);b.hasConnections()!==!1&&this.sendValue(a,b.value)}},flagAllOutputsDirty:{value:function(a){for(var b=0;b<this._outputList.length;++b){var c=this._outputList[b];this.sendValue(c.name,c.value)}}},sendSignalOnOutput:{value:function(a){this.sendValue(a,!0),this.sendValue(a,!1),this._signalsSentThisUpdate[a]=!0,this.scheduleAfterInputsHaveUpdated(function(){this._signalsSentThisUpdate[a]=!1})}},queueInput:{value:function(a,b,c){this._inputValuesQueue[a]||(this._inputValuesQueue[a]=[]),c?this._inputValuesQueue[a].push({value:b,unit:c}):this._inputValuesQueue[a].push(b),this.flagDirty()}},scheduleAfterInputsHaveUpdated:{value:function(a){this._afterInputsHaveUpdatedCallbacks.push(a),this.flagDirty()}},setNodeModel:{value:function(a){this.model=a,a.on("parameterUpdated",this._onNodeModelParameterUpdated,this);var b=this;a.on("inputPortRemoved",function(a){b.hasInput(a.name)&&b.deregisterInput(a.name)},this),a.on("outputPortRemoved",function(a){b.hasOutput(a.name)&&b.deregisterOutput(a.name)},this)}},_onNodeDeleted:{value:function(){this.model&&(this.model.removeListenersWithRef(this),this.model=void 0)}},_onNodeModelParameterUpdated:{value:function(a){this.registerInputIfNeeded(a.name),"object"==typeof a.value&&a.value.hasOwnProperty("unit")?this.queueInput(a.name,a.value.value,a.value.unit):this.queueInput(a.name,a.value)}}}),b.exports=d},{"./outputproperty":301}],230:[function(a,b,c){"use strict";function d(a){if(a=a||{},a.runningInEditor=a.hasOwnProperty("runningInEditor")?a.runningInEditor:!1,this._dirtyNodes=[],this.callbacksAfterUpdate=[],this.eventEmitter=new e,this.eventEmitter.setMaxListeners(1e3),this.eventSenderEmitter=new e,this.eventSenderEmitter.setMaxListeners(1e4),this.globalValues={},this.globalsEventEmitter=new e,this.globalsEventEmitter.setMaxListeners(1e3),this.runningInEditor=a.runningInEditor,this.currentFrameTime=0,this.nodeRegister=new f(this),this.timerScheduler=new g(this.scheduleFrame.bind(this)),this.componentModels={},this.outputCollectionEnabled=!1,this.connectionsToPulse={},this.connectionsToPulseChanged=!1,this.connectionsToInspect={},this.inspectedConnectionValuesToSendQueue=[],this.connectionPulsingCallbackScheduled=!1,this.editorConnection=a.editorConnection,this.rootComponent=void 0,this.editorConnection&&this.editorConnection.on("connectionInspectorsUpdated",this.onConnectionInspectorsUpdated.bind(this)),a.uiEngineClass){var b=a.uiEngineClass;this.uiEngine=new b(this.timerScheduler,document.body),this.uiEngine.eventSender.on("requestFrame",this.scheduleFrame.bind(this))}}var e=a("events").EventEmitter,f=a("./noderegister"),g=a("./timerscheduler");d.prototype.setRootComponent=function(a){this.rootComponent=a,a.getVisualRoot()&&this.uiEngine.root.addChild(a.getVisualRoot()._internal.uiControl)},d.prototype.onConnectionInspectorsUpdated=function(a){var b={};a.forEach(function(a){var c=a.fromId+a.fromProperty;b[c]=a}),this.connectionsToInspect=b,this.sendConnectionsToInspectValues()},d.prototype.layout=function(){this.uiEngine&&this.uiEngine.layout()},d.prototype.update=function(){for(var a,b,c=!0,d=0;c&&10>d;){this.layout();var e=this._dirtyNodes;for(this._dirtyNodes=[],a=0,b=e.length;b>a;++a)e[a].update();var f=this.callbacksAfterUpdate;for(this.callbacksAfterUpdate=[],a=0,b=f.length;b>a;a++)f[a]();this.layout(),c=this.callbacksAfterUpdate.length>0||this._dirtyNodes.length>0,d++}this.timerScheduler.hasPendingTimers()&&(this.scheduleFrame(),this.timerScheduler.runTimers(this.currentFrameTime)),this.flushConnectionsToInspect()},d.prototype.flushConnectionsToInspect=function(){this.connectionsToPulseChanged&&(this.connectionsToPulseChanged=!1,this.editorConnection.sendPulsingConnections(this.connectionsToPulse)),this.inspectedConnectionValuesToSendQueue.length>0&&(this.editorConnection.sendConnectionValues(this.inspectedConnectionValuesToSendQueue),this.inspectedConnectionValuesToSendQueue=[])},d.prototype.reset=function(){this.eventEmitter.emit("applicationDataReloaded");var a=this.eventEmitter;["frameStart","frameEnd"].forEach(function(b){a.removeAllListeners(b)}),this.globalValues={},this._dirtyNodes.length=0,this.callbacksAfterUpdate.length=0,this.timerScheduler.runningTimers=[],this.timerScheduler.newTimers=[],this.rootComponent=void 0,this.clearAllConnectionInspections()},d.prototype.nodeIsDirty=function(a){this._dirtyNodes.push(a),this.scheduleFrame()},d.prototype.scheduleFrame=function(){this.eventEmitter.emit("scheduleFrame")},d.prototype.scheduleAfterUpdate=function(a){this.callbacksAfterUpdate.push(a),this.scheduleFrame()},d.prototype.scheduleNextFrame=function(a){this.eventEmitter.once("frameStart",a),this.scheduleFrame()},d.prototype.setGlobalValue=function(a,b){this.globalValues[a]=b,this.globalsEventEmitter.emit(a)},d.prototype.reloadApplication=function(){this.eventEmitter.emit("reloadApplication")},d.prototype.registerComponentModel=function(a){if(this.componentModels.hasOwnProperty(a.name))throw new Error("Duplicate component name "+a.name);this.componentModels[a.name]=a;var b=this;a.on("renamed",function(c){delete b.componentModels[c.oldName],b.componentModels[c.newName]=a},this)},d.prototype.deregisterComponentModel=function(a){this.componentModels.hasOwnProperty(a.name)&&(this.componentModels[a.name].removeListenersWithRef(this),delete this.componentModels[a.name])},d.prototype.getComponentModel=function(a){if(!a)throw new Error("Component instance must have a name");if(this.componentModels.hasOwnProperty(a)===!1)throw new Error("Unknown component "+a);return this.componentModels[a]},d.prototype.hasComponentModelWithName=function(a){return this.componentModels.hasOwnProperty(a)},d.prototype.createComponentInstanceNode=function(b){var c=this.getComponentModel(b),d=a("./nodes/componentinstance"),e=new d(this);return e.name=b,e.setComponentModel(c),e},d.prototype._sendConnectionValue=function(a,b){if(this.connectionsToInspect.hasOwnProperty(a.id)&&this.inspectedConnectionValuesToSendQueue.push({id:a.id,value:b}),this.connectionsToPulse.hasOwnProperty(a.id))return void(this.connectionsToPulse[a.id].timestamp="undefined"!=typeof window?window.performance.now():+new Date);var c=[];a.connections.forEach(function(b){c.push(a.owner.id+a.name+b.node.id+b.inputPortName)}),this.connectionsToPulse[a.id]={timestamp:"undefined"!=typeof window?window.performance.now():+new Date,connections:c},this.connectionsToPulseChanged=!0,this.connectionPulsingCallbackScheduled===!1&&(this.connectionPulsingCallbackScheduled=!0,setTimeout(this.clearOldConnectionPulsing.bind(this),100))},d.prototype.connectionSentValue=function(a,b){this.editorConnection&&this.editorConnection.isConnected()&&this.outputCollectionEnabled&&this._sendConnectionValue(a,b)},d.prototype.clearAllConnectionInspections=function(){this.connectionsToInspect={},this.connectionsToPulse={},this.editorConnection.sendPulsingConnections(this.connectionsToPulse)},d.prototype.clearOldConnectionPulsing=function(){this.connectionPulsingCallbackScheduled=!1;var a="undefined"!=typeof window?window.performance.now():+new Date,b=this,c=Object.keys(this.connectionsToPulse);c.forEach(function(c){var d=b.connectionsToPulse[c];a-d.timestamp>100&&(b.connectionsToPulseChanged=!0,delete b.connectionsToPulse[c])}),this.connectionsToPulseChanged&&(this.connectionsToPulseChanged=!1,this.editorConnection.sendPulsingConnections(this.connectionsToPulse)),Object.keys(this.connectionsToPulse).length>0&&(this.connectionPulsingCallbackScheduled=!0,setTimeout(this.clearOldConnectionPulsing.bind(this),100))},d.prototype.sendConnectionsToInspectValues=function(){var a=this,b=[];Object.keys(this.connectionsToInspect).forEach(function(c){var d=a.connectionsToInspect[c],e=a.rootComponent.nodeScope.getNodesWithIdRecursive(d.toId);if(e.length>0){var f=e[e.length-1],g=f._cachedInputValues[d.toProperty];"object"==typeof g&&"Node"===g.constructor.name&&(g="<Node> "+g.name),b.push({id:c,value:g})}}),b.length>0&&this.editorConnection.sendConnectionValues(b)},d.prototype.setOutputCollectionEnabled=function(a){this.outputCollectionEnabled=a,a&&this.sendConnectionsToInspectValues()},d.prototype.sendGlobalEventFromEventSender=function(a,b){this.eventSenderEmitter.emit(a,b),this.sessionRecorder&&this.sessionRecorder.appendEvent(a)},d.prototype.setSessionRecorder=function(a){this.sessionRecorder=a},b.exports=d},{"./noderegister":233,"./nodes/componentinstance":238,"./timerscheduler":309,events:17}],231:[function(a,b,c){"use strict";function d(a,b,c,d){if(a.hasOwnProperty(c))throw new Error("Input property "+c+" already registered");d.set&&(a[c]={set:d.set}),d.setUnitType&&(a[c].setUnitType=d.setUnitType),b.inputs[c]={displayName:d.displayName,editorName:d.editorName,group:d.group,type:d.type,"default":d["default"],index:d.index,exportToEditor:d.hasOwnProperty("exportToEditor")?d.exportToEditor:!0,inputPriority:d.inputPriority||0},d.valueChangedToTrue&&(b.inputs[c].type={name:"boolean",allowConnectionsOnly:!0})}function e(a,b,c,d){if(a.hasOwnProperty(c))throw new Error("Input property "+c+" already registered");a[c]={createSetter:d.createSetter},b.numberedInputs[c]={displayPrefix:d.displayPrefix,group:d.group,name:d.name},d.selectors&&(b.numberedInputs[c].selectors={},a[c].selectors={},Object.keys(d.selectors).forEach(function(e){var f=d.selectors[e];b.numberedInputs[c].selectors[e]={displayName:f.displayName,editorName:f.editorName,group:f.group},a[c].selectors[e]={set:f.set}}))}function f(a,b,c){Object.keys(c).forEach(function(e){d(a,b,e,c[e])})}function g(a,b){Object.keys(b).forEach(function(c){var d=b[c];a.outputs[c]={displayName:d.displayName,editorName:d.editorName,group:d.group,type:d.type,index:d.index,exportToEditor:d.hasOwnProperty("exportToEditor")?d.exportToEditor:!0}})}function h(a,b){Object.keys(b).forEach(function(c){a[c]=b[c]["default"]})}function i(a){function b(a){k.call(this,a)}if(!a.category)throw new Error("Node must have a category");if(!a.name)throw new Error("Node must have a name");var c={inputs:{},outputs:{},numberedInputs:{},category:a.category,dynamicports:a.dynamicports,allowChildren:a.allowChildren,allowChildrenWithCategory:a.allowChildrenWithCategory,allowAsChild:a.allowAsChild,panels:a.panels,color:a.color,usePortAsLabel:a.usePortAsLabel,portLabelTruncationMode:a.portLabelTruncationMode,name:a.name,displayNodeName:a.displayNodeName,deprecated:a.deprecated,haveComponentPorts:a.haveComponentPorts,version:a.version};a._internal=a._internal||{},a.prototypeExtensions=a.prototypeExtensions||{},a.inputs=a.inputs||{},a.outputs=a.outputs||{},a.numberedInputs=a.numberedInputs||{},a.initialize=a.initialize||function(){};var d={},i={};f(d,c,a.inputs),g(c,a.outputs),Object.keys(a.numberedInputs).forEach(function(b){e(i,c,b,a.numberedInputs[b])}),Object.keys(a.prototypeExtensions).forEach(function(b){a.prototypeExtensions[b].value||(a.prototypeExtensions[b]={value:a.prototypeExtensions[b]})}),b.prototype=Object.create(k.prototype,a.prototypeExtensions),Object.defineProperty(b.prototype,"name",{value:a.name});var j=function(e){var f=new b(e);return f._inputs=Object.create(d),Object.keys(a.inputs).forEach(function(b){var c=a.inputs[b];c.valueChangedToTrue&&(f._inputs[b]={set:l.createSetter({valueChangedToTrue:c.valueChangedToTrue})})}),
Object.keys(a.outputs).forEach(function(b){var c=a.outputs[b];"signal"===c.type?f.registerOutput(b,{getter:function(){return!1}}):f.registerOutput(b,c)}),Object.keys(i).forEach(function(a){f.registerNumberedInput(a,i[a])}),h(f._cachedInputValues,c.inputs),a.initialize.call(f),f};return j.metadata=c,j}function j(a,b){for(var c in b)if("initialize"===c&&a.initialize){var d=a.initialize;a.initialize=function(){d.call(this),b.initialize.call(this)}}else b[c]&&b[c].constructor===Object?a[c]=j(a[c]||{},b[c]):a[c]=b[c];return a}var k=a("./node"),l=a("./edgetriggeredinput");b.exports={defineNode:i,extend:j}},{"./edgetriggeredinput":218,"./node":229}],232:[function(a,b,c){"use strict";function d(a){var b={typecasts:[{from:"boolean",to:["number","string","signal"]},{from:"number",to:["boolean","string"]},{from:"string",to:["number","boolean","image","color"]},{from:"signal",to:["boolean","number"]},{from:"image",to:[]},{from:"color",to:[]},{from:"enum",to:[]},{from:"object",to:[]},{from:"reference",to:[]},{from:"font",to:[]}],dynamicports:[{type:"conditionalports",name:"basic"},{type:"expand",name:"basic"},{type:"portchannel",name:"event-sender-channel",channelPortname:"channelName",typename:"Event Sender",ignorePorts:["channelName","sendEvent","propagation"]},{type:"numbered",name:"simple-number",port:{type:"number"}},{type:"numbered",name:"simple-boolean",port:{type:"boolean"}},{type:"numbered",name:"simple-string",port:{type:"string"}},{type:"numbered",name:"simple-color",port:{type:"color"}}],colors:{nodes:{component:{base:"#6e3599",baseHighlighted:"#8440b8",header:"#6e3599",headerHighlighted:"#8440b8",outline:"#6e3599",outlineHighlighted:"#b58900",text:"#ffffff"},visual:{base:"#2a4e6e",baseHighlighted:"#376690",header:"#2a4e6e",headerHighlighted:"#376690",outline:"#2a4e6e",outlineHighlighted:"#b58900",text:"#ffffff"},data:{base:"#6d8241",baseHighlighted:"#2f8d22",header:"#6d8241",headerHighlighted:"#2f8d22",outline:"#6d8241",outlineHighlighted:"#b58900",text:"#ffffff"},javascript:{base:"#a24176",baseHighlighted:"#ab5484",header:"#a24176",headerHighlighted:"#ab5484",outline:"#ab5484",outlineHighlighted:"#d57bab",text:"#ffffff"},"default":{base:"#3e434e",baseHighlighted:"#505768",header:"#3e434e",headerHighlighted:"#505768",outline:"#3e434e",outlineHighlighted:"#b58900",text:"#ffffff"}},connections:{signal:{normal:"#468c8c",highlighted:"#73babb",pulsing:"#92d9d8"},"default":{normal:"#916311",highlighted:"#ffa300",pulsing:"#ffe85d"}}},nodetypes:[{name:"Component Children",color:"component",panels:"none",allowAsChild:!0,category:"Visual",haveComponentChildren:["Visual"]}]},c=Object.keys(a._constructors);return c.forEach(function(c){function d(a,b){var c={name:a,type:b.type,plug:"output"};b.group&&(c.group=b.group),b.displayName&&(c.displayName=b.displayName),b.editorName&&(c.editorName=b.editorName),f.ports.push(c)}var e=a._constructors[c].metadata,f={name:c};b.nodetypes.push(f),e.version&&(f.version=e.version),e.displayNodeName&&(f.displayNodeName=e.displayNodeName),e.deprecated&&(f.deprecated=!0),e.haveComponentPorts&&(f.haveComponentPorts=!0),"Visual"===e.category&&(f.allowAsChild=!0,f.allowAsExportRoot=!0,f.color="visual"),e.allowChildren&&(f.allowChildrenWithCategory=["Visual"],f.color="visual"),e.allowChildrenWithCategory&&(f.allowChildrenWithCategory=e.allowChildrenWithCategory),e.allowAsChild&&(f.allowAsChild=!0),f.category=e.category,e.panels&&(f.panels=e.panels),e.usePortAsLabel&&(f.usePortAsLabel=e.usePortAsLabel,f.portLabelTruncationMode=e.portLabelTruncationMode),e.color&&(f.color=e.color),e.dynamicports&&(f.dynamicports=e.dynamicports),f.ports=[];var g=[],h={},i={};e.dynamicports&&(e.dynamicports.filter(function(a){return"conditionalports/basic"===a.name}).forEach(function(a){a.ports.forEach(function(a){i[a.name]=!0})}),e.dynamicports.filter(function(a){return void 0!==a.channelPort}).forEach(function(a){i[a.channelPort.name]=!0})),e.numberedInputs&&Object.keys(e.numberedInputs).forEach(function(a){var b=e.numberedInputs[a],c={name:b.name,prefix:a};b.displayPrefix&&(c.displayPrefix=b.displayPrefix);var d={plug:"input"};if(b.group&&(d.group=b.group),c.port=d,b.selectors){var f=[];Object.keys(b.selectors).forEach(function(a){var c=b.selectors[a];h[a]=!0;var d={name:a,plug:"input"};c.displayName&&(d.displayName=c.displayName),c.editorName&&(d.editorName=c.editorName),c.group&&(d.group=c.group),d.allowEditOnly=!0,f.push(d)}),c.selectors=f}g.push(c)}),g.length&&(f.dynamicports=g),Object.keys(e.inputs).forEach(function(a){if(!h.hasOwnProperty(a)&&!i.hasOwnProperty(a)){var b=e.inputs[a];if(b.exportToEditor!==!1){var c={name:a,type:b.type,plug:"input"};b.group&&(c.group=b.group),b.displayName&&(c.displayName=b.displayName),b.editorName&&(c.editorName=b.editorName),void 0!==b["default"]&&(c["default"]=b["default"]),b.hasOwnProperty("index")&&(c.index=b.index),f.ports.push(c)}}}),Object.keys(e.outputs).forEach(function(a){var b=e.outputs[a];d(a,b)})}),b}b.exports=d},{}],233:[function(a,b,c){"use strict";function d(a){this._constructors={},this.context=a}d.prototype.register=function(a){var b=a.metadata.name;if(this._constructors.hasOwnProperty(b))throw new Error("Node with name "+b+" already registered");this._constructors[b]=a},d.prototype.createNode=function(a){if(this._constructors.hasOwnProperty(a)===!1)throw new Error("Unknown node type with name "+a);return this._constructors[a](this.context)},d.prototype.getNodeMetadata=function(a){if(this._constructors.hasOwnProperty(a)===!1)throw new Error("Unknown node type with name "+a);return this._constructors[a].metadata},d.prototype.hasNode=function(a){return this._constructors.hasOwnProperty(a)},b.exports=d},{}],234:[function(a,b,c){"use strict";function d(a){return!a}var e=a("../nodedefinition");b.exports=e.defineNode({name:"And",category:"Logic",initialize:function(){this._internal.inputs=[]},numberedInputs:{input:{name:"numbered/simple-boolean",displayPrefix:"Input",createSetter:function(a){return this._internal.inputs[a]=!1,function(b){this._internal.inputs[a]!==b&&(this._internal.inputs[a]=b,this.flagOutputDirty("result"))}}}},outputs:{result:{type:"boolean",displayName:"Result",getter:function(){var a=this._internal.inputs;return a.length>0&&a.some(d)===!1}}}})},{"../nodedefinition":231}],235:[function(a,b,c){"use strict";function d(a){this.name=a.name,this.startValue=0,this.endValue=0,this.currentValue=void 0,this.startMode="implicit",this.ease=a.ease,this.node=a.node,this.hasSampledStartValue=!1;var b=this;this.animation=a.node.context.timerScheduler.createTimer({startValue:0,endValue:0,onRunning:function(a){var c=b.ease(this.startValue,this.endValue,a);b.setCurrentValue(c)}}),this.animation.startValue=0,this.animation.endValue=0}var e=(a("../node"),a("../nodedefinition")),f=a("../easecurves"),g=a("bezier-easing");Object.defineProperties(d.prototype,{setCurrentValue:{value:function(a){this.currentValue=a,this.node.flagOutputDirty(this.name)}},play:{value:function(a,b){if(void 0===a&&(console.log("Animation warning, start value is undefined"),a=0),void 0===b)return void console.error("Animation error, start:",a,"end:",b);var c=this.animation;c.startValue=a,this.setCurrentValue(a),c.endValue=b,c.duration=this.node._internal.duration,c.start()}},playToEnd:{value:function(){this.hasConnections()!==!1&&(this.updateStartValue(),this.play(this.getTargetsCurrentValue(),this.endValue))}},playToStart:{value:function(){this.hasConnections()!==!1&&(this.updateStartValue(),this.play(this.getTargetsCurrentValue(),this.startValue))}},replayToEnd:{value:function(){this.hasConnections()!==!1&&(this.updateStartValue(),this.play(this.startValue,this.endValue))}},replayToStart:{value:function(){this.hasConnections()!==!1&&this.play(this.endValue,this.startValue)}},hasConnections:{value:function(){return this.node.getOutput(this.name).hasConnections()}},getTargetsCurrentValue:{value:function(){var a=this.node.getOutput(this.name).connections;return a[0].node._cachedInputValues[a[0].inputPortName]}},updateStartValue:{value:function(){"implicit"!==this.startMode||this.hasSampledStartValue||(this.hasSampledStartValue=!0,this.startValue=this.getTargetsCurrentValue())}},stop:{value:function(){this.animation.stop(),this.setCurrentValue(void 0)}},jumpToStart:{value:function(){this.animation.stop(),this.setCurrentValue(this.startValue)}},jumpToEnd:{value:function(){this.animation.stop(),this.setCurrentValue(this.endValue)}}});var h=[{value:"easeOut",label:"Ease Out"},{value:"easeIn",label:"Ease In"},{value:"linear",label:"Linear"},{value:"easeInOut",label:"Ease In Out"},{value:"cubicBezier",label:"Cubic Bezier"}],i=300,j={name:"Animation",category:"Animation",initialize:function(){var a=this._internal;a.duration=i,a.ease=f.easeOut,a._isPlayingToEnd=!1,a.animations=[],a.cubicBezierPoints=[0,0,0,0],a.cubicBezierFunction=void 0;var b=this;a.animation=this.context.timerScheduler.createTimer({onFinish:function(){a._isPlayingToEnd===!1?b.sendSignalOnOutput("hasReachedStart"):b.sendSignalOnOutput("hasReachedEnd")}})},inputs:{duration:{index:0,type:"number",displayName:"Duration (ms)",group:"Animation Properties","default":i,set:function(a){this._internal.duration=a}},easingCurve:{index:10,type:{name:"enum",enums:h},group:"Animation Properties",displayName:"Easing Curve","default":"easeOut",set:function(a){var b;"cubicBezier"===a?(this.updateCubicBezierFunction(),b=this._internal.cubicBezierFunction):b=f[a],this._internal.ease=b}},playToEnd:{index:20,group:"Play",displayName:"To End",editorName:"Play To End",valueChangedToTrue:function(){this._internal._isPlayingToEnd=!0;var a=this._internal.animation,b=this._internal.animations,c=this;this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].playToEnd()})}},playToStart:{index:21,group:"Play",displayName:"To Start",editorName:"Play To Start",valueChangedToTrue:function(){this._internal._isPlayingToEnd=!1;var a=this._internal.animation,b=this._internal.animations,c=this;this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].playToStart()})}},replayToEnd:{index:22,group:"Play",displayName:"From Start To End",editorName:"Play From Start To End",valueChangedToTrue:function(){var a=this._internal.animation,b=this._internal.animations,c=this;this._internal._isPlayingToEnd=!0,this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].replayToEnd()})}},replayToStart:{index:23,group:"Play",displayName:"From End To Start",editorName:"Play From End To Start",valueChangedToTrue:function(){this._internal._isPlayingToEnd=!1;var a=this._internal.animation,b=this._internal.animations,c=this;this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].replayToStart()})}},stop:{index:60,group:"Instant Actions",displayName:"Stop",valueChangedToTrue:function(){var a=this._internal.animation,b=this._internal.animations;a.stop();for(var c=0;c<b.length;c++)b[c].stop()}},jumpToStart:{index:61,group:"Instant Actions",displayName:"Jump To Start",valueChangedToTrue:function(){for(var a=this._internal.animations,b=0;b<a.length;b++)a[b].jumpToStart();this.sendSignalOnOutput("hasReachedStart")}},jumpToEnd:{index:62,group:"Instant Actions",displayName:"Jump To End",valueChangedToTrue:function(){for(var a=this._internal.animations,b=0;b<a.length;b++)a[b].jumpToEnd();this.sendSignalOnOutput("hasReachedEnd")}},cubicBezierP1X:{set:function(a){this._internal.cubicBezierPoints[0]=Math.min(1,Math.max(0,a)),this.updateCubicBezierFunction()}},cubicBezierP1Y:{set:function(a){this._internal.cubicBezierPoints[1]=a,this.updateCubicBezierFunction()}},cubicBezierP2X:{set:function(a){this._internal.cubicBezierPoints[2]=Math.min(1,Math.max(0,a)),this.updateCubicBezierFunction()}},cubicBezierP2Y:{set:function(a){this._internal.cubicBezierPoints[3]=a,this.updateCubicBezierFunction()}}},outputs:{hasReachedStart:{type:"signal",group:"Signals",displayName:"Has Reached Start"},hasReachedEnd:{type:"signal",group:"Signals",displayName:"Has Reached End"}},dynamicports:[{name:"conditionalports/basic",condition:"easingCurve = cubicBezier",ports:[{name:"cubicBezierP1X",displayName:"P1 X",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:11},{name:"cubicBezierP1Y",displayName:"P1 Y",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:12},{name:"cubicBezierP2X",displayName:"P2 X",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:13},{name:"cubicBezierP2Y",displayName:"P2 Y",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:14}]},{name:"expand/basic",indexStep:100,template:[{name:"{{portname}}.startMode",type:{name:"enum",enums:[{value:"explicit",label:"Explicit"},{value:"implicit",label:"Implicit"}],allowEditOnly:!0},plug:"input",group:"{{portname}} Animation",displayName:"Start Mode","default":"implicit",index:1e3},{name:"{{portname}}.endValue",type:"number",plug:"input",group:"{{portname}} Animation",displayName:"End Value",editorName:"End Value | {{portname}} ","default":0,index:1002}]},{name:"expand/basic",condition:"'{{portname}}.startMode' = explicit",indexStep:100,template:[{name:"{{portname}}.startValue",plug:"input",type:"number",displayName:"Start Value",editorName:"Start Value | {{portname}}",group:"{{portname}} Animation","default":0,index:1001}]}],panels:[{name:"PortEditor",title:"Animations",plug:"output",type:{name:"number"},group:"Animation Values"}],prototypeExtensions:{updateCubicBezierFunction:{value:function(){var a=this._internal.cubicBezierPoints,b=g(a);this._internal.cubicBezierFunction=function(a,c,d){return f.linear(a,c,b.get(d))},this._internal.ease=this._internal.cubicBezierFunction}},_registerAnimationGroup:{value:function(a){var b=new d({node:this,ease:this._internal.ease,name:a});this._internal.animations.push(b);var c={};c[a+".startMode"]={set:function(a){b.startMode=a}},c[a+".startValue"]={"default":0,set:function(a){b.startValue=a}},c[a+".endValue"]={"default":0,set:function(a){b.endValue=a}},this.registerInputs(c),this.registerOutput(a,{getter:function(){return b.currentValue}})}},registerInputIfNeeded:{value:function(a){if(!this.hasInput(a)){var b=a.indexOf("."),c=a.substr(0,b);this.hasOutput(c)||this._registerAnimationGroup(c)}}},registerOutputIfNeeded:{value:function(a){this.hasOutput(a)||this._registerAnimationGroup(a)}}}};b.exports=e.defineNode(j)},{"../easecurves":217,"../node":229,"../nodedefinition":231,"bezier-easing":2}],236:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a,b){for(var c=0;3>c;++c){var d=1+2*c;a[c]=parseInt(b.substring(d,d+2),16)}}function f(a){var b=a.toString(16);return 1==b.length?"0"+b:b}function g(a){return"#"+f(a[0])+f(a[1])+f(a[2])}var h=a("../easecurves"),i=[0,0,0],j=[0,0,0],k=[0,0,0],l={name:"Color Blend",category:"Interpolation",initialize:function(){var a=this._internal;a.resultColor="#000000",a.blendValue=0,a.colors=[]},numberedInputs:{color:{name:"numbered/simple-color",displayPrefix:"Color",createSetter:function(a){return function(b){this._internal.colors[a]=b,this.updateColor()}}}},inputs:{blendValue:{type:"number",displayName:"Blend Value","default":0,set:function(a){this._internal.blendValue=a,this.updateColor()}}},outputs:{result:{type:"color",displayName:"Result",getter:function(){return this._internal.resultColor}}},prototypeExtensions:{updateColor:function(){function a(a){return b[a]?b[a]:"#000000"}var b=this._internal.colors;if(0!==b.length){var c=d(0,b.length-1,this._internal.blendValue),f=Math.floor(c),l=c-f;0===l?this._internal.resultColor=a(f):(e(i,a(f)),e(j,a(f+1)),k[0]=Math.floor(h.linear(i[0],j[0],l)),k[1]=Math.floor(h.linear(i[1],j[1],l)),k[2]=Math.floor(h.linear(i[2],j[2],l)),this._internal.resultColor=g(k)),this.flagOutputDirty("result")}}}};b.exports={node:l}},{"../easecurves":217}],237:[function(a,b,c){"use strict";b.exports={node:{name:"Component Inputs",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Inputs",plug:"output",type:{name:"*"},canArrangeInGroups:!0},{name:"PropertyEditor",hidden:!0}],color:"component",haveComponentPorts:!0,category:"Component Utilities",initialize:function(){this._internal.outputs={}},prototypeExtensions:{registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:function(){return this.nodeScope.componentOwner._internal.inputValues[a]}})}}}}},{}],238:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.nodeScope=new f(a,this),this._internal.childRoot=null,this._internal.componentOutputValues={},this._internal.componentOutputs=[],this._internal.componentInputs=[],this._internal.inputValues={}}var e=a("../node"),f=a("../nodescope"),g=a("lodash");d.prototype=Object.create(e.prototype,{setComponentModel:{value:function(a){this.model=a;var b=this;this.nodeScope.setComponentModel(a),this._internal.componentInputs=this.nodeScope.getNodesWithType("Component Inputs"),this._internal.componentOutputs=this.nodeScope.getNodesWithType("Component Outputs"),g.values(a.getInputPorts()).forEach(this.registerComponentInputPort.bind(this)),g.values(a.getOutputPorts()).forEach(this.registerComponentOutputPort.bind(this)),a.roots&&a.roots.length>0&&this.setRoot(a.roots[0]),a.on("rootAdded",function(a){b._internal.root||b.setRoot(a)},this),a.on("rootRemoved",function(c){if(b._internal.root&&b._internal.root.id===c){var d=b._internal.visualParent;b.resetRoot();var e=a.getFirstRootId();e&&this.nodeScope.hasNodeWithId(e)&&(b.setRoot(a.getFirstRootId()),d&&d.addChild(b))}},this),a.on("inputPortAdded",this.registerComponentInputPort.bind(this),this),a.on("outputPortAdded",this.registerComponentOutputPort.bind(this),this),a.on("inputPortRemoved",function(a){b.hasInput(a.name)&&b.deregisterInput(a.name)},this),a.on("outputPortRemoved",function(a){this.hasOutput(a.name)&&b.deregisterOutput(a.name)},this),a.on("nodeAdded",function(a){"Component Inputs"===a.type?b._internal.componentInputs.push(b.nodeScope.getNodeWithId(a.id)):"Component Outputs"===a.type&&b._internal.componentOutputs.push(b.nodeScope.getNodeWithId(a.id))},this),a.on("nodeRemoved",function(a){"Component Inputs"===a.type?g.remove(b._internal.componentInputs,{id:a.id}):"Component Outputs"===a.type&&g.remove(b._internal.componentOutputs,{id:a.id})},this),a.on("renamed",function(a){b.name=a.newName},this)}},_onNodeDeleted:{value:function(){this.model&&(this.model.removeListenersWithRef(this),this.model=void 0),this.nodeScope.reset()}},registerComponentInputPort:{value:function(a){this.registerInput(a.name,{set:function(b,c){c?this._internal.inputValues[a.name]={value:b,unit:c}:this._internal.inputValues[a.name]=b,this._internal.componentInputs.forEach(function(b){b.registerOutputIfNeeded(a.name),b.flagOutputDirty(a.name)})}})}},registerComponentOutputPort:{value:function(a){this.registerOutput(a.name,{getter:function(){return this._internal.componentOutputValues[a.name]}})}},setOutputFromComponentOutput:{value:function(a,b){this.hasOutput(a)!==!1&&(this._internal.componentOutputValues[a]=b,this.flagOutputDirty(a))}},setRoot:{value:function(a){if(!a)throw Error("id must be set");var b=this.nodeScope.getNodeWithId(a);if(b.getVisualRoot){this._internal.root&&this.resetRoot(),this._internal.root=b;var c=b.getVisualRoot();c&&(c._internal.visualParent&&c._internal.visualParent.removeChild(this._internal.root),void 0===c.componentIds&&(c.componentIds=[]),-1===c.componentIds.indexOf(this.id)&&c.componentIds.push(this.id))}}},resetRoot:{value:function(){this._internal.visualParent&&this._internal.visualParent.removeChild(this);var a=this._internal.root.getVisualRoot();if(this._internal.root=void 0,a&&a.componentIds){var b=a.componentIds.indexOf(this.id);-1!==b&&a.componentIds.splice(b,1)}}},setChildRoot:{value:function(a){var b=this._internal.childRoot,c=a;if(this._internal.childRoot=c,this.model.children){var d=this.parentNodeScope,e=this.model.children.map(function(a){return d.getNodeWithId(a.id)});if(b)for(var f=0;f<e.length;f++)b.isChild(e[f])&&b.removeChild(e[f]);if(c)for(var f=0;f<e.length;f++){var g=e[f],h=g.model.parent.children.indexOf(g.model);this.addChild(g,h)}}}},getChildRootIndex:{value:function(){if(!this._internal.childRoot||!this._internal.childRoot.model||!this._internal.childRoot.model.children)return 0;for(var a=this._internal.childRoot.model.children,b=0;b<a.length;b++)if("Component Children"===a[b].type)return b;return 0}},getChildRoot:{value:function(){return this._internal.childRoot?this._internal.childRoot:this._internal.root.getChildRoot()}},getVisualRoot:{value:function(){return this._internal.root?this._internal.root.getVisualRoot():void 0}},addChild:{value:function(a,b){this.getChildRoot().addChild(a,b+this.getChildRootIndex())}},flagDirty:{value:function(){if(!this._dirty){e.prototype.flagDirty.call(this);for(var a=this._internal.componentInputs,b=0,c=a.length;c>b;b++)a[b].flagDirty();this._internal.componentOutputs.forEach(function(a){a.flagDirty()})}}},setHighlightEnabled:{value:function(a){var b=this.getVisualRoot();b&&b.setHighlightEnabled&&b.setHighlightEnabled(a)}},update:{value:function(){e.prototype.update.call(this),this._internal.componentOutputs.forEach(function(a){a.update()})}}}),d.prototype.constructor=d,b.exports=d},{"../node":229,"../nodescope":299,lodash:128}],239:[function(a,b,c){"use strict";b.exports={node:{category:"Component Utilities",name:"Component Outputs",panels:[{name:"PortEditor",context:["select","connectTo"],title:"Outputs",plug:"input",type:{name:"*"},canArrangeInGroups:!0},{name:"PropertyEditor",hidden:!0}],color:"component",haveComponentPorts:!0,prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:function(b){this.nodeScope.componentOwner.setOutputFromComponentOutput(a,b)}})}}}}},{}],240:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Counter",category:"Math",initialize:function(){this._internal.currentValue=0,this._internal.startValue=0,this._internal.startValueSet=!1,this._internal.limitsEnabled=!1,this._internal.limitsMin=0,this._internal.limitsMax=0},inputs:{increase:{displayName:"Increase Count",valueChangedToTrue:function(){this._internal.limitsEnabled&&this._internal.currentValue>=this._internal.limitsMax||(this._internal.currentValue++,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},decrease:{displayName:"Decrease Count",valueChangedToTrue:function(){this._internal.limitsEnabled&&this._internal.currentValue<=this._internal.limitsMin||(this._internal.currentValue--,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},reset:{displayName:"Reset To Start",valueChangedToTrue:function(){0!==this.currentValue&&(this._internal.currentValue=this._internal.startValue,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},startValue:{type:"number",displayName:"Start Value","default":0,set:function(a){this._internal.startValue=Number(a),this._internal.startValueSet===!1&&(this._internal.startValueSet=!0,this._internal.currentValue=this._internal.startValue,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},limitsMin:{type:{name:"number"},displayName:"Min Value",group:"Limits","default":0,set:function(a){this._internal.limitsMin=Number(a)}},limitsMax:{type:{name:"number"},displayName:"Max Value",group:"Limits","default":0,set:function(a){this._internal.limitsMax=Number(a)}},limitsEnabled:{type:{name:"boolean"},displayName:"Limits Enabled",group:"Limits","default":!1,set:function(a){this._internal.limitsEnabled=a?!0:!1}}},outputs:{currentCount:{displayName:"Current Count",type:"number",getter:function(){return this._internal.currentValue}},countChanged:{displayName:"Count Changed",type:"signal"}}})},{"../nodedefinition":231}],241:[function(a,b,c){"use strict";function d(){this.items=[]}var e=a("./model"),f=a("lodash"),g={};d.get=function(a){return void 0===a&&(a=e.guid()),g[a]||(g[a]=new d),g[a]},d.exists=function(a){return void 0!==g[a]},d.prototype.on=function(a,b){this.listeners||(this.listeners={}),this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(b)},d.prototype.off=function(a,b){if(this.listeners&&this.listeners[a]){var c=this.listeners[a].indexOf(b);-1!==c&&this.listeners[a].splice(c,1)}},d.prototype.notify=function(a,b){if(this.listeners&&this.listeners[a])for(var c=f.clone(this.listeners[a]),d=0;d<c.length;d++)c[d](b)},d.prototype.set=function(a){function b(a){for(var b={},c=a.length,d=0;c>d;d++){var e=a[d];b[e.getId()]=e}return b}var c,f;if(a!==this){var a=a instanceof d?a.items:a,g=[];for(c=a.length,f=0;c>f;f++){var h=a[f];h instanceof e?g.push(h):g.push(e.create(h))}var i=this.items,j=b(i),k=b(g);for(c=i.length,f=0;c>f;f++)k.hasOwnProperty(i[f].getId())||(this.removeAtIndex(f),f--,c--);for(f=0;f<Math.min(i.length,g.length);f++)i[f]!==g[f]&&(j.hasOwnProperty(g[f].getId())&&this.remove(g[f]),this.addAtIndex(g[f],f));for(f=i.length;f<g.length;f++)this.add(g[f])}},d.prototype.contains=function(a){return-1!==this.items.indexOf(a)},d.prototype.add=function(a){this.contains(a)||(this.items.push(a),this.notify("add",{item:a}),this.notify("change"),a.notify("add",{collection:this}))},d.prototype.addAtIndex=function(a,b){this.contains(a)||(this.items.splice(b,0,a),this.notify("add",{item:a,index:b}),this.notify("change"),a.notify("add",{collection:this,index:b}))},d.prototype.removeAtIndex=function(a){var b=this.items[a];this.items.splice(a,1),this.notify("remove",{item:b,index:a}),this.notify("change"),b.notify("remove",{collection:this})},d.prototype.remove=function(a){var b=this.items.indexOf(a);-1!==b&&this.removeAtIndex(b)},d.prototype.size=function(){return this.items.length},d.prototype.get=function(a){return this.items[a]},d.prototype.each=function(a){for(var b=0;b<this.items.length;b++)a(this.items[b],b)},b.exports=d},{"./model":245,lodash:128}],242:[function(a,b,c){"use strict";var d=a("../../nodedefinition"),e=a("../../node"),f=a("./model"),g=a("./collection"),h=a("../../edgetriggeredinput"),i={name:"Collection",category:"Data",usePortAsLabel:"collectionId",color:"data",dynamicports:[{name:"conditionalports/basic",condition:"idType = explicit OR idType NOT SET",ports:[{name:"collectionId",plug:"input",type:"string",displayName:"Id",group:"General"}]},{name:"conditionalports/basic",condition:"idType = unique",ports:[{name:"newId",plug:"input",type:{name:"boolean",allowConnectionsOnly:!0},displayName:"New",group:"General"}]}],initialize:function(){var a=this;this._internal.flagCountDirtyCallback=function(){a.flagOutputDirty("count")},this._internal.copySourceItemsCallback=function(){a.copySourceItems()}},inputs:{idType:{type:{name:"enum",enums:[{label:"Explicit",value:"explicit"},{label:"Generated",value:"unique"}],allowEditOnly:!0},"default":"explicit",displayName:"Id Mode",group:"General",set:function(a){this._internal.idType=a}},items:{type:"collection",group:"Modify",displayName:"Items",set:function(a){a&&a!==this._internal.sourceItems&&(this.bindSourceCollection(a),this.scheduleCopySourceItems())}},modifyId:{type:{name:"string",allowConnectionsOnly:!0},displayName:"Item Id",group:"Modify",set:function(a){this._internal.modifyId=a}},add:{displayName:"Add",group:"Modify",valueChangedToTrue:function(){var a=this._internal;this.scheduleAfterInputsHaveUpdated(function(){if(a.modifyId){var b=f.get(a.modifyId);a.collection.add(b)}})}},remove:{displayName:"Remove",group:"Modify",valueChangedToTrue:function(){var a=this._internal;this.scheduleAfterInputsHaveUpdated(function(){if(a.modifyId){var b=f.get(a.modifyId);a.collection.remove(b)}})}},clear:{displayName:"Clear",group:"Modify",valueChangedToTrue:function(){var a=this._internal;this.scheduleAfterInputsHaveUpdated(function(){a.collection.set([])})}}},outputs:{id:{type:"string",displayName:"Id",group:"General",getter:function(){return this._internal.name}},items:{type:"collection",displayName:"Items",group:"General",getter:function(){return this._internal.collection}},count:{type:"number",displayName:"Count",group:"General",getter:function(){return this._internal.collection?this._internal.collection.size():0}}},prototypeExtensions:{registerInputIfNeeded:function(a){var b=this;this.hasInput(a)||("collectionId"===a?this.registerInput(a,{set:function(a){b.setCollectionID(a)}}):"newId"===a&&this.registerInput(a,{set:h.createSetter({valueChangedToTrue:function(){b.newCollectionID()}})}))},newCollectionID:function(){this.setCollectionID(f.guid())},setCollectionID:function(a){this._internal.name=a,this.setCollection(g.get(a)),this.flagOutputDirty("id")},setCollection:function(a){this.bindCollection(a),this.flagOutputDirty("items"),this.flagOutputDirty("count")},unbindSourceCollection:function(){var a=this._internal;a.sourceItems&&a.sourceItems instanceof g&&(a.sourceItems.off("change",this._internal.copySourceItemsCallback),a.sourceItems=void 0)},bindSourceCollection:function(a){var b=this._internal;this.unbindSourceCollection(),b.sourceItems=a,a instanceof g&&a.on("change",this._internal.copySourceItemsCallback)},unbindCurrentCollection:function(){var a=this._internal.collection;a&&(a.off("change",this._internal.flagCountDirtyCallback),this._internal.collection=void 0)},bindCollection:function(a){this.unbindCurrentCollection(),this._internal.collection=a,a.on("change",this._internal.flagCountDirtyCallback)},_onNodeDeleted:function(){e.prototype._onNodeDeleted.call(this),this.unbindCurrentCollection()},scheduleCopySourceItems:function(){var a=this._internal;a.hasScheduledCopySourceItems||(a.hasScheduledCopySourceItems=!0,this.scheduleAfterInputsHaveUpdated(this.copySourceItems.bind(this)))},copySourceItems:function(){var a=this._internal;a.hasScheduledCopySourceItems=!1,(a.collection||void 0!==a.idType&&"explicit"!==a.idType)&&(a.collection||"unique"!==a.idType||this.newCollectionID(),a.collection.set(a.sourceItems))}}},j=d.defineNode(i);b.exports=j},{"../../edgetriggeredinput":218,"../../node":229,"../../nodedefinition":231,"./collection":241,"./model":245}],243:[function(a,b,c){"use strict";var d=a("../../nodedefinition"),e=a("../../node"),f=a("../../guid"),g="// model item is available in item variable\n// set the component variable to the name of the desired component for this\n// item. Component name must start with a '/'.\ncomponent = '/MyComponent';",h={name:"For Each",color:"data",category:"Visual",dynamicports:[{name:"conditionalports/basic",condition:"templateType = explicit OR templateType NOT SET",ports:[{name:"template",plug:"input",type:"component",displayName:"Component",group:"Appearance"}]},{name:"conditionalports/basic",condition:"templateType = dynamic",ports:[{name:"templateScript",plug:"input",type:{name:"string",codeeditor:"javascript",allowEditOnly:!0},displayName:"Script","default":g,group:"Appearance"}]}],initialize:function(){this._internal.itemNodes=[];var a=this;this._internal.onAddItem=function(b){a.addItem(b.item,b.index)},this._internal.onRemoveItem=function(b){a.removeItem(b.item)}},inputs:{items:{group:"Data",displayName:"Items",type:{name:"collection",allowConnectionsOnly:!0},set:function(a){a&&a!==this._internal.items&&(this.bindCollection(a),this.scheduleRefresh())}},templateType:{group:"Appearance",displayName:"Template Type",type:{name:"enum",enums:[{label:"Explicit",value:"explicit"},{label:"Dynamic",value:"dynamic"}]},"default":"explicit",set:function(a){this._internal.templateType=a,this.scheduleRefresh()}},template:{set:function(a){this._internal.template=a,this.scheduleRefresh()}},templateScript:{set:function(a){try{this._internal.templateFunction=new Function("item","var component;"+a+";return component;")}catch(b){console.log(b),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"foreach-syntax-warning",{message:"<strong>Syntax</strong>: "+b.message
})}this.scheduleRefresh()}},refresh:{group:"Appearance",displayName:"Refresh",type:"signal",valueChangedToTrue:function(){this.scheduleRefresh()}}},prototypeExtensions:{updateTarget:function(a){this._internal.target=a?this.nodeScope.getNodeWithId(a):void 0,this.scheduleRefresh()},setNodeModel:function(a){e.prototype.setNodeModel.call(this,a),a.parent&&this.updateTarget(a.parent.id);var b=this;a.on("parentUpdated",function(a){b.updateTarget(a?a.id:void 0)},this)},scheduleRefresh:function(){var a=this,b=this._internal;b.hasScheduledRefresh||(b.hasScheduledRefresh=!0,this.scheduleAfterInputsHaveUpdated(function(){a.refresh()}))},unbindCurrentCollection:function(){var a=this._internal.items;a&&(a.off("add",this._internal.onAddItem),a.off("remove",this._internal.onRemoveItem),this._internal.collection=void 0)},bindCollection:function(a){var b=this._internal;this.unbindCurrentCollection(),a.on("add",this._internal.onAddItem),a.on("remove",this._internal.onRemoveItem),b.items=a},getTemplateForModel:function(a){var b=this._internal;if(void 0===b.templateType||"explicit"===b.templateType)return b.template;if(b.templateFunction){try{var c=b.templateFunction(a)}catch(d){console.log(d),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"foreach-dynamic-warning",{message:"<strong>Dynamic template</strong>: "+d.message})}return c}},addItem:function(a,b){var c=this._internal,d=this.getTemplateForModel(a);if(d){var e=this.nodeScope.createNode(d,f());e._forEachModel=a;var g=e.nodeScope.getNodesWithType("Model");if(g&&g.length>0)for(var h=0;h<g.length;h++)g[h].hasInstanceIDType()&&g[h].setModel(a);var i=e.nodeScope.getNodesWithType("For Each Actions");if(i&&i.length>0)for(var h=0;h<i.length;h++)i[h].setItemId(a.getId()),i[h].signalAdded();c.itemNodes.push(e),c.target.addChild(e,b)}},removeItem:function(a){function b(){var b=c.target._internal.children;for(var d in b){var e=b[d];if(e._forEachModel===a&&!e._forEachRemoveInProgress)return e}}var c=this._internal,d=b();if(d){var e=d.nodeScope.getNodesWithType("For Each Actions");e&&e.length>0?(d._forEachRemoveInProgress=!0,e[0].tryRemove(function(){c.target.removeChild(d),c.target.nodeScope.deleteNode(d)})):(c.target.removeChild(d),c.target.nodeScope.deleteNode(d));var f=c.itemNodes.indexOf(d);-1!==f&&c.itemNodes.splice(f,1)}},refresh:function(){var a=this._internal;if(a.hasScheduledRefresh=!1,(a.template||a.templateFunction)&&a.items&&a.target){for(var b=0;b<a.itemNodes.length;b++)a.target.removeChild(a.itemNodes[b]);a.itemNodes=[];for(var b=0;b<a.items.size();b++){var c=a.items.get(b);this.addItem(c)}}},_onNodeDeleted:function(){e.prototype._onNodeDeleted.call(this),this.unbindCurrentCollection()}}};b.exports=d.defineNode(h)},{"../../guid":223,"../../node":229,"../../nodedefinition":231}],244:[function(a,b,c){"use strict";var d={name:"For Each Actions",displayNodeName:"For Each Item",category:"Data",color:"data",inputs:{removeCompleted:{type:{name:"boolean",allowConnectionsOnly:!0},displayName:"Remove Completed",group:"Events",valueChangedToTrue:function(){this._internal.removeCompletedCallback&&this._internal.removeCompletedCallback()}}},outputs:{added:{type:"signal",displayName:"Added",group:"Events"},tryRemove:{type:"signal",displayName:"Try Remove",group:"Events"},itemId:{type:"string",displayName:"Item Id",group:"General",getter:function(){return this._internal.itemId}}},prototypeExtensions:{setItemId:function(a){this._internal.itemId=a,this.flagOutputDirty("itemId")},signalAdded:function(){this.sendSignalOnOutput("added")},tryRemove:function(a){this.getOutput("tryRemove").hasConnections()?(this._internal.removeCompletedCallback=a,this.sendSignalOnOutput("tryRemove")):a()}}};b.exports={node:d}},{}],245:[function(a,b,c){function d(a,b){this.id=a,this.data=b}var e=a("lodash"),f={};d.get=function(a){return void 0===a&&(a=d.guid()),f[a]||(f[a]=new d(a,{})),f[a]},d.create=function(a){var b=a?a:{},c=d.get(b.id);for(var e in b)"id"!==e&&c.set(e,b[e]);return c},d.exists=function(a){return void 0!==f[a]},d.guid=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},d.prototype.on=function(a,b){this.listeners||(this.listeners={}),this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(b)},d.prototype.off=function(a,b){if(this.listeners&&this.listeners[a]){var c=this.listeners[a].indexOf(b);-1!==c&&this.listeners[a].splice(c,1)}},d.prototype.notify=function(a,b){if(this.listeners&&this.listeners[a])for(var c=e.clone(this.listeners[a]),d=0;d<c.length;d++)c[d](b)},d.prototype.setAll=function(a){for(var b in a)if("id"!==b&&this.data[b]!==a[b]){var c=this.data[b];this.data[b]=a[b],this.notify("change",{name:b,value:a[b],old:c})}},d.prototype.set=function(a,b,c){if(c&&c.resolve&&-1!==a.indexOf(".")){for(var e=a.split("."),f=this,g=0;g<e.length-1;g++){var h=f.get(e[g]);if(!(h instanceof d))return;f=h}return void f.set(e[e.length-1],b)}var i=this.data[a];this.data[a]=b,i!==b&&(!c||!c.silent)&&this.notify("change",{name:a,value:b,old:i})},d.prototype.getId=function(){return this.id},d.prototype.get=function(a,b){if(b&&b.resolve&&-1!==a.indexOf(".")){for(var c=a.split("."),e=this,f=0;f<c.length-1;f++){var g=e.get(c[f]);if(!(g instanceof d))return;e=g}return e.get(c[c.length-1])}return this.data[a]},b.exports=d},{lodash:128}],246:[function(a,b,c){"use strict";function d(a){return this._internal.model?this._internal.model.get(a,{resolve:!0}):void 0}function e(a,b){this._internal.inputValues[a]=b}function f(a,b,c){var d=[];b=b?b.split(","):void 0;for(var e in b){var f=b[e];d.push({type:{name:"*",allowConnectionsOnly:!0},plug:"input/output",group:"Properties",name:f})}var g=JSON.stringify(d);j[a]!==g&&(j[a]=g,c.sendDynamicPorts(a,d))}var g=a("./model"),h=a("../../edgetriggeredinput"),i=a("../../node"),j={},k={name:"Model",category:"Data",color:"data",dynamicports:[{name:"conditionalports/basic",condition:"idType = explicit",ports:[{name:"modelId",plug:"input",type:"string",displayName:"Id",group:"General"}]},{name:"conditionalports/basic",condition:"idType = unique OR idType NOT SET",ports:[{name:"newId",plug:"input",type:{name:"boolean",allowConnectionsOnly:!0},displayName:"New Id",group:"General"}]}],initialize:function(){var a=this._internal;a.inputValues={};var b=this;this._internal.onModelChangedCallback=function(a){b.hasOutput(a.name)&&b.flagOutputDirty(a.name)}},outputs:{id:{type:"string",displayName:"Id",group:"General",getter:function(){return this._internal.model?this._internal.model.getId():void 0}},stored:{type:"signal",displayName:"Stored",group:"Events"}},inputs:{idType:{type:{name:"enum",enums:[{label:"Explicit",value:"explicit"},{label:"Generated",value:"unique"}],allowEditOnly:!0},"default":"unique",displayName:"Id Mode",group:"General",set:function(a){this._internal.idType=a}},properties:{type:{name:"stringlist",allowEditOnly:!0},displayName:"Properties",group:"Properties",set:function(a){}},store:{displayName:"Store",group:"Actions",valueChangedToTrue:function(){this.scheduleStore()}},clear:{displayName:"Clear",group:"Actions",valueChangedToTrue:function(){var a=this._internal;if(a.model)for(var b in a.inputValues)a.model.set(b,void 0,{resolve:!0})}}},prototypeExtensions:{scheduleStore:function(){if(!this.hasScheduledStore){this.hasScheduledStore=!0;var a=this._internal;this.scheduleAfterInputsHaveUpdated(function(){if(a.model){for(var b in a.inputValues)a.model.set(b,a.inputValues[b],{resolve:!0});this.sendSignalOnOutput("stored"),this.hasScheduledStore=!1}})}},hasInstanceIDType:function(){return"instance"===this._internal.idType},newModelID:function(){this.setModelID(g.guid())},setModelID:function(a){var b=g.get(a);this.setModel(b)},setModel:function(a){this._internal.model&&this._internal.model.off("change",this._internal.onModelChangedCallback),this._internal.model=a,this.flagOutputDirty("id"),a.on("change",this._internal.onModelChangedCallback);for(var b in a.data)this.hasOutput(b)&&this.flagOutputDirty(b)},_onNodeDeleted:function(){i.prototype._onNodeDeleted.call(this),this._internal.model&&this._internal.model.off("change",this._internal.onModelChangedCallback)},registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:d.bind(this,a)})},registerInputIfNeeded:function(a){var b=this;this.hasInput(a)||("modelId"===a?this.registerInput(a,{set:function(a){b.setModelID(a)}}):"newId"===a?this.registerInput(a,{set:h.createSetter({valueChangedToTrue:function(){b.newModelID()}})}):this.registerInput(a,{set:e.bind(this,a)}))}}};b.exports={node:k,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Model",function(b){b.parameters.properties&&f(b.id,b.parameters.properties,a.editorConnection),b.on("parameterUpdated",function(c){"properties"===c.name&&f(b.id,b.parameters.properties,a.editorConnection)})})}}},{"../../edgetriggeredinput":218,"../../node":229,"./model":245}],247:[function(a,b,c){"use strict";function d(a){return this._internal.responseOutputs[a]}function e(a,b){this._internal.requestInputs[a]=b}function f(a,b){function c(a){for(var b=0;b<d.length;b++)if(d[b].name===a)return!0;return!1}if(a.parameters){var d=[];if(a.parameters.resource){var e=a.parameters.resource.match(/\{[A-Za-z0-9_]*\}/g);for(var f in e){var h=e[f],i=h.replace("{","").replace("}","");d.push({name:i,type:"string",plug:"input",group:"Inputs"})}}if(a.parameters.externalFile&&"yes"===a.parameters.useExternalFile){var j=a.parameters.externalFile,k=void 0!==b;k&&"/"!==j[0]&&(j="/"+j),g.createFromURL(j,null,function(e){e.getPorts().forEach(function(a){c(a.name)||d.push(a)}),b.sendDynamicPorts(a.id,d)})}else if(a.parameters.code){var l=g.createFromCode(a.parameters.code,null);l.getPorts().forEach(function(a){c(a.name)||d.push(a)}),b.sendDynamicPorts(a.id,d)}}}var g=(a("../../nodedefinition"),a("../../node"),a("../../guid"),a("../../javascriptnodeparser")),h=a("xml2js"),i="define({\n	// The input ports of the REST node, name of input and type\n	inputs:{\n	    //ExampleInput:'number',\n	},\n	\n	// The output ports of the REST node, name of output and type\n	outputs:{\n	    //ExampleOutput:'string',\n	},\n	\n	//Add custom code to setup the request object before the request\n	//is made.\n	//\n	//*request.resource     contains the resource path of the request.\n	//*request.method       contains the method, GET, POST, PUT or DELETE.\n	//*request.headers      is a map where you can add additional headers.\n	//*request.parameters   is a map the parameters that will be appended\n	//                      to the url.\n	//*request.content      contains the content of the request as a javascript\n	//                      object.\n	//\n	// The inputs and outputs maps can also be accessed via *this.inputs and\n	// *this.outputs.\n	request:function(inputs,request) {\n	},\n	\n	// Add custom code to convert the response content to outputs\n	//\n	//*response.status    The status code of the response\n	//*response.content   The content of the response as a javascript\n	//                    object.\n	//*response.request   The request object that resulted in the response.\n	//\n	// The inputs and outputs maps can also be accessed via *this.inputs and\n	// *this.outputs.\n	response:function(outputs,response) {\n	}\n})\n",j="//Add prototype backend code to response to the request\n//\n//*context.request                      contains the request object as passed from the\n//                                      request script.\n//*context.sendResponse(status,content) should be called to send a response back\n//                                      to the request script with status code\n//                                      and a javascript object with the content\n//                                      of the response.\ncontext.sendResponse(200,{result:'success'});\n",k={name:"REST",category:"Data",color:"data",initialize:function(){this._internal.requestInputs={},this._internal.responseOutputs={},this._internal.backendProperties={},this._internal.hasPendingFetch=!1,this._internal.useExternalFile=!1},dynamicports:[{name:"conditionalports/basic",condition:"backendType = external OR backendType NOT SET",ports:[{name:"backendEndpoint",plug:"input",type:{name:"string",allowEditOnly:!0},displayName:"Endpoint",group:"Backend"}]},{name:"conditionalports/basic",condition:"backendType = prototype",ports:[{name:"backendScript",plug:"input",type:{name:"string",codeeditor:"javascript",allowEditOnly:!0},displayName:"Script","default":j,group:"Backend"}]},{name:"conditionalports/basic",condition:"useExternalFile = no OR useExternalFile NOT SET",ports:[{name:"code",displayName:"Script",group:"Request",plug:"input",type:{name:"string",allowEditOnly:!0,codeeditor:"javascript"},"default":i}]},{name:"conditionalports/basic",condition:"useExternalFile = yes",ports:[{name:"externalFile",displayName:"File Path",group:"Request",plug:"input",type:{name:"source",allowEditOnly:!0}}]}],inputs:{resource:{type:"string",displayName:"Resource",group:"Request","default":"/",set:function(a){this._internal.resource=a}},method:{type:{name:"enum",enums:[{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"DELETE",value:"DELETE"},{label:"PUT",value:"PUT"}]},displayName:"Method",group:"Request","default":"GET",set:function(a){this._internal.method=a}},useExternalFile:{type:{name:"enum",enums:[{value:"yes",label:"Yes"},{value:"no",label:"No"}],allowEditOnly:!0},"default":"no",displayName:"Use External File",group:"Request",set:function(a){this._internal.isWaitingForExternalFileToLoad="yes"===a,this._internal.useExternalFile="yes"===a}},code:{set:function(a){a&&this.scheduleAfterInputsHaveUpdated(function(){if(this._internal.useExternalFile===!1){var b=g.createFromCode(a,this.nodeScope.noodlJavascriptAPI);this._onCodeParsed(b)}})}},externalFile:{set:function(a){if(this._internal.useExternalFile!==!1){this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a);var b=this;g.createFromURL(a,this.nodeScope.noodlJavascriptAPI,function(a){b._internal.isWaitingForExternalFileToLoad=!1,b._onCodeParsed(a),b._internal.hasPendingFetch===!0&&(b._internal.hasPendingFetch=!1,b.doFetch())})}}},fetch:{type:"boolean",displayName:"Fetch",group:"Actions",valueChangedToTrue:function(){this.scheduleFetch()}},cancel:{type:"boolean",displayName:"Cancel",group:"Actions",valueChangedToTrue:function(){this.cancelFetch()}},backendType:{type:{name:"enum",enums:[{label:"External",value:"external"},{label:"Prototype",value:"prototype"}],allowEditOnly:!0},displayName:"Backend type",group:"Backend","default":"external",set:function(a){this._internal.backendType=a}}},outputs:{fetching:{type:"boolean",displayName:"Fetching",group:"Status",getter:function(){return!!this._internal.fetching}},started:{type:"signal",displayName:"Started",group:"Signals"},completed:{type:"signal",displayName:"Completed",group:"Signals"},statusOK:{type:"signal",displayName:"Status OK",group:"Signals"},statusFail:{type:"signal",displayName:"Status Fail",group:"Signals"}},prototypeExtensions:{_onCodeParsed:function(a){if(this.context.editorConnection&&(this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name,this.id),a.error&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-parse-waring",{message:a.error})),!a.error){var b=this;Object.keys(a.outputs).forEach(function(a){b.registerOutputIfNeeded(a)}),this._internal.requestFunction=a.definedObject.request,this._internal.responseFunction=a.definedObject.response}},registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:d.bind(this,a)})},registerInputIfNeeded:function(a){var b=this;this.hasInput(a)||(0===a.indexOf("backend")?this.registerInput(a,{set:function(c){b._internal.backendProperties[a]=c}}):this.registerInput(a,{set:e.bind(this,a)}))},scheduleFetch:function(){var a=this._internal;a.hasScheduledFetch||(a.hasScheduledFetch=!0,this.scheduleAfterInputsHaveUpdated(this.doFetch.bind(this)))},doResponse:function(a,b,c){if(this._internal.responseFunction){var d={inputs:this._internal.requestInputs,outputs:this._internal.responseOutputs};this._internal.responseFunction.apply(d,[this._internal.responseOutputs,{status:a,content:b,request:c}])}for(var e in this._internal.responseOutputs)this.hasOutput(e)&&this.flagOutputDirty(e);200===a?this.sendSignalOnOutput("statusOK"):this.sendSignalOnOutput("statusFail"),this._internal.fetching=!1,this.flagOutputDirty("fetching"),this.sendSignalOnOutput("completed")},doExternalFetch:function(a){var b=this,c=new window.XMLHttpRequest,d=this._internal.backendProperties.backendEndpoint+a.resource;if(Object.keys(a.parameters).length>0){d+="?";for(var e in a.parameters)d+=e+"="+a.parameters[e]+"&"}c.open(a.method,window.encodeURI(d),!0);for(var f in a.headers)c.setRequestHeader(f,a.headers[f]);c.onreadystatechange=function(){var c=(this.response,!1);if(4===this.readyState||this.readyState===XMLHttpRequest.DONE){var d=this.status,e=this.getResponseHeader("content-type"),f=this.response;e&&(e=e.toLowerCase(),-1!==e.indexOf("/json")?(b.doResponse(d,JSON.parse(f),a),c=!0):-1!==e.indexOf("/xml")&&(h.parseString(f,function(c,e){b.doResponse(d,c?f:e,a)}),c=!0)),c===!1&&b.doResponse(d,f,a)}},c.onerror=function(){console.log("REST: Failed to request",d)},a.content?(c.setRequestHeader("Content-Type","application/json"),c.send(JSON.stringify(a.content))):c.send()},doPrototypeFetch:function(a){var b=this,c=this._internal.backendProperties.backendScript,d=new Function("context",c),e={request:a,sendResponse:function(c,d){b.doResponse(c,d,a)}};d(e)},doFetch:function(){if(this._internal.hasScheduledFetch=!1,this._internal.useExternalFile===!0&&this._internal.isWaitingForExternalFileToLoad===!0)return void(this._internal.hasPendingFetch=!0);this.sendSignalOnOutput("started"),this._internal.fetching=!0,this.flagOutputDirty("fetching");var a=this._internal.resource;for(var b in this._internal.requestInputs)a=a.replace("{"+b+"}",this._internal.requestInputs[b]);var c={resource:a,headers:{},method:void 0!==this._internal.method?this._internal.method:"GET",parameters:{}};if(this._internal.requestFunction){var d={inputs:this._internal.requestInputs,outputs:this._internal.responseOutputs};this._internal.requestFunction.apply(d,[this._internal.requestInputs,c])}void 0===this._internal.backendType||"external"===this._internal.backendType?this.doExternalFetch(c):this.doPrototypeFetch(c)}}};b.exports={node:k,setup:function(a,b){a.editorConnection&&b.on("nodeAdded.REST",function(b){f(b,a.editorConnection),b.on("parameterUpdated",function(c){f(b,a.editorConnection)})})}}},{"../../guid":223,"../../javascriptnodeparser":225,"../../node":229,"../../nodedefinition":231,xml2js:193}],248:[function(a,b,c){"use strict";function d(a,b){b=b||",";for(var c=new RegExp("(\\"+b+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+b+"\\r\\n]*))","gi"),d=[[]],e=null;e=c.exec(a);){var f=e[1];f.length&&f!==b&&d.push([]);var g;g=e[2]?e[2].replace(new RegExp('""',"g"),'"'):e[3],d[d.length-1].push(g)}return d}var e=a("../../nodedefinition"),f=a("./collection"),g={name:"Static Data",category:"Data",color:"data",dynamicports:[{name:"conditionalports/basic",condition:"type = csv OR type NOT SET",ports:[{name:"csv",plug:"input",type:{name:"string",codeeditor:"text"},displayName:"CSV",group:"General"}]},{name:"conditionalports/basic",condition:"type = json",ports:[{name:"json",plug:"input",type:{name:"string",codeeditor:"json"},displayName:"JSON",group:"General"}]}],inputs:{type:{type:{name:"enum",enums:[{label:"CSV",value:"csv"},{label:"JSON",value:"json"}]},displayName:"Type",group:"General","default":"csv",set:function(a){this._internal.type=a}},csv:{set:function(a){this._internal.csv=a,this.scheduleParseData()}},json:{set:function(a){this._internal.json=a,this.scheduleParseData()}}},outputs:{items:{type:"collection",displayName:"Items",group:"General",getter:function(){return this._internal.collection}}},prototypeExtensions:{scheduleParseData:function(){var a=this._internal;a.hasScheduledParseData||(a.hasScheduledParseData=!0,this.scheduleAfterInputsHaveUpdated(this.parseData.bind(this)))},parseData:function(){var a=this._internal;if(a.hasScheduledParseData=!1,a.collection||(a.collection=f.get()),void 0===a.type||"csv"===a.type){for(var b=d(a.csv),c=[],e=b[0],g=1;g<b.length;g++){for(var h=b[g],i={},j=0;j<e.length;j++)i[e[j]]=h[j];c.push(i)}a.collection.set(c),this.flagOutputDirty("items")}else if("json"===a.type){var c=JSON.parse(a.json);a.collection.set(c),this.flagOutputDirty("items")}}}};b.exports=e.defineNode(g)},{"../../nodedefinition":231,"./collection":241}],249:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a){var b=this._internal.snapPositions.length-1;return this._internal.snapPositions.some(function(c,d){return c>a?(b=d-1,!0):!1}),b}function f(a){this._internal.currentSnappedIndex!==a&&(this._internal.currentSnappedIndex=a,this.flagOutputDirty("currentIndex"))}function g(a,b,c){var e=b+(c>0?1:-1);return e=d(0,a.length-1,e)}function h(a,b,c,e){var f=.5,g=.02,h=50,i=a.length-1,j=Math.abs(c-a[b]),k=Math.abs(e);if(h>j&&f>k)return b;for(var l=0;l<a.length;++l){if(j=Math.abs(c-a[l]),h>j&&g>k){i=l,e>0&&i--;break}if(a[l]>c){i=l-1;break}}return e>0&&i++,d(0,a.length-1,i)}function i(a,b,c){var d;if("none"!==this._internal.snapBehavior){d="everyPosition"===this._internal.snapBehavior?g(this._internal.snapPositions,a,c):h(this._internal.snapPositions,this._internal.currentSnappedIndex,b,c);var e=this._internal.snapAnimation;e.startPosition=b,e.endPosition=this._internal.snapPositions[d],e.start(),f.call(this,d)}}function j(a){var b=a;this._internal.clampEnabled===!0&&(b=d(this._internal.clampMin,this._internal.clampMax,a)),0===this._internal.dragGestureRecognizer.axis?this._internal.target.setPositionX(b):this._internal.target.setPositionY(b)}function k(){var a=this._internal.target._internal.uiControl;return 0===this._internal.dragGestureRecognizer.axis?a.positionX:a.positionY}function l(a,b){if(a._internal.dragEnabled!==!1){var c=a._internal.dragGestureRecognizer.onTouch(b);return a._internal.track?c:void 0}}var m=(a("../node"),a("../nodedefinition")),n=a("../easecurves"),o={name:"Drag",category:"Interaction",initialize:function(){var a=this,b=this._internal;b.snapPositions=[0],b.target=void 0,b.track=!0,b.startSnapIndex=0,b.currentSnappedIndex=0,b.snapBehavior="none",b.dragEnabled=!0,b.dragRatio=1,b.snapDuration=300,b.clampMin=0,b.clampMax=0,b.clampEnabled=!1,b.snapAnimation=this.context.timerScheduler.createTimer({duration:b.snapDuration,ease:n.easeOut,startPosition:0,endPosition:0,onRunning:function(b){j.call(a,this.ease(this.startPosition,this.endPosition,b))}}),b.controlStart=0,b.indexOnDragStart=0,b.snapIndex=0,b.dragGestureRecognizer={},b.dragGestureRecognizer=this.context.uiEngine.createDragGestureRecognizer({axis:0,threshold:5,onDragStart:function(){b.snapAnimation.stop(),a.sendSignalOnOutput("dragStart"),b.controlStart=k.call(a),b.indexOnDragStart=e.call(a,b.controlStart)},onDrag:function(){var c=b.controlStart+this.dragDistance*b.dragRatio;if("none"!==b.snapBehavior){var e=b.snapPositions[0],f=b.snapPositions[b.snapPositions.length-1];c=d(e,f,c)}j.call(a,c)},onDragEnd:function(){a.sendSignalOnOutput("dragEnd"),i.call(a,b.indexOnDragStart,k.call(a),this.velocity)}})},inputs:{target:{type:"reference",displayName:"Target",group:"Target Node",set:function(a){if(this._internal.target&&(this._internal.target.removeTouchHandlersWithId(this),this._internal.target=void 0),a){var b=a.getVisualRoot();if(!b._internal.uiControl)throw new Error("target must be a visual node, not a "+b.name);this._internal.target=b,this._internal.target.addTouchHandler(l.bind(null,this),this);var c=this;this.context.scheduleAfterUpdate(function(){"none"!==c._internal.snapBehavior&&j.call(c,c._internal.snapPositions[c._internal.startSnapIndex])})}}},axis:{type:{name:"enum",enums:[{value:"0",label:"Horizontal"},{value:"1",label:"Vertical"}]},"default":"0",displayName:"Drag Direction",group:"Drag Behavior",set:function(a){this._internal.dragGestureRecognizer.axis=Number(a)}},snapBehavior:{type:{name:"enum",enums:[{value:"none",label:"None"},{value:"everyPosition",label:"Every Position"},{value:"closestPosition",label:"Closest Position"}]},"default":"none",group:"Drag Behavior",displayName:"Snap Behavior",set:function(a){this._internal.snapBehavior=a}},track:{type:"boolean",displayName:"Track Touch",group:"Drag Behavior","default":!0,set:function(a){this._internal.track=a}},dragThreshold:{type:{name:"number",allowEditOnly:!0},displayName:"Drag Threshold",group:"Drag Behavior","default":5,set:function(a){this._internal.dragGestureRecognizer.threshold=a}},dragEnabled:{type:{name:"boolean"},displayName:"Drag Enabled",group:"Drag Behavior","default":!0,set:function(a){this._internal.dragEnabled=a?!0:!1}},dragRatio:{type:"number",displayName:"Drag Ratio","default":1,group:"Drag Behavior",set:function(a){this._internal.dragRatio=Number(a)}},"snapToIndex.index":{type:"number",displayName:"Index",group:"Snap To Index","default":0,set:function(a){a===!0?a=1:a===!1&&(a=0),this._internal.snapIndex=Math.floor(a)}},"snapToIndex.duration":{type:"number",displayName:"Duration",editorName:"Duration|Snap To Index",group:"Snap To Index","default":300,set:function(a){this._internal.snapDuration=a}},"snapToIndex.do":{group:"Snap To Index",displayName:"Do",editorName:"Do|Snap To Index",valueChangedToTrue:function(){var a=this._internal.snapAnimation,b=this;this.scheduleAfterInputsHaveUpdated(function(){a.startPosition=k.call(b),a.endPosition=b._internal.snapPositions[b._internal.snapIndex],a.duration=b._internal.snapDuration,a.start(),f.call(b,b._internal.snapIndex)})}},"clampDragPosition.min":{type:{name:"number"},displayName:"Start",group:"Constrain","default":0,set:function(a){this._internal.clampMin=a}},"clampDragPosition.max":{type:{name:"number"},displayName:"End",group:"Constrain","default":0,set:function(a){this._internal.clampMax=a}},"clampDragPosition.enabled":{type:{name:"boolean"},displayName:"Constrain",group:"Constrain","default":!1,set:function(a){this._internal.clampEnabled=a}}},numberedInputs:{position:{name:"numbered/simple-number",displayPrefix:"Position",group:"Snap Positions",createSetter:function(a){return function(b){this._internal.snapPositions[a]=b}},selectors:{startAt:{displayName:"Start At",group:"Snap Positions",set:function(a){var b=this._internal;b.startSnapIndex=a,f.call(this,a),b.target&&a<b.snapPositions.length&&j.call(this,b.snapPositions[b.startSnapIndex])}}}}},outputs:{dragStart:{group:"Signals",type:"signal",displayName:"Drag Started"},dragEnd:{group:"Signals",type:"signal",displayName:"Drag Ended"},currentIndex:{group:"Current State",type:"number",displayName:"Current Index",getter:function(){return this._internal.currentSnappedIndex}}}};b.exports=m.defineNode(o)},{"../easecurves":217,"../node":229,"../nodedefinition":231}],250:[function(a,b,c){"use strict";var d={name:"Event Receiver",category:"Events",usePortAsLabel:"channelName",color:"component",initialize:function(){var a=this._internal;a.outputValues={},a.outputNames=[],a.eventReceived=!1,a._isEnabled=!0,a.channelName=""},dynamicports:[{name:"portchannel/event-sender-channel",channelPort:{name:"channelName",displayName:"Channel",plug:"input"},port:{type:"*",plug:"output",allowConnectionOnly:!0}}],inputs:{enabled:{displayName:"Enabled",type:"boolean","default":!0,set:function(a){this._internal._isEnabled=a?!0:!1}},channelName:{set:function(a){this._internal.channelName=a,this.registerListenersForChannel(a)}}},outputs:{eventReceived:{displayName:"Event Received",type:"signal"}},prototypeExtensions:{registerOutputIfNeeded:function(a){if(!this.hasOutput(a)){var b=this;this._internal.outputNames.push(a),this.registerOutput(a,{getter:function(){return b._internal.outputValues[a]}})}},handleEvent:function(a){if(this._internal._isEnabled!==!1){this.sendSignalOnOutput("eventReceived");for(var b in a)this.hasOutput(b)&&(this._internal.outputValues[b]=a[b],this.flagOutputDirty(b))}},onEventReceived:function(a){this.handleEvent(a)},registerListenersForChannel:function(a){var b=this.context.eventSenderEmitter,c=this.onEventReceived.bind(this);b.on(a,c),this.context.eventEmitter.once("applicationDataReloaded",function(){b.removeListener(a,c)})},getChannelName:function(){return this._internal.channelName}}};b.exports={node:d}},{}],251:[function(a,b,c){"use strict";var d={name:"Event Sender",category:"Events",usePortAsLabel:"channelName",color:"component",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Inputs",plug:"input",type:{name:"*",allowConnectionOnly:!0}}],initialize:function(){this._internal.inputValues={},this._internal.channelName="",this._internal.propagation="global"},inputs:{sendEvent:{displayName:"Send Event",valueChangedToTrue:function(){var a=this;this.scheduleAfterInputsHaveUpdated(function(){"global"===a._internal.propagation?a.context.sendGlobalEventFromEventSender(a._internal.channelName,a._internal.inputValues):a.nodeScope.sendEventFromThisScope(a._internal.channelName,a._internal.inputValues,a._internal.propagation)})}},channelName:{type:{name:"string",allowEditOnly:!0},"default":"",group:"Settings",displayName:"Channel Name",set:function(a){this._internal.channelName=a,this._internal.inputValues._channelName=a}},propagation:{type:{name:"enum",enums:[{value:"global",label:"Global"},{value:"parent",label:"Parent"},{value:"children",label:"Children"}]},"default":"global",group:"Settings",displayName:"Propagation",set:function(a){this._internal.propagation=a}}},prototypeExtensions:{registerInputIfNeeded:{value:function(a){if(!this.hasInput(a)){var b=this;this.registerInput(a,{set:function(c){b._internal.inputValues[a]=c}})}}}}};b.exports={node:d}},{}],252:[function(a,b,c){"use strict";function d(a,b){function c(){return a.apply(this,b)}return c.prototype=a.prototype,new c}function e(a){function b(a){-1===l.indexOf(a)&&(d.some(function(b){return b===a})||d.push(a))}function c(a){"Identifier"!==a.type||a.raw?"ConditionalExpression"===a.type?(c(a.test),c(a.consequent),c(a.alternate)):"MemberExpression"===a.type?c(a.object):"CallExpression"===a.type?(c(a.callee),a.arguments.forEach(c)):"UnaryExpression"===a.type?c(a.argument):("BinaryExpression"===a.type||"LogicalExpression"===a.type)&&(c(a.left),c(a.right)):b(a.name)}var d=[];try{var e=h(a);c(e)}catch(f){d=[]}return d}function f(a,b,c){var d=e(b),f=d.map(function(a){return{name:a,type:"number",plug:"input"}});c.sendDynamicPorts(a,f)}var g=(a("../node"),a("lodash")),h=a("jsep"),i={name:"Expression",category:"Math",usePortAsLabel:"expression",initialize:function(){var a=this._internal;a.scope={},a.hasScheduledEvaluation=!1,a.code=void 0,a.cachedValue=0,a.currentExpression="",a.compiledFunction=void 0,a.inputNames=[],a.inputValues=[]},inputs:{expression:{inputPriority:1,type:{name:"string",allowEditOnly:!0},displayName:"Expression",set:function(a){var b=this._internal;b.currentExpression=j+"return ("+a+");",b.compiledFunction=void 0;var c=e(a),d=g.difference(c,b.inputNames),f=g.difference(b.inputNames,c),h=this;f.forEach(function(a){h.deregisterInput(a),delete b.scope[a]}),d.forEach(function(a){h.registerInput(a,{set:function(c){b.scope[a]=c,this._scheduleEvaluateExpression()}}),b.scope[a]=0,h._cachedInputValues[a]=0}),b.inputNames=Object.keys(b.scope),this._scheduleEvaluateExpression()}}},outputs:{result:{type:"number",displayName:"Result",getter:function(){return this._internal.currentExpression?this._internal.cachedValue:0}}},prototypeExtensions:{_scheduleEvaluateExpression:{value:function(){var a=this._internal;a.hasScheduledEvaluation===!1&&(a.hasScheduledEvaluation=!0,this.flagDirty(),this.scheduleAfterInputsHaveUpdated(function(){var b=a.cachedValue;a.cachedValue=this._calculateExpression(),b!==a.cachedValue&&this.flagOutputDirty("result"),a.hasScheduledEvaluation=!1}))}},_calculateExpression:{
value:function(){var a=this._internal;a.compiledFunction||(a.compiledFunction=this._compileFunction());for(var b=0;b<a.inputNames.length;++b){var c=a.scope[a.inputNames[b]];a.inputValues[b]=c}try{return a.compiledFunction.apply(null,a.inputValues)}catch(d){console.error("Error in expression:",d.message)}return 0}},_compileFunction:{value:function(){var a=this._internal.currentExpression,b=Object.keys(this._internal.scope),c=a+b.join(" ");if(k.hasOwnProperty(c)===!1){b.push(a);try{k[c]=d(Function,b)}catch(e){console.error("Failed to compile JS function",e.message)}}return k[c]}}}},j=["var min = Math.min,    max = Math.max,    cos = Math.cos,    sin = Math.sin,    tan = Math.tan,    sqrt = Math.sqrt,    pi = Math.PI,    round = Math.round,    floor = Math.floor,    ceil = Math.ceil,    abs = Math.abs,    random = Math.random;"].join(""),k={},l=["min","max","cos","sin","tan","sqrt","pi","round","floor","ceil","abs","random","Math","window","document"];b.exports={node:i,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Expression",function(b){b.parameters.expression&&f(b.id,b.parameters.expression,a.editorConnection),b.on("parameterUpdated",function(c){"expression"===c.name&&f(b.id,b.parameters.expression,a.editorConnection)})})}}},{"../node":229,jsep:23,lodash:128}],253:[function(a,b,c){"use strict";var d={name:"Globals",category:"Utilities",color:"component",panels:[{name:"PortEditor",context:["select","connectTo","connectFrom"],title:"Globals",plug:"input/output",type:{name:"*"}}],prototypeExtensions:{_newOutputValueReceived:{value:function(a){this._cachedInputValues[a]=this.context.globalValues[a],this.flagOutputDirty(a)}},registerInputIfNeeded:{value:function(a){var b=this;this.hasInput(a)||this.registerInput(a,{set:b.context.setGlobalValue.bind(b.context,a)})}},registerOutputIfNeeded:{value:function(a){if(!this.hasOutput(a)){var b=this._newOutputValueReceived.bind(this,a),c=this.context.globalsEventEmitter;c.on(a,b),this.context.eventEmitter.once("applicationDataReloaded",function(){c.removeListener(a,b)}),this.registerOutput(a,{getter:function(){return this.context.globalValues[a]}})}}}}};b.exports={node:d}},{}],254:[function(a,b,c){"use strict";function d(a){a.alpha!==this._internal.alpha&&(this._internal.alpha=a.alpha,this.flagOutputDirty("rotationZ")),a.beta!==this._internal.beta&&(this._internal.beta=a.beta,this.flagOutputDirty("rotationX")),a.gamma!==this._internal.gamma&&(this._internal.gamma=a.gamma,this.flagOutputDirty("rotationY"))}var e=a("../nodedefinition"),f={name:"Gyroscope",displayNodeName:"Device Orientation",category:"Sensors",initialize:function(){this._internal.alpha=0,this._internal.beta=0,this._internal.gamma=0;var a=d.bind(this);window.addEventListener("deviceorientation",a),this.context.eventEmitter.once("applicationDataReloaded",function(){window.removeEventListener("deviceorientation",a)})},outputs:{rotationX:{type:"number",displayName:"Rotation X",getter:function(){return-this._internal.beta}},rotationY:{type:"number",displayName:"Rotation Y",getter:function(){return this._internal.gamma}},rotationZ:{type:"number",displayName:"Rotation Z",getter:function(){return-this._internal.alpha}}}};b.exports=e.defineNode(f)},{"../nodedefinition":231}],255:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e={name:"Inverter",category:"Math",initialize:function(){this._internal.currentValue=!1},inputs:{value:{type:{name:"boolean"},displayName:"Value",set:function(a){this._internal.currentValue=a,this.flagOutputDirty("result")}}},outputs:{result:{type:"boolean",displayName:"Result",getter:function(){return!this._internal.currentValue}}}};b.exports=d.defineNode(e)},{"../nodedefinition":231}],256:[function(a,b,c){"use strict";function d(){return this._internal.isFirstFrame?void(this._internal.isFirstFrame=!1):(this._evaluateFunction(),this.context.nodeIsDirty(this),void this.flagDirty())}function e(a,b){this._internal.needsToEval=!0,this._internal.inputValues[a]=b,this.flagDirty()}function f(a){return this._internal.needsToEval&&this._evaluateFunction(),this._internal.outputValues[a]}var g=a("../nodedefinition"),h=a("../node"),i={};b.exports=g.defineNode({name:"Javascript",category:"Javascript",displayNodeName:"Javascript (Deprecated)",deprecated:!0,panels:[{name:"PortEditor",context:["select"],title:"Inputs",plug:"input",type:{name:"*"}},{name:"PortEditor",context:["select"],title:"Outputs",plug:"output",type:{name:"*"}}],initialize:function(){var a=this._internal;a.inputValues={},a.outputValues={},a.needsToEval=!1;var b=this;a.userFunctionScope={flagOutputDirty:function(a){if(!a)throw new Error("Output port name must be specified");b.flagOutputDirty(a)}},a.isFirstFrame=!0,a.onFrameStart=d.bind(this)},inputs:{code:{type:{name:"string",allowEditOnly:!0,codeeditor:"javascript"},displayName:"code",group:"Code",set:function(a){i[a]||(i[a]=new Function("inputs","outputs",a)),this._internal.userFunction=i[a],this._internal.needsToEval=!0}},runEveryFrame:{type:"boolean",displayName:"Run Every Frame",group:"Settings",set:function(a){a=a?!0:!1;var b=this.context.eventEmitter;a===!0?b.on("frameStart",this._internal.onFrameStart):b.removeListener("frameStart",this._internal.onFrameStart)}}},prototypeExtensions:{update:{value:function(){this._dirty===!1||this._isUpdating||(h.prototype.update.call(this),this._internal.needsToEval&&(this._evaluateFunction(),this.flagDirty()))}},registerInputIfNeeded:{value:function(a){this.hasInput(a)||this.registerInput(a,{set:e.bind(this,a)})}},registerOutputIfNeeded:{value:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:f.bind(this,a)})}},_evaluateFunction:{value:function(){var a=this._internal;a.userFunction.call(a.userFunctionScope,a.inputValues,a.outputValues),a.needsToEval=!1}},flagDirty:{value:function(){for(var a in this._internal.outputValues)this.flagOutputDirty(a);h.prototype.flagDirty.call(this)}}}})},{"../node":229,"../nodedefinition":231}],257:[function(a,b,c){"use strict";function d(){for(var a in this._internal.dirtyOutputs)this.flagOutputDirty(a);this._internal.dirtyOutputs={}}function e(){this._internal.setupScheduled||(this._internal.setupScheduled=!0,this.scheduleAfterInputsHaveUpdated(function(){this._callSetupFunction(),this._internal.setupScheduled=!1,d.call(this)}))}function f(){this._internal.runScheduled||(this._internal.runScheduled=!0,this.scheduleAfterInputsHaveUpdated(function(){this._callRunFunction(),this._internal.runScheduled=!1,d.call(this)}))}function g(){this._internal.runNextFrame=!1,f.call(this)}function h(a,b){this._internal.inputValues[a]=b,this._internal.hasParsedCode===!0&&f.call(this)}function i(a){return this._internal.outputValues[a]}function j(a,b){if(a.parameters)if(a.parameters.externalFile&&"yes"===a.parameters.useExternalFile){var c=a.parameters.externalFile,d=void 0!==b;d&&"/"!==c[0]&&(c="/"+c),l.createFromURL(c,null,function(c){var d=c.getPorts();b.sendDynamicPorts(a.id,d)})}else if(a.parameters.code){var e=l.createFromCode(a.parameters.code,null),f=e.getPorts();b.sendDynamicPorts(a.id,f)}}var k=a("../node"),l=a("../javascriptnodeparser"),m=["define({","    inputs: {",'        inputValue: "number"',"    },","    outputs: {",'        outputValue: "number"',"    },","    setup: function(inputs, outputs) {","","    },","    run: function(inputs, outputs) {","","    }","});"].join("\n"),n={name:"Javascript2",displayNodeName:"Javascript",category:"Javascript",color:"javascript",initialize:function(){var a=this._internal;a.inputValues={},a.outputValues={},a.outputProperties={},a.dirtyOutputs={},a.runScheduled=!1,a.setupScheduled=!1,a.runNextFrameScheduled=!1,a.isWaitingForExternalFileToLoad=!1,a.useExternalFile=!1,a.runFunction=void 0,a.setupFunction=void 0,a.hasParsedCode=!1;var b=this;a.userFunctionScope={flagOutputDirty:function(c){if(!c)throw new Error("Output port name must be specified");b.flagOutputDirty(c),a.dirtyOutputs.hasOwnProperty(c)&&delete a.dirtyOutputs[c]},runNextFrame:function(){a.runNextFrameScheduled||(a.runNextFrameScheduled=!0,b.context.scheduleNextFrame(function(){a.runNextFrameScheduled=!1,f.call(b)}))},sendSignalOnOutput:function(c){a.outputValues[c]=!0,b.flagOutputDirty(c),a.outputValues[c]=!1,b.flagOutputDirty(c)}},a.onFrameStart=g.bind(this)},dynamicports:[{name:"conditionalports/basic",condition:"useExternalFile = no OR useExternalFile NOT SET",ports:[{name:"code",displayName:"Code",group:"Code",plug:"input",type:{name:"string",allowEditOnly:!0,codeeditor:"javascript"},"default":m}]},{name:"conditionalports/basic",condition:"useExternalFile = yes",ports:[{name:"externalFile",displayName:"File Path",group:"Code",plug:"input",type:{name:"source",allowEditOnly:!0}}]}],inputs:{useExternalFile:{type:{name:"enum",enums:[{value:"yes",label:"Yes"},{value:"no",label:"No"}],allowEditOnly:!0},"default":"no",displayName:"Use External File",group:"Code",set:function(a){this._internal.isWaitingForExternalFileToLoad="yes"===a,this._internal.useExternalFile="yes"===a}},code:{set:function(a){if(a){var b=this;this.scheduleAfterInputsHaveUpdated(function(){if(this._internal.useExternalFile===!1){var c=l.createFromCode(a,b.nodeScope.noodlJavascriptAPI);b._onCodeParsed(c)}})}}},externalFile:{set:function(a){if(this._internal.useExternalFile!==!1){this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a);var b=this;l.createFromURL(a,this.nodeScope.noodlJavascriptAPI,function(a){b._internal.isWaitingForExternalFileToLoad=!1,b._onCodeParsed(a)})}}}},prototypeExtensions:{update:function(){this._internal.isWaitingForExternalFileToLoad===!0?this._dirty=!1:k.prototype.update.call(this)},_onCodeParsed:function(a){if(this.context.editorConnection&&(this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name,this.id),a.error&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-parse-waring",{message:a.error})),!a.error){var b=this;Object.keys(a.outputs).forEach(function(a){b.registerOutputIfNeeded(a)}),this._internal.setupFunction=a.setup,this._internal.runFunction=a.run,this._internal.setupFunction&&e.call(this),this._internal.runFunction&&f.call(this),this._internal.hasParsedCode=!0}},registerInputIfNeeded:function(a){this.hasInput(a)||(this._internal.inputValues[a]=void 0,this.registerInput(a,{set:h.bind(this,a)}))},registerOutputIfNeeded:function(a){if(!this.hasOutput(a)){var b=this;Object.defineProperty(this._internal.outputProperties,a,{set:function(c){b._internal.outputValues[a]=c,b._internal.dirtyOutputs[a]=!0,b.context.scheduleFrame()},get:function(){return b._internal.outputValues[a]}}),this.registerOutput(a,{getter:i.bind(this,a)})}},_callRunFunction:function(){var a=this._internal;if(a.runFunction)try{a.runFunction.call(a.userFunctionScope,a.inputValues,a.outputProperties)}catch(b){console.log("Error in JS node run code.",Object.getPrototypeOf(b).constructor.name+": "+b.message),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-run-waring",{message:"<strong>run</strong>: "+b.message})}},_callSetupFunction:function(){var a=this._internal;if(a.setupFunction)try{a.setupFunction.call(a.userFunctionScope,a.inputValues,a.outputProperties)}catch(b){console.log("Error in JS node setup code.",Object.getPrototypeOf(b).constructor.name+": "+b.message),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-setup-waring",{message:"<strong>setup</strong>: "+b.message})}}}};b.exports={node:n,setup:function(a,b){a.editorConnection&&b.on("nodeAdded.Javascript2",function(b){j(b,a.editorConnection),b.on("parameterUpdated",function(c){j(b,a.editorConnection)})})}}},{"../javascriptnodeparser":225,"../node":229}],258:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e=a("../easecurves");b.exports=d.defineNode({name:"Number Blend",category:"Interpolation",initialize:function(){var a=this._internal;a.inputs=[],a.blendValue=0,a.result=0,a.clamp=!1},prototypeExtensions:{updateResult:function(){var a=this._internal.inputs;if(0===a.length)return 0;var b=Math.floor(this._internal.blendValue),c=this._internal.blendValue-b;b>=a.length-1?this._internal.clamp?(b=a.length-1,c=0):(c+=b-(a.length-1),b=a.length-1):0>=b&&(this._internal.clamp?(b=0,c=0):(c+=b,b=0)),0===c||1===a.length?this._internal.result=a[b]:b===a.length-1&&c>0?this._internal.result=e.linear(a[b-1],a[b],c+1):this._internal.result=e.linear(a[b],a[b+1],c),this.flagOutputDirty("result")}},numberedInputs:{input:{name:"numbered/simple-number",displayPrefix:"Number",createSetter:function(a){var b=this._internal.inputs;return b[a]=0,function(c){b[a]!==c&&(b[a]=c,this.updateResult())}}}},inputs:{blendValue:{type:"number",displayName:"Blend Value","default":0,set:function(a){this._internal.blendValue=a,this.updateResult()}},clamp:{type:"boolean",displayName:"Clamp","default":!1,set:function(a){this._internal.clamp=a?!0:!1,this.updateResult()}}},outputs:{result:{type:"number",displayName:"Result",getter:function(){return this._internal.result}}}})},{"../easecurves":217,"../nodedefinition":231}],259:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Number Remapper",category:"Math",initialize:function(){var a=this._internal;a._currentInputValue=0,a._remappedValue=0,a._minInputValue=0,a._maxInputValue=0,a._minOutputValue=0,a._maxOutputValue=1,a._clampOutput=!0},inputs:{inputValue:{group:"Value to Remap",type:{name:"number",allowConnectionOnly:!0},"default":0,displayName:"Input Value",set:function(a){this._internal._currentInputValue=a,this._calculateNewOutputValue()}},minInputValue:{group:"Input Parameters",type:{name:"number"},"default":0,displayName:"Input Minimum",set:function(a){this._internal._minInputValue=a,this._calculateNewOutputValue()}},maxInputValue:{group:"Input Parameters",type:{name:"number"},"default":0,displayName:"Input Maximum",set:function(a){this._internal._maxInputValue=a,this._calculateNewOutputValue()}},minOutputValue:{group:"Output Parameters",type:{name:"number"},"default":0,displayName:"Output Minimum",set:function(a){this._internal._minOutputValue=a,this._calculateNewOutputValue()}},maxOutputValue:{group:"Output Parameters",type:{name:"number"},"default":1,displayName:"Output Maximum",set:function(a){this._internal._maxOutputValue=a,this._calculateNewOutputValue()}},clamp:{group:"Output Parameters",type:{name:"boolean",allowEditOnly:!0},"default":!0,displayName:"Clamp Output",set:function(a){this._internal._clampOutput=a?!0:!1,this._calculateNewOutputValue()}}},outputs:{remappedValue:{type:"number",displayName:"Remapped Value",group:"Outputs",getter:function(){return this._internal._remappedValue}}},prototypeExtensions:{_calculateNewOutputValue:{value:function(){var a,b=this._internal;a=b._maxInputValue===b._minInputValue?0:(b._currentInputValue-b._minInputValue)/(b._maxInputValue-b._minInputValue),b._clampOutput&&(a=Math.max(0,Math.min(1,a))),b._remappedValue=b._minOutputValue+a*(b._maxOutputValue-b._minOutputValue),this.flagOutputDirty("remappedValue")}}}})},{"../nodedefinition":231}],260:[function(a,b,c){"use strict";function d(a){return a?!0:!1}var e=a("../nodedefinition");b.exports=e.defineNode({name:"Or",category:"Logic",initialize:function(){this._internal.inputs=[]},numberedInputs:{input:{name:"numbered/simple-boolean",displayPrefix:"Input",createSetter:function(a){return function(b){this._internal.inputs[a]!==b&&(this._internal.inputs[a]=b,this.flagOutputDirty("result"))}}}},outputs:{result:{type:"boolean",displayName:"Result",getter:function(){return this._internal.inputs.some(d)}}}})},{"../nodedefinition":231}],261:[function(a,b,c){"use strict";function d(a){for(var b=a.getNodesWithTypeRecursive("Page");0===b.length&&a.componentOwner;)a=a.componentOwner.parentNodeScope,b=a.getNodesWithTypeRecursive("Page");var c=b[0];return c._internal.pagesNode}var e=a("../nodedefinition"),f=a("lodash"),g=a("../node");b.exports=e.defineNode({name:"Page Navigation",category:"Navigation",initialize:function(){this._internal.inputValues={},this._internal.portUpdateScheduled=!1,this._internal.targetPagesNode=null,this._internal.resetPageStack=!1},inputs:{navigate:{displayName:"Navigate To Page",group:"Navigation",valueChangedToTrue:function(){this.scheduleAfterInputsHaveUpdated(this._doNavigation.bind(this))}},destination:{displayName:"Destination",group:"Navigation",type:"component",set:function(a){var b=this._internal;if(b.destinationComponentModel&&(b.destinationComponentModel.removeListenersWithRef(this),b.destinationComponentModel=void 0),this.context.hasComponentModelWithName(a)!==!1){b.destinationComponentModel&&b.destinationComponentModel.removeListenersWithRef(this),b.destinationComponentName=a;var c=this.context.getComponentModel(a);b.destinationComponentModel=c,this.updateDestinationPagePorts(c),c.on("inputPortAdded",this.scheduleUpdateDestinationPagePorts.bind(this,c),this),c.on("inputPortRemoved",this.scheduleUpdateDestinationPagePorts.bind(this,c),this)}}},targetPages:{displayName:"Pages Target",group:"Navigation",type:"reference",set:function(a){this._internal.targetPages=a}},resetPageStack:{displayName:"Reset history",group:"Navigation","default":!1,type:"boolean",set:function(a){this._internal.resetPageStack=a?!0:!1}}},prototypeExtensions:{_doNavigation:function(){var a=this._internal;if(a.destinationComponentName){var b=a.destinationComponentModel.getInputPorts();for(var c in a.inputValues)b.hasOwnProperty(c)===!1&&delete a.inputValues[c];var e=this._internal.targetPagesNode,f=e?e:d(this.nodeScope);this._internal.resetPageStack?f.resetTo(a.destinationComponentName,a.inputValues):f.navigateTo(a.destinationComponentName,a.inputValues)}},_onNodeDeleted:function(){g.prototype._onNodeDeleted.call(this);var a=this._internal;a.destinationComponentModel&&a.destinationComponentModel.removeListenersWithRef(this)},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:function(b){this._internal.inputValues[a]=b}})},scheduleUpdateDestinationPagePorts:function(a){if(!this._internal.portUpdateScheduled){this._internal.portUpdateScheduled=!0;var b=this;this.context.scheduleAfterUpdate(function(){b.updateDestinationPagePorts(a),b._internal.portUpdateScheduled=!1})}},updateDestinationPagePorts:function(a){var b=f.values(a.getInputPorts()).map(function(a){return{name:a.name,plug:"input",type:a.type,group:"Destination Page Inputs"}});this.context.editorConnection.sendDynamicPorts(this.id,b)}}})},{"../node":229,"../nodedefinition":231,lodash:128}],262:[function(a,b,c){"use strict";function d(a){for(var b=a.getNodesWithType("Page");0===b.length&&a.componentOwner;)a=a.componentOwner.parentNodeScope,b=a.getNodesWithType("Page");var c=b[0];return c._internal.pagesNode}var e=a("../nodedefinition");b.exports=e.defineNode({name:"Page Navigation Back",category:"Navigation",inputs:{back:{displayName:"Back",group:"Navigation",valueChangedToTrue:function(){var a=d(this.nodeScope);a.back()}}}})},{"../nodedefinition":231}],263:[function(a,b,c){"use strict";function d(a,b){this._internal.topicComponents[a]=b,this.scheduleSubscribe()}function e(a){return this._internal.outputValues[a]}function f(a,b,c){var d=b.match(/\{([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\}/g),e=[];for(var f in d)e.push({name:d[f].replace(/(\{|\})/g,""),group:"Topic components",plug:"input",type:"*"});var g=b.match(/\+([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\+/g);for(var f in g)e.push({name:g[f].replace(/\+/g,""),group:"Topic components",plug:"output",type:"*"});c.sendDynamicPorts(a,e)}var g=(a("../nodedefinition"),a("../services/services")),h={name:"Receive Message",category:"Messages",usePortAsLabel:"topic",color:"component",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Payload",plug:"outputs",group:"Payload",type:{name:"*",allowConnectionOnly:!0}}],initialize:function(){var a=this._internal;a.payload={},a.messageReceived=!1,a.isEnabled=!0,a.topic="",a.topicComponents={},a.outputValues={}},inputs:{enabled:{displayName:"Enabled",type:"boolean","default":!0,set:function(a){this._internal.isEnabled=a?!0:!1}},topic:{displayName:"Topic",type:"string","default":"",set:function(a){this._internal.topic=a,this.scheduleSubscribe()}}},outputs:{messageReceived:{displayName:"Received",type:"signal"}},prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:d.bind(this,a)})},registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:e.bind(this,a)})},computeTopic:function(){var a=this._internal.topic,b=this._internal.topicComponents;for(var c in b)a=a.replace("{"+c+"}",b[c]);return a.replace(/\+([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\+/g,"+")},handleMessage:function(a){if(this._internal.isEnabled!==!1){for(var b=a.payload,c=this._internal.topic.split("/"),d=a.topic.split("/"),e=0;e<d.length;e++){var f=c[e];if("+"===f[0]&&"+"===f[f.length-1]){var g=f.substring(1,f.length-1);this._internal.outputValues[g]=d[e],this.flagOutputDirty(g)}}for(var h in b)this._internal.outputValues[h]=b[h],this.hasOutput(h)&&this.flagOutputDirty(h);this.sendSignalOnOutput("messageReceived"),this.context.scheduleFrame()}},onMessageReceived:function(a){this.handleMessage(a)},scheduleSubscribe:function(){var a=this;this._internal.subscribeScheduled||(this._internal.subscribeScheduled=!0,this.scheduleAfterInputsHaveUpdated(function(){a._internal.subscribeScheduled=!1,a.subscribe()}))},subscribe:function(){this.subscription&&(g.pubsub.unsubscribe(this.subscription.topic,this.subscription.subscriber),this.subscription=void 0);var a=this.computeTopic();if(a){var b=this.onMessageReceived.bind(this);this.subscription={topic:a,subscriber:b},g.pubsub.subscribe(a,b),this.context.eventEmitter.once("applicationDataReloaded",function(){g.pubsub.unsubscribe(a,b)})}}}};b.exports={node:h,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Receive Message",function(b){b.parameters.topic&&f(b.id,b.parameters.topic,a.editorConnection),b.on("parameterUpdated",function(c){"topic"===c.name&&f(b.id,b.parameters.topic,a.editorConnection)})})}}},{"../nodedefinition":231,"../services/services":306}],264:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Reload",category:"Utilities",inputs:{reload:{displayName:"Reload",valueChangedToTrue:function(){this.context.reloadApplication()}}}})},{"../nodedefinition":231}],265:[function(a,b,c){"use strict";var d={name:"Screen Resolution",category:"Utilities",initialize:function(){var a=this;this.context.uiEngine.on("viewportSizeChanged",this._viewportSizeChanged.bind(this),this),this.context.eventEmitter.once("applicationDataReloaded",function(){a.context.uiEngine.removeListenersWithRef(a)}),this._viewportSizeChanged(this.context.uiEngine.getViewportSize())},outputs:{width:{type:"number",displayName:"Width",getter:function(){return this._internal.width}},height:{type:"number",displayName:"Height",getter:function(){return this._internal.height}},aspectRatio:{type:"number",displayName:"Aspect Ratio",getter:function(){return this._internal.width/this._internal.height}}},prototypeExtensions:{_viewportSizeChanged:function(a){this._internal.width=a.width,this._internal.height=a.height,this.flagAllOutputsDirty()}}};b.exports={node:d}},{}],266:[function(a,b,c){"use strict";function d(){return"undefined"!=typeof window?window.performance.now():+new Date}function e(a,b){this._internal.inputValues[a]=b,this._internal.publishOnInputsChanged&&this.schedulePublish()}function f(a,b,c){var d=b.match(/\{([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\}/g),e=[];for(var f in d)e.push({name:d[f].replace(/(\{|\})/g,""),group:"Topic components",plug:"input",type:"*"});c.sendDynamicPorts(a,e)}var g=a("../services/services"),h={name:"Send Message",category:"Messages",usePortAsLabel:"topic",color:"component",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Payload",plug:"input",group:"Payload",type:{name:"*",allowConnectionOnly:!0}}],initialize:function(){this._internal.payload={},this._internal.topic="",this._internal.inputValues={},this._internal.topicComponentsMap={},this._internal.hasScheduledPublish=!1,this._internal.publishOnInputsChanged=!1,this._internal.rateLimitEnabled=!1,this._internal.maxMessagesPerSecond=10,this._internal.lastPublishTime=0},dynamicports:[{name:"conditionalports/basic",condition:"rateLimit = true",ports:[{name:"maxMessagesPerSecond",type:"number","default":10,displayName:"Messages / Sec",group:"Rate Limit",plug:"input"}]}],inputs:{send:{displayName:"Send",valueChangedToTrue:function(){this.schedulePublish()}},topic:{type:{name:"string"},"default":"",displayName:"Topic",group:"General",set:function(a){this._internal.topic=a;var b=a.match(/\{([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\}/g);for(var c in b)this._internal.topicComponentsMap[b[c].replace(/(\{|\})/g,"")]=!0}},publishOnInputsChanged:{type:"boolean","default":!1,displayName:"Send On Change",group:"General",set:function(a){this._internal.publishOnInputsChanged=a?!0:!1}},rateLimit:{type:"boolean","default":!1,displayName:"Rate Limit",group:"Rate Limit",set:function(a){this._internal.rateLimitEnabled=a?!0:!1}},maxMessagesPerSecond:{set:function(a){this._internal.maxMessagesPerSecond=Number(a)}}},prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:e.bind(this,a)})},computeTopic:function(){var a=this._internal.topic,b=this._internal.topicComponentsMap,c=this._internal.inputValues;for(var d in b)a=a.replace("{"+d+"}",c[d]);return a},schedulePublish:function(){if(!this._internal.hasScheduledPublish){if(this._internal.rateLimitEnabled){clearTimeout(this._internal.rateLimitTimeoutId);var a=d(),b=1e3/this._internal.maxMessagesPerSecond,c=a-this._internal.lastPublishTime;if(b>c)return void(this._internal.rateLimitTimeoutId=setTimeout(this.schedulePublish.bind(this),b-c))}this._internal.hasScheduledPublish=!0,this.scheduleAfterInputsHaveUpdated(function(){this._internal.hasScheduledPublish=!1;var a=this.computeTopic(),b={},c=this._internal.inputValues,e=this._internal.topicComponentsMap;for(var f in c)e[f]||(b[f]=c[f]);g.pubsub.publish(a,b),this._internal.lastPublishTime=d()})}}}};b.exports={node:h,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Send Message",function(b){b.parameters.topic&&f(b.id,b.parameters.topic,a.editorConnection),b.on("parameterUpdated",function(c){"topic"===c.name&&f(b.id,b.parameters.topic,a.editorConnection)})})}}},{"../services/services":306}],267:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e=a("../edgetriggeredinput");b.exports=d.defineNode({name:"Signal To Index",category:"Logic",initialize:function(){this._internal.currentIndex=0},numberedInputs:{input:{name:"numbered/simple-boolean",displayPrefix:"Signal",createSetter:function(a){return e.createSetter({valueChangedToTrue:this.onValueChangedToTrue.bind(this,a)})},selectors:{startIndex:{displayName:"Start Index",set:function(a){this._internal.currentIndex=a,this.flagOutputDirty("index")}}}}},outputs:{index:{displayName:"Index",type:"number",getter:function(){return this._internal.currentIndex}},signalTriggered:{displayName:"Signal Triggered",type:"signal"}},prototypeExtensions:{onValueChangedToTrue:function(a){this.sendSignalOnOutput("signalTriggered"),this._internal.currentIndex!==a&&(this._internal.currentIndex=a,this.flagOutputDirty("index"))}}})},{"../edgetriggeredinput":218,"../nodedefinition":231}],268:[function(a,b,c){"use strict";function d(a,b,c){var d=b.states,e=b.values,f=[];e=e?e.split(","):void 0;for(var g in e){var j=e[g];f.push({type:{name:"number",allowConnectionsOnly:!0},plug:"output",group:"Values",name:j})}d=d?d.split(","):void 0,d.forEach(function(a){e&&e.forEach(function(b){f.push({plug:"input",type:"number",group:a+" Values",name:"value-"+a+"-"+b,displayName:b,editorName:a+"|"+b})}),f.push({plug:"input",type:{name:"enum",enums:[{value:"easeOut",label:"Ease Out"},{value:"easeIn",label:"Ease In"},{value:"linear",label:"Linear"},{value:"easeInOut",label:"Ease In Out"},{value:"cubicBezier",label:"Cubic Bezier"}]},"default":"easeOut",displayName:"Easing Curve",group:a+" Transition",name:"transition-"+a}),"cubicBezier"===b["transition-"+a]&&(f=f.concat([{name:"cubicBezierP1X-"+a,editorName:a+"|P1 X",displayName:"P1 X",group:a+" Transition",plug:"input",type:"number","default":0},{name:"cubicBezierP1Y-"+a,editorName:a+"|P1 Y",displayName:"P1 Y",group:a+" Transition",plug:"input",type:"number","default":0},{name:"cubicBezierP2X-"+a,editorName:a+"|P2 X",displayName:"P2 X",group:a+" Transition",plug:"input",type:"number","default":0},{name:"cubicBezierP2Y-"+a,editorName:a+"|P2 Y",displayName:"P2 Y",group:a+" Transition",plug:"input",type:"number","default":0}])),f.push({plug:"input",type:"number","default":h,displayName:"Duration",group:a+" Transition",name:"duration-"+a}),f.push({plug:"input",type:{name:"boolean",allowConnectionsOnly:!0},displayName:"To "+a,name:"to-"+a,group:"Go to state"}),f.push({plug:"output",type:"boolean",displayName:"At "+a,name:"at-"+a,group:"Current state"}),f.push({plug:"output",type:"boolean",displayName:"Has Reached "+a,name:"reached-"+a,group:"Current state"})}),d&&f.push({plug:"input",type:{name:"enum",enums:d},group:"States",displayName:"Start at",name:"startState","default":d[0]});var k=JSON.stringify(f);i[a]!==k&&(i[a]=k,c.sendDynamicPorts(a,f))}var e=a("../edgetriggeredinput"),f=a("../easecurves"),g=a("bezier-easing"),h=300,i={},j={name:"States",category:"Animation",initialize:function(){var a=this,b=this._internal;b.currentValues={},b.stateParameters={},b.startValues={},b.bezierEaseCurves={},b.valuesAreInitialised=!1,b.animation=this.context.timerScheduler.createTimer({duration:h,ease:f.easeOut,onStart:function(){},onRunning:function(c){var d=this.ease(0,1,c),e=b.values,f=b.currentValues,g=b.stateParameters,h="value-"+b.state+"-",i=b.startValues;for(var j in e){var k=e[j];f[k]=i[k]*(1-d)+(g[h+k]||0)*d,a.flagOutputDirty(k)}},onFinish:function(){var c="reached-"+b.state;a.hasOutput(c)&&a.sendSignalOnOutput(c)}})},inputs:{states:{type:{name:"stringlist",allowEditOnly:!0},displayName:"States",group:"States",set:function(a){this._internal.states=a.split(",");var b=this;this.scheduleAfterInputsHaveUpdated(function(){b._internal.scheduledToGoToState||b.goToState(b._internal.states[0])})}},values:{type:{name:"stringlist",allowEditOnly:!0},displayName:"Values",group:"Values",set:function(a){var b=this._internal;b.values=a.split(",");for(var c in b.values)this.registerOutputIfNeeded(b.values[c])}},toggle:{group:"Go to state",displayName:"Toggle",valueChangedToTrue:function(){var a=this._internal,b=this;if(a.states){var c=a.states.indexOf(a.state),d=(c+1)%a.states.length;this._internal.scheduledToGoToState=a.states[d],this.scheduleAfterInputsHaveUpdated(function(){b.goToState(a.states[d])})}}},currentState:{type:{name:"string",allowConnectionsOnly:!0},displayName:"Current State",group:"Go to state",set:function(a){var b=this,c=this._internal;c.states&&-1!==c.states.indexOf(a)&&(c.scheduledToGoToState=a,this.scheduleAfterInputsHaveUpdated(function(){b.goToState(a)}))}}},outputs:{currentState:{type:"string",displayName:"Current State",group:"Current State",getter:function(){return this._internal.state}},stateChanged:{type:"signal",displayName:"State Changed",group:"Current State"}},prototypeExtensions:{registerOutputIfNeeded:function(a){var b=this._internal;this.hasOutput(a)||this.registerOutput(a,{getter:function(){return b.currentValues[a]}})},registerInputIfNeeded:function(a){var b=this,c=this._internal;if(!this.hasInput(a))if(0===a.indexOf("to-")){var d=a.substring(3);this.registerInput(a,{set:e.createSetter({valueChangedToTrue:function(){this._internal.scheduledToGoToState=d,this.scheduleAfterInputsHaveUpdated(function(){b.goToState(d)})}})})}else if("startState"===a)this.registerInput(a,{set:function(a){this._internal.scheduledToGoToState=a,this.scheduleAfterInputsHaveUpdated(function(){b.goToState(a);
})}});else if(0===a.indexOf("value-")){var f=a.split("-"),d=f[1],g=f[2];this.registerInput(a,{set:function(e){c.stateParameters[a]=e,c.state===d&&(c.currentValues[g]=e,b.flagOutputDirty(g))}})}else if(0===a.search(/duration-/g))this.registerInput(a,{set:function(b){c.stateParameters[a]=b}});else if(0===a.search(/transition-/g)){var d=a.substring(11);this.registerInput(a,{set:function(b){c.stateParameters[a]=b,"cubicBezier"===b&&this.updateCubicBezierFunction(d)}})}else if(0===a.search(/cubicBezierP[1-2][X-Y]-/g)){var d=a.substring(15);this.registerInput(a,{set:function(b){c.stateParameters[a]=b,this.updateCubicBezierFunction(d)}})}},updateCubicBezierFunction:function(a){var b=[],c=this._internal;["1X","1Y","2X","2Y"].forEach(function(d,e){var f=c.stateParameters["cubicBezierP"+d+"-"+a]||0;e%2===0&&(f=Math.min(1,Math.max(0,f))),b.push(f)});var d=g(b);c.bezierEaseCurves[a]=function(a,b,c){return f.linear(a,b,d.get(c))}},jumpToState:function(a){var b=this._internal;if(b.states&&(a||(a=b.states[0]),b.state!==a)){b.animation.stop();var c="value-"+a+"-";for(var d in b.values){var e=b.values[d];b.currentValues[e]=b.stateParameters[c+e]||0,this.flagOutputDirty(e)}b.valuesAreInitialised=!0,b.state=a,this.sendSignalOnOutput("stateChanged"),this.updateAtStatePorts(),this.flagOutputDirty("currentState")}},goToState:function(a){var b=this._internal;if(b.states&&(a||(a=b.states[0]),b.state!==a))if(this._internal.scheduledToGoToState=void 0,b.valuesAreInitialised){for(var c in b.values){var d=b.values[c];b.startValues[d]=b.currentValues[d]}var e=b.stateParameters["transition-"+a]||"easeOut";b.animation.ease="cubicBezier"===e?b.bezierEaseCurves[a]:f[e];var g="duration-"+a;b.animation.duration=b.stateParameters.hasOwnProperty(g)?b.stateParameters[g]:h,b.animation.start(),b.state=a,this.sendSignalOnOutput("stateChanged"),this.updateAtStatePorts(),this.flagOutputDirty("currentState")}else this.jumpToState(a)},updateAtStatePorts:function(){var a=this._internal,b=a.states;for(var c in b){var d=b[c],e="at-"+d;a.currentValues[e]=a.state===d,this.hasOutput(e)&&this.flagOutputDirty(e)}}}};b.exports={node:j,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.States",function(b){b.parameters.states&&d(b.id,b.parameters,a.editorConnection),b.on("parameterUpdated",function(c){("states"===c.name||"values"===c.name||"transition-"===c.name.substring(0,11))&&d(b.id,b.parameters,a.editorConnection)})})}}},{"../easecurves":217,"../edgetriggeredinput":218,"bezier-easing":2}],269:[function(a,b,c){"use strict";function d(a,b){this._internal.inputValues[a]=b,this._internal.resultDirty=!0,this.flagOutputDirty("formatted")}function e(a,b,c){var d=b.match(/\{[A-Za-z0-9_]*\}/g),e=[];for(var f in d){var g=d[f],h=g.replace("{","").replace("}","");e.push({name:h,type:"*",plug:"input"})}c.sendDynamicPorts(a,e)}var f={name:"String Format",category:"String Manipulation",initialize:function(){var a=this._internal;a.format="",a.cachedResult="",a.resultDirty=!1,a.inputValues={}},inputs:{format:{type:{name:"string",multiline:!0},displayName:"Format",set:function(a){this._internal.format=a,this._internal.resultDirty=!0,this.flagOutputDirty("formatted")}}},outputs:{formatted:{type:"string",displayName:"Formatted",getter:function(){var a=this._internal;if(a.resultDirty){var b=a.format,c=a.format.match(/\{[A-Za-z0-9_]*\}/g),d=[];c&&(d=c.map(function(a){return a.replace("{","").replace("}","")})),d.forEach(function(c){var d=a.inputValues[c];b=b.replace("{"+c+"}",void 0!==d?d:"")}),a.cachedResult=b,a.resultDirty=!1}return a.cachedResult}}},prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:d.bind(this,a)})}}};b.exports={node:f,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.String Format",function(b){b.parameters.format&&e(b.id,b.parameters.format,a.editorConnection),b.on("parameterUpdated",function(c){"format"===c.name&&e(b.id,b.parameters.format,a.editorConnection)})})}}},{}],270:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"String Mapper",category:"Utilities",initialize:function(){this._internal.inputs=[],this._internal.mappings=[]},numberedInputs:{input:{name:"numbered/simple-string",displayPrefix:"Input",group:"Inputs",index:11,createSetter:function(a){return function(b){b=b.toString(),this._internal.inputs[a]=b,this.scheduleMapping()}}},output:{name:"numbered/simple-string",displayPrefix:"Mapping",index:12,group:"Mappings",createSetter:function(a){return function(b){b=b.toString(),this._internal.mappings[a]=b,this.scheduleMapping()}}}},inputs:{inputString:{type:{name:"string"},index:1,displayName:"Input String",set:function(a){this._internal.currentInputString=a,this.scheduleMapping()}},defaultMapping:{type:"string",displayName:"Default",index:10,group:"Mappings",set:function(a){this._internal.defaultMapping=a,this.scheduleMapping()}}},outputs:{mappedString:{type:"string",displayName:"Mapped String",group:"Value",getter:function(){return this._internal.mappedString}}},prototypeExtensions:{doMapping:function(){this._internal.hasScheduledFetch=!1;var a=this._internal.inputs.indexOf(this._internal.currentInputString);-1!==a?this._internal.mappedString=this._internal.mappings[a]:this._internal.mappedString=this._internal.defaultMapping,this.flagOutputDirty("mappedString")},scheduleMapping:function(){var a=this._internal;a.hasScheduledFetch||(a.hasScheduledFetch=!0,this.scheduleAfterInputsHaveUpdated(this.doMapping.bind(this)))}}})},{"../nodedefinition":231}],271:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"String Selector",category:"Utilities",initialize:function(){this._internal.inputs=[],this._internal.currentSelectedIndex=0,this._internal.indexChanged=!1},numberedInputs:{input:{name:"numbered/simple-string",displayPrefix:"Input",group:"Inputs",createSetter:function(a){return function(b){b=b.toString(),this._internal.inputs[a]=b,this._internal.currentSelectedIndex===a&&this.flagOutputDirty("currentValue")}}}},inputs:{index:{type:{name:"number"},displayName:"Index","default":0,set:function(a){a=0|a,this._internal.currentSelectedIndex=a,this.flagOutputDirty("currentValue"),this.sendSignalOnOutput("indexChanged")}}},outputs:{currentValue:{type:"string",displayName:"Current Value",group:"Value",getter:function(){return this._internal.inputs[this._internal.currentSelectedIndex]}},indexChanged:{type:"signal",displayName:"Index Changed",group:"Signals"}}})},{"../nodedefinition":231}],272:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Substring",category:"String Manipulation",initialize:function(){var a=this._internal;a.startIndex=0,a.endIndex=-1,a.cachedResult="",a.inputString="",a.resultDirty=!1},inputs:{start:{type:"number",displayName:"Start","default":0,set:function(a){this._internal.startIndex=a,this._internal.resultDirty=!0,this.flagOutputDirty("result")}},end:{type:"number",displayName:"End","default":0,set:function(a){this._internal.endIndex=a,this._internal.resultDirty=!0,this.flagOutputDirty("result")}},string:{type:{name:"string"},displayName:"String","default":"",set:function(a){a=a.toString(),this._internal.inputString=a,this._internal.resultDirty=!0,this.flagOutputDirty("result")}}},outputs:{result:{type:"string",displayName:"Result",getter:function(){var a=this._internal;return a.resultDirty&&(-1===a.endIndex?a.cachedResult=a.inputString.substr(a.startIndex):a.cachedResult=a.inputString.substr(a.startIndex,a.endIndex-a.startIndex),a.resultDirty=!1),a.cachedResult}}}})},{"../nodedefinition":231}],273:[function(a,b,c){"use strict";var d={name:"Switch",category:"Logic",initialize:function(){this._internal.state=!1,this._internal.initialized=!1},inputs:{on:{displayName:"On",group:"Change State",valueChangedToTrue:function(){this._internal.state!==!0&&(this._internal.state=!0,this.flagOutputDirty("state"),this.emitSignals())}},off:{displayName:"Off",group:"Change State",valueChangedToTrue:function(){this._internal.state!==!1&&(this._internal.state=!1,this.flagOutputDirty("state"),this.emitSignals())}},flip:{displayName:"Flip",group:"Change State",valueChangedToTrue:function(){this._internal.state=!this._internal.state,this.flagOutputDirty("state"),this.emitSignals()}},onFromStart:{type:"boolean",displayName:"Start State",group:"Start State","default":!1,set:function(a){a&&!this._internal.initialized&&(this._internal.state=!0,this.flagOutputDirty("state"),this._internal.initialized=!0,this.emitSignals())}}},outputs:{state:{type:"boolean",displayName:"Current State",getter:function(){return this._internal.state}},switchedToOn:{displayName:"Switched To On",type:"signal",group:"Signals"},switchedToOff:{displayName:"Switched To Off",type:"signal",group:"Signals"}},prototypeExtensions:{emitSignals:function(){this._internal.state===!0?this.sendSignalOnOutput("switchedToOn"):this.sendSignalOnOutput("switchedToOff")}}};b.exports={node:d}},{}],274:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Timer",category:"Utilities",initialize:function(){var a=this;this._internal._animation=this.context.timerScheduler.createTimer({duration:0,onStart:function(){a.sendSignalOnOutput("timerStarted")},onFinish:function(){a.sendSignalOnOutput("timerFinished")}})},inputs:{start:{displayName:"Start",valueChangedToTrue:function(){this._internal._animation._isRunning===!1&&this._internal._animation.start()}},restart:{displayName:"Restart",valueChangedToTrue:function(){this._internal._animation.start()}},duration:{type:"number",displayName:"Duration","default":0,set:function(a){this._internal._animation.duration=a}},startDelay:{type:"number",displayName:"Start Delay","default":0,set:function(a){this._internal._animation.delay=a}},stop:{displayName:"Stop",valueChangedToTrue:function(){this._internal._animation.stop()}}},outputs:{timerStarted:{type:"signal",displayName:"Started"},timerFinished:{type:"signal",displayName:"Finished"}}})},{"../nodedefinition":231}],275:[function(a,b,c){"use strict";var d=a("../node"),e={name:"Touch Position",category:"Interaction",initialize:function(){this._internal.x=0,this._internal.y=0,this.context.uiEngine.on("touchEvent",this.onTouchEvent.bind(this),this)},outputs:{x:{type:"number",displayName:"Position X",getter:function(){return this._internal.x}},y:{type:"number",displayName:"Position Y",getter:function(){return this._internal.y}}},prototypeExtensions:{_onNodeDeleted:function(){d.prototype._onNodeDeleted.call(this),this.context.uiEngine.removeListenersWithRef(this)},onTouchEvent:function(a){this._internal.x!==a.x&&(this._internal.x=a.x,this.flagOutputDirty("x")),this._internal.y!==a.y&&(this._internal.y=a.y,this.flagOutputDirty("y"))}}};b.exports={node:e}},{"../node":229}],276:[function(a,b,c){"use strict";function d(a){var b=this._internal._animation;b.stop(),b.startValue=a,this.scheduleAfterInputsHaveUpdated(function(){b.endValue!==a&&b.start()}),this._internal.currentNumber=a,this.flagOutputDirty("currentValue")}var e=a("../nodedefinition"),f=a("../easecurves"),g=300,h={name:"Transition",category:"Animation",initialize:function(){var a=this,b=this._internal;b.currentNumber=0,b.numberInitialized=!1,b.animationStarted=!1,b.setCurrentNumberEnabled=!1,b.overrideValue=0,b._animation=this.context.timerScheduler.createTimer({duration:g,startValue:0,endValue:0,ease:f.easeOut,onStart:function(){b.animationStarted=!0},onRunning:function(c){b.currentNumber=this.ease(this.startValue,this.endValue,c),a.flagOutputDirty("currentValue")},onFinish:function(){a.sendSignalOnOutput("atTargetValue")}})},inputs:{targetValue:{type:{name:"number"},displayName:"Value",group:"Target Value","default":void 0,set:function(a){if(a===!0?a=1:a===!1&&(a=0),a=Number(a),!isNaN(a)){var b=this._internal;return b.numberInitialized===!1?(b.currentNumber=a,b.numberInitialized=!0,b._animation.endValue=a,void this.flagOutputDirty("currentValue")):void(a!==b._animation.endValue&&(b._animation.startValue=b.currentNumber,b._animation.endValue=a,b._animation.start()))}}},"overrideCurrentValue.value":{type:{name:"number"},group:"Override Value",displayName:"Value",editorName:"Value|Override Value",set:function(a){this._internal.overrideValue=a}},"overrideCurrentValue.do":{group:"Override Value",displayName:"Do",editorName:"Do|Override Value",valueChangedToTrue:function(){d.call(this,this._internal.overrideValue)}},duration:{type:"number",group:"Parameters",displayName:"Duration","default":g,set:function(a){this._internal._animation.duration=a}},delay:{type:"number",group:"Parameters",displayName:"Delay","default":0,set:function(a){this._internal._animation.delay=a}},easingCurve:{type:{name:"enum",enums:[{value:"easeOut",label:"Ease Out"},{value:"easeIn",label:"Ease In"},{value:"linear",label:"Linear"},{value:"easeInOut",label:"Ease In Out"}]},"default":"easeOut",displayName:"Easing Curve",group:"Parameters",set:function(a){this._internal._animation.ease=f[a]}}},outputs:{currentValue:{type:"number",displayName:"Current Value",group:"Current State",getter:function(){return this._internal.currentNumber}},atTargetValue:{type:"signal",displayName:"At Target Value",group:"Signals"}}};b.exports=e.defineNode(h)},{"../easecurves":217,"../nodedefinition":231}],277:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Value Changed",category:"Logic",initialize:function(){this._internal.lastValue=void 0},inputs:{value:{type:"*",displayName:"Input",set:function(a){this._internal.lastValue!==a&&(this.sendSignalOnOutput("valueChanged"),this._internal.lastValue=a)}}},outputs:{valueChanged:{type:"signal",displayName:"Value Changed"}}})},{"../nodedefinition":231}],278:[function(a,b,c){"use strict";var d=a("./variablebase"),e=d.createDefinition({name:"Boolean",startValue:!1,type:{name:"boolean"},cast:function(a){return Boolean(a)}});b.exports={node:e}},{"./variablebase":282}],279:[function(a,b,c){"use strict";var d=a("./variablebase"),e=a("../../nodedefinition");b.exports=e.defineNode(d.createDefinition({name:"Color",startValue:"#f1f2f4",type:{name:"color"},cast:function(a){return a}}))},{"../../nodedefinition":231,"./variablebase":282}],280:[function(a,b,c){"use strict";var d=a("./variablebase"),e=d.createDefinition({name:"Number",startValue:0,type:{name:"number"},cast:function(a){return Number(a)}});b.exports={node:e}},{"./variablebase":282}],281:[function(a,b,c){"use strict";var d=a("./variablebase"),e=a("../../nodedefinition"),f=d.createDefinition({name:"String",startValue:"",type:{name:"string"},cast:function(a){return a.toString()}});e.extend(f,{outputs:{length:{type:"number",displayName:"Length",getter:function(){return this._internal.currentValue.length}}}}),b.exports=e.defineNode(f)},{"../../nodedefinition":231,"./variablebase":282}],282:[function(a,b,c){"use strict";function d(a){return{name:a.name,category:"Variables",initialize:function(){this._internal.currentValue=a.startValue,this._internal.latestValue=0},inputs:{value:{type:a.type,displayName:"Value","default":a.startValue,set:function(a){this.isInputConnected("saveValue")===!1?this.setValueTo(a):this._internal.latestValue=a}},saveValue:{displayName:"Save Value",valueChangedToTrue:function(){this.scheduleAfterInputsHaveUpdated(function(){this.setValueTo(this._internal.latestValue)})}}},outputs:{savedValue:{type:a.type.name,displayName:"Saved Value",getter:function(){return this._internal.currentValue}}},prototypeExtensions:{setValueTo:function(b){b=a.cast(b),this._internal.currentValue=b,this.flagAllOutputsDirty()}}}}b.exports={createDefinition:d}},{}],283:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Velocity",category:"Math",initialize:function(){var a=this._internal;a.oldValue=0,a.sampledAtTime=0,a.velocity=0},inputs:{value:{type:"number",displayName:"Value",set:function(a){var b=this._internal;if(0===b.sampledAtTime)return b.oldValue=a,void(b.sampledAtTime=this.context.currentFrameTime);if(this.context.currentFrameTime!==b.sampledAtTime){var c=this.context.currentFrameTime-b.sampledAtTime;b.velocity=(a-b.oldValue)/c,b.sampledAtTime=this.context.currentFrameTime,b.oldValue=a,this.flagOutputDirty("velocity")}}}},outputs:{velocity:{type:"number",displayName:"Velocity",getter:function(){return this._internal.velocity}}}})},{"../nodedefinition":231}],284:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f="#f0f0f0",g=d.createDefinition({defaultSizeEnum:"explicit",defaultSizeUnit:"px",defaultWidth:200,defaultHeight:200,defaultColor:f,createControl:function(a){var b=a.createCircleControl();return b.setWidth(200),b.setColor(f),b}});delete g.inputs.height,g.inputs.width.displayName="Size",g.inputs.width.type.units=["px"],e.extend(g,{name:"Circle",inputs:{solid:{index:3004,type:"boolean",displayName:"Solid",group:"Appearance","default":!0,set:function(a){this._internal.uiControl.setSolid(a?!0:!1)}},lineWidth:{index:3005,type:"number",displayName:"Line Width",group:"Appearance","default":1,set:function(a){this._internal.uiControl.setLineWidth(a)}},blur:{index:3006,displayName:"Blur Length",group:"Appearance",type:"number","default":0,set:function(a){this._internal.uiControl.setBlur(a)}},arcAngle:{index:3007,displayName:"Arc Angle",group:"Appearance",type:"number","default":360,set:function(a){this._internal.uiControl.setArcAngle(a*Math.PI/180)}},image:{index:3500,displayName:"Image Path",group:"Image Properties",type:{name:"image"},set:function(a){"string"==typeof a&&this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a),this._internal.uiControl.setImagePath(a)}}}}),b.exports={node:g}},{"../../nodedefinition":231,"./renderable":292}],285:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=a("../../nodedefinition"),f=d.createDefinition({name:"Flow Layout",hasOrientation:!0,createControl:function(a){return a.createFlowLayoutControl()}});e.extend(f,{inputs:{verticalItemSpacing:{index:2501,group:"Layout",displayName:"V. Spacing",type:"number","default":0,set:function(a){this._internal.uiControl.setVerticalItemSpacing(Number(a))}},horizontalItemSpacing:{index:2502,group:"Layout",displayName:"H. Spacing",type:"number","default":0,set:function(a){this._internal.uiControl.setHorizontalItemSpacing(Number(a))}},contentAlignX:{index:2503,type:{name:"enum",enums:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},group:"Layout",displayName:"Content Align X","default":"left",set:function(a){this._internal.uiControl.setContentAlignX(a)}},contentAlignY:{index:2504,type:{name:"enum",enums:[{value:"top",label:"Top"},{value:"center",label:"Center"},{value:"bottom",label:"Bottom"}]},group:"Layout",displayName:"Content Align Y","default":"top",set:function(a){this._internal.uiControl.setContentAlignY(a)}}}}),b.exports=e.defineNode(f)},{"../../nodedefinition":231,"./layoutbase":288}],286:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=d.createDefinition({name:"Group",createControl:function(a){return a.createDockLayoutControl()},version:2});b.exports={node:e}},{"./layoutbase":288}],287:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f=d.createDefinition({sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"childSize",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100,widthCondition:"sizeMode = explicit OR sizeMode = childHeight",heightCondition:"sizeMode = explicit OR sizeMode = childWidth",defaultColor:"#ffffff",createControl:function(a){return a.createImageControl()}});e.extend(f,{name:"Image",version:2,usePortAsLabel:"image",portLabelTruncationMode:"filename",inputs:{image:{index:2500,type:{name:"image"},displayName:"Image Path",group:"Image Properties",set:function(a){return a?("string"==typeof a&&0!==a.lastIndexOf("data:",0)&&0!==a.lastIndexOf("http:",0)&&0!==a.lastIndexOf("https:",0)&&this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a),void this._internal.uiControl.setImagePath(a)):void this._internal.uiControl.setImagePath(null)}},cornerRadius:{index:3004,type:"number",displayName:"Corner Radius",group:"Appearance","default":0,set:function(a){}},fillMode:{index:2501,type:{name:"enum",enums:[{value:"original",label:"Original"},{value:"aspectFill",label:"Aspect Fill"},{value:"aspectFit",label:"Aspect Fit"},{value:"fill",label:"Fill"}],allowEditOnly:!0},displayName:"Fill Mode",group:"Image Properties","default":"original",set:function(a){this._internal.uiControl.setFillMode(a)}},clipImage:{index:2502,type:"boolean",displayName:"Clip Image","default":!0,group:"Image Properties",set:function(a){this._internal.uiControl.setClip(a?!0:!1)}}}});var g=[{inputName:"cropStartX",index:0,"default":0,displayName:"Crop Start X"},{inputName:"cropEndX",index:2,"default":1,displayName:"Crop End X"},{inputName:"cropStartY",index:1,"default":0,displayName:"Crop Start Y"},{inputName:"cropEndY",index:3,"default":1,displayName:"Crop End Y"}],h={};g.forEach(function(a){var b=a.index;h[a.inputName]={index:2503+b,type:"number",group:"Image Properties","default":a["default"],displayName:a.displayName,set:function(a){this._internal.innerControl._srcRect[b]=a,this._internal.innerControl.contentDirty=!0}}}),e.extend(f,h),b.exports=e.defineNode(f)},{"../../nodedefinition":231,"./renderable":292}],288:[function(a,b,c){"use strict";function d(a){var b=e.createDefinition({createControl:a.createControl,sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"explicit",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100});return f.extend(b,{name:a.name,version:a.version,initialize:function(){var a=this._internal;a.children=[]},allowChildren:!0,inputs:{clip:{group:"Appearance",displayName:"Clip",type:"boolean",index:3100,"default":!1,set:function(a){this._internal.uiControl.setClip(a)}},padding:{group:"Padding",displayName:"Padding",type:"number",index:2800,"default":0,set:function(a){var b=this._internal.uiControl;b.setPaddingTop(a),b.setPaddingLeft(a),b.setPaddingBottom(a),b.setPaddingRight(a)}},paddingLeft:{group:"Padding",displayName:"Pad Left",type:"number",index:2801,set:function(a){this._internal.uiControl.setPaddingLeft(a)}},paddingRight:{group:"Padding",displayName:"Pad Right",type:"number",index:2802,set:function(a){this._internal.uiControl.setPaddingRight(a)}},paddingTop:{group:"Padding",displayName:"Pad Top",type:"number",index:2803,set:function(a){this._internal.uiControl.setPaddingTop(a)}},paddingBottom:{group:"Padding",displayName:"Pad Bottom",type:"number",index:2804,set:function(a){this._internal.uiControl.setPaddingBottom(a)}}},outputs:{childCount:{displayName:"Child Count",type:"number",getter:function(){return this._internal.children.length}}},prototypeExtensions:{addChild:{value:function(a,b){if(!a.getVisualRoot)throw new Error("child must have a visual root");var c=this._internal.uiControl,d=this._internal.children;void 0===b&&(b=d.length),b=Math.max(0,b),c.addChild(a.getVisualRoot()._internal.uiControl,b),b===d.length?d.push(a):d.splice(b,0,a),this.flagOutputDirty("childCount");for(var e=b;e<d.length;e++)d[e].getVisualRoot().flagOutputDirty("childIndex");a._internal.visualParent=this,a.getVisualRoot()._internal.visualParent=this}},getChildren:{value:function(){return g.clone(this._internal.children)}},removeChild:{value:function(a){if(!a.getVisualRoot)throw new Error("child must be a visual node");var b=this._internal.children,c=b.indexOf(a);if(-1===c)throw new Error("child is not a child of this node");if(a.getVisualRoot()){var d=a.getVisualRoot()._internal.uiControl;d.parent&&d.parent.removeChild(d)}b.splice(c,1),this.flagOutputDirty("childCount");for(var e=c;e<b.length;e++)b[e].getVisualRoot().flagOutputDirty("childIndex");a._internal.visualParent=void 0,a.getVisualRoot()&&(a.getVisualRoot()._internal.visualParent=void 0)}},isChild:{value:function(a){return-1!==this._internal.children.indexOf(a)}},getChildRoot:{value:function(){return this}}}}),a.hasOrientation&&f.extend(b,{initialize:function(){this._internal.uiControl.setOrientation("vertical")},inputs:{orientation:{index:2500,group:"Layout",displayName:"Orientation",type:{name:"enum",enums:[{value:"horizontal",label:"Horizontal"},{value:"vertical",label:"Vertical"}]},"default":"vertical",set:function(a){this._internal.uiControl.setOrientation(a)}}}}),b}var e=a("./visualbase"),f=a("../../nodedefinition"),g=a("lodash");b.exports={createDefinition:d}},{"../../nodedefinition":231,"./visualbase":297,lodash:128}],289:[function(a,b,c){"use strict";function d(a,b){var c=a.getLayoutRect().width;void 0===c&&(c=0);var d=.3*-c;0>=b?a.setPositionX(g.easeInOut(d,0,1+b)):a.setPositionX(g.easeInOut(0,c,b))}var e=a("./layoutbase"),f=a("../../nodedefinition"),g=a("../../easecurves"),h=e.createDefinition({name:"Page",createControl:function(a){return a.createDockLayoutControl()}});f.extend(h,{initialize:function(){this._internal.title="",this._internal.transition="default",this._internal.transitionPosition=0,this._internal.transitionDuration=350,this._internal.customTransitionDuration=350},dynamicports:[{name:"conditionalports/basic",condition:"transition = custom",ports:[{name:"customTransitionDuration",plug:"input",type:"number",displayName:"Transition Duration",group:"Page","default":350}]}],inputs:{title:{type:"string",displayName:"Title",group:"Page",set:function(a){this._internal.title=a,this._internal.pagesNode&&this._internal.pagesNode.flagOutputDirty("currentPageTitle")}},transition:{displayName:"Transition",group:"Page","default":"default",type:{name:"enum",enums:[{value:"none",label:"None"},{value:"default",label:"Default"},{value:"custom",label:"Custom"}]},set:function(a){var b=this._internal;b.transition=a}},customTransitionDuration:{set:function(a){this._internal.customTransitionDuration=a}}},outputs:{transitionPosition:{index:0,type:"number",displayName:"Transition Position",group:"Page",getter:function(){return this._internal.transitionPosition}},pageShowing:{type:"signal",displayName:"Page Showing",group:"Page Signals"},pageHiding:{type:"signal",displayName:"Page Hiding",group:"Page Signals"},pageShown:{type:"signal",displayName:"Page Shown",group:"Page Signals"},pageHidden:{type:"signal",displayName:"Page Hidden",group:"Page Signals"}},prototypeExtensions:{setPagesNode:function(a){this._internal.pagesNode=a},setTransitionPosition:function(a){var b=this._internal;"default"===b.transition&&d(this,a),b.transitionPosition=a,this.flagOutputDirty("transitionPosition")},getAnimationDuration:function(){switch(this._internal.transition){case"none":return 0;case"default":case"ios":return 350;case"custom":return this._internal.customTransitionDuration}return 0},getAnimationPosition:function(){return this._internal.transitionPosition},sendPageShowingSignal:function(){this.sendSignalOnOutput("pageShowing")},sendPageHidingSignal:function(){this.sendSignalOnOutput("pageHiding")},sendPageShownSignal:function(){this.sendSignalOnOutput("pageShown")},sendPageHiddenSignal:function(){this.sendSignalOnOutput("pageHidden")},getTitle:function(){return this._internal.title}}}),b.exports=f.defineNode(h)},{"../../easecurves":217,"../../nodedefinition":231,"./layoutbase":288}],290:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=a("../../nodedefinition"),f=a("../../guid"),g=a("../../easecurves"),h=a("lodash"),i=a("../../node"),j=d.createDefinition({name:"Pages",createControl:function(a){return a.createDockLayoutControl()}});e.extend(j,{initialize:function(){this._internal.pageStack=[],this._internal.isNavigating=!1,this._internal.portUpdateScheduled=!1},inputs:{startPage:{type:"component",displayName:"Start Page",group:"Navigation",set:function(a){if(this._cleanup(),a){var b=this._createPage(a);this.startPageComponent=b;var c=this._internal,d=this.context.getComponentModel(a);c.startPageComponentModel=d,this.updateStartPagePorts(d),d.on("inputPortAdded",this.scheduleUpdateStartPagePorts.bind(this,d),this),d.on("inputPortRemoved",this.scheduleUpdateStartPagePorts.bind(this,d),this),c.pageStack.push(b),this.addPageAtIndex(b,0),b.getVisualRoot().sendPageShowingSignal()}}},back:{displayName:"Back",group:"Navigation",valueChangedToTrue:function(){this.back()}}},outputs:{currentPageTitle:{type:"string",displayName:"Current Page Title",group:"Pages",getter:function(){var a=this._internal.pageStack;return a[a.length-1].getVisualRoot().getTitle()}},prevPageTitle:{type:"string",displayName:"Previous Page Title",group:"Pages",getter:function(){var a=this._internal.pageStack;return 1===a.length?"":a[a.length-2].getVisualRoot().getTitle()}},hasPreviousPage:{type:"boolean",displayName:"Has Previous Page",group:"Pages",getter:function(){return this._internal.pageStack.length>1}},navigatedForward:{type:"signal",displayName:"Navigated Forward",group:"Pages Signals"},navigatedBack:{type:"signal",displayName:"Navigated Back",group:"Pages Signals"}},prototypeExtensions:{_cleanup:function(){var a=this._internal;a.startPageComponentModel&&(a.startPageComponentModel.removeListenersWithRef(this),a.startPageComponentModel=void 0);var b=this;this.getChildren().forEach(function(a){b.removeChild(a),b.nodeScope.deleteNode(a)}),a.pageStack.forEach(function(a){a._onNodeDeleted()}),this.startPageComponent=void 0,a.pageStack=[]},_onNodeDeleted:function(){i.prototype._onNodeDeleted.call(this),this._cleanup()},addPageAtIndex:function(a,b){this.addChild(a,b),this.flagOutputDirty("currentPageTitle"),this.flagOutputDirty("prevPageTitle")},navigateTo:function(a,b){if(!this._internal.isNavigating){var c=this._internal,d=c.pageStack,e=d[d.length-1],f=this._createPage(a,b),g=f.getVisualRoot();d.push(f),this.addPageAtIndex(f),this.context.layout(),g.setTransitionPosition(1),f.update();var h=this;this.context.scheduleNextFrame(function(){h._animationPageAnimationPositionTo(f,0),h._animationPageAnimationPositionTo(e,-1)}),d.length>1&&this.flagOutputDirty("hasPreviousPage"),this.sendSignalOnOutput("navigatedForward")}},resetTo:function(a,b){var c=this._internal,d=c.pageStack,e=this._createPage(a,b),f=e.getVisualRoot(),g=this;d.forEach(function(a){g.isChild(a)&&g.removeChild(a),g.nodeScope.deleteNode(a)}),d.length=0,d.push(e),this.addPageAtIndex(e),this.context.layout(),f.setTransitionPosition(0),e.update(),f.sendPageShownSignal(),this.flagOutputDirty("hasPreviousPage")},back:function(){var a=this._internal.pageStack;if(1!==a.length&&!this._internal.isNavigating){var b=a.pop();1===a.length&&this.flagOutputDirty("hasPreviousPage");var c=a[a.length-1];c.getVisualRoot()._internal.visualParent||this.addPageAtIndex(c,this._internal.children.indexOf(b)-1),this._animationPageAnimationPositionTo(c,0),this._animationPageAnimationPositionTo(b,1),this.sendSignalOnOutput("navigatedBack")}},_animationPageAnimationPositionTo:function(a,b){var c=a.getVisualRoot(),d=c.getAnimationPosition();if(d!==b){0===b?c.sendPageShowingSignal():c.sendPageHidingSignal(),this._internal.isNavigating=!0;var e=this,f=this.context.timerScheduler.createTimer({duration:c.getAnimationDuration(),onRunning:function(a){c.setTransitionPosition(g.linear(d,b,a))},onFinish:function(){-1===b||1===b?(c.sendPageHiddenSignal(),e.isChild(a)&&e.removeChild(a),1===b&&e.context.scheduleNextFrame(function(){e.nodeScope.deleteNode(a)})):0===b&&c.sendPageShownSignal(),e._internal.isNavigating=!1}});f.start()}},_createPage:function(a,b){var c=this.nodeScope.createNode(a,f());c.getVisualRoot().setPagesNode(this);for(var d in b)c.queueInput(d,b[d]);return c},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:function(b){this.startPageComponent?this.startPageComponent.setInputValue(a,b):this.scheduleAfterInputsHaveUpdated(function(){this.startPageComponent.hasInput(a)&&this.startPageComponent.setInputValue(a,b)})}})},scheduleUpdateStartPagePorts:function(a){
if(!this._internal.portUpdateScheduled){this._internal.portUpdateScheduled=!0;var b=this;this.context.scheduleAfterUpdate(function(){b.updateStartPagePorts(a),b._internal.portUpdateScheduled=!1})}},updateStartPagePorts:function(a){var b=h.values(a.getInputPorts()).map(function(a){return{name:a.name,plug:"input",type:a.type,group:"Start Page Inputs"}});this.context.editorConnection.sendDynamicPorts(this.id,b)}}}),b.exports=e.defineNode(j)},{"../../easecurves":217,"../../guid":223,"../../node":229,"../../nodedefinition":231,"./layoutbase":288,lodash:128}],291:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f="#f1f2f4",g=d.createDefinition({defaultSizeEnum:"explicit",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100,defaultColor:f,createControl:function(a){var b=a.createRectangleControl();return b.setColor(f),b}});e.extend(g,{name:"Rectangle",inputs:{cornerRadius:{index:3004,type:"number",displayName:"Corner Radius",group:"Appearance","default":0,set:function(a){this._internal.uiControl.setCornerRadius(a)}},blur:{index:3005,type:"number",displayName:"Blur Length",group:"Appearance","default":0,set:function(a){this._internal.uiControl.setBlur(a)}}}}),b.exports=e.defineNode(g)},{"../../nodedefinition":231,"./renderable":292}],292:[function(a,b,c){"use strict";function d(a){if(!a.defaultColor)throw new Error("No default color specified");var b=e.createDefinition(a),c=[{value:"alpha",label:"Alpha"},{value:"solid",label:"Solid"},{value:"additive",label:"Additive"},{value:"multiply",label:"Multiply"}];return f.extend(b,{inputs:{blendMode:{index:3003,type:{name:"enum",enums:c},"default":"alpha",displayName:"Blend Mode",group:"Appearance",set:function(a){this._internal.uiControl.setBlendMode(a)}},color:{index:3002,type:"color",displayName:"Color",group:"Appearance","default":a.defaultColor,set:function(a){this._internal.uiControl.setColor(a)}}}}),b}var e=a("./visualbase"),f=a("../../nodedefinition");b.exports={createDefinition:d}},{"../../nodedefinition":231,"./visualbase":297}],293:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a){var b=this.noodlNode,c=b._internal;if(c.scrollEnabled===!1||c.uiControl.touchPropagation===!1)return c.isTracking&&(c.isTracking=!1,b.sendSignalOnOutput("dragEnded")),void(c.hasReceivedEnter=!1);var d,e=c.uiControl.scroller,f=c.uiControl.scrollOffset;if(a.isEnter&&(c.hasReceivedEnter=!0),a.isExit)c.isTracking===!0?(b.sendSignalOnOutput("dragEnded"),c.isTracking=!1,b.context.scheduleAfterUpdate(function(){e.onTouch(f,a)})):e.onTouch(f,a),c.hasReceivedEnter=!1;else{if(c.hasReceivedEnter===!1){c.hasReceivedEnter=!0;var g={};for(var h in a)g[h]=a[h];g.type="isEnter",g.isEnter=!0,g.isDown=g.isUp=g.isMove=!1,c.uiControl.onTouch(g)}d=e.onTouch(f,a),"StartTracking"===d&&c.isTracking===!1&&(c.isTracking=!0,b.sendSignalOnOutput("dragStarted"))}return d}function f(a){var b=this._internal.children;if(b.length<=1)return 0;for(var c="horizontal"===this._internal.uiControl.orientation?"width":"height",d=0,e=this._internal.uiControl.getItemSpacing(),f=0,g=b.length;g>f;++f){var h=b[f].getVisualRoot().getLayoutRect(),i=h[c];if(Math.floor(d+i)>a)return f;d+=i+e}return console.error("Invalid position",a),b.length-1}function g(a){var b=this._internal.children;if(0>a||a>=b.length)return console.error("ScrollView: Invalid item index",index),0;for(var c="horizontal"===this._internal.uiControl.orientation?"width":"height",d=this._internal.uiControl.getItemSpacing(),e=0,f=0;a>f;f++)e+=b[f].getVisualRoot().getLayoutRect()[c]+d;return e}function h(a){return a=d(0,this._internal.children.length-1,a),g.call(this,a)}function i(a){var b=this._internal;a!==b.currentIndex&&(b.currentIndex=a,this.flagOutputDirty("index"),this.sendSignalOnOutput("indexChanged"))}function j(a,b){var c=this;this.context.timerScheduler.createTimer({duration:b,startPosition:l.call(this),endPosition:-a,onRunning:function(a){c._internal.uiControl.setScrollOffset(q.easeOut(this.startPosition,this.endPosition,a))}}).start()}function k(a,b){return b}function l(){return this._internal.uiControl.scrollOffset}function m(a,b){var c=f.call(this,-l.call(this)),e=0;return e=0>a?c+1:c,e=d(0,this._internal.children.length-1,e),-h.call(this,e)}function n(a,b){var c="horizontal"===this._internal.uiControl.orientation?"width":"height",d=this._internal.children,e=this._internal.uiControl.getItemSpacing();if(1===d.length)return 0>a?-d[0].getVisualRoot().getLayoutRect()[c]:0;for(var f=0,g=0,h=Number.MAX_VALUE,i=0,j=0;j<d.length-1;++j){var k=d[j].getVisualRoot().getLayoutRect()[c],m=f+k+e,n=Math.abs(f+b),o=Math.abs(m+b);if(h>n&&(h=n,i=f),h>o&&(h=o,i=m),o>n){var p=l.call(this);return 0>a&&-f>p?-m:a>0&&p>-f?-g:-f}g=f,f+=k+e}return-f}var o=a("./layoutbase"),p=a("../../nodedefinition"),q=a("../../easecurves"),r=500,s=o.createDefinition({name:"Scroll View",createControl:function(a){return a.createScrollViewControl()},hasItemSpacing:!0});p.extend(s,{initialize:function(){var a=this._internal;a.scrollEnabled=!0,a.isTracking=!1,a.currentIndex=0,a.hasReceivedEnter=!1,a.scrollToPositionValue=0,a.scrollDuration=r,a.scrollToPositionDuration=r,a.scrollToIndexDuration=r,a.scrollToIndexValue=0,a.uiControl.scrollEndedPositionCallback=function(a,b){return b};var b=this;this._internal.uiControl.on("scrollOffsetChanged",function(a){b.flagOutputDirty("scrollPosition");var c=f.call(b,-a);if(c<b._internal.children.length){var d=b._internal.children[c].getVisualRoot().getLayoutRect(),e="horizontal"===b._internal.uiControl.orientation?"width":"height",g=-a+.5*d[e];i.call(b,f.call(b,g))}}),this.addTouchHandler(e,b)},inputs:{itemSpacing:{index:2400,group:"Layout",displayName:"Item Spacing",type:"number","default":0,set:function(a){this._internal.uiControl.setItemSpacing(Number(a))}},clip:{index:3100,type:"boolean",group:"Appearance",displayName:"Clip","default":!1,set:function(a){this._internal.uiControl.setClip(a?!0:!1)}},scrollDuration:{index:2500,type:"number",displayName:"Scroll Duration",group:"Scroll Behavior","default":r,set:function(a){this._internal.scrollDuration=a,this._internal.scroller&&(this._internal.scroller.scrollEndedAnimationDuration=a)}},snap:{index:2501,type:{name:"enum",enums:[{value:"disabled",label:"Disabled"},{value:"item",label:"Item"},{value:"everyItem",label:"Every Item"}]},displayName:"Snap",group:"Scroll Behavior","default":"disabled",set:function(a){"disabled"===a?this._internal.uiControl.scrollEndedPositionCallback=k.bind(this):"everyItem"===a?this._internal.uiControl.scrollEndedPositionCallback=m.bind(this):"item"===a?this._internal.uiControl.scrollEndedPositionCallback=n.bind(this):console.error("Unknown snap value: "+a)}},scrollAxis:{index:2502,type:{name:"enum",enums:[{value:"0",label:"Horizontal"},{value:"1",label:"Vertical"}]},displayName:"Scroll Direction",group:"Scroll Behavior","default":"1",set:function(a){this._internal.uiControl.setOrientation(Number(a)?"vertical":"horizontal")}},scrollStartPosition:{index:2503,type:"number",displayName:"Scroll Position",group:"Scroll Behavior","default":0,set:function(a){this._internal.uiControl.setScrollOffset(Number(a))}},scrollEnabled:{index:2504,type:"boolean",displayName:"Scroll Enabled",group:"Scroll Behavior","default":!0,set:function(a){this._internal.scrollEnabled=a?!0:!1}},overscrollEnabled:{index:2505,type:"boolean",displayName:"Overscroll Enabled",group:"Scroll Behavior","default":!0,set:function(a){var b=a?!0:!1;this._internal.uiControl.setOverscrollEnabled(b)}},"scrollToPosition.value":{index:6e3,type:"number",displayName:"Position",editorName:"Position|Scroll To Position",group:"Scroll To Position","default":0,set:function(a){this._internal.scrollToPositionValue=a}},"scrollToPosition.do":{index:6001,group:"Scroll To Position",editorName:"Do|Scroll To Position",displayName:"Do",valueChangedToTrue:function(){this.scheduleAfterInputsHaveUpdated(function(){j.call(this,this._internal.scrollToPositionValue,this._internal.scrollToPositionDuration)})}},"scrollToPosition.duration":{index:6002,group:"Scroll To Position",displayName:"Duration",editorName:"Duration|Scroll To Position",type:"number","default":r,set:function(a){this._internal.scrollToPositionDuration=a}},"scrollToIndex.value":{index:6003,group:"Scroll To Index",editorName:"Index|Scroll To Index",displayName:"Index",type:"number","default":0,set:function(a){this._internal.scrollToIndexValue=Math.floor(a)}},"scrollToIndex.do":{index:6004,group:"Scroll To Index",editorName:"Do|Scroll To Index",displayName:"Do",valueChangedToTrue:function(){var a=this;this.scheduleAfterInputsHaveUpdated(function(){if(a._internal.children.length>0){var b=h.call(this,this._internal.scrollToIndexValue);j.call(this,b,this._internal.scrollToIndexDuration)}})}},"scrollToIndex.duration":{index:6005,type:"number",group:"Scroll To Index",displayName:"Duration",editorName:"Duration|Scroll To Index","default":r,set:function(a){this._internal.scrollToIndexDuration=a}}},outputs:{dragStarted:{type:"signal",displayName:"Drag Started",group:"Signals"},dragEnded:{type:"signal",displayName:"Drag Ended",group:"Signals"},indexChanged:{displayName:"Index Changed",group:"Signals",type:"signal"},scrollPosition:{displayName:"Scroll Position",type:"number",getter:function(){return this._internal.uiControl.scrollOffset}},index:{displayName:"Scroll Index",type:"number",getter:function(){return this._internal.currentIndex}},childCount:{displayName:"Child Count",type:"number",getter:function(){return this._internal.children.length}}}}),b.exports=p.defineNode(s)},{"../../easecurves":217,"../../nodedefinition":231,"./layoutbase":288}],294:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=a("../../nodedefinition"),f=d.createDefinition({name:"Stack Layout",hasOrientation:!0,hasItemSpacing:!0,createControl:function(a){return a.createStackLayoutControl()}});e.extend(f,{inputs:{itemSpacing:{index:2501,group:"Layout",displayName:"Item Spacing",type:"number","default":0,set:function(a){this._internal.uiControl.setItemSpacing(Number(a))}}}}),b.exports=e.defineNode(f)},{"../../nodedefinition":231,"./layoutbase":288}],295:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f=a("../../fontloader"),g="Text",h=d.createDefinition({createControl:function(a){var b=a.createTextControl();return b.setColor("#ffffff"),b.setFontFamily("Helvetica"),b.setFontSize(40),b.setText(g),b},defaultColor:"#ffffff",sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"childSize",widthCondition:"sizeMode = explicit OR sizeMode = childHeight",heightCondition:"sizeMode = explicit OR sizeMode = childWidth",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100});e.extend(h,{name:"Text",version:2,usePortAsLabel:"text",inputs:{text:{index:2500,group:"Text",displayName:"Text",type:{name:"string",multiline:!0},"default":g,set:function(a){this._internal.uiControl.setText(a)}},fontFamily:{index:2501,type:"font",group:"Text",displayName:"Font Family","default":"Helvetica",set:function(a){var b=a.replace(/\.[^\/.]+$/,"");b=b.split("/").pop();var c=this._internal;f.instance.callWhenFontIsActive(b,function(){c.uiControl.setFontFamily(b)})}},fontSize:{index:2502,type:"number",group:"Text",displayName:"Font Size","default":40,set:function(a){this._internal.uiControl.setFontSize(a)}},lineHeight:{index:2503,type:"number",displayName:"Line Height",group:"Text","default":0,set:function(a){this._internal.uiControl.setLineHeight(a)}},alignment:{index:2504,type:{name:"enum",enums:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}],allowEditOnly:!0},displayName:"Horizontal",group:"Text Alignment","default":"left",set:function(a){this._internal.uiControl.setHorizontalAlignment(a)}},verticalAlignment:{index:2505,type:{name:"enum",enums:[{value:"top",label:"Top"},{value:"center",label:"Center"},{value:"bottom",label:"Bottom"}],allowEditOnly:!0},displayName:"Vertical",group:"Text Alignment","default":"top",set:function(a){this._internal.uiControl.setVerticalAlignment(a)}},clipText:{index:2999,type:"boolean",displayName:"Clip Text","default":!0,group:"Appearance",set:function(a){this._internal.uiControl.setClip(a?!0:!1)}}}}),b.exports={node:h,setup:function(a,b){b.on("nodeAdded.Text",function(a){a.parameters.fontFamily&&f.instance.loadFont(a.parameters.fontFamily),a.on("parameterUpdated",function(a){"fontFamily"===a.name&&f.instance.loadFont(a.value)})})}}},{"../../fontloader":222,"../../nodedefinition":231,"./renderable":292}],296:[function(a,b,c){"use strict";function d(a){var b=this.noodlNode;return a.isUp?(b._internal.uiControl.focus(),"StopPropagation"):void 0}var e=a("./renderable"),f=a("../../nodedefinition"),g=a("../../fontloader"),h="Text",i=e.createDefinition({controlAttribute:"innerTextControl",createControl:function(a){var b=a.createTextInputControl();return b.setColor("#ffffff"),b.setFontFamily("Helvetica"),b.setFontSize(40),b.setText(h),b},defaultColor:"#ffffff",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100});f.extend(i,{name:"Text Input",initialize:function(){this.addTouchHandler(d);var a=this;this._internal.uiControl.on("textChanged",function(){a.flagOutputDirty("text")},this),this._internal.uiControl.on("focused",function(){a.flagOutputDirty("focused"),a.flagOutputDirty("blurred")},this),this._internal.uiControl.on("blurred",function(){a.flagOutputDirty("focused"),a.flagOutputDirty("blurred")},this)},inputs:{text:{index:2500,group:"Text",displayName:"Text",type:{name:"string",multiline:!0},"default":h,set:function(a){this._internal.uiControl.getText()!==a&&this._internal.uiControl.setText(a)}},fontFamily:{index:2501,type:"font",group:"Text",displayName:"Font Family","default":"Helvetica",set:function(a){var b=a.replace(/\.[^\/.]+$/,"");b=b.split("/").pop();var c=this._internal;g.instance.callWhenFontIsActive(b,function(){c.uiControl.setFontFamily(b)})}},fontSize:{index:2502,type:"number",group:"Text",displayName:"Font Size","default":40,set:function(a){this._internal.uiControl.setFontSize(a)}},clear:{index:2600,group:"Actions",displayName:"Clear",valueChangedToTrue:function(){this._internal.uiControl.setText("")}},type:{index:3001,group:"Appearance",displayName:"Type","default":"text",type:{name:"enum",enums:[{value:"text",label:"Text"},{value:"textarea",label:"Text Area"},{value:"password",label:"Password"},{value:"email",label:"Email"},{value:"tel",label:"Tel"},{value:"number",label:"Number"}]},set:function(a){this._internal.uiControl.setInputType(a)}},color:{index:3002,type:"color",displayName:"Color",group:"Appearance","default":"#ffffff",set:function(a){this._internal.uiControl.setColor(a)}}},outputs:{text:{index:2500,group:"Text",displayName:"Text",type:"string",getter:function(){return this._internal.uiControl.getText()}},focused:{index:2501,group:"State",displayName:"Focused",type:"boolean",getter:function(){return this._internal.uiControl.isFocused()}},blurred:{index:2502,group:"State",displayName:"Blurred",type:"boolean",getter:function(){return!this._internal.uiControl.isFocused()}}},prototypeExtensions:{setText:function(a){this._internal.uiControl.setText(a)}}}),b.exports={node:i,setup:function(a,b){b.on("nodeAdded.Text Input",function(a){a.parameters.fontFamily&&g.instance.loadFont(a.parameters.fontFamily),a.on("parameterUpdated",function(a,b){"fontFamily"===a&&g.instance.loadFont(b)})})}}},{"../../fontloader":222,"../../nodedefinition":231,"./renderable":292}],297:[function(a,b,c){"use strict";function d(a){if(a=a||{},!a.createControl)throw new Error("createControl can't be undefined");a.sizeEnums=a.sizeEnums||[],a.defaultSizeEnum=a.defaultSizeEnum||"",a.defaultSizeUnit=a.defaultSizeUnit||"px",a.defaultPivotUnit=a.defaultPivotUnit||"%",a.defaultWidth=a.hasOwnProperty("defaultWidth")?a.defaultWidth:0,a.defaultHeight=a.hasOwnProperty("defaultHeight")?a.defaultHeight:0,a.widthCondition=a.widthCondition||"sizeMode = explicit OR sizeMode = childHeight OR sizeMode NOT SET",a.heightCondition=a.heightCondition||"sizeMode = explicit OR sizeMode = childWidth OR sizeMode NOT SET";var b={category:"Visual",initialize:function(){var b=this._internal,c=a.createControl.call(this,this.context.uiEngine);c.onTouch=g,c.onHover=h,c.noodlNode=this,b.uiControl=c,b.touchHandlers=[],b.hoverHandlers=[],b.visualParent=void 0,c.setSizeMode(a.defaultSizeEnum),c.setWidth(a.defaultWidth),c.setHeight(a.defaultHeight),c.setWidthUnit(a.defaultSizeUnit),c.setHeightUnit(a.defaultSizeUnit),c.setPivotXUnit(a.defaultPivotUnit),c.setPivotYUnit(a.defaultPivotUnit),this._internal.tapHandler=this.context.uiEngine.createTapHandler(e),this.addTouchHandler(j,this),this.addHoverHandler(k,this);var d=this;c.on("screenXChanged",function(){d.flagOutputDirty("screenX")}),c.on("screenYChanged",function(){d.flagOutputDirty("screenY")}),c.on("layoutWidthChanged",function(){d.flagOutputDirty("width")}),c.on("layoutHeightChanged",function(){d.flagOutputDirty("height")})},inputs:{x:{type:{name:"number"},group:"Placement",index:2002,displayName:"Position X","default":0,set:function(a){this.setPositionX(a)}},y:{type:{name:"number"},index:2003,group:"Placement",displayName:"Position Y","default":0,set:function(a){this.setPositionY(a)}},z:{type:{name:"number"},index:2004,group:"Placement",displayName:"Position Z","default":0,set:function(a){this._internal.uiControl.setPositionZ(a)}},alignX:{index:2e3,type:{name:"enum",enums:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},group:"Placement",displayName:"Align X","default":"left",set:function(a){this._internal.uiControl.setAlignX(a)}},alignY:{index:2001,type:{name:"enum",enums:[{value:"top",label:"Top"},{value:"center",label:"Center"},{value:"bottom",label:"Bottom"}]},group:"Placement",displayName:"Align Y","default":"top",set:function(a){this._internal.uiControl.setAlignY(a)}},width:{index:1001,type:{name:"number",units:["%","px"],defaultUnit:a.defaultSizeUnit},displayName:"Width",group:"Dimensions","default":a.defaultWidth,set:function(a,b){void 0!==a&&this._internal.uiControl.setWidth(a),b&&this._internal.uiControl.setWidthUnit(b)}},height:{index:1002,type:{name:"number",units:["%","px"],defaultUnit:a.defaultSizeUnit},displayName:"Height",group:"Dimensions","default":a.defaultHeight,set:function(a,b){void 0!==a&&this._internal.uiControl.setHeight(a),b&&this._internal.uiControl.setHeightUnit(b)}},opacity:{index:3e3,group:"Appearance",displayName:"Opacity",type:"number","default":1,set:function(a){this._internal.uiControl.setOpacity(a)}},visible:{type:{name:"boolean"},index:3001,displayName:"Visible",group:"Appearance","default":!0,set:function(a){this._internal.uiControl.setVisible(a?!0:!1)}},scaleX:{index:5e3,type:"number",group:"Transform",displayName:"Scale X","default":1,set:function(a){this._internal.uiControl.setScaleX(a)}},scaleY:{index:5001,type:"number",group:"Transform",displayName:"Scale Y","default":1,set:function(a){this._internal.uiControl.setScaleY(a)}},rotationX:{index:5002,type:"number",group:"Transform",displayName:"Rotation X","default":0,set:function(a){this._internal.uiControl.setRotationX(Math.PI/180*a)}},rotationY:{index:5003,type:"number",group:"Transform",displayName:"Rotation Y","default":0,set:function(a){this._internal.uiControl.setRotationY(Math.PI/180*a)}},rotationZ:{index:5004,type:"number",group:"Transform",displayName:"Rotation Z","default":0,set:function(a){this._internal.uiControl.setRotationZ(Math.PI/180*a)}},pivotX:{index:5005,type:{name:"number",units:["%","px"],defaultUnit:a.defaultPivotUnit},"default":50,group:"Transform",displayName:"Pivot X",set:function(a,b){b&&this._internal.uiControl.setPivotXUnit(b),this._internal.uiControl.setPivotX(a)}},pivotY:{index:5006,type:{name:"number",units:["%","px"],defaultUnit:a.defaultPivotUnit},"default":50,group:"Transform",displayName:"Pivot Y",set:function(a,b){b&&this._internal.uiControl.setPivotYUnit(b),this._internal.uiControl.setPivotY(a)}},pivotZ:{index:5007,type:"number",group:"Transform",displayName:"Pivot Z","default":0,set:function(a){this._internal.uiControl.setPivotZ(a)}},touchPropagation:{index:4e3,type:{name:"boolean"},displayName:"Ignore Touch","default":!1,set:function(a){this._internal.uiControl.setTouchPropagation(a?!1:!0)}},blockTouch:{index:4001,type:{name:"boolean"},displayName:"Block Touch","default":!1,set:function(a){this._internal.uiControl.setBlockTouch(a?!0:!1)}},depth:{index:4002,type:{name:"number"},displayName:"Depth",set:function(a){a===!0?a=1:a===!1&&(a=0),this._internal.uiControl.setDepth(a)}}},outputs:{"this":{type:"reference",displayName:"This",getter:function(){return this}},childIndex:{type:"number",displayName:"Child Index",getter:function(){var a=this._internal.uiControl.parent;return a?a.children.indexOf(this._internal.uiControl):-1}},width:{displayName:"Width",group:"Dimensions",type:"number",getter:function(){return this._internal.uiControl.layoutRect.width}},height:{displayName:"Height",group:"Dimensions",type:"number",getter:function(){return this._internal.uiControl.layoutRect.height}},x:{displayName:"Position X",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.positionX}},y:{displayName:"Position Y",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.positionY}},screenX:{displayName:"Screen Position X",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.getScreenX()}},screenY:{displayName:"Screen Position Y",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.getScreenY()}}},prototypeExtensions:{addTouchHandler:function(a,b){this._internal.touchHandlers.push({callback:a,id:b})},removeTouchHandlersWithId:function(a){n.remove(this._internal.touchHandlers,function(b){return b.id===a})},addHoverHandler:function(a,b){this._internal.hoverHandlers.push({callback:a,id:b})},removeHoverHandler:function(a){n.remove(this._internal.hoverHandlers,function(b){return b.id===a})},getVisualRoot:function(){return this},_onNodeDeleted:function(){m.prototype._onNodeDeleted.call(this),this._internal.uiControl.dispose()},setPositionX:function(a){this._internal.uiControl.setPositionX(a),this.flagOutputDirty("x")},setPositionY:function(a){this._internal.uiControl.setPositionY(a),this.flagOutputDirty("y")},getLayoutRect:function(){return this._internal.uiControl.layoutRect},setHighlightEnabled:function(a){this._internal.uiControl.setHighlightEnabled(a)}}};return a.sizeEnums.length>0&&f(b,a),i(b),b}function e(a){var b=a.noodlNode;b.sendSignalOnOutput("touch.tap")}function f(a,b){var c={index:1001,name:"width",plug:"input",type:{name:"number",units:["%","px"],defaultUnit:b.defaultSizeUnit},displayName:"Width",group:"Dimensions","default":b.defaultWidth},d={index:1002,name:"height",plug:"input",type:{name:"number",units:["%","px"],defaultUnit:b.defaultSizeUnit},displayName:"Height",group:"Dimensions","default":b.defaultHeight},e={name:"conditionalports/basic",condition:b.widthCondition,ports:[c]},f={name:"conditionalports/basic",condition:b.heightCondition,ports:[d]},g=[e,f];l(a,{dynamicports:g,inputs:{sizeMode:{index:1e3,type:{name:"enum",enums:b.sizeEnums,allowEditOnly:!0},group:"Dimensions",displayName:"Size Mode","default":b.defaultSizeEnum,set:function(a){this._internal.uiControl.setSizeMode(a)}}}})}function g(a){var b=void 0,c=this.noodlNode,d=this;return c._internal.touchHandlers.forEach(function(c){var e=c.callback.call(d,a);void 0!==e&&("StartTracking"===e?b=e:"StopPropagation"===e&&"StartTracking"!==b&&(b=e))}),c.context.scheduleFrame(),b}function h(a){var b=void 0,c=this.noodlNode,d=this;return c._internal.hoverHandlers.forEach(function(c){var e=c.callback.call(d,a);void 0!==e&&"StopPropagation"===e&&(b=e)}),c.context.scheduleFrame(),b}function i(a){l(a,{initialize:function(){this._internal.hasSignaledMove=!1,this.context.nodeIsDirty(this)},outputs:{"touch.tap":{group:"Touch",displayName:"Tap",type:"signal"},"touch.press":{type:"signal",group:"Touch",displayName:"Press"},"touch.release":{type:"signal",group:"Touch",displayName:"Release"},"touch.enter":{type:"signal",group:"Touch",displayName:"Enter"},"touch.exit":{type:"signal",group:"Touch",displayName:"Exit"},"touch.move":{type:"signal",group:"Touch",displayName:"Move"},"hover.enter":{type:"signal",group:"Hover",displayName:"Hover Enter"},"hover.move":{type:"signal",group:"Hover",displayName:"Hover Move"},"hover.exit":{type:"signal",group:"Hover",displayName:"Hover Exit"}}})}function j(a){var b=this.noodlNode;return a.isDown&&(b.sendSignalOnOutput("touch.press"),b._internal.hasSignaledMove=!1),a.isMove?b._internal.hasSignaledMove===!1&&(b._internal.hasSignaledMove=!0,b.sendSignalOnOutput("touch.move")):a.isUp?b.sendSignalOnOutput("touch.release"):a.isEnter?b.sendSignalOnOutput("touch.enter"):a.isExit&&b.sendSignalOnOutput("touch.exit"),b.getOutput("touch.tap").hasConnections()?b._internal.tapHandler.onTouch(this,a):void 0}function k(a){var b=this.noodlNode;a.isHoverEnter&&b.sendSignalOnOutput("hover.enter"),a.isHoverMove?b.sendSignalOnOutput("hover.move"):a.isHoverExit&&b.sendSignalOnOutput("hover.exit")}var l=a("../../nodedefinition").extend,m=a("../../node"),n=a("lodash");b.exports={createDefinition:d}},{"../../node":229,"../../nodedefinition":231,lodash:128}],298:[function(a,b,c){"use strict";function d(a){function b(){console.log("websocket disconnected",a),delete i[a]}if(!i[a]){var c=new WebSocket(a);c.addEventListener("open",function(){console.log("websocket connected",a)}),c.addEventListener("close",b),c.addEventListener("error",b),i[a]=c}return i[a]}function e(a){function b(){e._close(),window.setTimeout(e.connect.bind(e,e.uri),1e3)}function c(){e.eventEmitter.emit("connected"),e.context.eventEmitter.once("applicationDataReloaded",function(){e._close(),e.eventEmitter.removeAllListeners()}),e.socket.addEventListener("message",e._onMessage)}function d(a){var b=JSON.parse(a.data);e.eventEmitter.emit("jsonMessage",b),e.context.update()}this.eventEmitter=new h,this.eventEmitter.setMaxListeners(1e3),this.context=a;var e=this;this._reconnect=b,this._onConnectionOpen=c,this._onMessage=d}function f(a,b){if(a){var c={};for(var d in b)isNaN(Number(b[d]))?c[d]=b[d]:c[d]=Number(b[d]);a.send(JSON.stringify(c))}}var g=a("../nodedefinition"),h=a("events").EventEmitter,i={};e.prototype._close=function(){this.socket&&(this.eventEmitter.emit("disconnected"),this.socket.removeEventListener("close",this.reconnect),this.socket.removeEventListener("error",this.reconnect),this.socket.removeEventListener("open",this._onConnectionOpen),this.socket.removeEventListener("message",this._onMessage),this.socket=void 0)},e.prototype.connect=function(a){this._close(),this.uri=a,this.socket=d(a),this.socket.addEventListener("close",this._reconnect),this.socket.addEventListener("error",this._reconnect),this.socket.readyState===WebSocket.OPEN?this._onConnectionOpen():this.socket.addEventListener("open",this._onConnectionOpen)},e.prototype.addEventListener=function(a,b){this.eventEmitter.on(a,b)},e.prototype.send=function(a){this.socket&&this.socket.readyState===WebSocket.OPEN&&this.socket.send(a)},b.exports=g.defineNode({name:"Websocket",category:"Communication",initialize:function(){var a=this._internal;a.socket=new e(this.context),a.socket.addEventListener("connected",this.onConnected.bind(this)),a.socket.addEventListener("disconnected",this.onDisconnected.bind(this)),a.socket.addEventListener("jsonMessage",this.onMessageReceived.bind(this)),a.address=void 0,a.connected=!1,a.inputValues={},a.outputValues={},a.outputNames=[]},panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Outputs",plug:"output",type:{name:"*",group:"Output data"}},{name:"PortEditor",context:["select","connectTo"],title:"Data To Send",plug:"input",group:"Data To Send",type:{name:"string"}}],inputs:{address:{group:"Settings",displayName:"Ip Address:Port",type:{name:"string"},set:function(a){if(!(void 0===a||a.length<=0)){this._internal.address=a;var b="ws://"+a+"/";this._internal.socket.connect(b)}}},sendData:{group:"Send Data",displayName:"Send Data",valueChangedToTrue:function(){var a=this;this.scheduleAfterInputsHaveUpdated(function(){a._internal.inputValues._nodeId=a.id,f(a._internal.socket,a._internal.inputValues)})}}},outputs:{newDataReceived:{displayName:"New Data Received",type:"signal"},connected:{displayName:"Connected",type:"boolean",getter:function(){return this._internal.connected}}},prototypeExtensions:{registerOutputIfNeeded:function(a){if(!this.hasOutput(a)){this._internal.outputValues[a]=void 0;var b=this;this.registerOutput(a,{getter:function(){return b._internal.outputValues[a]}})}},registerInputIfNeeded:function(a){if(!this.hasInput(a)){var b=this;this.registerInput(a,{set:function(c){b._internal.inputValues[a]=c}})}},onMessageReceived:function(a){if(!a._nodeIds||-1!==a._nodeIds.indexOf(this.id)){var b=!1;for(var c in a)this.hasOutput(c)&&(this._internal.outputValues[c]=a[c],this.flagOutputDirty(c),b=!0);b&&this.sendSignalOnOutput("newDataReceived")}},onConnected:function(){this._internal.connected!==!0&&(this._internal.connected=!0,this.flagOutputDirty("connected"))},onDisconnected:function(){this._internal.connected!==!1&&(this._internal.connected=!1,this.flagOutputDirty("connected"))}}})},{"../nodedefinition":231,events:17}],299:[function(a,b,c){"use strict";function d(a,b){this.context=a,this.nodes={},this.componentOwner=b,this.noodlJavascriptAPI=f(this),this.componentInstanceChildren={}}function e(a,b){b.forEach(function(b){if(!a[b])throw new Error("Missing "+b)})}var f=a("./noodl-js-api"),g=a("lodash");d.prototype.addConnection=function(a){try{e(a,["sourceId","sourcePort","targetId","targetPort"])}catch(b){throw new Error("Error in connection: "+b.message)}try{var c=this.getNodeWithId(a.sourceId),d=this.getNodeWithId(a.targetId);d.registerInputIfNeeded(a.targetPort),c.registerOutputIfNeeded(a.sourcePort),d.connectInput(a.targetPort,c,a.sourcePort)}catch(b){console.error(b.message)}},d.prototype.setNodeParameters=function(a,b){var c=Object.keys(b);if(this.context.nodeRegister.hasNode(a.name)){var d=this.context.nodeRegister.getNodeMetadata(a.name);c.sort(function(a,b){var c=d.inputs[a],e=d.inputs[b];return(c?c.inputPriority:0)-(e?e.inputPriority:0)})}c.forEach(function(c){function d(){var d=b[c];"object"==typeof d?a.setInputValue(c,d.value,d.unit):a.setInputValue(c,d)}a.registerInputIfNeeded(c),a.hasInput(c)!==!1&&("undefined"!=typeof window&&window.chrome&&navigator&&"Win32"===navigator.platform&&"text"===c?a._internal.setTextHaxTimeout=window.setTimeout(d,200):d())})},d.prototype.createNodeFromModel=function(a){if("Component Children"!==a.type){var b;try{b=this.createNode(a.type,a.id),b.setNodeModel(a)}catch(c){return void console.error(c.message,c.stack)}this.setNodeParameters(b,a.parameters),a.parent&&this.insertNodeInTree(b,a)}else if(a.parent){var d=this.getNodeWithId(a.parent.id);this.componentOwner.setChildRoot(d)}},d.prototype.insertNodeInTree=function(a,b){var c=this.getNodeWithId(b.parent.id),d=b.parent.children.indexOf(b);if(!c.addChild)throw new Error("Node "+c.id+" of type "+c.constructor.name+" can't have children");a.getVisualRoot&&c.addChild(a,d)},d.prototype.getNodeWithId=function(a){if(this.nodes.hasOwnProperty(a)===!1)throw new Error("Unknown node id "+a);return this.nodes[a]},d.prototype.hasNodeWithId=function(a){return this.nodes.hasOwnProperty(a)},d.prototype.createNode=function(a,b){if(this.nodes.hasOwnProperty(b))throw Error("duplicate id "+b);var c;return this.context.hasComponentModelWithName(a)?(c=this.context.createComponentInstanceNode(a),c.parentNodeScope=this,this.componentInstanceChildren[b]=c):(c=this.context.nodeRegister.createNode(a),c.nodeScope=this),this.nodes[b]=c,c.id=b,c},d.prototype.getNodesWithIdRecursive=function(b){function c(a,b,e){a.nodes.hasOwnProperty(b)&&e.push(a.nodes[b]);var f=Object.keys(a.nodes).filter(function(b){return a.nodes[b]instanceof d});f.forEach(function(d){
c(a.nodes[d].nodeScope,b,e)})}var d=a("./nodes/componentinstance"),e=[];return c(this,b,e),e},d.prototype.getNodesWithType=function(a){var b=this,c=Object.keys(this.nodes).filter(function(c){return b.nodes[c].name===a});return c.map(function(a){return b.nodes[a]})},d.prototype.getNodesWithTypeRecursive=function(b){function c(){f=f.concat(e.getNodesWithType(b));var a=Object.keys(e.nodes).filter(function(a){return e.nodes[a]instanceof d});a.forEach(function(a){var c=e.nodes[a].nodeScope.getNodesWithTypeRecursive(b);f=f.concat(c)})}var d=a("./nodes/componentinstance"),e=this,f=[];return c(f),f},d.prototype.onNodeModelRemoved=function(a){var b=this.getNodeWithId(a.id);if(a.parent){var c=this.getNodeWithId(a.parent.id);c.removeChild(b)}b._onNodeDeleted(),delete this.nodes[b.id],delete this.componentInstanceChildren[b.id]},d.prototype.removeConnection=function(a){var b=this.getNodeWithId(a.targetId);b.removeInputConnection(a.targetPort,a.sourceId,a.sourcePort)},d.prototype.removeNodeFromParent=function(a){if(a.getVisualRoot&&a.getVisualRoot()){var b=a.getVisualRoot()._internal.visualParent;b&&b.removeChild(a)}},d.prototype.setComponentModel=function(a){this.componentModel=a;var b=a.getAllNodes();b.forEach(this.createNodeFromModel.bind(this)),a.getAllConnections().forEach(this.addConnection.bind(this)),a.on("connectionAdded",this.addConnection,this),a.on("connectionRemoved",this.removeConnection,this),a.on("nodeAdded",this.createNodeFromModel,this);var c=this;a.on("nodeParentWillBeRemoved",function(a){if("Component Children"!==a.type){var b=c.getNodeWithId(a.id);c.removeNodeFromParent(b)}else if(a.parent){this.getNodeWithId(a.parent.id);this.componentOwner.setChildRoot(null)}},this),a.on("nodeParentUpdated",function(a){if("Component Children"===a.type){var b=this.getNodeWithId(a.parent.id);this.componentOwner.setChildRoot(b)}else{var d=c.getNodeWithId(a.id);c.insertNodeInTree(d,a)}},this),a.on("nodeRemoved",function(a){"Component Children"!==a.type&&c.onNodeModelRemoved(a)},this)},d.prototype.reset=function(){if(this.componentModel){this.componentModel.removeListenersWithRef(this);var a=this;Object.keys(this.nodes).forEach(function(b){a.nodes.hasOwnProperty(b)&&a.deleteNode(a.nodes[b])}),this.componentModel=void 0,this.noodlJavascriptAPI.eventEmitter.removeAllListeners()}},d.prototype.deleteNode=function(a){if(this.nodes.hasOwnProperty(a.id)===!1)return void console.error("Node doesn't belong to this scope",this,a);var b=this;this.removeNodeFromParent(a),a.getChildren&&(a.getChildren().forEach(a.removeChild.bind(a)),a.getChildren().forEach(function(a){b.deleteNode(a)}));var c=this.componentModel.getConnectionsFrom(a.id),d=this.componentModel.getConnectionsTo(a.id);c.concat(d).forEach(function(a){b.nodes.hasOwnProperty(a.targetId)&&b.nodes.hasOwnProperty(a.sourceId)&&b.removeConnection(a)}),a._onNodeDeleted(),delete this.nodes[a.id],delete this.componentInstanceChildren[a.id]},d.prototype.sendEventFromThisScope=function(a,b,c,d){if(d){var e=this.getNodesWithType("Event Receiver").filter(function(b){return b.getChannelName()===a});e.forEach(function(a){a.handleEvent(b)})}"parent"===c&&this.componentOwner.parentNodeScope?this.componentOwner.parentNodeScope.sendEventFromThisScope(a,b,c,!0):"children"===c&&g.forIn(this.componentInstanceChildren,function(d){d.nodeScope.sendEventFromThisScope(a,b,c,!0)})},b.exports=d},{"./nodes/componentinstance":238,"./noodl-js-api":300,lodash:128}],300:[function(a,b,c){"use strict";function d(a){function b(b){return b&&b.length>0&&"/"!==b[0]&&(b="/"+b),a.createNode(b,e())}function c(b){a.deleteNode(b)}function d(a,b){j.scheduleAfterUpdate(function(){j.setGlobalValue(a,b)})}function i(a,b){if(k[a]){var c=k[a].indexOf(b);-1!==c&&k[a].splice(c,1)}}var j=a.context,k={},l={on:function(a,b){var c=j.eventSenderEmitter;c.on(a,b),k[a]=k[a]||[],k[a].push(b),j.eventEmitter.once("applicationDataReloaded",function(){c.removeListener(a,b),i(a,b)})},once:function(a,b){j.eventSenderEmitter.once(a,b)},off:function(a,b){j.eventSenderEmitter.removeListener(a,b),i(a,b)},emit:function(a,b){j.eventSenderEmitter.emit(a,b)},removeAllListeners:function(){Object.keys(k).forEach(function(a){for(var b=k[a],c=b.length-1;c>=0;c--){var d=b[c];j.eventSenderEmitter.removeListener(a,d),i(a,d)}})}};return{createComponent:b,deleteComponent:c,setGlobalValue:d,eventEmitter:l,Collection:f,Model:g,Item:g,AnimationCurve:h}}var e=a("./guid"),f=a("./nodes/data/collection"),g=a("./nodes/data/model"),h=a("./easecurves");b.exports=d},{"./easecurves":217,"./guid":223,"./nodes/data/collection":241,"./nodes/data/model":245}],301:[function(a,b,c){"use strict";function d(a){if(!a.owner)throw new Error("Owner must be set");this.getter=a.getter,this.connections=[],this.owner=a.owner,this.name=a.name,this._id=void 0}Object.defineProperties(d.prototype,{value:{get:function(){return this.getter.call(this.owner)}},id:{get:function(){return this._id||(this._id=this.owner.id+this.name),this._id}},registerConnection:{value:function(a,b){this.connections.push({node:a,inputPortName:b})}},deregisterConnection:{value:function(a,b){for(var c=0;c<this.connections.length;c++){var d=this.connections[c];if(d.node===a&&d.inputPortName===b){this.connections.splice(c,1);break}}}},flagDependeesDirty:{value:function(a){for(var b=0,c=this.connections.length;c>b;b++)this.connections[b].node.flagDirty()}},sendValue:{value:function(a){for(var b=0,c=this.connections.length;c>b;b++){var d=this.connections[b];d.node.queueInput(d.inputPortName,a)}}},hasConnections:{value:function(){return this.connections.length>0}}}),b.exports=d},{}],302:[function(a,b,c){"use strict";function d(a,b,c){if(!c[a]){if(!g[a])throw new Error("Unknown patch key "+a);var d={nodePatches:[],dismissPatches:[]};for(var e in g[a])d[e]=g[a][e];c[a]=d}c[a].nodePatches.push(b)}function e(a,b){var c=[],e=[h,i,j,k,l];e.forEach(function(b){b.condition(a)&&c.push(b.generatePatch(a))}),c.forEach(function(a){d(a.key,a.patch,b)})}function f(a,b){e(a,b),a.children&&a.children.forEach(function(a){f(a,b)})}var g={LayoutNotSupported:{message:"Group with layout is no longer supported. These have been replaced with the new nodes Stack Layout and Flow Layout",notifyUser:!0,askPermission:!1,key:"LayoutNotSupported"},ImageDefaultUnitChanged:{notifyUser:!1,askPermission:!1,key:"ImageDefaultUnitChanged",message:""},TextMaxLineWidthReplaced:{notifyUser:!0,askPermission:!1,key:"TextMaxLineWidthReplaced",message:"Text max line width is no longer supported. Replaced with size mode content height and explicit width set in pixels"},RemoveValue:{notifyUser:!1,askPermission:!1,key:"RemoveValue",message:""}},h={condition:function(a){return void 0===a.version&&"Group"===a.type&&"none"===a.parameters.layout},generatePatch:function(a){return{key:"RemoveValue",version:2,patch:{nodeId:a.id,params:{layout:null}}}}},i={condition:function(a){return void 0===a.version&&"Group"===a.type&&a.parameters.hasOwnProperty("layout")&&"none"!==a.parameters.layout},generatePatch:function(a){var b,c;if("stackHorizontal"===a.parameters.layout)b="Stack Layout",c="horizontal";else if("stackVertical"===a.parameters.layout)b="Stack Layout",c="vertical";else if("flowHorizontal"===a.parameters.layout)b="Flow Layout",c="horizontal";else{if("flowVertical"!==a.parameters.layout)return void console.error("Can't convert layout",a);b="Flow Layout",c="vertical"}return{key:"LayoutNotSupported",patch:{nodeId:a.id,version:2,typename:b,params:{layout:null,orientation:c}}}}},j={condition:function(a){return void 0!==a.version||"Image"!==a.type?!1:"explicit"!==a.parameters.sizeMode&&"childHeight"!==a.parameters.sizeMode?!1:a.parameters.hasOwnProperty("width")&&"object"==typeof a.parameters.width?!1:!0},generatePatch:function(a){var b=0;return a.parameters.width&&(b=a.parameters.width.value?a.parameters.width.value:a.parameters.width),{key:"ImageDefaultUnitChanged",patch:{nodeId:a.id,version:2,params:{width:{value:b,unit:"px"}}}}}},k={condition:function(a){return void 0!==a.version||"Image"!==a.type?!1:"explicit"!==a.parameters.sizeMode&&"childWidth"!==a.parameters.sizeMode?!1:a.parameters.hasOwnProperty("height")&&"object"==typeof a.parameters.height?!1:!0},generatePatch:function(a){var b=0;return a.parameters.height&&(b=a.parameters.height.value?a.parameters.height.value:a.parameters.height),{key:"ImageDefaultUnitChanged",patch:{nodeId:a.id,version:2,params:{height:{value:b,unit:"px"}}}}}},l={condition:function(a){return void 0===a.version&&"Text"===a.type&&a.parameters.hasOwnProperty("maxWidth")},generatePatch:function(a){return{key:"TextMaxLineWidthReplaced",patch:{nodeId:a.id,version:2,params:{maxWidth:null,sizeMode:"childHeight",width:{value:a.parameters.maxWidth,unit:"px"}}}}}};b.exports={collectPatches:function(a){var b={};return a.components.forEach(function(a){a.nodes.forEach(function(a){f(a,b)})}),b}}},{}],303:[function(a,b,c){"use strict";function d(a,b){var c="Device Settings - "+a;b.ports.push({group:c,type:{name:"enum",enums:[{label:"WebGL",value:"webgl"},{label:"Canvas2D",value:"canvas2d"}]},name:a+".renderer",displayName:"Renderer","default":"webgl"}),b.ports.push({group:c,type:{name:"component"},name:a+".rootComponent",displayName:"Root Component"}),b.dynamicports.push({name:"conditionalports/basic",condition:"'"+a+".fillMode' = aspectFit OR '"+a+".fillMode' NOT SET",ports:[{group:c,type:"number",name:a+".canvasWidth",displayName:"Width","default":1080},{group:c,type:"number",name:a+".canvasHeight",displayName:"Height","default":1920}]}),b.ports.push({group:c,type:{name:"enum",enums:[{label:"Fill",value:"fill"},{label:"Aspect Fit",value:"aspectFit"}]},name:a+".fillMode",displayName:"Fill Mode","default":"aspectFit"})}function e(a){a.dynamicports.push({name:"conditionalports/basic",condition:"mqttUseExternalBroker = true",ports:[{group:"MQTT",type:"string",name:"mqttBrokerUrl",displayName:"Broker URL","default":"mqtt://user:pass@brokerurl.com:1883"}]}),a.ports.push({group:"MQTT",type:"boolean",name:"mqttUseExternalBroker",displayName:"External Broker","default":!1})}function f(a){a.ports.push({group:"Cloud",type:"boolean",name:"cloudRuntimeEnabled",displayName:"Enable","default":!0}),a.dynamicports.push({name:"conditionalports/basic",condition:"cloudRuntimeEnabled = true OR cloudRuntimeEnabled NOT SET",ports:[{group:"Cloud",type:{name:"component"},name:"cloudRuntimeRootComponent",displayName:"Root Component","default":"/Cloud"}]})}function g(a){var b={dynamicports:[],ports:[{group:"Devices",type:"stringlist",name:"devices",displayName:"Devices","default":i}]},c=[i];return a.devices&&(c=a.devices.split(",")),c.forEach(function(a){d(a,b)}),e(b),f(b),b}function h(a){var b=["fillMode","canvasWidth","canvasHeight","renderer"],c=b.filter(function(b){return a.hasOwnProperty(b)});if(0!==c.length){var d={fillMode:null,canvasWidth:null,canvasHeight:null,renderer:null,devices:i};return c.forEach(function(b){d[i+"."+b]=a[b]}),{askPermission:!1,notifyUser:!1,settingsPatch:d}}}var i="Default Device";b.exports={generateProjectSettings:g,collectPatch:h}},{}],304:[function(a,b,c){"use strict";function d(){}var e=a("mqtt"),f=a("./services");d.prototype.connect=function(a){if(this.url!==a.url||this.clientId!==a.clientId){this.url=a.url,this.clientId=a.clientId,this.client&&this.client.end();var b=e.connect(a.url,{clientId:a.clientId});b.on("connect",function(){console.log("Connected to",a.url)}),b.on("message",function(a,b){var c=JSON.parse(b.toString());f.pubsub.routeMessage({topic:a,payload:c})}),this.client=b}},d.prototype.sendServiceRequest=function(a){"subscribe"===a.type?this.client.subscribe(a.topic):"unsubscribe"===a.type?this.client.unsubscribe(a.topic):"publish"===a.type&&this.client.publish(a.topic,JSON.stringify(a.payload))},b.exports=d},{"./services":306,mqtt:149}],305:[function(a,b,c){"use strict";function d(){}var e={};d.prototype.setConnection=function(a){this.connection=a},d.prototype.getMatchingSubscribers=function(a){function b(a,b){var c=a.split("/"),d=b.split("/");if(c.length!==d.length)return!1;for(var e=0;e<c.length;e++)if("+"!==d[e]&&c[e]!==d[e])return!1;return!0}var c=[];for(var d in e)if(b(a,d))for(var f=e[d],g=0;g<f.length;g++)c.push(f[g]);return c},d.prototype.routeMessage=function(a){for(var b=this.getMatchingSubscribers(a.topic),c=0;c<b.length;c++)b[c](a)},d.prototype.getSubscribers=function(a){return e[a]||(e[a]=[]),e[a]},d.prototype.subscribe=function(a,b){var c=this.getSubscribers(a);0===c.length&&this.connection.sendServiceRequest({service:"pubsub",type:"subscribe",topic:a}),c.push(b)},d.prototype.unsubscribe=function(a,b){for(var c=this.getSubscribers(a),d=0;d<c.length;d++)c[d]===b&&c.splice(d,1);0===c.length&&this.connection.sendServiceRequest({service:"pubsub",type:"unsubscribe",topic:a})},d.prototype.publish=function(a,b){this.connection.sendServiceRequest({service:"pubsub",type:"publish",topic:a,payload:b})},b.exports=d},{}],306:[function(a,b,c){function d(){}var e=a("events").EventEmitter;d.events=new e,b.exports=d},{events:17}],307:[function(a,b,c){"use strict";function d(a,b,c){var d=e(JSON.stringify(b)),g=new f(4);g.writeUInt32LE(d.uncompressedSize,0);var h=new XMLHttpRequest;h.open("POST",a,!0),h.send(f.concat([g,d.buffer])),h.addEventListener("readystatechange",function(){h.readyState===XMLHttpRequest.DONE&&c(200===h.status?"success":"error")})}function e(a){var b=new f(a),c=new f(g.encodeBound(b.length)),d=g.encodeBlock(b,c);return c=c.slice(0,d),{buffer:c,uncompressedSize:b.length}}var f=a("buffer").Buffer,g=a("lz4");b.exports=function(a){function b(){e||(e=!0,d(c,f,function(a){"success"===a&&(e=!1)}))}var c,e=!1,f={frames:[],events:[],metadata:{}};a.onmessage=function(a){var d=JSON.parse(a.data);if("sessionStart"===d.cmd)f.id=d.id,c=d.url,setInterval(b,5e3);else if("frame"===d.cmd)f.frames.push(d.frame);else if("events"===d.cmd)f.events.push(d.events);else if("metadata"===d.cmd)for(var e in d.metadata)f.metadata[e]=d.metadata[e]}}},{buffer:9,lz4:140}],308:[function(a,b,c){"use strict";function d(b,c){var d=this;this.touchPoints={},this.startTime=void 0,this.frameNumber=0,this.renderer={render:this._onRenderCommands.bind(this),setViewportSize:function(a,b){d.compressAndUploadWorker.postMessage(JSON.stringify({cmd:"metadata",metadata:{viewportWidth:a,viewportHeight:b}}))},setFillMode:function(a){d.compressAndUploadWorker.postMessage(JSON.stringify({cmd:"metadata",metadata:{fillMode:a}}))},beginFrame:this._onBeginFrame.bind(this),endFrame:this._onEndFrame.bind(this),removeResourcesForRenderCommand:function(){}},this.compressAndUploadWorker=f(a("./session-recorder-webworker.js")),this.compressAndUploadWorker.postMessage(JSON.stringify({cmd:"sessionStart",id:b,url:c}))}var e=a("lodash"),f=a("webworkify");d.prototype._onBeginFrame=function(){void 0===this.startTime&&(this.startTime=window.performance.now()),this.renderCommands=[],this.timestamp=window.performance.now()-this.startTime},d.prototype._onEndFrame=function(){this.frameNumber++,this.compressAndUploadWorker.postMessage(JSON.stringify({cmd:"frame",frame:{renderCommands:this.renderCommands,touchPoints:this.touchPoints,timestamp:this.timestamp}})),this.compressAndUploadWorker.postMessage(JSON.stringify({cmd:"events",events:this.events})),this.events=[]},d.prototype._onRenderCommands=function(a){var b=e.cloneDeep(a);b.forEach(function(a){a.content.image&&delete a.content.image}),this.renderCommands=b},d.prototype.appendTouchEvent=function(a){"isDown"===a.type||"isMove"===a.type?this.touchPoints[a.id]={x:a.x,y:a.y}:"isUp"===a.type&&delete this.touchPoints[a.id]},d.prototype.appendEvent=function(a){this.events.push({eventName:a,frame:this.frameNumber,timestamp:this.timestamp})},d.prototype.getRenderer=function(){return this.renderer},b.exports=d},{"./session-recorder-webworker.js":307,lodash:128,webworkify:189}],309:[function(a,b,c){"use strict";function d(a,b){this.duration=b.duration||0,this._isRunning=!1,this._hasCalledOnStart=!1,this.scheduler=a,this.repeatCount=1,this.delay=0;for(var c in b)this[c]=b[c]}function e(a){this.requestFrame=a,this.runningTimers=[],this.newTimers=[]}d.prototype.start=function(){return this._isRunning&&this.stop(),this.scheduler.scheduleTimer(this),this},d.prototype.stop=function(){this.scheduler.stopTimer(this),this._hasCalledOnStart=!1,this._isRunning=!1,this._wasStopped=!0},e.prototype.createTimer=function(a){return new d(this,a)},e.prototype.scheduleTimer=function(a){-1===this.newTimers.indexOf(a)&&(0===a.repeatCount&&(a.repeatCount=1e5),this.newTimers.push(a),this.requestFrame())},e.prototype.stopTimer=function(a){var b;a._isRunning?(b=this.runningTimers.indexOf(a),-1!==b&&this.runningTimers.splice(b,1),a.onStop&&!a._wasStopped&&a.onStop()):(b=this.newTimers.indexOf(a),-1!==b&&this.newTimers.splice(b,1))},e.prototype.runTimers=function(a){var b,c,d=[],e=[],f=[],g=this.runningTimers.length;for(b=0;g>b;++b)f[b]=this.runningTimers[b];for(b=0;g>b;++b)if(c=f[b],c&&a>=c._start){c._hasCalledOnStart===!1&&c.onStart&&(c.onStart(),c._hasCalledOnStart=!0);var h;h=c.duration>0?(a-c._start)/(c.duration*c.repeatCount):1;var i=h*c.repeatCount-Math.floor(h*c.repeatCount);h>=1&&(i=1),c.onRunning&&c.onRunning(i),1>h&&c._isRunning?d.push(c):c._wasStopped||e.push(c)}else d.push(c);for(this.runningTimers=d,b=0;b<e.length;++b)e[b]._isRunning=!1,e[b]._hasCalledOnStart=!1,e[b].onFinish&&e[b].onFinish();if(this.newTimers.length>0){for(b=0;b<this.newTimers.length;++b)c=this.newTimers[b],c._start=a+c.delay,c._isRunning=!0,c._wasStopped=!1,this.runningTimers.push(c),0===c.delay&&(c.onStart&&(c.onStart(),c._hasCalledOnStart=!0),c.onRunning&&c.onRunning(0));this.newTimers.length=0}},e.prototype.hasPendingTimers=function(){return this.runningTimers.length>0||this.newTimers.length>0},b.exports=e},{}],310:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.layout=f,this.imageCache=b,this.renderCommand={type:"circle",color:"#ffffff",blendMode:"alpha",arcAngle:2*Math.PI,solid:!0,lineWidth:2,blur:0,image:null,imagePath:null}}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var d="%"===a.widthUnit?b*(a.width/100):a.width;return{width:d,height:d}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setArcAngle=function(a){this.renderCommand.arcAngle=a,this.setContentDirty(!0)},d.prototype.setSolid=function(a){this.renderCommand.solid=a,this.setContentDirty(!0)},d.prototype.setLineWidth=function(a){this.renderCommand.lineWidth=a,this.setContentDirty(!0)},d.prototype.setBlur=function(a){this.renderCommand.blur=a,this.setContentDirty(!0)},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},d.prototype.setImagePath=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a,this.setContentDirty(!0),this.imageCache.getImage(a,this._onImageLoaded.bind(this))},d.prototype._onImageLoaded=function(a){a._path===this.path&&(this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.setContentDirty(!0))},d.prototype.setMaskType=function(a){this.renderCommand.maskType=a},b.exports=d},{"./uicontrol":324}],311:[function(a,b,c){"use strict";function d(a){e.call(this,a,f["static"])}var e=a("./layoutcontrol"),f=a("../layout/docklayout");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d},{"../layout/docklayout":326,"./layoutcontrol":315}],312:[function(a,b,c){"use strict";function d(a){e.call(this,a,f["static"]),this.verticalItemSpacing=0,this.horizontalItemSpacing=0,this.orientation="horizontal",this.contentAlignX="left",this.contentAlignY="top"}var e=a("./layoutcontrol"),f=a("../layout/flowlayout");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setVerticalItemSpacing=function(a){this.verticalItemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setHorizontalItemSpacing=function(a){this.horizontalItemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setOrientation=function(a){this.orientation=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setContentAlignX=function(a){this.contentAlignX=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setContentAlignY=function(a){this.contentAlignY=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},b.exports=d},{"../layout/flowlayout":327,"./layoutcontrol":315}],313:[function(a,b,c){"use strict";function d(a,b,c,d){var e=c/a,f=d/b,g=Math.min(e,f);return{width:a*g,height:b*g}}function e(a,b,c,d){var e=c/a,f=d/b,g=Math.max(e,f);return{width:a*g,height:b*g}}function f(a,b){g.call(this,a),this.layout=h,this.setAlignX("center"),this.setAlignY("center"),this.setSizeMode("original"),this.imageCache=b,this.renderCommand={type:"image",color:"#ffffff",blendMode:"alpha",image:null,imagePath:null},this.imageWidth=0,this.imageHeight=0}var g=a("../uicontrol"),h={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var f=a.imageWidth,g=a.imageHeight;if("fill"===a.sizeMode){var h=a.parent.sizeMode;("explicit"===h||"childHeight"===h)&&(f=b),("explicit"===h||"childWidth"===h)&&(g=c)}var i=b&&c&&a.imageWidth&&a.imageHeight;return"aspectFit"===a.sizeMode&&i?d(a.imageWidth,a.imageHeight,b,c):"aspectFill"===a.sizeMode&&i?e(a.imageWidth,a.imageHeight,b,c):{width:f,height:g}}};f.prototype=Object.create(g.prototype),f.prototype.setImagePath=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a,this.imageWidth=0,this.imageHeight=0,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this),null!==a&&this.imageCache.getImage(a,this._onImageLoaded.bind(this))},f.prototype.setVideoElement=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a.src,this.imageWidth=0,this.imageHeight=0,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this),a.videoWidth?this._onVideoLoaded(a):a.addEventListener("canplay",this._onVideoLoaded.bind(this,a))},f.prototype._onVideoLoaded=function(a){a.src===this.path&&(this.imageWidth=a.videoWidth,this.imageHeight=a.videoHeight,this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this))},f.prototype._onImageLoaded=function(a){a._path===this.path&&(this.imageWidth=a.width,this.imageHeight=a.height,this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0))},f.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},f.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},f.prototype.setImageSourceRect=function(a){var b=this.renderCommand;b.srcRect||(b.srcRect=[0,0,1,1]),b.srcRect[0]=a[0],b.srcRect[1]=a[1],b.srcRect[2]=a[2],b.srcRect[3]=a[3]},b.exports=f},{"../uicontrol":324}],314:[function(a,b,c){"use strict";function d(a,b){f.call(this,a),this.clip=!0,this.innerControl=new e(a,b),this.addChild(this.innerControl)}var e=a("./image/imageinnercontrol"),f=a("./docklayoutcontrol");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype.setImagePath=function(a){this.innerControl.setImagePath(a)},d.prototype.setVideoElement=function(a){this.innerControl.setVideoElement(a)},d.prototype.setFillMode=function(a){this.innerControl.setSizeMode(a)},d.prototype.setClip=function(a){this.clip=a,this.setContentDirty(!0)},d.prototype.setColor=function(a){this.innerControl.setColor(a)},d.prototype.setBlendMode=function(a){this.innerControl.setBlendMode(a)},d.prototype.setImageSourceRect=function(a){this.innerControl.setImageSourceRect(a)},d.prototype.dispose=function(){this.innerControl.dispose(),f.prototype.dispose.call(this)},b.exports=d},{"./docklayoutcontrol":311,"./image/imageinnercontrol":313}],315:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.layout=b,this.children=[],this.padding={top:0,bottom:0,left:0,right:0},this.clip=!1,this.childAABB=f.create()}var e=a("./uicontrol"),f=a("../math/aabb");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setPaddingTop=function(a){this.padding.top=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPaddingLeft=function(a){this.padding.left=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPaddingRight=function(a){this.padding.right=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPaddingBottom=function(a){this.padding.bottom=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.addChild=function(a,b){void 0===b&&(b=this.children.length-1),this.children.splice(b,0,a),a.parent=this,this.layouter.setNeedsRelayout(this),this.layouter.setNeedsRelayout(a),a.setContentDirty(!0),a.localTransformDirty=!0},d.prototype.removeChild=function(a){var b=this.children.indexOf(a);-1!==b?this.children.splice(b,1):console.error("Node is not a child"),this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setClip=function(a){this.clip=a,this.setContentDirty(!0)},d.prototype.getChildren=function(){return this.children},b.exports=d},{"../math/aabb":332,"./uicontrol":324}],316:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.layout=f,this.setWidth(100),this.setHeight(100),this.renderCommand={type:"mesh",color:"#ffffff",blendMode:"alpha",mesh:null,shader:null,image:null,imagePath:null,srcRect:[0,0,1,1]},this.imageCache=b}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){return{width:"%"===a.widthUnit?b*(a.width/100):a.width,height:"%"===a.heightUnit?c*(a.height/100):a.height}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setImagePath=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a,this.imageWidth=0,this.imageHeight=0,this.setContentDirty(!0),null!==a&&this.imageCache.getImage(a,this._onImageLoaded.bind(this))},d.prototype._onImageLoaded=function(a){a._path===this.path&&(this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.setContentDirty(!0))},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setShader=function(a){this.renderCommand.shader=a,this.setContentDirty(!0)},d.prototype.setMesh=function(a){this.renderCommand.mesh=a,this.setContentDirty(!0)},d.prototype.setImageSourceRect=function(a){var b=this.renderCommand;b.srcRect||(b.srcRect=[0,0,1,1]),b.srcRect[0]=a[0],b.srcRect[1]=a[1],b.srcRect[2]=a[2],b.srcRect[3]=a[3]},d.prototype.dispose=function(){this.renderCommand.mesh&&this.renderCommand.mesh.dispose(),e.prototype.dispose.call(this)},b.exports=d},{"./uicontrol":324}],317:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=f,this.renderCommand={type:"rectangle",color:"#ffffff",blendMode:"solid",cornerRadius:0,blur:0}}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){return{width:"%"===a.widthUnit?b*(a.width/100):a.width,height:"%"===a.heightUnit?c*(a.height/100):a.height}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setCornerRadius=function(a){this.renderCommand.cornerRadius=a,this.setContentDirty(!0)},d.prototype.setBlur=function(a){this.renderCommand.blur=a,this.setContentDirty(!0)},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},d.prototype.setMaskType=function(a){this.renderCommand.maskType=a},b.exports=d},{"./uicontrol":324}],318:[function(a,b,c){"use strict";function d(a,b){e.call(this,a,f["static"]),this.itemSpacing=0,this.orientation="vertical",this.scrollOffset=0,this.scrollDuration=300;var c=this;this.scroller=new g(b,{scrollThreshold:50,axis:1,scrollEndedAnimationDuration:this.scrollDuration,bounceOnPositionEndedOverride:!1,scrollEndedPositionCallback:function(a,b){return c.scrollEndedPositionCallback(a,b)},scrollCallback:function(a){c.setScrollOffset(a)}}),this.contentLengthChanged=function(a){c.scroller.scrollObjectSize=a},this.on("layoutWidthChanged",function(a){"horizontal"===c.orientation&&(c.scroller.scrollViewSize=a)}),this.on("layoutHeightChanged",function(a){"vertical"===c.orientation&&(c.scroller.scrollViewSize=a)})}var e=a("./layoutcontrol"),f=a("../layout/scrollviewlayout"),g=a("../touch/scroller");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setItemSpacing=function(a){this.itemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.getItemSpacing=function(){return this.itemSpacing},d.prototype.setOrientation=function(a){this.orientation=a,this.scroller.setOrientation(a),this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setScrollOffset=function(a){this.scrollOffset=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0),this.emit("scrollOffsetChanged",a)},d.prototype.setOverscrollEnabled=function(a){this.scroller.shouldRubber=a},b.exports=d},{"../layout/scrollviewlayout":330,"../touch/scroller":353,"./layoutcontrol":315}],319:[function(a,b,c){"use strict";function d(a){e.call(this,a,f["static"]),this.orientation="vertical",this.itemSpacing=0}var e=a("./layoutcontrol"),f=a("../layout/stacklayout");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setItemSpacing=function(a){this.itemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setOrientation=function(a){this.orientation=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},b.exports=d},{"../layout/stacklayout":331,"./layoutcontrol":315}],320:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=g,this.renderCommand={type:"text",fontFamily:"Helvetica",fontSize:40,color:"#ffffff",text:"",lineHeight:0,blendMode:"alpha"},this.text="",this.textWidth=0,this.textHeight=0,this.horizontalAlignment="left",this.maxWidth=0,this.lineHeight=0}var e=a("../uicontrol"),f=a("./textlayout"),g={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){return a.layoutText(),{width:a.textWidth,height:a.textHeight}}};d.prototype=Object.create(e.prototype),d.prototype.layoutText=function(){var a=f.layoutText(this.text,this.renderCommand.fontFamily,this.renderCommand.fontSize,this.horizontalAlignment,this.lineHeight,this.maxWidth);this.textWidth=a.width,this.textHeight=a.height,this.renderCommand.lines=a.lines,this.renderCommand.text=a.lines.map(function(a){return a.text}).join("\n"),this.setContentDirty(!0)},d.prototype.setFontFamily=function(a){this.renderCommand.fontFamily=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setFontSize=function(a){this.renderCommand.fontSize=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setLineHeight=function(a){this.lineHeight=a,this.renderCommand.lineHeight=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setText=function(a){a=String(a),this.text!==a&&(this.text=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0))},d.prototype.getText=function(){return this.text},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setHorizontalAlignment=function(a){this.horizontalAlignment=a,this.renderCommand.horizontalAlignment=a,this.layouter.setNeedsRelayout(this)},d.prototype.setMaxWidth=function(a){this.maxWidth!==a&&(this.maxWidth=a,this.layouter.setNeedsRelayout(this))},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},b.exports=d},{"../uicontrol":324,"./textlayout":321}],321:[function(a,b,c){"use strict";function d(a,b){var c=a+" - "+b;if(void 0===i[c]){var d=document.createElement("span");d.style.fontFamily=a,d.style.fontSize=b+"px",d.innerHTML="yq|";var e=document.createElement("div");
e.style.display="inline-block",e.style.width="1px",e.style.height="0px";var f=document.createElement("div");f.style.display="inline-block",f.appendChild(d),f.appendChild(e),document.body.appendChild(f),e.style.verticalAlign="bottom";var g=e.offsetTop-d.offsetTop;e.style.verticalAlign="baseline";var h=e.offsetTop-d.offsetTop;document.body.removeChild(f);var j={height:g,baseline:h};i[c]=j}return i[c]}function e(a,b,c){k.font=c+'px "'+b+'"';var e=d(b,c);return{width:k.measureText(a).width,height:e.height,baseline:e.baseline}}function f(a,b){if(k.measureText(a).width<b)return[a];var c=a.split(" ").map(function(a){return a+" "});c[c.length-1]=c[c.length-1].slice(0,-1);for(var d=[],e="";c.length>0;){for(;c[0].length>1&&k.measureText(c[0]).width>=b;){var f=c[0];c[0]=f.slice(0,-1),c.length>1?c[1]=f.slice(-1)+c[1]:c.push(f.slice(-1))}0===e.length||k.measureText(e+c[0]).width<b?e+=c.shift():(d.push(e),e="",c.length&&" "===c[0][0]&&(c[0]=c[0].slice(1),0===c[0].length&&c.shift())),0===c.length&&d.push(e)}return d}function g(a,b,c){return"center"===a?(b-c)/2:"right"===a?b-c:0}function h(a,b,c,e,h,i){k.font=c+'px "'+b+'"';var j=[];0===i?j=a.split("\n"):a.split("\n").forEach(function(a){j=j.concat(f(a,i))});var l=0,m=[];j.forEach(function(a){var b=k.measureText(a).width;l=Math.max(l,b),m.push(b)});var n=d(b,c),o=h?h:n.height,p=n.height+(j.length-1)*o,q=[];return j.forEach(function(a,b){var c=m[b],d=g(e,l,c);q.push({text:a,x:d,y:n.baseline+b*o})}),{width:l,height:p,lines:q}}var i={},j=document.createElement("canvas"),k=j.getContext("2d");b.exports={measureText:e,layoutText:h}},{}],322:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.innerControl=new f(a),this.addChild(this.innerControl)}var e=a("./docklayoutcontrol"),f=a("./text/textinnercontrol");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype._onLayoutWidthChanged=function(a){e.prototype._onLayoutWidthChanged.call(this,a),"explicit"===this.sizeMode||"childHeight"===this.sizeMode?this.innerControl.setMaxWidth(a):this.innerControl.setMaxWidth(0)},d.prototype.setFontFamily=function(a){this.innerControl.setFontFamily(a)},d.prototype.setFontSize=function(a){this.innerControl.setFontSize(a)},d.prototype.setLineHeight=function(a){this.innerControl.setLineHeight(a)},d.prototype.setText=function(a){this.innerControl.setText(a)},d.prototype.getText=function(){return this.innerControl.getText()},d.prototype.setColor=function(a){this.innerControl.setColor(a)},d.prototype.setHorizontalAlignment=function(a){this.innerControl.setHorizontalAlignment(a),this.innerControl.setAlignX(a)},d.prototype.setVerticalAlignment=function(a){this.innerControl.setAlignY(a)},d.prototype.setBlendMode=function(a){this.innerControl.setBlendMode(a)},d.prototype.dispose=function(){this.innerControl.dispose(),e.prototype.dispose.call(this)},b.exports=d},{"./docklayoutcontrol":311,"./text/textinnercontrol":320}],323:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=h,this.contentWidth=0,this.contentHeight=0,this.renderCommand={type:"textInput",fontFamily:"Helvetica",fontSize:40,color:"#ffffff",focused:!1,text:"",blendMode:"alpha"},this.text="",this.type="text",this.clip=!0}var e=a("./uicontrol"),f=a("./text/textlayout"),g=a("../../useragent-utils"),h={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var d=0,e=0;return d="childSize"===a.sizeMode||"childWidth"===a.sizeMode?a.contentWidth:"%"===a.widthUnit?b*(a.width/100):a.width,e="childSize"===a.sizeMode||"childHeight"===a.sizeMode?a.contentHeight:"%"===a.heightUnit?c*(a.height/100):a.height,{width:d,height:e}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.updateTextMetrics=function(){var a=f.measureText(this.renderCommand.text,this.renderCommand.fontFamily,this.renderCommand.fontSize);this.contentWidth=a.width,this.contentHeight=a.height,this.renderCommand.baseline=a.baseline,this.renderCommand.textWidth=a.width,this.renderCommand.textHeight=a.height,this.layouter.setNeedsRelayout(this)},d.prototype.setInputField=function(a){this.textInputField=a;var b=this;a.on("inputChanged",function(a){b.setText(a)},this),a.on("blur",this.blur.bind(this),this)},d.prototype.setFontFamily=function(a){this.renderCommand.fontFamily=a,this.updateTextMetrics(),this.setContentDirty(!0)},d.prototype.setFontSize=function(a){this.renderCommand.fontSize=a,this.updateTextMetrics(),this.setContentDirty(!0)},d.prototype.getRenderText=function(a){if("password"===this.type){var b=g.isMobile.iOS()?"":"";a=b.repeat(a.length)}return a},d.prototype.setText=function(a){this.renderCommand.text=this.getRenderText(a),this.updateTextMetrics(),this.setContentDirty(!0),this.text=a,this.emit("textChanged",a)},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.getText=function(){return this.text},d.prototype.setHorizontalAlignment=function(a){},d.prototype.setVerticalAlignment=function(a){},d.prototype.focus=function(){this.renderCommand.focused!==!0&&(this.renderCommand.focused=!0,this.textInputField.focus(),this.setContentDirty(!0),this.emit("focused",this))},d.prototype.blur=function(){this.renderCommand.focused!==!1&&(this.renderCommand.focused=!1,this.textInputField.blur(),this.setContentDirty(!0),this.emit("blurred",this))},d.prototype.isFocused=function(){return this.renderCommand.focused},d.prototype.setInputType=function(a){this.type=a,this.textInputField.setType(a),this.renderCommand.text=this.getRenderText(this.text),this.updateTextMetrics(),this.setContentDirty(!0)},d.prototype.dispose=function(){e.prototype.dispose.call(this),this.textInputField&&(this.textInputField.removeListenersWithRef(this),this.textInputField.dispose())},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},b.exports=d},{"../../useragent-utils":358,"./text/textlayout":321,"./uicontrol":324}],324:[function(a,b,c){"use strict";function d(a){f.call(this),this.id=g(),this.layouter=a,this.sizeMode="explicit",this.pivotUnitType=[],this.pivotFactors=[.5,.5],this.parent=null,this.positionX=0,this.positionY=0,this.positionZ=0,this.alignX="left",this.alignY="top",this.pivotX=50,this.pivotY=50,this.pivotXUnit="%",this.pivotYUnit="%",this.pivotXPx=0,this.pivotYPx=0,this.pivotZPx=0,this.width=0,this.height=0,this.widthUnit="%",this.heightUnit="%",this.depth=void 0,this.opacity=1,this.visible=!0,this.scaleX=1,this.scaleY=1,this.rotationX=0,this.rotationY=0,this.rotationZ=0,this.blockTouch=!1,this.touchPropagation=!0,this.contentDirty=!0,this.highlightEnabled=!1,this.layoutRect=new e({xChanged:this._onLayoutPositionChanged.bind(this),yChanged:this._onLayoutPositionChanged.bind(this),widthChanged:this._onLayoutWidthChanged.bind(this),heightChanged:this._onLayoutHeightChanged.bind(this)}),this.screenAABB=i.create(),this.transform=h.create(),this.localTransform=h.create(),this.localTransformDirty=!1}var e=a("./../layout/layoutrect"),f=a("../../eventsender"),g=a("../../guid"),h=a("../math/mat4"),i=a("../math/aabb");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype._onLayoutPositionChanged=function(){this.localTransformDirty=!0},d.prototype._onLayoutWidthChanged=function(a){this.emit("layoutWidthChanged",a),"%"===this.pivotXUnit&&this.setPivotX(this.pivotX)},d.prototype._onLayoutHeightChanged=function(a){this.emit("layoutHeightChanged",a),"%"===this.pivotYUnit&&this.setPivotY(this.pivotY)},d.prototype.setPositionX=function(a){this.positionX=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPositionY=function(a){this.positionY=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPositionZ=function(a){this.positionZ=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setWidth=function(a){this.width=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setHeight=function(a){this.height=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setWidthUnit=function(a){this.widthUnit=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setHeightUnit=function(a){this.heightUnit=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setSizeMode=function(a){this.sizeMode=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setAlignX=function(a){this.alignX=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setAlignY=function(a){this.alignY=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setBlockTouch=function(a){this.blockTouch=a},d.prototype.setTouchPropagation=function(a){this.touchPropagation=a},d.prototype.setDepth=function(a){this.depth=a,this.setContentDirty(!0)},d.prototype.setOpacity=function(a){0===this.opacity&&a>0&&(this.localTransformDirty=!0),this.opacity=a,this.setContentDirty(!0)},d.prototype.setVisible=function(a){this.visible=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setPivotX=function(a){this.pivotX=a;var b=a;if("%"===this.pivotXUnit){var c=void 0===this.layoutRect.width?0:this.layoutRect.width;b=c*a*.01}this.pivotXPx!==b&&(this.pivotXPx=b,this.localTransformDirty=!0,this.setContentDirty(!0))},d.prototype.setPivotXUnit=function(a){this.pivotXUnit=a,this.setPivotX(this.pivotX),this.setContentDirty(!0)},d.prototype.setPivotY=function(a){this.pivotY=a;var b=a;if("%"===this.pivotYUnit){var c=void 0===this.layoutRect.height?0:this.layoutRect.height;b=c*a*.01}this.pivotYPx!==b&&(this.pivotYPx=b,this.localTransformDirty=!0,this.setContentDirty(!0))},d.prototype.setPivotYUnit=function(a){this.pivotYUnit=a,this.setPivotY(this.pivotY),this.setContentDirty(!0)},d.prototype.setPivotZ=function(a){this.pivotZPx=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setRotationX=function(a){this.rotationX=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setRotationY=function(a){this.rotationY=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setRotationZ=function(a){this.rotationZ=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setScaleX=function(a){this.scaleX=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setScaleY=function(a){this.scaleY=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setContentDirty=function(a){this.contentDirty!==a&&(this.contentDirty=a,a&&this.parent&&this.parent.setContentDirty(!0))},d.prototype.setHighlightEnabled=function(a){this.highlightEnabled=a,this.setContentDirty(!0)},d.prototype.getScreenX=function(){return this.screenAABB.min[0]},d.prototype.getScreenY=function(){return this.screenAABB.min[1]},d.prototype.dispose=function(){this.emit("disposed",this),this.removeAllListeners()},b.exports=d},{"../../eventsender":221,"../../guid":223,"../math/aabb":332,"../math/mat4":334,"./../layout/layoutrect":329}],325:[function(a,b,c){"use strict";function d(){this.cache={}}d.prototype.getImage=function(a,b){var c=this.cache[a];if(c)return void(c.isLoaded?b(c.image):c.callbacks.push(b));this.cache[a]={image:new Image,callbacks:[],isLoaded:!1},c=this.cache[a],c.callbacks.push(b);var d=c.image;d.crossOrigin="anonymous",d.addEventListener("load",function(){c.callbacks.forEach(function(a){a(d)}),c.isLoaded=!0,delete c.callbacks}),d.src=a,d._path=a},d.prototype.clear=function(){this.cache={}},b.exports=d},{}],326:[function(a,b,c){"use strict";function d(){}d.prototype.layoutChildHorizontally=function(a,b,c,d,e){"left"===b.alignX?(a.x=b.positionX+e.left,a.width=c):"right"===b.alignX?(a.x=d.width-e.right+b.positionX-c,a.width=c):"center"===b.alignX&&(a.x=(d.width-e.right-e.left)/2+e.left+b.positionX-c/2,a.width=c),a.x=Math.round(a.x)},d.prototype.layoutChildVertically=function(a,b,c,d,e){"top"===b.alignY?(a.y=b.positionY+e.top,a.height=c):"bottom"===b.alignY?(a.y=d.height-e.bottom+b.positionY-c,a.height=c):"center"===b.alignY&&(a.y=(d.height-e.bottom-e.top)/2+e.top+b.positionY-c/2,a.height=c),a.y=Math.round(a.y)},d.prototype.setChildLayoutRect=function(a,b){var c=a.layoutRect.width!=b.width||a.layoutRect.height!=b.height;a.layoutRect.x=b.x,a.layoutRect.y=b.y,a.layoutRect.width=Math.max(b.width,0),a.layoutRect.height=Math.max(b.height,0),(c||a.needsRelayout)&&(a.layout.layout&&a.layout.layout(a),a.needsRelayout=!1)},d.prototype.layout=function(a){for(var b={x:0,y:0,width:0,height:0},c=0;c<a.children.length;c++){var d=a.children[c],e=a.layoutRect.width-a.padding.left-a.padding.right,f=a.layoutRect.height-a.padding.top-a.padding.bottom,g=d.layout.layoutSize(d,e,f);this.layoutChildHorizontally(b,d,g.width,a.layoutRect,a.padding),this.layoutChildVertically(b,d,g.height,a.layoutRect,a.padding),this.setChildLayoutRect(d,b)}},d.prototype.layoutSize=function(a,b,c){var d=this.measure(a,b,c);return{width:"childWidth"===a.sizeMode||"childSize"===a.sizeMode?d.width:this.layoutWidth(a,b),height:"childHeight"===a.sizeMode||"childSize"===a.sizeMode?d.height:this.layoutHeight(a,c)}},d.prototype.measureChildrenWidth=function(a,b){for(var c=0,d=0;d<a.children.length;d++){var e=a.children[d],f=e.layout.measure(e,b.width,b.height);c=Math.max(c,Math.max(e.positionX,0)+f.width)}return c},d.prototype.measureChildrenHeight=function(a,b){for(var c=0,d=0;d<a.children.length;d++){var e=a.children[d],f=e.layout.measure(e,b.width,b.height);c=Math.max(c,Math.max(e.positionY,0)+f.height)}return c},d.prototype.layoutWidth=function(a,b){return"%"===a.widthUnit?b*(a.width/100):a.width},d.prototype.layoutHeight=function(a,b){return"%"===a.heightUnit?b*(a.height/100):a.height},d.prototype.measure=function(a,b,c){var d={width:"childWidth"===a.sizeMode||"childSize"===a.sizeMode?0:this.layoutWidth(a,b),height:"childHeight"===a.sizeMode||"childSize"===a.sizeMode?0:this.layoutHeight(a,c)},e={width:"childWidth"===a.sizeMode||"childSize"===a.sizeMode?this.measureChildrenWidth(a,d)+a.padding.left+a.padding.right:d.width,height:"childHeight"===a.sizeMode||"childSize"===a.sizeMode?this.measureChildrenHeight(a,d)+a.padding.top+a.padding.bottom:d.height};return e},d["static"]=new d,b.exports=d},{}],327:[function(a,b,c){"use strict";function d(){}var e=a("./docklayout");d.prototype=Object.create(e.prototype),d.prototype.measureChildrenHeightForHorizontalFlow=function(a,b){if("explict"===this.sizeMode||"childWidth"===this.sizeMode)return b.height;for(var c="childSize"===a.sizeMode?Number.MAX_VALUE:b.width-a.padding.left-a.padding.right,d=0,e=0,f=0,g=a.children.length,h=0;g>h;h++){var i=a.children[h],j=i.layout.measure(i,b.width,b.height);e+j.width>c&&(d+=f+a.verticalItemSpacing,f=e=0),f=Math.max(f,j.height+i.positionY),e+=j.width+a.horizontalItemSpacing}return d+=f},d.prototype.measureChildrenWidthForHorizontalFlow=function(a,b){if("explict"===this.sizeMode||"childHeight"===this.sizeMode)return b.width;for(var c=0,d=a.children.length,e=0;d>e;e++){var f=a.children[e],g=f.layout.measure(f,b.width,b.height);c+=g.width+(e!==d-1?a.horizontalItemSpacing:0)}return c},d.prototype.measureChildrenWidthForVerticalFlow=function(a,b){if("explict"===this.sizeMode||"childHeight"===this.sizeMode)return dim.width;for(var c="childSize"===a.sizeMode?Number.MAX_VALUE:b.height-a.padding.top-a.padding.left,d=0,e=0,f=0,g=a.children.length,h=0;g>h;h++){var i=a.children[h],j=i.layout.measure(i,b.width,b.height);d+j.height>c&&(e+=f+a.horizontalItemSpacing,f=d=0),f=Math.max(f,j.width+i.positionX),d+=j.height+a.verticalItemSpacing}return e+=f},d.prototype.measureChildrenHeightForVerticalFlow=function(a,b){if("explict"===this.sizeMode||"childWidth"===this.sizeMode)return b.height;for(var c=0,d=a.children.length,e=0;d>e;e++){var f=a.children[e],g=f.layout.measure(f,b.width,b.height);c+=g.height+(e!==d-1?a.verticalItemSpacing:0)}return c},d.prototype.measureChildrenWidth=function(a,b){return"horizontal"===a.orientation?this.measureChildrenWidthForHorizontalFlow(a,b):this.measureChildrenWidthForVerticalFlow(a,b)},d.prototype.measureChildrenHeight=function(a,b){return"horizontal"===a.orientation?this.measureChildrenHeightForHorizontalFlow(a,b):this.measureChildrenHeightForVerticalFlow(a,b)};var f=[];d.prototype.layout=function(a){function b(b,c,d,e,g){var h=0,i=a.layoutRect.width-a.padding.left-a.padding.right;"center"===a.contentAlignX?h=Math.round(.5*(i-g)):"right"===a.contentAlignX&&(h=i-g);for(var k=b;c>k;k++){var l=a.children[k],m=f[k],n=l.layout.layoutSize(l,0,e);j.layoutChildVertically(m,l,n.height,{height:e},{top:0,bottom:0,left:0,right:0}),m.x+=h,m.y+=d,j.setChildLayoutRect(l,m)}}function c(b,c,d,e,g){var h=0,i=a.layoutRect.height-a.padding.top-a.padding.bottom;"center"===a.contentAlignY?h=Math.round(.5*(i-g)):"bottom"===a.contentAlignY&&(h=i-g);for(var k=b;c>k;k++){var l=a.children[k],m=f[k],n=l.layout.layoutSize(l,e,0);j.layoutChildHorizontally(m,l,n.width,{width:e},{top:0,bottom:0,left:0,right:0}),m.x+=d,m.y+=h,j.setChildLayoutRect(l,m)}}var d,e,g,h,i,j=this,k=0,l=0,m=0,n=0,o=0,p=a.children.length;if(f.length<p)for(e=0;p>e;e++)f[e]={x:0,y:0,width:0,height:0};if("horizontal"===a.orientation){var q=a.layoutRect.width-a.padding.left-a.padding.right;d=q;var n=0;for(e=0;p>e;e++)i=f[e],g=a.children[e],h=g.layout.layoutSize(g,q,0),k+h.width>d&&(b(o,e,l+a.padding.top,m,k-a.horizontalItemSpacing),l+=m+a.verticalItemSpacing,o=e,m=0,n=0,k=0),m=Math.round(Math.max(m,h.height)),i.x=k+a.padding.left+g.positionX,i.width=h.width,k+=Math.round(h.width)+a.horizontalItemSpacing;b(o,e,l+a.padding.top,m,k-a.horizontalItemSpacing)}else{var r=a.layoutRect.height-a.padding.top-a.padding.bottom;for(d=r,e=0;p>e;e++)i=f[e],g=a.children[e],h=g.layout.layoutSize(g,0,r),l+h.height>d&&(c(o,e,k+a.padding.left,n,l-a.verticalItemSpacing),k+=n+a.horizontalItemSpacing,o=e,n=0,l=0),n=Math.round(Math.max(n,h.width)),i.y=l+a.padding.top+g.positionY,i.height=h.height,l+=Math.round(h.height)+a.verticalItemSpacing;c(o,e,k+a.padding.left,n,l-a.verticalItemSpacing)}},d["static"]=new d,b.exports=d},{"./docklayout":326}],328:[function(a,b,c){"use strict";function d(){}var e=a("./docklayout");d.prototype.setWindowSize=function(a,b){this.windowSize={width:a,height:b}},d.prototype.layout=function(a){var b={layoutRect:{x:0,y:0,width:this.windowSize.width,height:this.windowSize.height},padding:{top:0,left:0,bottom:0,right:0},children:[a]};e["static"].layout(b),a.needsRelayout=!1},d.prototype.setNeedsFullRelayout=function(a){function b(a){if(a.measuredSize=void 0,a.needsRelayout=!0,a.children)for(var c=0;c<a.children.length;c++)b(a.children[c])}b(a)},d.prototype.setNeedsRelayout=function(a){a.needsRelayout||(a.measuredSize=void 0,a.needsRelayout=!0,a.parent&&this.setNeedsRelayout(a.parent))},d.prototype.relayout=function(a){this.setNeedsFullRelayout(a),this.layout(a)},b.exports=d},{"./docklayout":326}],329:[function(a,b,c){var d=function(a){this._x=this._y=this._width=this._height=void 0,this.callbacks=a};Object.defineProperties(d.prototype,{x:{set:function(a){this._x!==a&&(this._x=a,this.callbacks.xChanged(a))},get:function(){return this._x}},y:{set:function(a){this._y!==a&&(this._y=a,this.callbacks.yChanged(a))},get:function(){return this._y}},width:{set:function(a){this._width!==a&&(this._width=a,this.callbacks.widthChanged(a))},get:function(){return this._width}},height:{set:function(a){this._height!==a&&(this._height=a,this.callbacks.heightChanged(a))},get:function(){return this._height}}}),b.exports=d},{}],330:[function(a,b,c){"use strict";function d(){}var e=a("./stacklayout");d.prototype=Object.create(e.prototype),d.prototype.layout=function(a){var b,c,d,e=a.children.length,f={x:0,y:0,width:0,height:0},g=a.layoutRect.height-a.padding.top-a.padding.bottom,h=a.layoutRect.width-a.padding.left-a.padding.right;if("horizontal"===a.orientation){var i=a.padding.left;for(d=0;e>d;d++)b=a.children[d],c=b.layout.layoutSize(b,h,g),f.x=Math.round(i+a.scrollOffset+b.positionX),f.width=Math.round(c.width),this.layoutChildVertically(f,b,c.height,a.layoutRect,a.padding),this.setChildLayoutRect(b,f),i+=a.itemSpacing+b.layoutRect.width;a.contentLengthChanged&&a.contentLengthChanged(i-(d>0?a.itemSpacing:0)-a.padding.left)}else{var j=a.padding.top;for(d=0;e>d;d++)b=a.children[d],c=b.layout.layoutSize(b,h,g),this.layoutChildHorizontally(f,b,c.width,a.layoutRect,a.padding),f.y=Math.round(j+a.scrollOffset+b.positionY),f.height=Math.round(c.height),this.setChildLayoutRect(b,f),j+=a.itemSpacing+b.layoutRect.height;a.contentLengthChanged&&a.contentLengthChanged(j-(d>0?a.itemSpacing:0)-a.padding.top)}},d["static"]=new d,b.exports=d},{"./stacklayout":331}],331:[function(a,b,c){"use strict";function d(){}var e=a("./docklayout");d.prototype=Object.create(e.prototype),d.prototype.layout=function(a){var b,c,d,e=0,f=0,g=0,h={x:0,y:0,width:0,height:0},i=a.layoutRect.width-a.padding.left-a.padding.right,j=a.layoutRect.height-a.padding.top-a.padding.bottom;if("horizontal"===a.orientation){for(c=a.children.length,d=0;c>d;d++)if(b=a.children[d],"%"!==b.widthUnit||"explicit"!==b.sizeMode&&"childHeight"!==b.sizeMode){var k=b.layout.measure(b,i,j);e+=k.width}else g+=b.width/100;f=Math.max(0,a.layoutRect.width-a.padding.left-a.padding.right-e-a.itemSpacing*(c-1))/g;var l=Math.round(a.padding.left);for(d=0;c>d;d++){b=a.children[d];var m=a.layoutRect.height-a.padding.top-a.padding.bottom;k=b.layout.layoutSize(b,f,m),h.x=l+b.positionX,h.width=Math.round(k.width),this.layoutChildVertically(h,b,k.height,a.layoutRect,a.padding),this.setChildLayoutRect(b,h),l+=a.itemSpacing+b.layoutRect.width}}else{for(c=a.children.length,d=0;c>d;d++)b=a.children[d],"%"!==b.heightUnit||"explicit"!==b.sizeMode&&"childWidth"!==b.sizeMode?(k=b.layout.measure(b,i,j),e+=k.height):g+=b.height/100;f=Math.max(0,a.layoutRect.height-a.padding.top-a.padding.bottom-e-a.itemSpacing*(c-1))/g;var n=Math.round(a.padding.top);for(d=0;c>d;d++){b=a.children[d];var o=a.layoutRect.width-a.padding.left-a.padding.right;k=b.layout.layoutSize(b,o,f),this.layoutChildHorizontally(h,b,k.width,a.layoutRect,a.padding),h.y=n+b.positionY,h.height=Math.round(k.height),this.setChildLayoutRect(b,h),n+=a.itemSpacing+b.layoutRect.height}}a.needsRelayout=!1},d.prototype.measureChildrenWidth=function(a,b){if("horizontal"===a.orientation){for(var c=0,d=a.children.length,f=0;d>f;f++){var g=a.children[f],h=g.layout.measure(g,b.width,b.height);c+=h.width+(f!==d-1?a.itemSpacing:0)}return c}return e.prototype.measureChildrenWidth.call(this,a,b)},d.prototype.measureChildrenHeight=function(a,b){if("vertical"===a.orientation){for(var c=0,d=a.children.length,f=0;d>f;f++){var g=a.children[f],h=g.layout.measure(g,b.width,b.height);c+=h.height+(f!==d-1?a.itemSpacing:0)}return c}return e.prototype.measureChildrenHeight.call(this,a,b)},d["static"]=new d,b.exports=d},{"./docklayout":326}],332:[function(a,b,c){"use strict";var d=a("./mat3"),e=a("./mat4"),f=[[0,0,0],[0,0,0],[0,0,0],[0,0,0]],g={};g.create=function(){return{min:[0,0],max:[0,0]}},g.set=function(a,b,c,d,e){a.min[0]=b,a.min[1]=c,a.max[0]=d,a.max[1]=e},g.transform3=function(a,b){f[0][0]=a.min[0],f[0][1]=a.min[1],f[1][0]=a.min[0],f[1][1]=a.max[1],f[2][0]=a.max[0],f[2][1]=a.min[1],f[3][0]=a.max[0],f[3][1]=a.max[1],d.transformPoint(b,f[0]),a.min[0]=a.max[0]=f[0][0],a.min[1]=a.max[1]=f[0][1];for(var c=1;4>c;++c){var e=f[c];d.transformPoint(b,e),e[0]<a.min[0]&&(a.min[0]=e[0]),e[1]<a.min[1]&&(a.min[1]=e[1]),e[0]>a.max[0]&&(a.max[0]=e[0]),e[1]>a.max[1]&&(a.max[1]=e[1])}},g.transform4=function(a,b){f[0][0]=a.min[0],f[0][1]=a.min[1],f[1][0]=a.min[0],f[1][1]=a.max[1],f[2][0]=a.max[0],f[2][1]=a.min[1],f[3][0]=a.max[0],f[3][1]=a.max[1],e.transformPoint(b,f[0]),a.min[0]=a.max[0]=f[0][0],a.min[1]=a.max[1]=f[0][1];for(var c=1;4>c;++c){var d=f[c];e.transformPoint(b,d),d[0]<a.min[0]&&(a.min[0]=d[0]),d[1]<a.min[1]&&(a.min[1]=d[1]),d[0]>a.max[0]&&(a.max[0]=d[0]),d[1]>a.max[1]&&(a.max[1]=d[1])}},g.copy=function(a,b){a.min[0]=b.min[0],a.min[1]=b.min[1],a.max[0]=b.max[0],a.max[1]=b.max[1]},g.intersects=function(a,b){return a.min[0]>=b.max[0]||a.max[0]<=b.min[0]||a.min[1]>=b.max[1]||a.max[1]<=b.min[1]?!1:!0},g.union=function(a,b){b.min[0]<a.min[0]&&(a.min[0]=b.min[0]),b.min[1]<a.min[1]&&(a.min[1]=b.min[1]),b.max[0]>a.max[0]&&(a.max[0]=b.max[0]),b.max[1]>a.max[1]&&(a.max[1]=b.max[1])},g.width=function(a){return a.max[0]-a.min[0]},g.height=function(a){return a.max[1]-a.min[1]},g.isPointInside=function(a,b){return b[0]>=a.min[0]&&b[0]<=a.max[0]&&b[1]>=a.min[1]&&b[1]<=a.max[1]},g.intersection=function(a,b){a.min[0]=Math.max(a.min[0],b.min[0]),a.min[1]=Math.max(a.min[1],b.min[1]),a.max[0]=Math.min(a.max[0],b.max[0]),a.max[1]=Math.min(a.max[1],b.max[1])},b.exports=g},{"./mat3":333,"./mat4":334}],333:[function(b,c,d){"use strict";var e={};e.create=function(){var a=new Array(9);return e.identity(a),a},e.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},e.copy=function(a,b){for(var c=0;9>c;c++)a[c]=b[c];return a},e.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=c[0],n=c[1],o=c[2],p=c[3],q=c[4],r=c[5],s=c[6],t=c[7],u=c[8];return a[0]=m*d+n*g+o*j,a[1]=m*e+n*h+o*k,a[2]=m*f+n*i+o*l,a[3]=p*d+q*g+r*j,a[4]=p*e+q*h+r*k,a[5]=p*f+q*i+r*l,a[6]=s*d+t*g+u*j,a[7]=s*e+t*h+u*k,a[8]=s*f+t*i+u*l,a},e.translate=function(a,b,c){return a[6]=b*a[0]+c*a[3]+a[6],a[7]=b*a[1]+c*a[4]+a[7],a[8]=b*a[2]+c*a[5]+a[8],a},e.rotate=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=Math.sin(b),m=Math.cos(b);return a[0]=m*c+l*f,a[1]=m*d+l*g,a[2]=m*e+l*h,a[3]=m*f-l*c,a[4]=m*g-l*d,a[5]=m*h-l*e,a[6]=i,a[7]=j,a[8]=k,a},e.scale=function(b,c,d){return b[0]=c*a[0],b[1]=c*a[1],b[2]=c*a[2],b[3]=d*a[3],b[4]=d*a[4],b[5]=d*a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},e.transformPoint=function(a,b){var c=b[0],d=b[1];b[0]=a[0]*c+a[3]*d+a[6],b[1]=a[1]*c+a[4]*d+a[7]},e.invert=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=j*f-g*i,l=-j*e+g*h,m=i*e-f*h,n=b*k+c*l+d*m;return n?(n=1/n,a[0]=k*n,a[1]=(-j*c+d*i)*n,a[2]=(g*c-d*f)*n,a[3]=l*n,a[4]=(j*b-d*h)*n,a[5]=(-g*b+d*e)*n,a[6]=m*n,a[7]=(-i*b+c*h)*n,a[8]=(f*b-c*e)*n,a):null},c.exports=e},{}],334:[function(b,c,d){"use strict";var e={};e.create=function(){var a=new Array(16);return e.identity(a),a},e.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.copy=function(a,b){for(var c=0;16>c;c++)a[c]=b[c];return a},e.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a},e.translate=function(a,b,c,d){return a[12]=a[0]*b+a[4]*c+a[8]*d+a[12],a[13]=a[1]*b+a[5]*c+a[9]*d+a[13],a[14]=a[2]*b+a[6]*c+a[10]*d+a[14],a[15]=a[3]*b+a[7]*c+a[11]*d+a[15],a},e.rotateX=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[4],f=a[5],g=a[6],h=a[7],i=a[8],j=a[9],k=a[10],l=a[11];return a[4]=e*d+i*c,a[5]=f*d+j*c,a[6]=g*d+k*c,a[7]=h*d+l*c,a[8]=i*d-e*c,a[9]=j*d-f*c,a[10]=k*d-g*c,a[11]=l*d-h*c,a},e.rotateY=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[8],j=a[9],k=a[10],l=a[11];return a[0]=e*d-i*c,a[1]=f*d-j*c,a[2]=g*d-k*c,a[3]=h*d-l*c,a[8]=e*c+i*d,a[9]=f*c+j*d,a[10]=g*c+k*d,a[11]=h*c+l*d,a},e.rotateZ=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[4],j=a[5],k=a[6],l=a[7];return a[0]=e*d+i*c,a[1]=f*d+j*c,a[2]=g*d+k*c,a[3]=h*d+l*c,a[4]=i*d-e*c,a[5]=j*d-f*c,a[6]=k*d-g*c,a[7]=l*d-h*c,a},e.scale=function(b,c,d,e){return b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c,b[3]=a[3]*c,b[4]=a[4]*d,b[5]=a[5]*d,b[6]=a[6]*d,b[7]=a[7]*d,b[8]=a[8]*e,b[9]=a[9]*e,b[10]=a[10]*e,b[11]=a[11]*e,b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},e.transformPoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=a[3]*c+a[7]*d+a[11]*e+a[15];f=f||1,b[0]=(a[0]*c+a[4]*d+a[8]*e+a[12])/f,b[1]=(a[1]*c+a[5]*d+a[9]*e+a[13])/f,b[2]=(a[2]*c+a[6]*d+a[10]*e+a[14])/f},e.invert=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15],r=b*g-c*f,s=b*h-d*f,t=b*i-e*f,u=c*h-d*g,v=c*i-e*g,w=d*i-e*h,x=j*o-k*n,y=j*p-l*n,z=j*q-m*n,A=k*p-l*o,B=k*q-m*o,C=l*q-m*p,D=r*C-s*B+t*A+u*z-v*y+w*x;return D?(D=1/D,a[0]=(g*C-h*B+i*A)*D,a[1]=(d*B-c*C-e*A)*D,a[2]=(o*w-p*v+q*u)*D,a[3]=(l*v-k*w-m*u)*D,a[4]=(h*z-f*C-i*y)*D,a[5]=(b*C-d*z+e*y)*D,a[6]=(p*t-n*w-q*s)*D,a[7]=(j*w-l*t+m*s)*D,a[8]=(f*B-g*z+i*x)*D,a[9]=(c*z-b*B-e*x)*D,a[10]=(n*v-o*t+q*r)*D,a[11]=(k*t-j*v-m*r)*D,a[12]=(g*y-f*A-h*x)*D,a[13]=(b*A-c*y+d*x)*D,a[14]=(o*s-n*u-p*r)*D,void(a[15]=(j*u-k*s+l*r)*D)):null},e.perspective=function(a,b,c,d,e){var f=1/Math.tan(b/2),g=1/(d-e);return a[0]=f/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(e+d)*g,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*e*d*g,a[15]=0,a},c.exports=e},{}],335:[function(a,b,c){"use strict";function d(a){h.call(this),this.rootElement=document.createElement("div"),this.rootElement.style.position="absolute",this.rootElement.style.display="block",this.rootElement.style.perspective="1000px",this.rootElement.style.webkitPerspective="1000px",a.appendChild(this.rootElement),document.ontouchstart=function(a){a.preventDefault()},this.clipAABB=g.create(),this.renderers=[],this.renderDepthSet={},this._resizeRootElement();var b=this;i.isMobile.Android()&&window.addEventListener("orientationchange",function(){window.setTimeout(b._resizeRootElement.bind(b),100)})}function e(a,b){return a-b}var f=a("./math/mat4"),g=a("./math/aabb"),h=a("../eventsender"),i=a("../useragent-utils"),j=a("lodash");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.prototype._resizeRootElement=function(){i.isMobile.Android()?(this.rootElement.style.width=window.innerWidth+"px",this.rootElement.style.height=window.innerHeight+"px"):(this.rootElement.style.width="100%",this.rootElement.style.height="100%"),this.renderers.forEach(function(a){a.resizeRootElement&&a.resizeRootElement()}),this.emit("requestFrame")},d.prototype.removeAllRenderers=function(){this.renderers.forEach(function(a){a.detach&&a.detach()}),this.renderers=[]},d.prototype.addRenderer=function(a){a.setViewportSize&&a.setViewportSize(this.viewportWidth,this.viewportHeight),a.attach&&a.attach(this.rootElement),this.renderers.push(a)},d.prototype.createTextInputField=function(a){for(var b=0;b<this.renderers.length;b++){var c=this.renderers[b];if(c.createInputField)return c.createInputField(a)}},d.prototype.beginLayout=function(){this.renderDepthSet={}},d.prototype.layout=function(a,b){if(a.visible&&0!==a.opacity){a.contentDirty=!1;var c=a.layoutRect,d=a.localTransform,e=b||a.localTransformDirty;if(a.localTransformDirty&&(f.identity(d),d[0]=a.scaleX,d[5]=a.scaleY,d[12]=c.x+a.pivotXPx,d[13]=c.y+a.pivotYPx,d[14]=a.positionZ+a.pivotZPx,a.rotationX&&f.rotateX(d,a.rotationX),a.rotationY&&f.rotateY(d,a.rotationY),a.rotationZ&&f.rotateZ(d,a.rotationZ),f.translate(d,-a.pivotXPx,-a.pivotYPx,-a.pivotZPx),a.localTransformDirty=!1),e){f.multiply(a.transform,a.parent.transform,d);var h=a.screenAABB.min[0],i=a.screenAABB.min[1];g.set(a.screenAABB,0,0,c.width,c.height),g.transform4(a.screenAABB,a.transform),h!==a.screenAABB.min[0]&&a.emit("screenXChanged",a.screenAABB.min[0]),i!==a.screenAABB.min[1]&&a.emit("screenYChanged",a.screenAABB.min[1])}if(a.renderDepth=void 0!==a.depth?a.depth:a.parent.renderDepth||0,this.renderDepthSet[a.renderDepth]=!0,a.children){g.copy(a.childAABB,a.screenAABB);for(var j=0,k=a.children.length;k>j;j++){var l=a.children[j];this.layout(l,e),a.clip||g.union(a.childAABB,l.childAABB||l.screenAABB)}}}},d.prototype._addRenderCommand=function(a,b,c){if(void 0!==c)a[c].push(b);else for(var d=0;d<this.renderDepths.length;d++)a[this.renderDepths[d]].push(b);
},d.prototype._collectRenderCommandsRecursive=function(a,b,c,d){if(a.visible&&0!==a.opacity&&g.intersects(this.clipAABB,a.childAABB||a.screenAABB)!==!1){if(a.clip){this._addRenderCommand(b,{content:{type:"pushClipRect"},id:a.id+"clip",transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height});var e=g.create();g.copy(e,this.clipAABB),g.intersection(this.clipAABB,a.screenAABB)}var f=a.renderCommand;if(f&&("image"!==f.type||f.image)&&(f.opacity=a.opacity*d,this._addRenderCommand(b,{content:f,id:a.id,transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height},a.renderDepth)),f&&f.maskType&&"none"!==f.maskType){var h=j.clone(f);h.maskType="positive"===f.maskType?"negative":"positive",c.push({content:h,id:a.id+"-undoMask",transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height})}if(a.children){for(var i=[],k=0,l=a.children.length;l>k;k++)this._collectRenderCommandsRecursive(a.children[k],b,i,a.opacity*d);for(var k=0,l=i.length;l>k;k++)this._addRenderCommand(b,i[k],a.renderDepth)}if(a.highlightEnabled&&this._addRenderCommand(b,{id:a.id+"-hl",content:{type:"rectangle",color:"#8BC6E9",opacity:.6,cornerRadius:0,blur:0},transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height},a.renderDepth),a.clip){for(var k=0;k<this.renderDepths.length;k++){var m=b[this.renderDepths[k]];"pushClipRect"===m[m.length-1].content.type?m.length=m.length-1:m.push({content:{type:"popClipRect"}})}g.copy(this.clipAABB,e)}}},d.prototype._collectRenderCommands=function(a){var b={};this.renderDepths=Object.keys(this.renderDepthSet);for(var c=0;c<this.renderDepths.length;c++)b[this.renderDepths[c]]=[];return this._collectRenderCommandsRecursive(a,b,[],1),b},d.prototype.render=function(a){var b=this._collectRenderCommands(a),c=Object.keys(b).sort(e);this.renderers.forEach(function(a){for(var d=0;d<c.length;d++)a.render(b[c[d]])})},d.prototype.setViewportSize=function(a,b){this.viewportWidth=a,this.viewportHeight=b,this.renderers.forEach(function(c){c.setViewportSize&&c.setViewportSize(a,b)})},d.prototype.beginFrame=function(){g.set(this.clipAABB,0,0,this.viewportWidth,this.viewportHeight),this.renderers.forEach(function(a){a.beginFrame&&a.beginFrame()})},d.prototype.endFrame=function(){this.renderers.forEach(function(a){a.endFrame&&a.endFrame()})},d.prototype.setFillMode=function(a){this.fillMode=a,this.renderers.forEach(function(b){b.setFillMode&&b.setFillMode(a)})},d.prototype.captureScreenShot=function(a,b,c){for(var d,e=0;e<this.renderers.length;e++){var f=this.renderers[e];if(f.rootElement&&"CANVAS"===f.rootElement.tagName){d=f;break}}if(d){var g=this.rootElement.style.width,h=this.rootElement.style.height;this.rootElement.style.width=b+"px",this.rootElement.style.height=c+"px",d.resizeRootElement(),d.beginFrame&&d.beginFrame();for(var i=this._collectRenderCommands(a),j=Object.keys(i).sort(),e=0;e<j.length;e++)d.render(i[j[e]]);d.endFrame&&d.endFrame();var k=d.rootElement.toDataURL();return this.rootElement.style.width=g,this.rootElement.style.height=h,d.resizeRootElement(),this.emit("requestFrame"),k}},d.prototype.onControlDisposed=function(a){this.renderers.forEach(function(b){b.removeResourcesForRenderCommand({id:a.id,content:a.renderCommand})})},d.prototype.clearImageCaches=function(){this.renderers.forEach(function(a){a.clearImageCache&&a.clearImageCache()})},b.exports=d},{"../eventsender":221,"../useragent-utils":358,"./math/aabb":332,"./math/mat4":334,lodash:128}],336:[function(a,b,c){"use strict";function d(a,b){e.call(this);var c=document.createElement("input");c.style.position="absolute",c.style.display="block",c.style.transformOrigin="0% 0%",c.style.padding="0px",c.style.margin="0px",c.style.border="none",c.style.outline="none",c.style.background="none",c.style.textAlign="left",c._noodlStyle={},this.element=c,this.inputListener=this.onInput.bind(this),this.blurListener=this.emit.bind(this,"blur"),c.addEventListener("keyup",this.inputListener),c.addEventListener("blur",this.blurListener),this.renderer=b,this.id=a}var e=a("../../../eventsender");d.prototype=Object.create(e.prototype),d.prototype.onInput=function(){this.emit("inputChanged",this.element.value)},d.prototype.focus=function(){this.element.style.visibility="visible",this.element._noodlStyle.visibility="visible",this.element.focus()},d.prototype.blur=function(){this.element.style.visibility="hidden",this.element._noodlStyle.visibility="hidden",this.element.blur()},d.prototype.setText=function(a){this.element.value=a},d.prototype.setType=function(a){this.element.type=a},d.prototype.dispose=function(){this.element.removeEventListener("input",this.inputListener),this.element.removeEventListener("blur",this.blurListener),this.renderer.removeInputField(this.id)},b.exports=d},{"../../../eventsender":221}],337:[function(a,b,c){"use strict";function d(a){this.rootElement=document.createElement(a.rootElementTag),this.rootElement.style.position="absolute",this.rootElement.style.display="block",this.rootElement.style.overflow="hidden",this.rootElement.style.pointerEvents="none",this.fillMode="aspectFit",this.viewportWidth=0,this.viewportHeight=0,this.onResizeCallback=a.onResize,this.onWindowResizeHandler=this._windowResizeListener.bind(this)}d.prototype._windowResizeListener=function(){"aspectFit"===this.fillMode&&this.resizeRootElement(),this.onResizeCallback&&this.onResizeCallback()},d.prototype.attach=function(a){a.appendChild(this.rootElement),window.addEventListener("resize",this.onWindowResizeHandler),this.resizeRootElement()},d.prototype.detach=function(){window.removeEventListener("resize",this.onWindowResizeHandler),this.rootElement.parentNode&&this.rootElement.parentNode.removeChild(this.rootElement)},d.prototype.setViewportSize=function(a,b){this.viewportWidth=a,this.viewportHeight=b,this.rootElement.parentNode&&"aspectFit"===this.fillMode&&this.resizeRootElement(),this.onResizeCallback&&this.onResizeCallback()},d.prototype._calculateAspectFit=function(){var a=this.viewportWidth,b=this.viewportHeight,c=1,d=1,e=a/b,f=this.rootElement.parentElement.getBoundingClientRect(),g=f.width/f.height;return e/g>1?d=g/e:c=e/g,{width:f.width*c,height:f.height*d}},d.prototype.resizeRootElementAspectFit=function(){var a=this._calculateAspectFit();this.rootElement.style.width=a.width+"px",this.rootElement.style.height=a.height+"px";var b=this.rootElement.parentElement.getBoundingClientRect(),c=Math.round(b.width-a.width)/2+"px",d=Math.round(b.height-a.height)/2+"px";this.rootElement.style.transform="translate("+c+","+d+")",this.rootElement.style.webkitTransform=this.rootElement.style.transform},d.prototype.resizeRootElementFill=function(){this.rootElement.style.width="100%",this.rootElement.style.height="100%",this.rootElement.style.transform="",this.rootElement.style.webkitTransform=""},d.prototype.resizeRootElement=function(){"aspectFit"===this.fillMode?this.resizeRootElementAspectFit():this.resizeRootElementFill(),this.onResizeCallback&&this.onResizeCallback()},d.prototype.setFillMode=function(a){this.fillMode=a,this.resizeRootElement()},b.exports=d},{}],338:[function(a,b,c){"use strict";function d(a){e.call(this,{rootElementTag:"canvas",onResize:this._onResize.bind(this)}),this.useScreenResolution=a.useScreenResolution?!0:!1}var e=a("./renderer-base");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype._onResize=function(){this.resizeCanvasBuffer()},d.prototype.resizeCanvasBuffer=function(){var a=this.rootElement.getBoundingClientRect(),b=window.devicePixelRatio||1;if("aspectFit"===this.fillMode){var c=Math.max(a.width*b/this.viewportWidth,a.height*b/this.viewportHeight);this.useScreenResolution===!1&&(c=Math.max(1,Math.round(c))),this.rootElement.width=this.viewportWidth*c,this.rootElement.height=this.viewportHeight*c,this.renderScale=this.rootElement.width/this.viewportWidth}else this.rootElement.width=a.width*b,this.rootElement.height=a.height*b,this.renderScale=b},b.exports=d},{"./renderer-base":337}],339:[function(a,b,c){"use strict";function d(a){j.call(this,a),this.coloredImagesCache=new k,this.rectangleBlurEdgeCache=new k,this.circleBlurCache=new k,this.circleStrokeBlurCache=new k,this.circleStrokeCache=new k,this.ctx=this.rootElement.getContext("2d",{alpha:a.alpha?!0:!1})}function e(a,b){for(var c=0;3>c;++c){var d=1+2*c;a[c]=parseInt(b.substring(d,d+2),16)}}function f(a,b,c){var d=Math.max(0,Math.min(1,(c-a)/(b-a)));return d*d*(3-2*d)}function g(a,b){var c=document.createElement("canvas"),d=c.getContext("2d");c.width=1,c.height=a;var g=d.createImageData(1,a);e(l,b);for(var h=0;a>h;h++){var i=f(0,1,h/(a-1));g.data[4*h]=l[0],g.data[4*h+1]=l[1],g.data[4*h+2]=l[2],g.data[4*h+3]=255*i}return d.putImageData(g,0,0),c}function h(a,b,c){var d=document.createElement("canvas"),g=d.getContext("2d");d.width=a+b,d.height=a+b;var h=g.createImageData(a+b,a+b);e(l,c);for(var i=0;i<h.height;i++)for(var j=0;j<h.width;j++){var k=Math.sqrt(j*j+i*i)-a,m=f(1,0,k/b),n=h.width-1-j+(h.height-1-i)*h.width;h.data[4*n]=l[0],h.data[4*n+1]=l[1],h.data[4*n+2]=l[2],h.data[4*n+3]=255*m}return g.putImageData(h,0,0),d}function i(a,b,c,d){var g=document.createElement("canvas"),h=g.getContext("2d");g.width=a+b,g.height=a+b;var i=h.createImageData(a+b,a+b);e(l,d);for(var j=0;j<i.height;j++)for(var k=0;k<i.width;k++){var m=Math.sqrt(k*k+j*j),n=0;m>=a-c-b&&a-c>=m?n=f(a-c-b,a-c,m):m>a-c&&a>m?n=1:m>=a&&(n=1-f(a,a+b,m));var o=i.width-1-k+(i.height-1-j)*i.width;i.data[4*o]=l[0],i.data[4*o+1]=l[1],i.data[4*o+2]=l[2],i.data[4*o+3]=255*n}return h.putImageData(i,0,0),g}var j=a("./renderer-canvas-base"),k=a("../resourcecache");d.prototype=Object.create(j.prototype),d.prototype.constructor=d,d.prototype.beginFrame=function(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.globalAlpha=1,this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.toPixel(this.viewportWidth),this.toPixel(this.viewportHeight))},d.prototype.endFrame=function(){},d.prototype.render=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=c.content.type;"pushClipRect"===d?this.pushClipRect(c):"popClipRect"===d?this.popClipRect():this._renderContent(c)}},d.prototype.drawColoredImage=function(a,b,c){var d=b.src+"."+c;if(this.coloredImagesCache.isInCache(d)===!1){var e=document.createElement("canvas");e.width=b.width,e.height=b.height;var f=e.getContext("2d",{alpha:!0});f.clearRect(0,0,e.width,e.height),f.drawImage(b,0,0,b.width,b.height),f.globalCompositeOperation="source-in",f.fillStyle=c,f.fillRect(0,0,b.width,b.height),this.coloredImagesCache.addResource(d,e)}return this.coloredImagesCache.updateReference(a,d),this.coloredImagesCache.getResource(d)},d.prototype._drawRoundedRect=function(a,b,c,d){2*c>a&&(c=a/2),2*c>b&&(c=b/2),this.ctx.beginPath(),this.ctx.moveTo(c,0),this.ctx.arcTo(a,0,a,b,c),this.ctx.arcTo(a,b,0,b,c),this.ctx.arcTo(0,b,0,0,c),this.ctx.arcTo(0,0,a,0,c),this.ctx.closePath(),"positive"===d?(this.ctx.save(),this.ctx.clip()):this.ctx.fill()};var l=[0,0,0];d.prototype._drawRectangleBlurred=function(a,b,c,d,f,i){2*d>b&&(d=b/2),2*d>c&&(d=c/2),d>0?(this.ctx.fillRect(d,0,b-2*d,d),this.ctx.fillRect(0,d,b,c-2*d),this.ctx.fillRect(d,c-d,b-2*d,d)):this.ctx.fillRect(0,0,b,c),e(l,i);var j=i+f;this.rectangleBlurEdgeCache.isInCache(j)===!1&&this.rectangleBlurEdgeCache.addResource(j,g(f,i)),this.rectangleBlurEdgeCache.updateReference(a,j);var k=i+d+"."+f;this.circleBlurCache.isInCache(k)===!1&&this.circleBlurCache.addResource(k,h(d,f,i)),this.circleBlurCache.updateReference(a,k);var m=this.rectangleBlurEdgeCache.getResource(j),n=this.circleBlurCache.getResource(k);this.ctx.drawImage(m,d,-f,b-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.save(),this.ctx.rotate(Math.PI/2),this.ctx.translate(0,-b),this.ctx.drawImage(m,d,-f,c-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.rotate(Math.PI/2),this.ctx.translate(0,-c),this.ctx.drawImage(m,d,-f,b-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.rotate(Math.PI/2),this.ctx.translate(0,-b),this.ctx.drawImage(m,d,-f,c-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.restore()},d.prototype._drawCircleBlurred=function(a,b,c,d,e){var f=d+b+"."+c;this.circleBlurCache.isInCache(f)===!1&&this.circleBlurCache.addResource(f,h(b,c,d)),this.circleBlurCache.updateReference(a,f);var g=this.circleBlurCache.getResource(f);this.ctx.save(),e<2*Math.PI&&(this.ctx.beginPath(),this.ctx.arc(b,b,b+c,-Math.PI/2,-Math.PI/2+e,!1),this.ctx.lineTo(b,b),this.ctx.clip()),this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c,-c-2*b,c+b,c+b),e>Math.PI/2&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c-2*b,-c-2*b,c+b,c+b),e>Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c-2*b,-c,c+b,c+b),e>1.5*Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c,-c,c+b,c+b)))),this.ctx.restore()},d.prototype._drawCircleStrokeBlurred=function(a,b,c,d,e,f){var g=d+b+"."+c+"."+f;this.circleStrokeBlurCache.isInCache(g)===!1&&this.circleStrokeBlurCache.addResource(g,i(b,c,f,d)),this.circleStrokeBlurCache.updateReference(a,g);var h=this.circleStrokeBlurCache.getResource(g);this.ctx.save(),e<2*Math.PI&&(this.ctx.beginPath(),this.ctx.arc(b,b,b+c,-Math.PI/2,-Math.PI/2+e,!1),this.ctx.lineTo(b,b),this.ctx.clip()),this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c,-c-2*b,c+b,c+b),e>Math.PI/2&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c-2*b,-c-2*b,c+b,c+b),e>Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c-2*b,-c,c+b,c+b),e>1.5*Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c,-c,c+b,c+b)))),this.ctx.restore()},d.prototype.toPixel=function(a){return a*this.renderScale},d.prototype._renderContent=function(a){var b=a.content.type;switch(this._setTransform(a.transform),this.ctx.globalAlpha=a.content.opacity,a.content.blendMode){case"alpha":this.ctx.globalCompositeOperation="source-over";break;case"solid":this.ctx.globalCompositeOperation="source-over";break;case"additive":this.ctx.globalCompositeOperation="lighter";break;case"multiply":this.ctx.globalCompositeOperation="multiply"}if("-undoMask"===a.id.slice(-9))return void this.ctx.restore();if("rectangle"===b){this.ctx.fillStyle=a.content.color;var c=Math.floor(this.toPixel(a.content.blur));c>0?this._drawRectangleBlurred(a.id,this.toPixel(a.width),this.toPixel(a.height),this.toPixel(a.content.cornerRadius),a.content.blur,a.content.color):a.content.cornerRadius>0?this._drawRoundedRect(this.toPixel(a.width),this.toPixel(a.height),this.toPixel(a.content.cornerRadius),a.content.maskType):this.ctx.fillRect(0,0,this.toPixel(a.width),this.toPixel(a.height))}else if("image"===b&&a.content.image){var d=a.content.image;"#ffffff"!==a.content.color&&(d=this.drawColoredImage(a.id,a.content.image,a.content.color)),this.ctx.drawImage(d,0,0,this.toPixel(a.width),this.toPixel(a.height))}else if("text"===b&&a.content.text){this.ctx.fillStyle=a.content.color,this.ctx.font=this.toPixel(a.content.fontSize)+'px "'+a.content.fontFamily+'"';for(var e=0;e<a.content.lines.length;e++){var f=a.content.lines[e];this.ctx.fillText(f.text,this.toPixel(f.x),this.toPixel(f.y))}}else if("textInput"===b&&a.content.text&&!a.content.focused){this.ctx.fillStyle=a.content.color,this.ctx.font=this.toPixel(a.content.fontSize)+'px "'+a.content.fontFamily+'"';var g=.5*(a.height-a.content.textHeight);this.ctx.fillText(a.content.text,0,this.toPixel(g+a.content.baseline))}else if("circle"===b){var h=a.width/2,c=Math.floor(this.toPixel(a.content.blur));if(c>1)a.content.solid?this._drawCircleBlurred(a.id,Math.floor(this.toPixel(h)),c,a.content.color,a.content.arcAngle):this._drawCircleStrokeBlurred(a.id,Math.floor(this.toPixel(h)),c,a.content.color,a.content.arcAngle,Math.floor(this.toPixel(a.content.lineWidth)));else{var i=a.width/2,g=a.height/2;if(this.ctx.beginPath(),a.content.solid||(h-=.5*a.content.lineWidth),this.ctx.arc(this.toPixel(i),this.toPixel(g),this.toPixel(h),-Math.PI/2,-Math.PI/2+a.content.arcAngle,!1),a.content.solid)if(a.content.arcAngle<2*Math.PI&&this.ctx.lineTo(this.toPixel(i),this.toPixel(g)),a.content.image){this.ctx.save(),this.ctx.clip();var d=a.content.image;"#ffffff"!==a.content.color&&(d=this.drawColoredImage(a.id,a.content.image,a.content.color)),this.ctx.drawImage(d,0,0,this.toPixel(a.width),this.toPixel(a.height)),this.ctx.restore()}else this.ctx.fillStyle=a.content.color,this.ctx.fill();else this.ctx.strokeStyle=a.content.color,this.ctx.lineWidth=Math.max(1,this.toPixel(a.content.lineWidth)),this.ctx.stroke()}}},d.prototype._setTransform=function(a){this.ctx.setTransform(a[0],a[1],a[4],a[5],this.toPixel(a[12]),this.toPixel(a[13]))},d.prototype.pushClipRect=function(a){this._setTransform(a.transform),this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(0,0,this.toPixel(a.width),this.toPixel(a.height)),this.ctx.clip()},d.prototype.popClipRect=function(){this.ctx.restore()},d.prototype.removeResourcesForRenderCommand=function(a){"image"===a.content.type||"circle"===a.content.type?this.coloredImagesCache.removeReference(a.id):"rectangle"===a.content.type?(this.rectangleBlurEdgeCache.removeReference(a.id),this.circleBlurCache.removeReference(a.id)):"circle"===a.content.type&&(this.circleBlurCache.removeReference(a.id),this.circleStrokeBlurCache.removeReference(a.id),this.circleStrokeCache.removeReference(a.id))},d.prototype.detach=function(){j.prototype.detach.call(this),this.coloredImagesCache.clear(),this.rectangleBlurEdgeCache.clear(),this.circleBlurCache.clear(),this.circleStrokeBlurCache.clear(),this.circleStrokeCache.clear()},b.exports=d},{"../resourcecache":351,"./renderer-canvas-base":338}],340:[function(a,b,c){"use strict";function d(a){var b=document.createElement(a);return b.style.position="absolute",b.style.display="block",b.style.pointerEvents="none",b.style.transformOrigin="0% 0%",b._noodlStyle={},b}function e(){j.call(this,{rootElementTag:"div",onResize:this._onResize.bind(this)}),this.rootElement.style.transformStyle="preserve-3d",this.rootElement.style.webkitTransformStyle="preserve-3d",this.elements={},this.unusedElements={},this.transformStack=[],this.textFields={},this.renderTextInputOnly=!1}function f(a,b,c){a._noodlStyle[b]!==c&&(a.style[b]=c,a._noodlStyle[b]=c)}function g(a,b,c){if(a.parentNode!==b||a.index!==c){c<b.children.length-1?b.insertBefore(a,b.children[c+1]):b.appendChild(a);for(var d=0;d<b.children.length;d++)b.children[d].index=d}}var h=a("../math/mat4"),i=a("./dom/dominputfield"),j=a("./renderer-base");e.prototype=Object.create(j.prototype),e.prototype.constructor=e,e.prototype.setRenderInputFieldsOnly=function(a){this.renderTextInputOnly=a},e.prototype._onResize=function(){"aspectFit"===this.fillMode?this.renderScale=this.rootElement.getBoundingClientRect().width/this.viewportWidth:this.renderScale=1},e.prototype.endFrame=function(){this._removeUnusedElements()},e.prototype._removeUnusedElements=function(){for(var a in this.elements)if(!this.elementsThisFrame[a]){var b=this.elements[a],c=b.parentNode;c.removeChild(b),delete this.elements[a],this.unusedElements[a]=b,b.index=void 0;for(var d=0;d<c.children.length;d++)c.children[d].index=d}},e.prototype._getTextInputCommands=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.content.type;("textInput"===e||"pushClipRect"===e||"popClipRect"===e)&&("popClipRect"===d.content.type&&"pushClipRect"===b[b.length-1].content.type?b.length=b.length-1:b.push(d))}return b},e.prototype.beginFrame=function(){this.elementsThisFrame={},this.nodeIndices=[0]},e.prototype.render=function(a){var b=this.nodeIndices;this.parentElement=this.rootElement,this.renderTextInputOnly&&(a=this._getTextInputCommands(a));for(var c=0;c<a.length;c++){var d=a[c],e=d.content.type;"pushClipRect"===e?(this.pushClipRect(d,b[b.length-1]),b[b.length-1]++,b.push(0)):"popClipRect"===e?(this.popClipRect(),b.pop()):(this._renderContent(d,b[b.length-1]),b[b.length-1]++)}};var k=h.create();e.prototype._setTransform=function(a,b){this.transformStack.length&&(h.identity(k),h.multiply(k,this.transformStack[this.transformStack.length-1],k),h.multiply(k,k,b),b=k);var c="matrix3d("+b[0]+","+b[1]+","+b[2]+","+b[3]+","+b[4]+","+b[5]+","+b[6]+","+b[7]+","+b[8]+","+b[9]+","+b[10]+","+b[11]+","+b[12]*this.renderScale+","+b[13]*this.renderScale+","+b[14]*this.renderScale+","+b[15]+")";a._noodlStyle.transform!==c&&(a._noodlStyle.transform=c,a.style.transform=c,a.style.webkitTransform=c)},e.prototype.createInputField=function(a){var b=new i(a,this);return this.textFields[a]=b,b},e.prototype.removeInputField=function(a){delete this.textFields[a]},e.prototype._renderContent=function(a,b){var c=a.id,e=a.content.type;if(!this.elements[c]){var h;this.unusedElements[c]?(h=this.unusedElements[c],delete this.unusedElements[c]):"rectangle"===e?h=d("div"):"image"===e?(h=d("div"),h.style.backgroundSize="100% 100%"):"text"===e?(h=d("div"),h.style.whiteSpace="nowrap"):"circle"===e?(h=d("div"),h.style.borderRadius="50%"):"textInput"===e&&(h=this.textFields[c].element),h.className=e,this.elements[c]=h}this.elementsThisFrame[c]=!0;var i=this.elements[c];g(i,this.parentElement,b),this._setTransform(i,a.transform),f(i,"width",a.width*this.renderScale+"px"),f(i,"height",a.height*this.renderScale+"px"),f(i,"opacity",a.content.opacity),"rectangle"===e?(f(i,"backgroundColor",a.content.color),f(i,"borderRadius",.5*a.content.cornerRadius+"px")):"image"===e?(f(i,"backgroundImage","url("+a.content.image.src+")"),"#ffffff"!==a.content.color?(f(i,"backgroundColor",a.content.color),f(i,"backgroundBlendMode","overlay"),f(i,"isolation","isolate")):(f(i,"backgroundColor",void 0),f(i,"backgroundBlendMode","normal"))):"text"===e?(f(i,"color",a.content.color),f(i,"fontFamily",a.content.fontFamily),f(i,"fontSize",a.content.fontSize*this.renderScale+"px"),f(i,"textAlign",a.content.horizontalAlignment),f(i,"lineHeight",a.content.lineHeight?a.content.lineHeight*this.renderScale+"px":"normal"),i.innerText!==a.content.text&&(i.innerText=a.content.text)):"textInput"===e?(f(i,"color",a.content.color),f(i,"fontFamily",a.content.fontFamily),f(i,"fontSize",a.content.fontSize*this.renderScale+"px"),a.content.focused||i.value===a.content.text||(i.value=a.content.text),this.renderTextInputOnly&&!a.content.focused&&f(i,"visibility","hidden")):"circle"===e&&(a.content.solid?f(i,"backgroundColor",a.content.color):f(i,"border",a.content.lineWidth+"px solid "+a.content.color))},e.prototype.pushClipRect=function(a,b){var c=a.id;if(!this.elements[c]){var e=d("div");e._noodlStyle={},e.style.overflow="hidden",this.elements[c]=e}this.elementsThisFrame[c]=!0;var i=this.elements[c];this._setTransform(i,a.transform),f(i,"width",a.width*this.renderScale+"px"),f(i,"height",a.height*this.renderScale+"px"),g(i,this.parentElement,b);var j=h.create();h.copy(j,a.transform),h.invert(j),this.transformStack.push(j),this.parentElement=i},e.prototype.popClipRect=function(){this.parentElement=this.parentElement.parentNode,this.transformStack.pop()},e.prototype.removeResourcesForRenderCommand=function(a){},b.exports=e},{"../math/mat4":334,"./dom/dominputfield":336,"./renderer-base":337}],341:[function(a,b,c){"use strict";function d(a){m.call(this,a);var b=this.rootElement.getContext("webgl",{alpha:a.alpha?!0:!1,stencil:!0});this.webGLHelper=new p(b,1080,1920),this.defaultShader=this.createShader({vertexSource:this.webGLHelper._defaultVsSource,fragmentSource:this.webGLHelper._defaultFsSource}),this.defaultTextShader=this._createDefaultTextShader(),this.clipRects=[o.create()],this.defaultMesh=this.webGLHelper.createMesh(),this.numVerticesThisFrame=0,this.textCache=new q(this.webGLHelper),this.circleCache={},this.roundedRectCache={},this.textureCache=new t(this.webGLHelper),this.tempVertices=new Float32Array(u*this.defaultShader.numComponentsPerVertex)}function e(a,b,c,d,e,f,g){a[0]=0,a[1]=0,a[2]=0,b[0]=e,b[1]=0,b[2]=0,c[0]=0,c[1]=f,c[2]=0,d[0]=e,d[1]=f,d[2]=0,n.transformPoint(g,a),n.transformPoint(g,b),n.transformPoint(g,c),n.transformPoint(g,d)}function f(a,b,c,d,e,f,g,h){var i=g.width,j=g.height;a[0]<h.min[0]&&(e[0]=(h.min[0]-a[0])/i,a[0]=h.min[0],c[0]=h.min[0]),a[1]<h.min[1]&&(e[1]=(h.min[1]-a[1])/j,a[1]=h.min[1],b[1]=h.min[1]),b[0]>h.max[0]&&(f[0]=(b[0]-h.max[0])/i,b[0]=h.max[0],d[0]=h.max[0]),c[1]>h.max[1]&&(f[1]=(c[1]-h.max[1])/j,c[1]=h.max[1],d[1]=h.max[1])}function g(a,b,c,d,e,f){var g=Math.min(a[0],b[0],c[0],d[0]),h=Math.min(a[1],b[1],c[1],d[1]),i=Math.max(a[0],b[0],c[0],d[0]),j=Math.max(a[1],b[1],c[1],d[1]),k=g<f.min[0]||h<f.min[1]||i>f.max[0]||j>f.max[1];k&&(e.scissorTest=!0,e.scissorRect[0]=f.min[0],e.scissorRect[1]=f.min[1],e.scissorRect[2]=f.max[0],e.scissorRect[3]=f.max[1])}function h(a){return 1!==a[0]||1!==a[5]||1!==a[10]}function i(a){return 0!==a[1]||0!==a[2]||0!==a[4]||0!==a[6]||0!==a[8]||0!==a[9]}function j(a,b){for(var c=0;3>c;++c){var d=1+2*c;a[c]=parseInt(b.substring(d,d+2),16)/255}}function k(a,b,c,d){var j=b.transform;e(w,x,y,z,b.width,b.height,j),A[0]=0,A[1]=0,B[0]=0,B[1]=0;var k=i(j)||h(j);k||0!==j[14]?g(w,x,y,z,c,d):f(w,x,y,z,A,B,b,d);var l=c.srcRect,m=l[2]-l[0],n=l[3]-l[1],o=c.color;a[0]=w[0],a[1]=w[1],a[2]=w[2],a[3]=l[0]+A[0]*m,a[4]=l[1]+A[1]*n,a[5]=o[0]*b.content.opacity,a[6]=o[1]*b.content.opacity,a[7]=o[2]*b.content.opacity,a[8]=b.content.opacity,a[9]=x[0],a[10]=x[1],a[11]=x[2],a[12]=l[2]-B[0]*m,a[13]=a[4],a[14]=a[5],a[15]=a[6],a[16]=a[7],a[17]=a[8],a[18]=y[0],a[19]=y[1],a[20]=y[2],a[21]=a[3],a[22]=l[3]-B[1]*n,a[23]=a[5],a[24]=a[6],a[25]=a[7],a[26]=a[8],a[27]=z[0],a[28]=z[1],a[29]=z[2],a[30]=a[12],a[31]=a[22],a[32]=a[5],a[33]=a[6],a[34]=a[7],a[35]=a[8]}function l(a,b,c,d,f){d.mesh=a,d.shader=b,b&&-1!==b.standardUniforms.u_world&&(d.worldTransform=c.transform),e(w,x,y,z,c.width,c.height,c.transform),g(w,x,y,z,d,f)}var m=a("./renderer-canvas-base"),n=a("../math/mat4"),o=a("../math/aabb"),p=a("./webgl/webglhelper"),q=a("./webgl/text-cache"),r=a("./webgl/circle"),s=a("./webgl/roundedrect"),t=a("./webgl/texturecache"),u=4;d.prototype=Object.create(m.prototype),d.prototype.constructor=d,d.prototype.createShader=function(a){return this.webGLHelper.createShader(a)},d.prototype._onResize=function(){m.prototype._onResize.call(this),o.set(this.clipRects[0],0,0,this.viewportWidth,this.viewportHeight),this.webGLHelper.setVirtualSize(this.viewportWidth,this.viewportHeight),this.webGLHelper.setRenderBufferSize(this.rootElement.width,this.rootElement.height)},d.prototype.render=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.content.type;if("pushClipRect"===e)this.pushClipRect(d);else if("popClipRect"===e)this.popClipRect();else{var f="textInput"===d.content.type&&d.content.focused;f===!1&&this._renderContent(d,b)}}for(c=0;c<b.length;c++)this.webGLHelper.executeRenderCommand(b[c])},d.prototype.pushClipRect=function(a){var b=o.create();o.set(b,0,0,a.width,a.height),o.transform4(b,a.transform),o.intersection(b,this.clipRects[this.clipRects.length-1]),this.clipRects.push(b)},d.prototype.popClipRect=function(){this.clipRects.pop()};var v=[0,0,1,1];d.prototype._renderContent=function(a,b){var c={texture:null,blendMode:p.BlendMode.Alpha,mesh:null,depthTest:!1,vertexIndex:-1,opacity:a.content.opacity,scissorTest:!1,scissorRect:[0,0,0,0],srcRect:a.content.srcRect||v,flipTexCoordY:0,writeToStencil:!1,maskIsPositive:!1,shader:this.defaultShader,worldTransform:null,color:[0,0,0]};switch(a.content.shader&&(c.shader=a.content.shader,a.content.shaderUniforms&&(c.shaderUniforms=a.content.shaderUniforms)),a.content.blendMode){case"alpha":c.blendMode=p.BlendMode.Alpha;break;case"solid":c.blendMode=p.BlendMode.Solid;break;case"additive":c.blendMode=p.BlendMode.Additive;break;case"multiply":c.blendMode=p.BlendMode.Multiply}if("solid"===a.content.blendMode&&a.content.opacity<1&&(c.blendMode=p.BlendMode.Alpha),a.content.maskType&&"none"!==a.content.maskType&&(c.writeToStencil=!0,c.maskIsPositive="positive"===a.content.maskType),j(c.color,a.content.color),a.content.image?(c.texture=this.textureCache.getTexture(a.content.imagePath,a.content.image),c.texture.refCount=1,c.texture.videoDOMNode&&c.texture.updateVideoTexture()):"text"===a.content.type||"textInput"===a.content.type?(c.texture=this.textCache.getTextTexture(a,this.renderScale,a.content.color),c.shader=this.defaultTextShader):c.texture=this.webGLHelper.whiteTexture(),"circle"===a.content.type){var d=this._getCircle(a);this.circleShader||(this.circleShader=r.createShader(this.webGLHelper)),l(d.getMesh(),this.circleShader,a,c,this.clipRects[this.clipRects.length-1])}else if("rectangle"===a.content.type&&s.cornerTooSmall(a.content.cornerRadius,a.content.blur)===!1){var e=this._getRoundedRectangle(a);this.roundedRectangleShader||(this.roundedRectangleShader=s.createShader(this.webGLHelper)),l(e.getMesh(),this.roundedRectangleShader,a,c,this.clipRects[this.clipRects.length-1])}else"mesh"===a.content.type&&a.content.mesh&&a.content.shader&&a.content.mesh.vertices&&a.content.mesh.vertices.length>0?l(a.content.mesh,a.content.shader,a,c,this.clipRects[this.clipRects.length-1]):(k(this.tempVertices,a,c,this.clipRects[this.clipRects.length-1]),c.vertexIndex=this.numVerticesThisFrame,this.numVerticesThisFrame+=this.tempVertices.length,this.numVerticesThisFrame*this.defaultShader.numComponentsPerVertex>this.defaultMesh.vertices.length&&(this.defaultMesh.vertices=new Float32Array(this.numVerticesThisFrame*this.defaultShader.numComponentsPerVertex*u*2)),c.mesh=this.defaultMesh,this.defaultMesh.vertices.set(this.tempVertices,c.vertexIndex*this.defaultShader.numComponentsPerVertex),this.defaultMesh.vertexDataDirty=!0);b.push(c)},d.prototype.removeResourcesForRenderCommand=function(a){"rectangle"===a.content.type&&this.roundedRectCache.hasOwnProperty(a.id)?(this.roundedRectCache[a.id].dispose(),delete this.roundedRectCache[a.id]):"circle"===a.content.type&&this.circleCache.hasOwnProperty(a.id)?(this.circleCache[a.id].dispose(),delete this.circleCache[a.id]):("text"===a.content.type||"textInput"===a.content.type)&&this.textCache.textResourceRemoved(a.id)},d.prototype.beginFrame=function(){this.webGLHelper.beginFrame(),this.webGLHelper.bindRenderTarget(0),this.numVerticesThisFrame=0},d.prototype.endFrame=function(){},d.prototype._getCircle=function(a){this.circleCache[a.id]||(this.circleCache[a.id]=new r(this.webGLHelper));var b=this.circleCache[a.id];return b.setSize(a.width),b.setArcAngle(a.content.arcAngle),b.setSolid(a.content.solid),b.setLineWidth(a.content.lineWidth),b.setBlur(Math.max(1,a.content.blur)),b.updateMesh(),b},d.prototype._getRoundedRectangle=function(a){this.roundedRectCache[a.id]||(this.roundedRectCache[a.id]=new s(this.webGLHelper));var b=this.roundedRectCache[a.id];return b.setWidth(a.width),b.setHeight(a.height),b.setBlur(a.content.blur),b.setCornerRadius(a.content.cornerRadius),b.updateMesh(),b},d.prototype.detach=function(){m.prototype.detach.call(this),this.textCache.clear(),this.textureCache.clear();var a=this.roundedRectCache;Object.keys(a).forEach(function(b){a[b].dispose()});var b=this.circleCache;Object.keys(b).forEach(function(a){b[a].dispose()})},d.prototype.clearImageCache=function(){this.textureCache.clear()};var w=[0,0,0],x=[0,0,0],y=[0,0,0],z=[0,0,0],A=[0,0],B=[0,0];d.prototype._createDefaultTextShader=function(){return this.createShader({vertexSource:["uniform mat4 u_projection;","uniform mat4 u_view;","attribute vec3 a_position;","attribute vec2 a_uv;","attribute vec4 a_color;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","   gl_Position = u_projection * u_view * vec4(a_position, 1.0);","   uv = a_uv;","   color = a_color;","}"].join("\n"),fragmentSource:["uniform sampler2D texture;","uniform lowp float u_opacity;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    lowp vec4 texColor = texture2D(texture, uv);","    gl_FragColor = texColor*color.a;","}"].join("\n")})},b.exports=d},{"../math/aabb":332,"../math/mat4":334,"./renderer-canvas-base":338,"./webgl/circle":342,"./webgl/roundedrect":345,"./webgl/text-cache":347,"./webgl/texturecache":349,"./webgl/webglhelper":350}],342:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a,b){b=b||{},this.solid=b.hasOwnProperty("solid")?b.solid:!0,this.radius=b.size/2||100,this.lineWidth=b.lineWidth||1,this.blurDistance=b.hasOwnProperty("blur")?b.blur:2,
this.arcAngle=b.hasOwnProperty("arcAngle")?d(0,2*Math.PI,b.arcAngle):2*Math.PI,this.error=b.error||.075,this.meshDirty=!0,this._calculateVertices(),this.mesh=a.createMesh({vertices:this.vertices,indices:this.indices,primitiveType:g.PrimitiveType.TriangleStrip})}function f(a){var b=["uniform mat4 u_projection;","uniform mat4 u_view;","uniform mat4 u_world;","uniform mediump vec4 u_srcRect;","uniform lowp float u_flipTexCoordY;","attribute vec2 a_position;","attribute vec2 a_uv;","attribute float aBlur;","attribute float aVertexOpacity;","varying mediump vec2 uv;","varying lowp float blur;","varying lowp float vertexOpacity;","void main(void) {","   gl_Position = u_projection * u_view * u_world * vec4(a_position, 0.0, 1.0);","   uv = u_srcRect.xy + a_uv * (u_srcRect.zw - u_srcRect.xy);","   if(u_flipTexCoordY > 0.0) { uv.y = 1.0 - uv.y; }","   blur = aBlur;","   vertexOpacity = aVertexOpacity;","}"].join("\n"),c=["uniform sampler2D texture;","uniform lowp vec3 u_color;","uniform lowp float u_opacity;","varying mediump vec2 uv;","varying lowp float blur;","varying lowp float vertexOpacity;","void main(void) {","   lowp float intensity = smoothstep(0.0, 1.0, blur*vertexOpacity);","   gl_FragColor = texture2D(texture, uv)*vec4(u_color,1.0)*(u_opacity*intensity);","}"].join("\n");return a.createShader({vertexSource:b,fragmentSource:c})}var g=a("./mesh");e.prototype._calculateVertices=function(){function a(a,c,d,e){var f=Math.cos(d-.5*Math.PI),g=Math.sin(d-.5*Math.PI);n[i++]=a+b*f,n[i++]=c+b*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=0,n[i++]=e,n[i++]=a+p*f,n[i++]=c+p*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=1,n[i++]=e,n[i++]=a+j*f,n[i++]=c+j*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=1,n[i++]=e,n[i++]=a+k*f,n[i++]=c+k*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=0,n[i++]=e}var b=this.radius+this.blurDistance,c=Math.acos(2*(1-this.error/b)*(1-this.error/b)-1),d=Math.ceil(this.arcAngle/c),e=24,f=this.arcAngle<2*Math.PI;this.arcAngle>0&&4>d&&(d=2);var g=d;f&&(g+=2);var h=g*e;this.vertices&&this.vertices.length===h||(this.vertices=new Float32Array(h));var i=0,j=this.radius-this.lineWidth,k=j-this.blurDistance,l=this.radius,m=this.radius;this.solid&&(j=0,k=0);var n=this.vertices,o=this.blurDistance,p=this.radius;f&&a(l,m-this.blurDistance,0,0);var q;for(q=0;d>q;++q){var r=q/(d-1),s=this.arcAngle*r;a(l,m,s,1)}f&&a(l-Math.sin(this.arcAngle)*o,m+Math.cos(this.arcAngle)*o,this.arcAngle,0);var t=8*(g-1);for(this.indices&&this.indices.length===t||(this.indices=new Uint16Array(t)),i=0,q=0;g-1>q;++q){var u;if(q%2===0)for(u=0;4>u;++u)this.indices[i++]=4*q+u,this.indices[i++]=4*(q+1)+u;else for(u=0;4>u;++u)this.indices[i++]=4*q+3-u,this.indices[i++]=4*(q+1)+3-u}},e.prototype.updateMesh=function(){this.meshDirty!==!1&&(this._calculateVertices(),this.mesh.vertices=this.vertices,this.mesh.indices=this.indices,this.mesh.vertexDataDirty=!0,this.meshDirty=!1)},e.prototype.setSize=function(a){this.radius!==a/2&&(this.radius=a/2,this.meshDirty=!0)},e.prototype.setLineWidth=function(a){this.lineWidth!==a&&(this.lineWidth=a,this.meshDirty=!0)},e.prototype.setSolid=function(a){this.solid!==a&&(this.solid=a,this.meshDirty=!0)},e.prototype.setBlur=function(a){this.blurDistance!==a&&(this.blurDistance=a,this.meshDirty=!0)},e.prototype.setArcAngle=function(a){a=d(0,2*Math.PI,a),this.arcAngle!==a&&(this.arcAngle=a,this.meshDirty=!0)},e.prototype.getMesh=function(){return this.mesh},e.prototype.dispose=function(){this.mesh.dispose()},e.createShader=function(a){return f(a)},b.exports=e},{"./mesh":344}],343:[function(a,b,c){"use strict";function d(a,b){this.texture=b.texture;var c,d,e=a.getParameter(a.FRAMEBUFFER_BINDING),f=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,f),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texture.handle,0),d=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,d),a.renderbufferStorage(a.RENDERBUFFER,a.STENCIL_INDEX8,b.width,b.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,d),b.depthBuffer&&(c=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,c),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,b.width,b.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,c));var g=a.checkFramebufferStatus(a.FRAMEBUFFER);switch(g){case a.FRAMEBUFFER_COMPLETE:break;case a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case a.FRAMEBUFFER_UNSUPPORTED:console.log("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;default:console.log("Incomplete framebuffer: "+g)}a.bindFramebuffer(a.FRAMEBUFFER,e),this.fbo=f,this.gl=a,this.width=b.width,this.height=b.height}b.exports=d},{}],344:[function(a,b,c){"use strict";function d(a,b){b=b||{},void 0===b.vertices&&(b.vertices=new Float32Array(0)),b.vertices instanceof Float32Array==!1&&console.error("Vertices must be of type Float32Array"),b.indices&&b.indices instanceof Uint16Array==!1&&console.error("Indices must be of type Uint16Array"),this.gl=a,this.vertexBuffer=a.createBuffer(),this.vertices=b.vertices,this.indexBuffer=null,this.indices=b.indices,b.primitiveType===d.PrimitiveType.Triangles?this.primitiveType=a.TRIANGLES:b.primitiveType===d.PrimitiveType.Lines?this.primitiveType=a.LINES:b.primitiveType===d.PrimitiveType.LineStrip?this.primitiveType=a.LINE_STRIP:b.primitiveType===d.PrimitiveType.TriangleFan?this.primitiveType=a.TRIANGLE_FAN:this.primitiveType=a.TRIANGLE_STRIP,this.vertexDataDirty=!0}d.prototype.bind=function(a,b){var c=this.gl;this.numComponentsPerVertex=b,c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);var d,e=0;for(d=c.numVertexAttribsEnabled;d<a.length;++d)c.enableVertexAttribArray(d);for(d=a.length;d<c.numVertexAttribsEnabled;++d)c.disableVertexAttribArray(d);for(c.numVertexAttribsEnabled=a.length,d=0;d<a.length;++d){var f=a[d];c.vertexAttribPointer(d,f.numComponents,c.FLOAT,!1,4*b,4*e),e+=f.numComponents}null===this.indexBuffer&&this.indices&&this.indices.length>0&&(this.indexBuffer=c.createBuffer()),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer)},d.prototype.syncVertexData=function(){var a=this.gl;this.vertexDataDirty&&(this.indices&&this.indices.length>0&&a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),a.bufferData(a.ARRAY_BUFFER,this.vertices,a.STREAM_DRAW),this.vertexDataDirty=!1)},d.prototype.draw=function(){this.syncVertexData();var a=this.gl,b=0;this.indexBuffer?a.drawElements(this.primitiveType,this.indices.length,a.UNSIGNED_SHORT,0):(b=this.vertices.length/this.numComponentsPerVertex,a.drawArrays(this.primitiveType,0,b))},d.prototype.drawVertexRange=function(a,b){this.syncVertexData();var c=this.gl;this.indexBuffer?c.drawElements(this.primitiveType,b,c.UNSIGNED_SHORT,2*a):c.drawArrays(this.primitiveType,a,b)},d.prototype.dispose=function(){this.gl.deleteBuffer(this.vertexBuffer),this.indexBuffer&&this.gl.deleteBuffer(this.indexBuffer)},d.PrimitiveType={TriangleStrip:0,Triangles:1,Lines:2,LineStrip:3,TriangleFan:4},b.exports=d},{}],345:[function(a,b,c){"use strict";function d(a){this.width=0,this.height=0,this.mesh=a.createMesh({vertices:new Float32Array(0),indices:new Uint16Array(0),primitiveType:e.PrimitiveType.TriangleStrip})}var e=a("./mesh");d.createShader=function(a){var b=["uniform mat4 u_projection;","uniform mat4 u_view;","uniform mat4 u_world;","uniform mediump vec4 u_srcRect;","uniform lowp float u_flipTexCoordY;","attribute vec2 a_position;","attribute vec2 a_uv;","attribute float a_blur;","varying mediump vec2 uv;","varying lowp float blur;","void main(void) {","   gl_Position = u_projection * u_view * u_world * vec4(a_position, 0.0, 1.0);","   uv = u_srcRect.xy + a_uv * (u_srcRect.zw - u_srcRect.xy);","   if(u_flipTexCoordY > 0.0) { uv.y = 1.0 - uv.y; }","   blur = a_blur;","}"].join("\n"),c=["uniform sampler2D texture;","uniform lowp vec3 u_color;","uniform lowp float u_opacity;","varying mediump vec2 uv;","varying lowp float blur;","void main(void) {","   lowp float intensity = smoothstep(0.0, 1.0, blur);","   gl_FragColor = texture2D(texture, uv)*vec4(u_color,1.0)*(u_opacity*intensity);","}"].join("\n");return a.createShader({vertexSource:b,fragmentSource:c})},d.prototype._generateMesh=function(){function a(a){return(a.numSegments+1)*s}function b(){var b=0;return k.forEach(function(c){b+=a(c)*p}),b}function c(){var a=0;k.forEach(function(b){a+=b.numSegments});var b=4,c=6,d=5,e=c*b+d,f=6;return a*f+e}function d(a,b,c,d,e){for(var f=b.radius+n,g=r/b.numSegments,h=0;h<=b.numSegments;++h){var i=Math.cos(e+h*g),j=Math.sin(e+h*g);a[o++]=c,a[o++]=d,a[o++]=a[o-3]/l,a[o++]=a[o-3]/m,a[o++]=1,a[o++]=c+b.radius*i,a[o++]=d-b.radius*j,a[o++]=a[o-3]/l,a[o++]=a[o-3]/m,a[o++]=1,a[o++]=c+f*i,a[o++]=d-f*j,a[o++]=a[o-3]/l,a[o++]=a[o-3]/m,a[o++]=0}}function e(a){d(a,k[0],k[0].radius,k[0].radius,Math.PI/2),d(a,k[1],k[1].radius,m-k[1].radius,Math.PI),d(a,k[2],l-k[2].radius,m-k[2].radius,3*Math.PI/2),d(a,k[3],l-k[3].radius,k[3].radius,0)}function f(a,b,c){for(var d=c.startFromVertexIndex,e=c.startFromInnerEdge===!0?0:1,f=0;f<b.numSegments;++f){var g;if(f%2===e){for(g=0;s>g;++g)a[o++]=f*s+g+d,a[o++]=(f+1)*s+g+d;c.startFromInnerEdge=!1}else{for(g=0;s>g;++g)a[o++]=f*s+(s-1)-g+d,a[o++]=(f+1)*s+(s-1)-g+d;c.startFromInnerEdge=!0}}c.startFromVertexIndex=a[o-1]}function g(a,b){var c,d,e=t/p;b.startFromInnerEdge===!0?(c=b.startFromVertexIndex+s,d=b.startFromVertexIndex,a[o++]=d,a[o++]=c%e,a[o++]=d+1,a[o++]=(c+1)%e,a[o++]=d+2,a[o++]=(c+2)%e,b.startFromInnerEdge=!1):b.startFromInnerEdge===!1&&(c=b.startFromVertexIndex+1,d=b.startFromVertexIndex,a[o++]=d,a[o++]=(c+2)%e,a[o++]=d-1,a[o++]=(c+1)%e,a[o++]=d-2,a[o++]=c%e,b.startFromInnerEdge=!0),b.startFromVertexIndex=c}function h(b){var c=[a(k[0]),a(k[1]),a(k[2]),a(k[3])];b[o++]=0,b[o++]=0,b[o++]=c[0]+c[1]+c[2],b[o++]=c[0],b[o++]=c[0]+c[1]}function i(a){var b={startFromInnerEdge:!0,startFromVertexIndex:0};o=0,f(a,k[0],b),g(a,b),f(a,k[1],b),g(a,b),f(a,k[2],b),g(a,b),f(a,k[3],b),g(a,b),h(a)}function j(){k.forEach(function(a){if(0===a.radius)a.numSegments=1;else{var b=1-q/(a.radius+n),c=Math.acos(2*b*b-1);a.numSegments=Math.ceil(r/c)}})}var k=this.corners,l=this.width,m=this.height,n=this.blurDistance,o=0,p=5,q=.2,r=Math.PI/2,s=3;j();var t=b();(void 0===this.vertices||this.vertices.length!==t)&&(this.vertices=new Float32Array(t)),e(this.vertices);var u=c();(void 0===this.indices||this.indices.length!==u)&&(this.indices=new Uint16Array(u)),i(this.indices),this.mesh.vertices=this.vertices,this.mesh.indices=this.indices,this.mesh.vertexDataDirty=!0},d.prototype.setCornerRadius=function(a){a=Math.max(0,a),this.corners&&this.corners[0].radius===a&&this.corners[1].radius===a&&this.corners[2].radius===a&&this.corners[3].radius===a||(a=Math.max(1,a),this.corners=[{radius:a},{radius:a},{radius:a},{radius:a}],this.meshDirty=!0)},d.prototype.setIndividualCornerRadii=function(a,b,c,d){this.corners=[{radius:Math.max(0,a)},{radius:Math.max(0,b)},{radius:Math.max(0,c)},{radius:Math.max(0,d)}],this.meshDirty=!0},d.prototype.updateMesh=function(){this.meshDirty!==!1&&(this._generateMesh(),this.meshDirty=!1)},d.cornerTooSmall=function(a,b){var c=.1;return c>a+b},d.prototype.setBlur=function(a){this.blurDistance!==a&&(this.blurDistance=a,this.meshDirty=!0)},d.prototype.setWidth=function(a){this.width!==a&&(this.width=a,this.meshDirty=!0)},d.prototype.setHeight=function(a){this.height!==a&&(this.height=a,this.meshDirty=!0)},d.prototype.setBlur=function(a){this.blurDistance!==a&&(this.blurDistance=a,this.meshDirty=!0)},d.prototype.dispose=function(){this.mesh.dispose()},d.prototype.getMesh=function(){return this.mesh},b.exports=d},{"./mesh":344}],346:[function(a,b,c){"use strict";function d(a,b,c){var d=a.createShader(c);if(a.shaderSource(d,b),a.compileShader(d),!a.getShaderParameter(d,a.COMPILE_STATUS))throw new Error("An error occurred compiling a shader: "+a.getShaderInfoLog(d));return d}function e(a,b){var c=1;switch(b.type){case"float":c=1;break;case"vec2":c=2;break;case"vec3":c=3;break;case"vec4":c=4}return{name:b.name,numComponents:c}}function f(a,b){var c,d=[],e=new RegExp(b+"\\s*([^;]*)","g");do if(c=e.exec(a)){var f=c[1].split(" ");3===f.length&&f.splice(0,1),d.push({type:f[0],name:f[1]})}while(c);return d}function g(a,b,c){var d,e=f(c,"attribute"),g=a.getProgramParameter(b,a.ACTIVE_ATTRIBUTES),h={};for(d=0;g>d;++d)h[a.getActiveAttrib(b,d).name]=!0;for(d=0;d<e.length;)h[e[d].name]!==!0?e.splice(d,1):d++;return e}function h(a,b){function c(a){a.forEach(function(a){d.some(function(b){return b.name===a.name})===!1&&d.push(a)})}var d=[];return c(f(a,"uniform")),c(f(b,"uniform")),d}function i(a){switch(a){case"float":return 0;case"vec2":return[0,0];case"vec3":return[0,0,0];case"vec4":return[0,0,0,0]}return 0}function j(a,b,c){function d(d,e,f){Object.defineProperty(d,e,{set:function(d){null===c.value&&(c.value=i(b)),c.value[f]=d,a.hasDirtyUniforms=!0},get:function(){return c.value[f]}})}for(var e=Number(b[b.length-1]),f={},g=0;e>g;g++)for(var h=0;h<m[g].length;h++)d(f,m[g][h],g);return Object.defineProperty(f,"array",{get:function(){return c.value},set:function(a){if(a.length!==e)throw new Error("Uniform array: Array must be of size "+e);c.value=a}}),Object.freeze(f)}function k(a,b){if(!b.vertexSource)throw new Error("No vertex shader source");if(!b.fragmentSource)throw new Error("No fragment shader source");if(b.uniforms&&Array.isArray(b.uniforms))throw new Error("WebGLShader: old style uniforms is unsupported");this.program=a.createProgram(),this.attributes=[];var c=d(a,b.vertexSource,a.VERTEX_SHADER),f=b.fragmentSource+"\nvoid _haxAndroidShaderCache() { lowp float hax="+Math.random()+";}",j=d(a,f,a.FRAGMENT_SHADER);if(a.attachShader(this.program,c),a.attachShader(this.program,j),a.linkProgram(this.program),!a.getProgramParameter(this.program,a.LINK_STATUS))throw new Error("Unable to initialize the shader program.");var k=0,m=this,n=g(a,this.program,b.vertexSource);n.forEach(function(b,c){a.bindAttribLocation(m.program,c,b.name);var d=e(a,b);m.attributes.push(d),k+=d.numComponents}),a.linkProgram(this.program),this.numComponentsPerVertex=k,this.standardUniforms={},this._uniforms={};var o=h(b.vertexSource,b.fragmentSource);o.forEach(function(b){var c=a.getUniformLocation(m.program,b.name);l[b.name]?m.standardUniforms[b.name]=c:m._uniforms[b.name]={type:b.type,location:c,value:i(b.type)}}),this.uniforms=this.createUniformSetters(this._uniforms),this.uniformNames=Object.keys(this._uniforms),this.hasDirtyUniforms=!0}var l={texture:!0,u_view:!0,u_projection:!0,u_world:!0,u_opacity:!0,u_color:!0,u_srcRect:!0,u_flipTexCoordY:!0},m=[["x","r","u"],["y","g","v"],["z","b"],["w","a"]];k.prototype.createUniformSetters=function(a){var b={},c=this;return Object.keys(this._uniforms).forEach(function(d){var e=c._uniforms[d];"vec"!==e.type.substring(0,3)?Object.defineProperty(b,d,{set:function(b){a[d].value=b,c.hasDirtyUniforms=!0},get:function(){return a[d].value}}):b[d]=j(c,e.type,a[d])}),b},b.exports=k},{}],347:[function(a,b,c){"use strict";function d(a){this.webGLHelper=a,this.textureCache=new e({freelistSize:50}),this.canvas=document.createElement("canvas")}var e=a("../../resourcecache");d.prototype._createNewTextTexture=function(a,b,c){var d=this.canvas;d.width=a.width*b,d.height=a.height*b;var e=d.getContext("2d");if(e.clearRect(0,0,d.width,d.height),e.font=a.content.fontSize*b+'px "'+a.content.fontFamily+'"',e.fillStyle=c,"text"===a.content.type)for(var f=0;f<a.content.lines.length;f++){var g=a.content.lines[f];e.fillText(g.text,g.x*b,g.y*b)}else if("textInput"===a.content.type){var h=.5*(a.height-a.content.textHeight);e.fillText(a.content.text,0,b*(h+a.content.baseline))}return this.webGLHelper.createTexture({canvas:d})},d.prototype.getTextTexture=function(a,b,c,d){var e=b+""+a.content.fontSize+a.content.fontFamily+c;return e+="text"===a.content.type?a.content.lines.map(function(a){return a.x+" "+a.text}).join(""):a.content.text,this.textureCache.isInCache(e)===!1&&this.textureCache.addResource(e,this._createNewTextTexture(a,b,c)),this.textureCache.updateReference(a.id,e),this.textureCache.getResource(e)},d.prototype.textResourceRemoved=function(a){this.textureCache.removeReference(a)},d.prototype.clear=function(){this.textureCache.clear()},b.exports=d},{"../../resourcecache":351}],348:[function(a,b,c){"use strict";function d(a,b){this.handle=0,this.size=[0,0],this.loaded=!1,this.path=null,this.target=null,this.gl=a,this.refCount=0,this.preloadedAndUnused=!1,this.keepForever=!1,this.sizeCallbacks=[],this._pixelDataChangedListeners=[],b.wrapMode=b.wrapMode||d.WrapMode.Clamp,b.filter=b.filter||d.Filter.Linear,b.pixels?this._uploadPixelData(b.pixels,b.width,b.height,b.wrapMode,b.filter):b.path instanceof Array?6==b.path.length?this._uploadCubemap(b.resourceDirectory,b.path,b.wrapMode,b.filter):console.error("Cubemap requries six image paths"):b.path&&b.domElement?this._uploadDomElement(b.domElement,b.path,b.wrapMode,b.filter):b.path?this._uploadImageData(b.resourceDirectory,b.path,b.wrapMode,b.filter):b.canvas?this._uploadCanvas(b.canvas,b.wrapMode,b.filter):b.video?this._uploadVideo(b.video,b.wrapMode,b.filter):this._uploadEmptyTexture(b.width,b.height,b.wrapMode,b.filter)}var e=0;d.prototype._uploadEmptyTexture=function(a,b,c,d){var e=this.gl;this._createAndBindHandle(e.TEXTURE_2D,c,d),e.texImage2D(this.target,0,e.RGBA,a,b,0,e.RGBA,e.UNSIGNED_BYTE,null),this._textureDataLoaded(a,b)},d.prototype._uploadPixelData=function(a,b,c,d,e){if(Array.isArray(a))a=new Uint8Array(a);else if(a instanceof Uint8Array==!1)throw new Error("pixels must be an array or Uint8Array");var f=this.gl;this._createAndBindHandle(f.TEXTURE_2D,d,e),f.bindTexture(this.target,this.handle),f.texImage2D(this.target,0,f.RGBA,b,c,0,f.RGBA,f.UNSIGNED_BYTE,a),this._textureDataLoaded(b,c)},d.prototype._uploadVideo=function(a,b,c){this.videoDOMNode=a,this._createAndBindHandle(this.gl.TEXTURE_2D,b,c)},d.prototype._uploadImageData=function(a,b,c,d){var e=this.gl;this._createAndBindHandle(e.TEXTURE_2D,c,d);var f="http"===b.substring(0,4).toLowerCase(),g=new Image;f&&(g.crossOrigin="anonymous");var h=this;g.onload=function(){e.bindTexture(h.target,h.handle),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(h.target,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this),h._textureDataLoaded(this.width,this.height)},g.src=a+b,this.path=b},d.prototype._uploadDomElement=function(a,b,c,d){if("video"===a.tagName.toLowerCase())this._uploadVideo(a,c,d);else{var e=this.gl;this._createAndBindHandle(e.TEXTURE_2D,c,d),e.bindTexture(this.target,this.handle),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(this.target,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),this._textureDataLoaded(a.width,a.height)}this.path=b},d.prototype._uploadCubemap=function(a,b,c,d){var e=this.gl;this._createAndBindHandle(e.TEXTURE_CUBE_MAP,c,d);for(var f=[e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_Z],g=this,h=0;6>h;++h){var i=new Image;i.crossOrigin="anonymous",i.onload=function(a){return function(){e.bindTexture(g.target,g.handle),e.texImage2D(f[a],0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this),g._textureDataLoaded(this.width,this.height)}}(h),i.src=a+b[h]}},d.prototype._uploadCanvas=function(a,b,c){var d=this.gl;this._createAndBindHandle(d.TEXTURE_2D,b,c),d.bindTexture(this.target,this.handle),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),d.texImage2D(this.target,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,a);var e=window.devicePixelRatio||1;this._textureDataLoaded(a.width/e,a.height/e)},d.prototype.updateVideoTexture=function(){var a=this.videoDOMNode;if(a.readyState===a.HAVE_ENOUGH_DATA){var b=this.gl;b.bindTexture(this.target,this.handle),b.texImage2D(this.target,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a),this.loaded===!1&&this._textureDataLoaded(a.videoWidth,a.videoHeight),this._notifyPixleDataChangedListeners()}},d.prototype.addPixelDataChangedListener=function(a){this._pixelDataChangedListeners.push(a)},d.prototype.removePixelDataChangedListener=function(a){var b=this._pixelDataChangedListeners.indexOf(a);if(-1===b)throw new Error("Listener is not added");this._pixelDataChangedListeners.splice(b,1)},d.prototype._notifyPixleDataChangedListeners=function(){for(var a=0;a<this._pixelDataChangedListeners.length;++a)this._pixelDataChangedListeners[a].onTexturePixelDataChanged(this)},d.prototype._createAndBindHandle=function(a,b,c){var e=this.gl;this.handle=e.createTexture(),this.target=a,e.bindTexture(a,this.handle);var f;c===d.Filter.Nearest?f=e.NEAREST:c===d.Filter.Linear&&(f=e.LINEAR),e.texParameteri(a,e.TEXTURE_MAG_FILTER,f),e.texParameteri(a,e.TEXTURE_MIN_FILTER,f),b===d.WrapMode.Repeat?(e.texParameteri(a,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(a,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),this.wrapMode=b},d.prototype._textureDataLoaded=function(a,b){this.size=[a,b],this.loaded=!0,this._notifySizeCallbacks(this.size),e+=a*b*4},d.prototype._notifySizeCallbacks=function(a){if(0!==this.sizeCallbacks.length){for(var b=0;b<this.sizeCallbacks.length;++b)this.sizeCallbacks[b].callback(a);this.sizeCallbacks.length=0}},d.prototype.dispose=function(){this.gl.deleteTexture(this.handle)},d.WrapMode={Clamp:0,Repeat:1},d.Filter={Nearest:1,Linear:2},b.exports=d},{}],349:[function(a,b,c){"use strict";function d(a){this.webGLHelper=a,this.textureCache={}}d.prototype.getTexture=function(a,b){var c=this.textureCache[a];return c||(c=this.webGLHelper.createTexture({path:a,domElement:b}),this.textureCache[a]=c),c},d.prototype.flushUnused=function(){for(var a in this.textureCache){var b=this.textureCache[a];0===b.refCount&&b.preloadedAndUnused===!1&&b.keepForever===!1&&delete this.textureCache[a]}},d.prototype.evict=function(a){this.textureCache[a]?delete this.textureCache[a]:console.log("WebGLTextureCache.evict: texture doesn't exist: "+a)},d.prototype.clear=function(){this.textureCache={}},b.exports=d},{}],350:[function(a,b,c){"use strict";function d(a,b,c){this.gl=a,this.gl.numVertexAttribsEnabled=0,this.screenCameraProjection=l.create(),this.screenCameraView=l.create(),this.fieldOfView=25,this._whiteTexture=null,this.currentBlendMode=d.BlendMode.Solid,this.currentRenderTarget=0,this.currentShader=0,this.currentUniformValues=null,this.currentViewMatrix=this.screenCameraView,this.currentProjectionMatrix=this.screenCameraProjection,this.currentDepthTestState=!1,this.currentScissorTestState=!1,this.currentStencilTestState=!1,this.currentBoundMesh=null,this.maskRenderingEnabled=!1,this.currentViewport={width:0,height:0},a.disable(a.CULL_FACE),a.clearColor(0,0,0,0),a.stencilMask(255),a.clearStencil(128),this.supportsEGLImageExternal=a.TEXTURE_EXTERNAL_OES?!0:!1,this.cameraMatricesDirty=!0,this.activeTexture=0,this.setVirtualSize(b,c),this.resourceDirectory="",this._defaultVsSource=["uniform mat4 u_projection;","uniform mat4 u_view;","attribute vec3 a_position;","attribute vec2 a_uv;","attribute vec4 a_color;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","   gl_Position = u_projection * u_view * vec4(a_position, 1.0);","   uv = a_uv;","   color = a_color;","}"].join("\n"),this._defaultFsSource=["uniform sampler2D texture;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    gl_FragColor = texture2D(texture, uv)*color;","}"].join("\n"),this._videoFsSource=["#extension GL_OES_EGL_image_external : require","uniform samplerExternalOES texture;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    gl_FragColor = texture2D(texture, uv)*color;","}"].join("\n"),this._imageMaskFsSource=["uniform sampler2D texture;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    lowp vec4 tex = texture2D(texture, uv);","    if (tex.a < 0.5) {","       discard;","    }","    else {","       gl_FragColor = vec4(vec3(tex.a), 1.);","    }","}"].join("\n")}function e(a,b){var c=new window.XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState&&200===c.status)b(c.responseText);else if(404===c.status)throw new Error("Failed to read shader file: "+a)},c.open("GET",a,!0),c.send()}function f(a,b,c){var d=g(c,"vertex"),e=g(c,"fragment"),f=b.file;b.file=void 0,b.vertexSource=d,b.fragmentSource=e;var h=a.createShader(b);void 0!==b.onCreated&&b.onCreated(h,f)}function g(a,b){function c(a,b,c,d){void 0===c&&(c=0),void 0===d&&(d=a.length);for(var e=0,f=a.indexOf(b,c);-1!=f&&d>f;)e++,f=a.indexOf(b,f+1);return e}function d(a,b){for(var c="",d=0;b>d;d++)c+=a;return c}var e,f,g="(^|\\n)\\s*\\["+b+"\\]((\\n|.)*?)(\\n\\s*\\[|$)",h=new RegExp(g);if(e=h.exec(a),null!==e){var i=e[2],j=a.indexOf(i),k=c(a,"\n",0,j),l=c(a,"\n",j+i.length);f=d("\n",k),f+=i,f+=d("\n",l)}return f}var h=a("./mesh"),i=a("./shader"),j=a("./texture"),k=a("./fbo"),l=a("../../math/mat4");d.prototype.setVirtualSize=function(a,b){this.virtualWidth=a,this.virtualHeight=b,this.calculateCamera(this.screenCameraView,this.screenCameraProjection,this.virtualWidth,this.virtualHeight)},d.prototype.setRenderBufferSize=function(a,b){this.renderWidth=a,this.renderHeight=b,this.gl.viewport(0,0,a,b),this.currentViewport.width=a,this.currentViewport.height=b},d.prototype.createShader=function(a){return void 0===a.vertexSource&&(a.vertexSource=this._defaultVsSource),void 0===a.fragmentSource&&(a.fragmentSource=this._defaultFsSource),new i(this.gl,a)},d.prototype.createShaderFromFile=function(a){if(void 0===a.file)throw new Error("createShaderFromFile: no file specified");e(a.file,f.bind(null,this,a))},d.prototype.createMesh=function(a){return new h(this.gl,a)},d.prototype.createTexture=function(a){return new j(this.gl,a)},d.prototype.createFBO=function(a){return a.texture=j(this.gl,{width:a.width,height:a.height}),new k(this.gl,a)},d.prototype.calculateCamera=function(a,b,c,d){var e=this.fieldOfView*Math.PI/180,f=.5*d/Math.tan(.5*e);l.perspective(b,e,c/d,.05*f,5*f),l.identity(a),l.translate(a,.5*-c,.5*d,-f),a[5]=-1,this.cameraMatricesDirty=!0},d.prototype.bindScreen=function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,null),a.viewport(0,0,this.renderWidth,this.renderHeight),this.currentViewport.width=this.renderWidth,this.currentViewport.height=this.renderHeight},d.prototype.setBlendMode=function(a){if(a!==this.currentBlendMode){var b=this.gl;this.currentBlendMode=a,this.currentBlendMode===d.BlendMode.Alpha?(b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.enable(b.BLEND)):this.currentBlendMode===d.BlendMode.Additive?(b.blendFunc(b.ONE,b.ONE),b.enable(b.BLEND)):this.currentBlendMode===d.BlendMode.Solid?b.disable(b.BLEND):this.currentBlendMode===d.BlendMode.Multiply&&(b.blendFunc(b.DST_COLOR,b.ONE_MINUS_SRC_ALPHA),b.enable(b.BLEND))}},d.prototype.setDepthTest=function(a){if(a!==this.currentDepthTestState){var b=this.gl;a?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST),this.currentDepthTestState=a}},d.prototype.setStencilTest=function(a){if(a!==this.currentStencilTestState){var b=this.gl;a?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST),this.currentStencilTestState=a}},d.prototype.setScissorTest=function(a,b){var c=this.gl;if(this.currentScissorTestState!==a&&(a?c.enable(c.SCISSOR_TEST):c.disable(c.SCISSOR_TEST),this.currentScissorTestState=a),a){var d=this.currentViewport.width/this.virtualWidth,e=this.currentViewport.height/this.virtualHeight,f=0!==this.currentRenderTarget;f&&(d=1,e=1);var g=Math.ceil(b[0]*d),h=Math.ceil(this.currentViewport.height-b[3]*e),i=Math.ceil((b[2]-b[0])*d),j=Math.ceil((b[3]-b[1])*e);c.scissor(g,h,i,j)}},d.prototype.bindFbo=function(a){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,a.fbo),b.viewport(0,0,a.width,a.height),this.currentViewport.width=a.width,this.currentViewport.height=a.height},d.prototype.bindRenderTarget=function(a){a!==this.currentRenderTarget&&(this.currentRenderTarget=a,0===this.currentRenderTarget||null===this.currentRenderTarget?(this.bindScreen(),this.currentViewMatrix=this.screenCameraView,this.currentProjectionMatrix=this.screenCameraProjection,this.cameraMatricesDirty=!0):(this.bindFbo(this.currentRenderTarget.fbo),this.currentViewMatrix=this.currentRenderTarget.cameraView,this.currentProjectionMatrix=this.currentRenderTarget.cameraProjection,this.cameraMatricesDirty=!0)),this.setScissorTest(!1),this.setMaskRendering(!1),this.gl.stencilMask(255),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT)},d.prototype.bindTexture=function(a,b){this.activeTexture!==a&&(this.activeTexture=a,this.gl.activeTexture(this.gl.TEXTURE0+a)),this.gl.bindTexture(b.target,b.handle)},d.prototype.bindShader=function(a,b){var c=this.gl;if(this.currentShader!==a&&(this.currentShader=a,this.currentBoundMesh=null,c.useProgram(this.currentShader.program),void 0!==a.standardUniforms.texture&&c.uniform1i(a.standardUniforms.texture,0),this.cameraMatricesDirty=!0,a.hasDirtyUniforms=!0),b!==this.currentUniformValues&&(this.currentUniformValues=b,a.hasDirtyUniforms=!0),this.currentShader.hasDirtyUniforms){for(var d=1,e=this.currentShader._uniforms,f=0,g=a.uniformNames.length;g>f;f++){var h=a.uniformNames[f],i=e[h],j=i.value;b&&b.hasOwnProperty(h)&&(j=b[h]),"float"===i.type||"f"===i.type?c.uniform1f(i.location,j):"vec2"===i.type?c.uniform2f(i.location,j[0],j[1]):"vec3"===i.type?c.uniform3f(i.location,j[0],j[1],j[2]):"vec4"===i.type?c.uniform4f(i.location,j[0],j[1],j[2],j[3]):"sampler2D"===i.type&&(this.bindTexture(d,j),c.uniform1i(i.location,d),d++)}a.hasDirtyUniforms=!1}this.cameraMatricesDirty&&(void 0!==a.standardUniforms.u_projection&&c.uniformMatrix4fv(a.standardUniforms.u_projection,!1,this.currentProjectionMatrix),void 0!==a.standardUniforms.u_view&&c.uniformMatrix4fv(a.standardUniforms.u_view,!1,this.currentViewMatrix),this.cameraMatricesDirty=!1)},d.prototype.bindMesh=function(a){this.currentBoundMesh!==a&&(a.bind(this.currentShader.attributes,this.currentShader.numComponentsPerVertex),this.currentBoundMesh=a)},d.prototype.beginFrame=function(){var a=this.gl;a.stencilMask(255),a.clear(a.STENCIL_BUFFER_BIT)},d.prototype.setMaskRendering=function(a,b){var c=this.gl;this.setStencilTest(!0),a?(this.maskRenderingEnabled===!1&&(c.colorMask(!1,!1,!1,!1),c.depthMask(!1),c.stencilFunc(c.NEVER,1,255),this.maskRenderingEnabled=!0),b?c.stencilOp(c.INCR,c.INCR,c.INCR):c.stencilOp(c.DECR,c.DECR,c.DECR)):this.maskRenderingEnabled===!0&&(c.colorMask(!0,!0,!0,!0),c.depthMask(!0),c.stencilFunc(c.LEQUAL,128,255),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),this.maskRenderingEnabled=!1)},d.prototype.executeRenderCommand=function(a){var b=this.gl;this.setBlendMode(a.blendMode),this.setDepthTest(a.depthTest),this.setMaskRendering(a.writeToStencil,a.maskIsPositive),this.setScissorTest(a.scissorTest,a.scissorRect),this.bindShader(a.shader,a.shaderUniforms),this.bindTexture(0,a.texture);var c=this.currentShader.standardUniforms.u_world;void 0!==c&&a.worldTransform&&b.uniformMatrix4fv(c,!1,a.worldTransform);var d=this.currentShader.standardUniforms.u_opacity;void 0!==d&&b.uniform1f(d,a.opacity);var e=this.currentShader.standardUniforms.u_color;void 0!==e&&b.uniform3f(e,a.color[0],a.color[1],a.color[2]);var f=this.currentShader.standardUniforms.u_srcRect;void 0!==f&&b.uniform4f(f,a.srcRect[0],a.srcRect[1],a.srcRect[2],a.srcRect[3]);var g=this.currentShader.standardUniforms.u_flipTexCoordY;void 0!==g&&b.uniform1f(g,a.flipTexCoordY),this.bindMesh(a.mesh),-1===a.vertexIndex?a.mesh.draw():a.mesh.drawVertexRange(a.vertexIndex,4)},d.prototype.whiteTexture=function(){return null===this._whiteTexture&&(this._whiteTexture=this.createTexture({pixels:new Uint8Array([255,255,255,255]),width:1,height:1})),this._whiteTexture},d.prototype.setFieldOfView=function(a){this.fieldOfView=a,
this.calculateCamera(this.screenCameraView,this.screenCameraProjection,this.virtualWidth,this.virtualHeight)},d.BlendMode={Alpha:0,Solid:1,Additive:2,Multiply:3},b.exports=d},{"../../math/mat4":334,"./fbo":343,"./mesh":344,"./shader":346,"./texture":348}],351:[function(a,b,c){"use strict";function d(a){a=a||{},this.cache={},this.activeReferences={},this.freelist={},this.freelistKeys=[],this.freelistMaxLength=a.freelistSize||0,this.disposeCallback=a.disposeCallback}d.prototype.isInCache=function(a){return this.cache.hasOwnProperty(a)||this.freelist.hasOwnProperty(a)},d.prototype.addResource=function(a,b){this.cache[a]={resource:b,refCount:0}},d.prototype._decreaseRefCount=function(a){var b=this.cache[a];if(b.refCount--,0===b.refCount){if(this.freelistMaxLength>0){if(this.freelistKeys.length===this.freelistMaxLength){var c=this.freelistKeys.shift();this._dispose(this.freelist[c]),delete this.freelist[c]}this.freelistKeys.push(a),this.freelist[a]=b.resource}else this._dispose(b.resource);delete this.cache[a]}},d.prototype.removeReference=function(a){if(this.activeReferences.hasOwnProperty(a)!==!1){var b=this.activeReferences[a];this._decreaseRefCount(b),delete this.activeReferences[a]}},d.prototype.updateReference=function(a,b){if(this.activeReferences[a]!==b){var c=this.activeReferences[a];if(this.freelist.hasOwnProperty(b)){this.cache[b]={resource:this.freelist[b],refCount:0},delete this.freelist[b];var d=this.freelistKeys.indexOf(b);this.freelistKeys.splice(d,1)}this.activeReferences[a]=b,this.cache[b].refCount++,c&&this._decreaseRefCount(c)}},d.prototype.getResource=function(a){return this.cache[a].resource},d.prototype.clear=function(){var a;for(a in this.cache)this._dispose(this.cache[a].resource);for(a in this.freelist)this._dispose(this.freelist[a]);this.cache={},this.freelist={},this.freelistKeys=[]},d.prototype._dispose=function(a){this.disposeCallback?this.disposeCallback(a):a.dispose&&a.dispose()},b.exports=d},{}],352:[function(a,b,c){"use strict";function d(){}function e(a){this.axis=a.axis||0,this.track=a.hasOwnProperty("track")?a.track:!0,this.threshold=a.threshold,this.onDragStart=a.onDragStart||d,this.onDrag=a.onDrag||d,this.onDragEnd=a.onDragEnd||d,this._startPosition=0,this._touchPosition=0,this._hasPressedDown=!1,this._isDragging=!1,this._velocity=0,this._deltaPosition=0}e.prototype=Object.create(e.prototype,{velocity:{get:function(){return this._velocity}},dragDistance:{get:function(){return this._touchPosition-this._startPosition}},dragDelta:{get:function(){return this._deltaPosition}}}),e.prototype.onTouch=function(a){if(a.isDown)this._touchPosition=a.pos[this.axis],this._hasPressedDown=!0,this._velocity=0,this._deltaPosition=0,this._startPosition=this._touchPosition;else if(a.isMove&&this._hasPressedDown){var b=a.pos[this.axis];if(this._isDragging===!1?Math.abs(b-this._touchPosition)>this.threshold&&(this._isDragging=!0,this._startPosition=b,this._touchPosition=b,this.onDragStart()):(a.deltaTime>0&&(this._velocity=(b-this._touchPosition)/a.deltaTime),this._touchPosition=b,this._deltaPosition=a.delta[this.axis],this.onDrag()),this._isDragging&&this.track)return"StartTracking"}else(a.isUp||a.isExit)&&this._isDragging&&(this._isDragging=!1,this._hasPressedDown=!1,this._deltaPosition=0,this.onDragEnd())},b.exports=e},{}],353:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f=1-e;return f*f*f*a+3*f*f*e*b+3*f*e*e*c+e*e*e*d}function e(a,b){this.axis=b.axis,this.scrollCallback=b.scrollCallback,this.scrollThreshold=b.scrollThreshold,this.shouldRubber=void 0!==b.shouldRubber?b.shouldRubber:!0,this.scrollSpeed=void 0!==b.scrollSpeed?b.scrollSpeed:1,this.scrollEndedAnimationDuration=b.scrollEndedAnimationDuration||300,this.scrollEndedPositionCallback=b.scrollEndedPositionCallback,this.trackId=-1,this.animation=null,this.speed=0,this.timerScheduler=a,this.scrollObjectSize=1,this.scrollViewSize=1,this.rubberLength=4}e.prototype.onTouch=function(a,b){if(-1===this.trackId||b.id===this.trackId){var c=0,e=this.axis,f=!0;if(b.isDown||b.isEnter)this.hasMoved=!1,this.downStartPos=b.pos[e],this.animation&&this.animation.stop(),this.speed=0;else if(b.isMove&&(this.hasMoved||Math.abs(b.pos[e]-this.downStartPos)>this.scrollThreshold)){this.hasMoved=!0;var g=0,h=a+b.delta[e],i=Math.min(0,-this.scrollObjectSize+this.scrollViewSize);if(h>0?g=h:i>h&&(g=i-h),g>0&&this.shouldRubber){var j=Math.max(0,1-g/this.scrollViewSize*this.rubberLength);c=b.delta[e]*j}else h>0?(c=-a,this.shouldRubber===!1&&(f=!1)):i>h?(c=i-a,this.shouldRubber===!1&&(f=!1)):c=b.delta[e];b.deltaTime>0&&(this.speed=b.delta[this.axis]/b.deltaTime),0!==c&&(a+=c,this.scrollCallback(a,c))}else if((b.isUp||b.isExit)&&this.hasMoved===!0){this.hasMoved=!1;var k=this.scrollEndedAnimationDuration,l=a+this.speed*k/3,m=a+this.speed*k/3,n=Math.min(0,this.scrollViewSize-this.scrollObjectSize);l>0?(l=0,m=0):n>l&&(l=n,m=l),l=this.scrollEndedPositionCallback(this.speed,l),this.shouldRubber===!1&&(m=l);var o=this.scrollCallback,p=this.onScrollEnded;this.animation=this.timerScheduler.createTimer({duration:k,p0:a,p1:m,p2:l,p3:l,onRunning:function(a){o(d(this.p0,this.p1,this.p2,this.p3,a))},onFinish:function(){p&&p()}}).start()}return this.hasMoved&&f?(this.trackId=b.id,"StartTracking"):void(this.trackId=-1)}},e.prototype.setOrientation=function(a){this.axis="horizontal"===a?0:1},b.exports=e},{}],354:[function(a,b,c){"use strict";function d(a,b){this.scrollThreshold=a,this.startPos=[0,0],this.hasReceivedDownEvent=!1,this.callback=b}d.prototype.onTouch=function(a,b){if(b.isDown)this.startPos[0]=b.pos[0],this.startPos[1]=b.pos[1],this.hasReceivedDownEvent=!0;else if(b.isMove)(Math.abs(b.pos[0]-this.startPos[0])>this.scrollThreshold||Math.abs(b.pos[1]-this.startPos[1])>this.scrollThreshold)&&(this.hasReceivedDownEvent=!1);else if(b.isUp&&this.hasReceivedDownEvent===!0)return this.callback(a,b),this.hasReceivedDownEvent=!1,"StopPropagation"},b.exports=d},{}],355:[function(a,b,c){"use strict";function d(){this.trackedControls=[],this.lastTouch=[],this.prevIntersectedControlsDepthLayers={},this.hoverState={prevIntersectedControlsDepthLayers:{},lastHover:{}},this.depthIndices=[],this.numDepthIndices=0,this.focusedControl=null}function e(a,b){return a-b}function f(a){for(var b=0,c=a.length;c>b;++b)null!==a[b].onTouch&&a[b].onTouch(p)}function g(a){for(var b=0,c=a.length;c>b;++b)null!==a[b].onHover&&a[b].onHover(r)}function h(a,b){return n.isPointInside(a.childAABB||a.screenAABB,b)}function i(a,b){return n.isPointInside(a.screenAABB,b)}function j(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.touchPropagation&&a.visible&&a.opacity>0&&h(a,b.pos)){(a.onTouch||a.blockTouch)&&i(a,b.pos)&&(a.blockTouch&&(c[d]=[],s=Math.max(s,d)),a.onTouch&&(void 0===c[d]&&(c[d]=[]),c[d].push(a)));var e=a.children;if(e)for(var f=0,g=e.length;g>f;f++)j(e[f],b,c,d)}}function k(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.touchPropagation&&a.visible&&a.opacity>0&&h(a,b.pos)){(a.onHover||a.blockTouch)&&i(a,b.pos)&&(a.blockTouch&&(c[d]=[],s=Math.max(s,d)),a.onHover&&(void 0===c[d]&&(c[d]=[a]),c[d].push(a)));var e=a.children;if(e)for(var f=0,g=e.length;g>f;f++)k(e[f],b,c,d)}}function l(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.visible&&a.opacity>0&&h(a,b)){(a.onTouch||a.blockTouch)&&i(a,b)&&(void 0===c[d]&&(c[d]=[]),c[d].push(a));var e=a.children;if(e)for(var f=0,g=e.length;g>f;f++)l(e[f],b,c,d)}}function m(){return{pos:[0,0],delta:[0,0],deltaTime:0,type:"isMove",isMove:!1,isUp:!1,isDown:!1,isEnter:!1,isExit:!1,id:0}}var n=a("../math/aabb"),o=m();o.type="isEnter",o.isEnter=!0;var p=m();p.type="isExit",p.isExit=!0;var q=m();q.type="isHoverEnter",q.isHoverEnter=!0;var r=m();r.type="isHoverExit",r.isHoverExit=!0,d.prototype.processTouchEvent=function(a,b){var c=b.id,d=this.lastTouch[c];d||(this.lastTouch[c]={pos:[0,0],time:0},d=this.lastTouch[c]),b.isMove&&(b.delta[0]=b.pos[0]-d.pos[0],b.delta[1]=b.pos[1]-d.pos[1],b.deltaTime=b.time-d.time),d.time=b.time,d.pos[0]=b.pos[0],d.pos[1]=b.pos[1];var g={0:[]};this.trackedControls[b.id]?g[0].push(this.trackedControls[b.id]):(s=-1e7,j(a,b,g,void 0===a.depth?0:a.depth)),o.id=b.id,o.pos[0]=b.pos[0],o.pos[1]=b.pos[1],o.delta[0]=b.delta[0],o.delta[1]=b.delta[1],o.deltaTime=b.deltaTime,o.force=b.force,o.domEvent=b.domEvent,p.id=b.id,p.pos[0]=b.pos[0],p.pos[1]=b.pos[1],p.delta[0]=b.delta[0],p.delta[1]=b.delta[1],p.deltaTime=b.deltaTime,p.force=0,p.domEvent=b.domEvent;var h,i,k,l,m,n,q=!0;this.numDepthIndices=0;for(n in g)n>=s&&(this.depthIndices[this.numDepthIndices++]=n);for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),l=this.numDepthIndices-1;l>=0&&q;--l)for(k=this.depthIndices[l],m=g[k],h=m.length-1;h>=0;--h){var r=m[h],t=!1;for(i in this.prevIntersectedControlsDepthLayers){var u=this.prevIntersectedControlsDepthLayers[i].indexOf(r);if(-1!==u){t=!0,this.prevIntersectedControlsDepthLayers[i].splice(u,1);break}}t===!1&&(r.onTouch(o),this.focusedControl&&r!==this.focusedControl&&(this.focusedControl.blur(),this.focusedControl=null));var v=r.onTouch(b);if("StartTracking"===v){this.trackedControls[b.id]=r,q=!1;break}if(this.trackedControls[b.id]=null,"StopPropagation"===v){q=!1;break}void 0!==v&&console.log("unknown return value from from onTouch "+v)}if(b.isUp){for(l=this.numDepthIndices-1;l>=0;--l)k=this.depthIndices[l],m=g[k],f(m);this.prevIntersectedControlsDepthLayers={}}else{this.numDepthIndices=0;for(n in this.prevIntersectedControlsDepthLayers)this.depthIndices[this.numDepthIndices++]=n;for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),l=this.numDepthIndices-1;l>=0;--l)k=this.depthIndices[l],m=this.prevIntersectedControlsDepthLayers[k],f(m);this.prevIntersectedControlsDepthLayers=g}},d.prototype.processHoverEvent=function(a,b){var c=(b.id,{0:[]});s=-1e7,k(a,b,c,void 0===a.depth?0:a.depth),q.id=b.id,q.pos[0]=b.pos[0],q.pos[1]=b.pos[1],q.delta[0]=b.delta[0],q.delta[1]=b.delta[1],q.deltaTime=b.deltaTime,q.domEvent=b.domEvent,r.id=b.id,r.pos[0]=b.pos[0],r.pos[1]=b.pos[1],r.delta[0]=b.delta[0],r.delta[1]=b.delta[1],r.deltaTime=b.deltaTime,r.domEvent=b.domEvent;var d,f,h,i,j,l,m=!0;this.numDepthIndices=0;for(l in c)l>=s&&(this.depthIndices[this.numDepthIndices++]=l);for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),i=this.numDepthIndices-1;i>=0&&m;--i)for(h=this.depthIndices[i],j=c[h],d=j.length-1;d>=0;--d){var n=j[d],o=!1;for(f in this.hoverState.prevIntersectedControlsDepthLayers){var p=this.hoverState.prevIntersectedControlsDepthLayers[f].indexOf(n);if(-1!==p){o=!0,this.hoverState.prevIntersectedControlsDepthLayers[f].splice(p,1);break}}o===!1&&n.onHover(q);var t=n.onHover(b);if("StopPropagation"===t){m=!1;break}void 0!==t&&console.log("unknown return value from from onhoverEvent "+t)}this.numDepthIndices=0;for(l in this.hoverState.prevIntersectedControlsDepthLayers)this.depthIndices[this.numDepthIndices++]=l;for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),i=this.numDepthIndices-1;i>=0;--i)h=this.depthIndices[i],j=this.hoverState.prevIntersectedControlsDepthLayers[h],g(j);this.hoverState.prevIntersectedControlsDepthLayers=c},d.prototype.handleTouchEvent=function(a,b){var c=m();c.pos[0]=b.x,c.pos[1]=b.y,c.delta[0]=0,c.delta[1]=0,c.time=b.timestamp,c[c.type]=!1,c.type=b.type,c[b.type]=!0,c.id=b.id,c.force=b.force,c.domEvent=b.domEvent,this.processTouchEvent(a,c)},d.prototype.handleHoverEvent=function(a,b){var c=m();c.pos[0]=b.x,c.pos[1]=b.y,c.delta[0]=0,c.delta[1]=0,c.time=b.timestamp,c[c.type]=!1,c.type=b.type,c[b.type]=!0,c.id=b.id,c.force=0,c.domEvent=b.domEvent,this.processHoverEvent(a,c)},d.prototype.setFocus=function(a){return a.blur?void(this.focusedControl=a):void console.error("Can't set focus on a control that can't be blurred")};var s;d.prototype.hitTest=function(a,b){var c={};return l(a,b,c,0),c},b.exports=d},{"../math/aabb":332}],356:[function(a,b,c){"use strict";function d(){e.call(this),this.mouseDown=!1,this.lastTouch=[];var a=this;this.onMouseMove=function(b){b.preventDefault(),a.mouseDown===!0&&a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),0,b.timeStamp,"isMove",b),a.emitHoverEvent(0,a.getTouchX(b),a.getTouchY(b),b.timeStamp,"isHoverMove",b)},this.onTouchMove=function(b){a.onTouchEvent(b,"isMove")},this.onTouchLeave=function(b){a.onTouchEvent(b,"isUp")},this.onTouchEnd=function(b){a.onTouchEvent(b,"isUp")},this.onMouseUp=function(b){0===b.button&&(b.preventDefault(),a.mouseDown=!1,a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),b.force,b.timeStamp,"isUp",b))},this.onMouseOut=function(b){b.preventDefault(),a.mouseDown&&(a.mouseDown=!1,a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),b.force,b.timeStamp,"isUp",b)),a.emitHoverEvent(0,a.getTouchX(b),a.getTouchY(b),b.timeStamp,"isHoverMove",b)},this.onTouchStart=function(b){a.onTouchEvent(b,"isDown")},this.onMouseDown=function(b){0===b.button&&(b.preventDefault(),a.mouseDown=!0,a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),b.force,b.timeStamp,"isDown",b))}}var e=a("../../eventsender");d.prototype=Object.create(e.prototype),d.prototype.setDOMElement=function(a){this.domElement=a,a.style.pointerEvents="auto",this.setTouchEnabled(!0)},d.prototype.setTouchEnabled=function(a){var b=this.domElement;b&&(a?(b.addEventListener("mousemove",this.onMouseMove,!1),b.addEventListener("touchmove",this.onTouchMove,!1),b.addEventListener("touchleave",this.onTouchLeave,!1),b.addEventListener("touchend",this.onTouchEnd,!1),b.addEventListener("mouseup",this.onMouseUp,!1),b.addEventListener("mouseout",this.onMouseOut,!1),b.addEventListener("touchstart",this.onTouchStart,!1),b.addEventListener("mousedown",this.onMouseDown,!1)):(b.removeEventListener("mousemove",this.onMouseMove),b.removeEventListener("touchmove",this.onTouchMove),b.removeEventListener("touchleave",this.onTouchLeave),b.removeEventListener("touchend",this.onTouchEnd),b.removeEventListener("mouseup",this.onMouseUp),b.removeEventListener("mouseout",this.onMouseOut),b.removeEventListener("touchstart",this.onTouchStart),b.removeEventListener("mousedown",this.onMouseDown)))},d.prototype.onTouchEvent=function(a,b){a.preventDefault();for(var c=0;c<a.changedTouches.length;++c){var d=a.changedTouches[c];this.emitEvent(d.identifier,this.getTouchX(d),this.getTouchY(d),d.force,a.timeStamp,b,a)}},d.prototype.emitEvent=function(a,b,c,d,e,f,g){this.emit("touchEvent",{id:a,x:b,y:c,force:d,timestamp:e,type:f,domEvent:g})},d.prototype.emitHoverEvent=function(a,b,c,d,e,f){this.emit("hoverEvent",{id:a,x:b,y:c,timestamp:d,type:e,domEvent:f})},d.prototype.getTouchX=function(a){var b=this.domElement.getBoundingClientRect(),c=b.right-b.left,d=a.pageX-b.left;return d/c},d.prototype.getTouchY=function(a){var b=this.domElement.getBoundingClientRect(),c=b.bottom-b.top,d=a.pageY-b.top;return d/c},b.exports=d},{"../../eventsender":221}],357:[function(a,b,c){"use strict";function d(a,b){i.call(this),this.timerScheduler=a,this.eventSender=new i,this.layouter=new f,this.imageCache=new v,this.renderer=new e(b);var c=this;this.renderer.on("requestFrame",function(){c.eventSender.emit("requestFrame")}),this.root=this.createDockLayoutControl(),this.root.setSizeMode("explicit"),this.root.setWidthUnit("px"),this.root.setHeightUnit("px"),this.touchEngine=new g,this.touchListener=new h,this.touchListener.on("touchEvent",this.handleTouchEvent.bind(this),this),this.touchListener.on("hoverEvent",this.handleHoverEvent.bind(this),this),this.fillMode="aspectFit",this.setAspectFitViewport(1080,1920),this.root.setContentDirty=function(a){k.prototype.setContentDirty(a),a&&c.eventSender.emit("requestFrame")},window.addEventListener("resize",function(){c._resizeViewport(),c.eventSender.emit("requestFrame")}),this.rendererSet=!1}var e=a("./renderer"),f=a("./layout/layouter"),g=a("./touch/touchengine"),h=a("./touch/touchlistener"),i=a("../eventsender"),j=a("./controls/circlecontrol"),k=a("./controls/docklayoutcontrol"),l=a("./controls/flowlayoutcontrol"),m=a("./controls/imagecontrol"),n=a("./controls/rectanglecontrol"),o=a("./controls/scrollviewcontrol"),p=a("./controls/stacklayoutcontrol"),q=a("./controls/textcontrol"),r=a("./controls/textinputcontrol"),s=a("./controls/meshcontrol"),t=a("./touch/taphandler"),u=a("./touch/draggesturerecognizer"),v=a("./imagecache");d.prototype=Object.create(i.prototype),d.prototype.constructor=d,d.prototype._addListenersToControl=function(a){a.on("disposed",this.renderer.onControlDisposed.bind(this.renderer))},d.prototype.createCircleControl=function(){var a=new j(this.layouter,this.imageCache);return this._addListenersToControl(a),a},d.prototype.createDockLayoutControl=function(){var a=new k(this.layouter);return a},d.prototype.createFlowLayoutControl=function(){return new l(this.layouter)},d.prototype.createImageControl=function(){var a=new m(this.layouter,this.imageCache);return this._addListenersToControl(a.innerControl),a},d.prototype.createRectangleControl=function(){var a=new n(this.layouter);return this._addListenersToControl(a),a},d.prototype.createScrollViewControl=function(){return new o(this.layouter,this.timerScheduler)},d.prototype.createStackLayoutControl=function(){return new p(this.layouter)},d.prototype.createTextControl=function(){var a=new q(this.layouter);return this._addListenersToControl(a.innerControl),a},d.prototype.createTextInputControl=function(){var a=new r(this.layouter);this._addListenersToControl(a);var b=this.renderer.createTextInputField(a.id);return b&&a.setInputField(b),a.on("focused",this.touchEngine.setFocus.bind(this.touchEngine)),a},d.prototype.createMeshControl=function(){var a=new s(this.layouter,this.imageCache);return this._addListenersToControl(a),a},d.prototype.createTapHandler=function(a){return new t(50,a)},d.prototype.createDragGestureRecognizer=function(a){return new u(a)},d.prototype.setAspectFitViewport=function(a,b){this.aspectFillViewportSize={width:a,height:b},this._resizeViewport()},d.prototype._resizeViewport=function(){var a,b;if("aspectFit"===this.fillMode)a=this.aspectFillViewportSize.width,b=this.aspectFillViewportSize.height;else{var c=this.renderer.rootElement.getBoundingClientRect();a=c.width,b=c.height}this._setViewportSize(a,b)},d.prototype._setViewportSize=function(a,b){this.renderer.setViewportSize(a,b),this.layouter.setWindowSize(a,b),this.root.setWidth(a),this.root.setHeight(b),this.root.screenAABB.max[0]=a,this.root.screenAABB.max[1]=b,this.root.childAABB.max[0]=a,this.root.childAABB.max[1]=b,this.emit("viewportSizeChanged",{width:a,height:b})},d.prototype.layout=function(){if(this.layouter.layout(this.root),this.root.contentDirty){this.renderer.beginLayout();for(var a=0;a<this.root.children.length;a++)this.renderer.layout(this.root.children[a],!1)}},d.prototype.renderFrame=function(){this.renderer.beginFrame(),this.renderer.render(this.root),this.renderer.endFrame()},d.prototype.handleTouchEvent=function(a){a.x*=this.renderer.viewportWidth,a.y*=this.renderer.viewportHeight,this.emit("touchEvent",a),this.touchEngine.handleTouchEvent(this.root,a)},d.prototype.handleHoverEvent=function(a){a.x*=this.renderer.viewportWidth,a.y*=this.renderer.viewportHeight,this.emit("hoverEvent",a),this.touchEngine.handleHoverEvent(this.root,a)},d.prototype.removeAllRenderers=function(){this.rendererSet=!1,this.renderer.removeAllRenderers()},d.prototype.addRenderer=function(a){this.rendererSet===!1&&a.rootElement&&(this.touchListener.setDOMElement(a.rootElement),this.rendererSet=!0),this.renderer.addRenderer(a)},d.prototype.setFillMode=function(a){this.fillMode=a,this.renderer.setFillMode(a),this._resizeViewport()},d.prototype.hitTest=function(a,b){return this.touchEngine.hitTest(this.root,[a,b])},d.prototype.captureScreenShot=function(a,b){return this.renderer.captureScreenShot(this.root,a,b)},d.prototype.getViewportSize=function(){return{width:this.renderer.viewportWidth,height:this.renderer.viewportHeight}},d.prototype.clearImageCache=function(){this.imageCache.clear(),this.renderer.clearImageCaches()},b.exports=d},{"../eventsender":221,"./controls/circlecontrol":310,"./controls/docklayoutcontrol":311,"./controls/flowlayoutcontrol":312,"./controls/imagecontrol":314,"./controls/meshcontrol":316,"./controls/rectanglecontrol":317,"./controls/scrollviewcontrol":318,"./controls/stacklayoutcontrol":319,"./controls/textcontrol":322,"./controls/textinputcontrol":323,"./imagecache":325,"./layout/layouter":328,"./renderer":335,"./touch/draggesturerecognizer":352,"./touch/taphandler":354,"./touch/touchengine":355,"./touch/touchlistener":356}],358:[function(a,b,c){"use strict";var d={Windows:function(){return/IEMobile/i.test(navigator.userAgent)},Android:function(){return/Android/i.test(navigator.userAgent)},BlackBerry:function(){return/BlackBerry/i.test(navigator.userAgent)},iOS:function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},any:function(){return d.Android()||d.BlackBerry()||d.iOS()||d.Windows()}};b.exports={isMobile:d}},{}]},{},[216])(216)});